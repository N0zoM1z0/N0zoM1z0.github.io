<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="能力有限 只能复现能做的一些题 其他的慢慢补">
<meta property="og:type" content="article">
<meta property="og:title" content="DASCTF X CBCTF 2023 10">
<meta property="og:url" content="http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/index.html">
<meta property="og:site_name" content="N0zoM1z0">
<meta property="og:description" content="能力有限 只能复现能做的一些题 其他的慢慢补">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2023/12/03/VSfdpxDN2AtmHkJ.png">
<meta property="og:image" content="https://s2.loli.net/2023/12/03/m9Br3gGlnudUvAO.png">
<meta property="og:image" content="https://s2.loli.net/2023/12/03/4bwU5vxHVqXTBIs.png">
<meta property="og:image" content="https://s2.loli.net/2023/12/03/7WanPqKwBNDe2gX.png">
<meta property="og:image" content="https://s2.loli.net/2023/12/03/YjdHfbD6wquvmnB.png">
<meta property="og:image" content="https://s2.loli.net/2023/12/03/GAH385FJgWbe4xw.png">
<meta property="og:image" content="https://s2.loli.net/2023/12/03/o6lqvjngdYhQsIW.png">
<meta property="og:image" content="https://s2.loli.net/2023/12/03/QR6G7gCuYtfhc1P.png">
<meta property="og:image" content="https://s2.loli.net/2023/12/03/GPh2KRF5AdOcoBj.png">
<meta property="og:image" content="https://s2.loli.net/2023/12/03/6zMsQ3kjYfnLX52.png">
<meta property="og:image" content="https://s2.loli.net/2023/12/03/1iHt5M7uEXzVw4A.png">
<meta property="og:image" content="https://s2.loli.net/2023/12/03/lEFAxXu9cnajroK.png">
<meta property="og:image" content="https://s2.loli.net/2023/12/03/IOML12SXx45RyFU.png">
<meta property="og:image" content="https://s2.loli.net/2023/12/03/Rusgx94JzwmIdvU.png">
<meta property="og:image" content="https://s2.loli.net/2023/12/03/OEBXFZSzy8VUcGt.png">
<meta property="article:published_time" content="2023-12-02T16:22:06.000Z">
<meta property="article:modified_time" content="2023-12-04T00:42:24.581Z">
<meta property="article:author" content="N0zoM1z0">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2023/12/03/VSfdpxDN2AtmHkJ.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>DASCTF X CBCTF 2023 10</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.1.1"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/N0zoM1z0">项目</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/%E8%AE%B0%E5%BD%95%E7%AC%AC%E4%B8%80%E6%AC%A1jadx-APK%E5%8A%A8%E8%B0%83/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/12-3-KasakiNozomi-s-Birthday/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/&text=DASCTF X CBCTF 2023 10"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/&title=DASCTF X CBCTF 2023 10"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/&is_video=false&description=DASCTF X CBCTF 2023 10"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=DASCTF X CBCTF 2023 10&body=Check out this article: http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/&title=DASCTF X CBCTF 2023 10"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/&title=DASCTF X CBCTF 2023 10"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/&title=DASCTF X CBCTF 2023 10"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/&title=DASCTF X CBCTF 2023 10"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/&name=DASCTF X CBCTF 2023 10&description=&lt;p&gt;能力有限 只能复现能做的一些题 其他的慢慢补&lt;/p&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/&t=DASCTF X CBCTF 2023 10"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-number">1.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#rsa"><span class="toc-number">1.1.</span> <span class="toc-text">rsa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#backpack"><span class="toc-number">1.2.</span> <span class="toc-text">backpack</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Re"><span class="toc-number">2.</span> <span class="toc-text">Re</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#auuuu3"><span class="toc-number">2.1.</span> <span class="toc-text">auuuu3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#marshal"><span class="toc-number">2.2.</span> <span class="toc-text">marshal</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        DASCTF X CBCTF 2023 10
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">N0zoM1z0</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-12-02T16:22:06.000Z" class="dt-published" itemprop="datePublished">2023-12-03</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/CTF-WP/">CTF-WP</a>
    </div>


      

    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>能力有限 只能复现能做的一些题 其他的慢慢补</p>
<span id="more"></span>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h2><p>chall.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">padding</span>(<span class="params">f</span>):</span><br><span class="line">    random_chars = <span class="built_in">bytes</span>([random.randint(<span class="number">0</span>, <span class="number">255</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)])</span><br><span class="line">    f = f + random_chars</span><br><span class="line">    <span class="keyword">return</span> f</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_p</span>(<span class="params">p</span>):</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    </span><br><span class="line">    P = p</span><br><span class="line">    n1 = getPrime(<span class="number">512</span>)*getPrime(<span class="number">512</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;enc.txt&#x27;</span>, <span class="string">&#x27;w+&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">while</span> jacobi(<span class="number">2</span>,n1) == <span class="number">1</span>:</span><br><span class="line">            n1 = getPrime(<span class="number">512</span>)*getPrime(<span class="number">512</span>)</span><br><span class="line">        <span class="keyword">while</span> P:</span><br><span class="line">            pad = random.randint(<span class="number">0</span>, <span class="number">2</span>**<span class="number">2023</span>)**<span class="number">2</span> </span><br><span class="line">            message = pad &lt;&lt; <span class="number">1</span> + P % <span class="number">2</span></span><br><span class="line">            cipher = <span class="built_in">pow</span>(message, e, n1)</span><br><span class="line">            f.write(<span class="built_in">str</span>(cipher)+<span class="string">&#x27;n&#x27;</span>)</span><br><span class="line">            P //= <span class="number">2</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n1 = &quot;</span>+ <span class="built_in">str</span>(n1) )    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_q</span>(<span class="params">q</span>):</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">q, n</span>):</span><br><span class="line">        e = random.randint(<span class="number">1000</span>,<span class="number">2000</span>)</span><br><span class="line">        noise = random.randint(<span class="number">0</span>, n - <span class="number">1</span>)</span><br><span class="line">        c = <span class="built_in">pow</span>(q+noise,e,n)</span><br><span class="line">        <span class="keyword">return</span> e, noise,c </span><br><span class="line">    </span><br><span class="line">    n2 = getPrime(<span class="number">512</span>)*getPrime(<span class="number">512</span>)</span><br><span class="line">    e1, noise1, c1 = encrypt(q, n2)</span><br><span class="line">    e2, noise2, c2 = encrypt(q, n2)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n2 = &quot;</span>+ <span class="built_in">str</span>(n2) ) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;(e1, noise1, c1) =&#x27;</span>, (e1,noise1,c1))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;(e2, noise2, c2) =&#x27;</span>, (e2,noise2,c2))</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">guess_p(p)</span><br><span class="line">guess_q(q)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">flag = padding(flag)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = &quot;</span> + <span class="built_in">str</span>(c))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n1 = 65634094430927080732256164808833233563732628654160389042977689628512527168256899310662239009610512772020503283842588142453533499954947692968978190310627721338357432052800695091789711809256924541784954080619073213358228083200846540676931341013554634493581962527475555869292091755676130810562421465063412235309</span></span><br><span class="line"><span class="string">n2 = 103670293685965841863872863719573676572683187403862749665555450164387906552249974071743238931253290278574192713467491802940810851806104430306195931179902098180199167945649526235613636163362672777298968943319216325949503045377100235181706964846408396946496139224344270391027205106691880999410424150216806861393</span></span><br><span class="line"><span class="string">(e1, noise1, c1) = (1743, 44560588075773853612820227436439937514195680734214431948441190347878274184937952381785302837541202705212687700521129385632776241537669208088777729355349833215443048466316517110778502508209433792603420158786772339233397583637570006255153020675167597396958251208681121668808253767520416175569161674463861719776, 65643009354198075182587766550521107063140340983433852821580802983736094225036497335607400197479623208915379722646955329855681601551282788854644359967909570360251550766970054185510197999091645907461580987639650262519866292285164258262387411847857812391136042309550813795587776534035784065962779853621152905983)</span></span><br><span class="line"><span class="string">(e2, noise2, c2) = (1325, 35282006599813744140721262875292395887558561517759721467291789696459426702600397172655624765281531167221787036009507833425145071265739486735993631460189629709591456017092661028839951392247601628468621576100035700437892164435424035004463142959219067199451575338270613300215815894328788753564798153516122567683, 50327632090778183759544755226710110702046850880299488259739672542025916422119065179822210884622225945376465802069464782311211031263046593145733701591371950349735709553105217501410716570601397725812709771348772095131473415552527749452347866778401205442409443726952960806789526845194216490544108773715759733714)</span></span><br><span class="line"><span class="string">c = 124349762993424531697403299350944207725577290992189948388824124986066269514204313888980321088629462472088631052329128042837153718129149149661961926557818023704330462282009415874674794190206220980118413541269327644472633791532767765585035518183177197863522573410860341245613331398610013697803459403446614221369</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>这里比赛的时候大概明白这里的Jacobi的玄机 但是只是储备完全不够 瞎猜的几个结论也求不出p<br>求q的部分当时也以为e不同不能sage跑(虽说写了一个copper但好像写假了。。。 要再认真弄懂copper的原理)<br>先跑q:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>():</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n2))</span><br><span class="line">    g1 = (x+noise1)^e1-c1</span><br><span class="line">    g2 = (x+noise2)^e2-c2</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">g1,g2</span>):</span><br><span class="line">        <span class="keyword">while</span> g2:</span><br><span class="line">            g1, g2 = g2,g1%g2</span><br><span class="line">        <span class="keyword">return</span> g1.monic()</span><br><span class="line">    <span class="keyword">return</span> -gcd(g1,g2)[<span class="number">0</span>]</span><br><span class="line"><span class="comment"># print(attack())</span></span><br></pre></td></tr></table></figure>
<p>然后求p<br>首先了解kronecker符号<br><img src="https://s2.loli.net/2023/12/03/VSfdpxDN2AtmHkJ.png" alt="_KE8ATP818UNXM_L6_9A_P2.png"><br>由于Jacobi只是将勒让德的奇素数推广到了奇数<br>而kronecker符号是推广到了一般的整数 更具普适意义</p>
<p>两种情况</p>
<ul>
<li><code>(2x^2)^e</code> </li>
<li><code>(2x^2+1)^e</code></li>
</ul>
<p><img src="https://s2.loli.net/2023/12/03/m9Br3gGlnudUvAO.png" alt="AHYCN6UYNIUKOMT____HZPE.png"><br><font color=red size=5>不要忘了欧拉准则！！！二次剩余最初的判断方式！！！</font></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">    <span class="comment"># print(i)</span></span><br><span class="line">    i = <span class="built_in">int</span>(i)</span><br><span class="line">    <span class="keyword">if</span>(kronecker(i,n1)==<span class="number">1</span>):</span><br><span class="line">        p = <span class="string">&#x27;1&#x27;</span>+p</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p = <span class="string">&#x27;0&#x27;</span>+p</span><br><span class="line"><span class="comment"># print(int(p,2))</span></span><br></pre></td></tr></table></figure>
<p>或者这种</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(kronecker(i,n1)==-<span class="number">1</span>):</span><br><span class="line">        p = <span class="string">&#x27;0&#x27;</span>+p</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p = <span class="string">&#x27;1&#x27;</span>+p</span><br></pre></td></tr></table></figure>
<p>最后的flag<br><img src="https://s2.loli.net/2023/12/03/4bwU5vxHVqXTBIs.png" alt="6R1Y1YM9VKF78ACQ__@FXF0.png"></p>
<h2 id="backpack"><a href="#backpack" class="headerlink" title="backpack"></a>backpack</h2><p>粗浅学了下格密码 看了看背包密码LLL破解的本质<br>还是要学会自己造格子<br>这题跟普通的背包不同在于 每6个中必有3个1<br>所以要再加上一列的约束 即 Σxi &#x3D; 24<br>借大佬的图<br><img src="https://s2.loli.net/2023/12/03/7WanPqKwBNDe2gX.png" alt="Y@V1GI@_GOC3F_LV8V_LY_H.png"><br>最后判断就是在常规的-S那列为0后加上最后一列为0<br>solution.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a = [<span class="number">65651991706497</span>, <span class="number">247831871690373</span>, <span class="number">120247087605020</span>, <span class="number">236854536567393</span>, <span class="number">38795708921144</span>, <span class="number">256334857906663</span>, <span class="number">120089773523233</span>, <span class="number">165349388120302</span>, <span class="number">123968326805899</span>, <span class="number">79638234559694</span>, <span class="number">259559389823590</span>, <span class="number">256776519514651</span>, <span class="number">107733244474073</span>, <span class="number">216508566448440</span>, <span class="number">39327578905012</span>, <span class="number">118682486932022</span>, <span class="number">263357223061004</span>, <span class="number">132872609024098</span>, <span class="number">44605761726563</span>, <span class="number">24908360451602</span>, <span class="number">237906955893793</span>, <span class="number">204469770496199</span>, <span class="number">7055254513808</span>, <span class="number">221802659519968</span>, <span class="number">169686619990988</span>, <span class="number">23128789035141</span>, <span class="number">208847144870760</span>, <span class="number">272339624469135</span>, <span class="number">269511404473473</span>, <span class="number">112830627321371</span>, <span class="number">73203551744776</span>, <span class="number">42843503010671</span>, <span class="number">118193938825623</span>, <span class="number">49625220390324</span>, <span class="number">230439888723036</span>, <span class="number">241486656550572</span>, <span class="number">107149406378865</span>, <span class="number">233503862264755</span>, <span class="number">269502011971514</span>, <span class="number">181805192674559</span>, <span class="number">152612003195556</span>, <span class="number">184127512098087</span>, <span class="number">165959151027513</span>, <span class="number">188723045133473</span>, <span class="number">241615906682300</span>, <span class="number">216101484550038</span>, <span class="number">81190147709444</span>, <span class="number">124498742419309</span>]</span><br><span class="line">re = <span class="number">4051501228761632</span></span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(a)</span><br><span class="line">K = <span class="number">2</span>^<span class="number">10</span></span><br><span class="line">M = Matrix(ZZ,n+<span class="number">1</span>,n+<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    M[i,i] = <span class="number">1</span></span><br><span class="line">    M[i,n] = K*a[i]</span><br><span class="line">    M[i,n+<span class="number">1</span>] = K*<span class="number">1</span></span><br><span class="line">M[n,n] = -K*re</span><br><span class="line">M[n,n+<span class="number">1</span>] = -<span class="number">24</span>*K</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> M.LLL():</span><br><span class="line">    <span class="keyword">if</span>(line[-<span class="number">1</span>]==<span class="number">0</span> <span class="keyword">and</span> line[-<span class="number">2</span>]==<span class="number">0</span>):</span><br><span class="line">        x = [<span class="built_in">abs</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> line[:-<span class="number">2</span>]]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">set</span>(x).issubset([<span class="number">0</span>, <span class="number">1</span>]):</span><br><span class="line">            <span class="built_in">print</span>(x)</span><br><span class="line">            flag = <span class="string">&#x27;DASCTF&#123;&#x27;</span>+sha256(<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> x]).encode()).hexdigest()+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p><img src="https://s2.loli.net/2023/12/03/YjdHfbD6wquvmnB.png" alt="image.png"></p>
<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="auuuu3"><a href="#auuuu3" class="headerlink" title="auuuu3"></a>auuuu3</h2><p>给的是一个autoit格式的exe<br>如果用IDA查看 基本上是做不出来的<br>万幸的是有个脚本可以帮我们extract<br><a target="_blank" rel="noopener" href="https://github.com/nazywam/AutoIt-Ripper">https://github.com/nazywam/AutoIt-Ripper</a><br>然后这么用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> autoit_ripper <span class="keyword">import</span> extract, AutoItVersion</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\浏览器下载\auuuu3.exe&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    file_content = f.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># EA05 for v3.00+, EA06 for v3.26+</span></span><br><span class="line"><span class="comment"># Omitting `version` or passing None will try both versions</span></span><br><span class="line">content_list = extract(data=file_content, version=AutoItVersion.EA06)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&#x27;D:\浏览器下载\auuuu3.txt&#x27;</span>,<span class="string">&#x27;w+&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> content <span class="keyword">in</span> content_list:</span><br><span class="line">        s = <span class="built_in">str</span>(content)</span><br><span class="line">        f.write(s)</span><br></pre></td></tr></table></figure>
<p>WP用的exe我没找到… 但是这样提取出来大致也能看<br>很容易定位到最后一部分<br><img src="https://s2.loli.net/2023/12/03/GAH385FJgWbe4xw.png" alt="image-1.png"><br>这里相当于load了一个dll 只是是用hex写的 我们将这段opcode导入dll用IDA来分析</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">OPCODE = <span class="string">&quot;83EC14B83400000099538B5C2420558B6C242056578B7C9DFCF7FB89C683C606C74424180000000085F68D76FF0F8EEA000000896C24288D4BFF8D549D00894C2410895424148974242081442418B979379E8B4C2418C1E90281E103000000894C241C31F6397424107E568B5424288BCF8B6CB204C1E9058D14AD0000000033CA8BD58BC7C1EA03C1E00433D003CA8B5424188BDE81E303000000335C241C8B4424308B1C9833D533DF03D333CA8B542428010CB28B0CB2463974241089CF7FAA8B5424288BCF8B2AC1E9058D14AD0000000033CA8BD58BC7C1EA03C1E00433D003CA8B5424188BDE81E303000000335C241C8B4424308B1C9833D533DF03D3FF4C242033CA8B542414014AFC8B4AFC8B54242089CF420F8F2DFFFFFF5F31C05E5D5B83C414C21000&quot;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\浏览器下载\enc.dll&quot;</span>,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(binascii.unhexlify(OPCODE))</span><br></pre></td></tr></table></figure>
<p><img src="https://s2.loli.net/2023/12/03/o6lqvjngdYhQsIW.png" alt="ZZ_QD_HMMKFJ94TSU_~VHPT.png"><br>标准的xxtea加密</p>
<p>我们已知 ciphertext<code>7218181A02F79F4B5773E8FFE83FE732DF96259FF2B86AAB945468A132A83D83CF9D750E316C8675</code></p>
<p>key<code>Wowww111auUu3</code><br>小端序转一下 解密</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z&gt;&gt;5^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">btea</span><span class="params">(<span class="type">uint32_t</span> *v, <span class="type">int</span> n, <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)            <span class="comment">/* Coding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n<span class="number">-1</span>; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p+<span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n<span class="number">-1</span>] += MX;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">/* Decoding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = rounds*DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=n<span class="number">-1</span>; p&gt;<span class="number">0</span>; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p<span class="number">-1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n<span class="number">-1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">10</span>]= &#123;<span class="number">0x1A181872</span>,<span class="number">0x4B9FF702</span>,<span class="number">0xFFE87357</span>,<span class="number">0x32E73FE8</span>,<span class="number">0x9F2596DF</span>,<span class="number">0xAB6AB8F2</span>,<span class="number">0xA1685494</span>,<span class="number">0x833DA832</span>,<span class="number">0x0E759DCF</span>,<span class="number">0x75866C31</span>&#125;;</span><br><span class="line">    <span class="type">uint32_t</span> <span class="type">const</span> k[<span class="number">4</span>]= &#123;<span class="number">0x77776f57</span>,<span class="number">0x31313177</span>,<span class="number">0x75557561</span>,<span class="number">0x33</span>&#125;;</span><br><span class="line">    <span class="type">int</span> n= <span class="number">10</span>; </span><br><span class="line">    btea(v, -n, k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">    	<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;=<span class="number">3</span>;j++)</span><br><span class="line">    		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,(v[i]&gt;&gt;(<span class="number">8</span>*j))&amp;<span class="number">0xff</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>flag : <strong>DASCTF{Oh1_autO1t_iS_so_Co0oL_aNd_Fun}</strong><br>可以看到 这题主要考的其实是合理利用工具进行分析(找到autoit-ripper后的分析其实并不难 <del>但如果只会IDA就G了…</del>)</p>
<h2 id="marshal"><a href="#marshal" class="headerlink" title="marshal"></a>marshal</h2><p>题目给的一个嵌套marshal的py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"></span><br><span class="line">code = <span class="string">b&#x27;c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00@\x00\x00\x00@\x00\x00\x00s\xe2\x00\x00\x00d\x00d\x01d\x02d\x03d\x04d\x05d\x06d\x07d\x08d\td\nd\x0bd\x0cd\rd\x0ed\x0fg\x10Z\x00d\x10d\x11\x84\x00e\x01d\x12\x83\x01D\x00\x83\x01Z\x02d\x05d\x12d\x13d\x14d\x0ed\x15d\x16d\x17d\x0fd\x18d\x19d\x1ad\x08d\x1bd\x1cd\x1dd\x0cd\x1ed\x1fd d\x01d!d&quot;d#d\x02d$d%d&amp;d\rd\&#x27;d(d)d\x0bd*d+d,d\x04d-d.d/d\x06d0d1d2d\x03d3d4d5d\x00d6d7d8d\x07d9d:d;d\td&lt;d=d&gt;d\nd?d@dAg@Z\x03dBd\x11\x84\x00e\x01dC\x83\x01D\x00\x83\x01Z\x04e\x05\xa0\x06dD\xa1\x01Z\x07e\x08e\x07\x83\x01\x01\x00dES\x00)F\xe9\x0c\x00\x00\x00\xe9\x05\x00\x00\x00\xe9\x06\x00\x00\x00\xe9\x0b\x00\x00\x00\xe9\t\x00\x00\x00\xe9\x00\x00\x00\x00\xe9\n\x00\x00\x00\xe9\r\x00\x00\x00\xe9\x03\x00\x00\x00\xe9\x0e\x00\x00\x00\xe9\x0f\x00\x00\x00\xe9\x08\x00\x00\x00\xe9\x04\x00\x00\x00\xe9\x07\x00\x00\x00\xe9\x01\x00\x00\x00\xe9\x02\x00\x00\x00c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x05\x00\x00\x00C\x00\x00\x00s\x16\x00\x00\x00g\x00|\x00]\x0e&#125;\x01t\x00\xa0\x01|\x01\xa1\x01\x91\x02q\x04S\x00\xa9\x00)\x02\xda\x04Sbox\xda\x05index\xa9\x02\xda\x02.0\xda\x01xr\x10\x00\x00\x00r\x10\x00\x00\x00\xda\x00\xda\n&lt;listcomp&gt;\x04\x00\x00\x00s\x04\x00\x00\x00\x06\x00\x02\x00r\x17\x00\x00\x00\xe9\x10\x00\x00\x00\xe9 \x00\x00\x00\xe90\x00\x00\x00\xe9\x11\x00\x00\x00\xe9!\x00\x00\x00\xe91\x00\x00\x00\xe9\x12\x00\x00\x00\xe9&quot;\x00\x00\x00\xe92\x00\x00\x00\xe9\x13\x00\x00\x00\xe9#\x00\x00\x00\xe93\x00\x00\x00\xe9\x14\x00\x00\x00\xe9$\x00\x00\x00\xe94\x00\x00\x00\xe9\x15\x00\x00\x00\xe9%\x00\x00\x00\xe95\x00\x00\x00\xe9\x16\x00\x00\x00\xe9&amp;\x00\x00\x00\xe96\x00\x00\x00\xe9\x17\x00\x00\x00\xe9\&#x27;\x00\x00\x00\xe97\x00\x00\x00\xe9\x18\x00\x00\x00\xe9(\x00\x00\x00\xe98\x00\x00\x00\xe9\x19\x00\x00\x00\xe9)\x00\x00\x00\xe99\x00\x00\x00\xe9\x1a\x00\x00\x00\xe9*\x00\x00\x00\xe9:\x00\x00\x00\xe9\x1b\x00\x00\x00\xe9+\x00\x00\x00\xe9;\x00\x00\x00\xe9\x1c\x00\x00\x00\xe9,\x00\x00\x00\xe9&lt;\x00\x00\x00\xe9\x1d\x00\x00\x00\xe9-\x00\x00\x00\xe9=\x00\x00\x00\xe9\x1e\x00\x00\x00\xe9.\x00\x00\x00\xe9&gt;\x00\x00\x00\xe9\x1f\x00\x00\x00\xe9/\x00\x00\x00\xe9?\x00\x00\x00c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x05\x00\x00\x00C\x00\x00\x00s\x16\x00\x00\x00g\x00|\x00]\x0e&#125;\x01t\x00\xa0\x01|\x01\xa1\x01\x91\x02q\x04S\x00r\x10\x00\x00\x00)\x02\xda\x04PBoxr\x12\x00\x00\x00r\x13\x00\x00\x00r\x10\x00\x00\x00r\x10\x00\x00\x00r\x16\x00\x00\x00r\x17\x00\x00\x00\t\x00\x00\x00s\x04\x00\x00\x00\x06\x00\x02\x00\xe9@\x00\x00\x00s#\n\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x02\x00\x00\x00C\x00\x00\x00s\x08\x00\x00\x00|\x00|\x01A\x00S\x00)\x01N\xa9\x00)\x02\xda\x05stateZ\x08roundkeyr\x00\x00\x00\x00r\x00\x00\x00\x00\xda\x00\xda\x0baddRoundKey\x02\x00\x00\x00s\x02\x00\x00\x00\x00\x01r\x03\x00\x00\x00s,\t\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00\x06\x00\x00\x00C\x00\x00\x00s6\x00\x00\x00d\x01&#125;\x01t\x00d\x02\x83\x01D\x00]$&#125;\x02|\x01t\x01|\x00|\x02d\x03\x14\x00?\x00d\x04@\x00\x19\x00|\x02d\x03\x14\x00&gt;\x007\x00&#125;\x01q\x0c|\x01S\x00)\x05N\xe9\x00\x00\x00\x00\xe9\x10\x00\x00\x00\xe9\x04\x00\x00\x00\xe9\x0f\x00\x00\x00)\x02\xda\x05rangeZ\x04Sbox)\x03\xda\x05state\xda\x06output\xda\x01i\xa9\x00r\x08\x00\x00\x00\xda\x00\xda\tsBoxLayer\x02\x00\x00\x00s\x08\x00\x00\x00\x00\x01\x04\x01\x0c\x01&quot;\x01r\n\x00\x00\x00s\xe4\x07\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00\x05\x00\x00\x00C\x00\x00\x00s.\x00\x00\x00d\x01&#125;\x01t\x00d\x02\x83\x01D\x00]\x1c&#125;\x02|\x01|\x00|\x02?\x00d\x03@\x00t\x01|\x02\x19\x00&gt;\x007\x00&#125;\x01q\x0c|\x01S\x00)\x04N\xe9\x00\x00\x00\x00\xe9@\x00\x00\x00\xe9\x01\x00\x00\x00)\x02\xda\x05rangeZ\x04PBox)\x03\xda\x05state\xda\x06output\xda\x01i\xa9\x00r\x07\x00\x00\x00\xda\x00\xda\x06pLayer\x02\x00\x00\x00s\x08\x00\x00\x00\x00\x01\x04\x01\x0c\x01\x1a\x01r\t\x00\x00\x00s\xac\x06\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x04\x00\x00\x00\x03\x00\x00\x00s\x1a\x00\x00\x00t\x00\x87\x00f\x01d\x01d\x02\x84\x08t\x01d\x03\x83\x01D\x00\x83\x01\x83\x01S\x00)\x04Nc\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x05\x00\x00\x00\x13\x00\x00\x00s \x00\x00\x00g\x00|\x00]\x18&#125;\x01t\x00\x88\x00|\x01\x19\x00\x83\x01d\x00|\x01\x14\x00&gt;\x00\x91\x02q\x04S\x00)\x01\xe9\x08\x00\x00\x00)\x01\xda\x03ord)\x02\xda\x02.0\xda\x01c\xa9\x01\xda\x01i\xa9\x00\xda\x00\xda\n&lt;listcomp&gt;\x03\x00\x00\x00s\x04\x00\x00\x00\x06\x00\x02\x00z!string2number.&lt;locals&gt;.&lt;listcomp&gt;r\x00\x00\x00\x00)\x02\xda\x03sum\xda\x05ranger\x04\x00\x00\x00r\x06\x00\x00\x00r\x04\x00\x00\x00r\x07\x00\x00\x00\xda\rstring2number\x02\x00\x00\x00s\x02\x00\x00\x00\x00\x01r\x0b\x00\x00\x00s\x01\x05\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04\x00\x00\x00\x05\x00\x00\x00C\x00\x00\x00st\x00\x00\x00g\x00&#125;\x02t\x00d\x01|\x01d\x01\x17\x00d\x01\x83\x03D\x00]Z&#125;\x03|\x02\xa0\x01|\x00d\x02?\x00\xa1\x01\x01\x00|\x00d\x03@\x00d\x04&gt;\x00|\x00d\x05?\x00\x17\x00&#125;\x00t\x02|\x00d\x06?\x00\x19\x00d\x06&gt;\x00|\x00d\x07d\x06\x13\x00d\x01\x18\x00@\x00\x17\x00&#125;\x00|\x00|\x03d\x08&gt;\x00|\x00d\x05?\x00A\x00N\x00&#125;\x00q\x14|\x02S\x00)\tN\xe9\x01\x00\x00\x00\xe9\x10\x00\x00\x00i\xff\xff\x07\x00\xe9=\x00\x00\x00\xe9\x13\x00\x00\x00\xe9L\x00\x00\x00\xe9\x02\x00\x00\x00\xe9\x0f\x00\x00\x00)\x03\xda\x05range\xda\x06appendZ\x04Sbox)\x04\xda\x03key\xda\x06roundsZ\troundkeys\xda\x01i\xa9\x00r\x0c\x00\x00\x00\xda\x00\xda\x13generateRoundkeys80\x02\x00\x00\x00s\x0e\x00\x00\x00\x00\x01\x04\x01\x14\x01\x0e\x01\x14\x01 \x01\x16\x01r\x0e\x00\x00\x00sF\x03\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00@\x00\x00\x00s\xa6\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01d\x02\x83\x01Z\x02e\x03e\x02\x83\x01d\x03k\x03r,e\x04d\x04\x83\x01\x01\x00e\x05d\x05\x83\x01\x01\x00e\x02d\x06d\x07\x85\x02\x19\x00e\x02d\x07d\x08\x85\x02\x19\x00e\x02d\x08d\t\x85\x02\x19\x00e\x02d\td\x03\x85\x02\x19\x00g\x04Z\x06d\nd\x0bd\x0cd\rg\x04Z\x07e\x00e\x06\x83\x01Z\x08e\td\x0e\x83\x01D\x00]$Z\ne\x07e\n\x19\x00e\x08e\n\x19\x00k\x03rte\x04d\x04\x83\x01\x01\x00e\x05d\x05\x83\x01\x01\x00qte\x04d\x0f\x83\x01\x01\x00d\x06S\x00)\x10c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x06\x00\x00\x00C\x00\x00\x00sp\x00\x00\x00d\x01&#125;\x01t\x00d\x02|\x01\x83\x02&#125;\x02g\x00&#125;\x03|\x00D\x00]T&#125;\x04t\x01|\x04\x83\x01&#125;\x05t\x02|\x01d\x03\x18\x00\x83\x01D\x00]&quot;&#125;\x06t\x03|\x05|\x02|\x06\x19\x00\x83\x02&#125;\x05t\x04|\x05\x83\x01&#125;\x05t\x05|\x05\x83\x01&#125;\x05q.t\x03|\x05|\x02d\x04\x19\x00\x83\x02&#125;\x07|\x03\xa0\x06|\x07\xa1\x01\x01\x00q\x16|\x03S\x00)\x05N\xe9 \x00\x00\x00l\x06\x00\x00\x00! 20\\X\xa8 1!\x02\x00\xe9\x01\x00\x00\x00\xe9\xff\xff\xff\xff)\x07Z\x13generateRoundkeys80Z\rstring2number\xda\x05rangeZ\x0baddRoundKeyZ\tsBoxLayerZ\x06pLayer\xda\x06append)\x08\xda\x06blocks\xda\x06roundsZ\troundkeysZ\x03outZ\x05block\xda\x05state\xda\x01iZ\x06cipher\xa9\x00r\t\x00\x00\x00\xda\x00\xda\x07encrypt\x02\x00\x00\x00s\x18\x00\x00\x00\x00\x01\x04\x01\n\x01\x04\x01\x08\x01\x08\x01\x10\x01\x0e\x01\x08\x01\n\x01\x0e\x01\x0c\x01r\x0b\x00\x00\x00z\x12pls input ur flag:r\x00\x00\x00\x00z\x0bwrong flag!\xe9\x00\x00\x00\x00N\xe9\x08\x00\x00\x00\xe9\x10\x00\x00\x00\xe9\x18\x00\x00\x00l\x04\x00\x00\x00\x9e\x1faH\xc4\x13d\rl\x05\x00\x00\x00b]t:\x94Z\x15\x18\x0e\x00l\x04\x00\x00\x000ek95\x04\xb2&quot;l\x05\x00\x00\x00\x88o\xeddY\x13\xb1L\x01\x00\xe9\x04\x00\x00\x00z\x08Correct!)\x0br\x0b\x00\x00\x00\xda\x05inputZ\x03inp\xda\x03len\xda\x05print\xda\x04exitr\x05\x00\x00\x00Z\x04cmpsZ\nout_blocksr\x03\x00\x00\x00r\x08\x00\x00\x00r\t\x00\x00\x00r\t\x00\x00\x00r\t\x00\x00\x00r\n\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x18\x00\x00\x00\x08\x0e\x08\x01\x0c\x01\x08\x01\x08\x01,\x01\x0c\x01\x08\x01\x0c\x01\x10\x01\x08\x01\n\x01N)\x05r\x0e\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x0c\x00\x00\x00r\x0c\x00\x00\x00r\x0c\x00\x00\x00r\r\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\t\n\x01N)\x05r\x0b\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x06\x00\x00\x00r\x06\x00\x00\x00r\x06\x00\x00\x00r\x07\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\x03\n\x01N)\x05r\t\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x07\x00\x00\x00r\x07\x00\x00\x00r\x07\x00\x00\x00r\x08\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\x06\n\x01N)\x05r\n\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x08\x00\x00\x00r\x08\x00\x00\x00r\x08\x00\x00\x00r\t\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\x06\n\x01N)\x05r\x03\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x00\x00\x00\x00r\x00\x00\x00\x00r\x00\x00\x00\x00r\x02\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\x03\n\x01N)\tr\x11\x00\x00\x00\xda\x05rangeZ\x08Sbox_invrH\x00\x00\x00Z\x08PBox_inv\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x10\x00\x00\x00r\x10\x00\x00\x00r\x10\x00\x00\x00r\x16\x00\x00\x00\xda\x08&lt;module&gt;\x03\x00\x00\x00sl\x00\x00\x00$\x01\x12\x01 \x01\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x01\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x01\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\x00\x02\xfd\x04\x04\x12\x02\n\x01&#x27;</span></span><br><span class="line"></span><br><span class="line">l = marshal.loads(code)</span><br><span class="line"><span class="built_in">exec</span>(l)</span><br></pre></td></tr></table></figure>
<p>直接执行是会报错的 拿到这种还是先用dis.dis查看下字节码(本地跑还一直报错 用在线python跑就行了)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">l = marshal.loads(code)</span><br><span class="line"><span class="keyword">import</span> dis</span><br><span class="line">dis.dis(l)</span><br></pre></td></tr></table></figure>
<p>可以发现里面还嵌了marshal</p>
<details>
<summary>点击查看代码</summary>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line">  3           0 LOAD_CONST               0 (12)</span><br><span class="line">              2 LOAD_CONST               1 (5)</span><br><span class="line">              4 LOAD_CONST               2 (6)</span><br><span class="line">              6 LOAD_CONST               3 (11)</span><br><span class="line">              8 LOAD_CONST               4 (9)</span><br><span class="line">             10 LOAD_CONST               5 (0)</span><br><span class="line">             12 LOAD_CONST               6 (10)</span><br><span class="line">             14 LOAD_CONST               7 (13)</span><br><span class="line">             16 LOAD_CONST               8 (3)</span><br><span class="line">             18 LOAD_CONST               9 (14)</span><br><span class="line">             20 LOAD_CONST              10 (15)</span><br><span class="line">             22 LOAD_CONST              11 (8)</span><br><span class="line">             24 LOAD_CONST              12 (4)</span><br><span class="line">             26 LOAD_CONST              13 (7)</span><br><span class="line">             28 LOAD_CONST              14 (1)</span><br><span class="line">             30 LOAD_CONST              15 (2)</span><br><span class="line">             32 BUILD_LIST              16</span><br><span class="line">             34 STORE_NAME               0 (Sbox)</span><br><span class="line"></span><br><span class="line">  4          36 LOAD_CONST              16 (&lt;code object &lt;listcomp&gt; at 0x7fbf6f8f83a0, file &quot;&quot;, line 4&gt;)</span><br><span class="line">             38 LOAD_CONST              17 (&#x27;&lt;listcomp&gt;&#x27;)</span><br><span class="line">             40 MAKE_FUNCTION            0</span><br><span class="line">             42 LOAD_NAME                1 (range)</span><br><span class="line">             44 LOAD_CONST              18 (16)</span><br><span class="line">             46 CALL_FUNCTION            1</span><br><span class="line">             48 GET_ITER</span><br><span class="line">             50 CALL_FUNCTION            1</span><br><span class="line">             52 STORE_NAME               2 (Sbox_inv)</span><br><span class="line"></span><br><span class="line">  5          54 LOAD_CONST               5 (0)</span><br><span class="line">             56 LOAD_CONST              18 (16)</span><br><span class="line">             58 LOAD_CONST              19 (32)</span><br><span class="line">             60 LOAD_CONST              20 (48)</span><br><span class="line">             62 LOAD_CONST              14 (1)</span><br><span class="line">             64 LOAD_CONST              21 (17)</span><br><span class="line">             66 LOAD_CONST              22 (33)</span><br><span class="line">             68 LOAD_CONST              23 (49)</span><br><span class="line">             70 LOAD_CONST              15 (2)</span><br><span class="line">             72 LOAD_CONST              24 (18)</span><br><span class="line">             74 LOAD_CONST              25 (34)</span><br><span class="line">             76 LOAD_CONST              26 (50)</span><br><span class="line">             78 LOAD_CONST               8 (3)</span><br><span class="line">             80 LOAD_CONST              27 (19)</span><br><span class="line">             82 LOAD_CONST              28 (35)</span><br><span class="line">             84 LOAD_CONST              29 (51)</span><br><span class="line"></span><br><span class="line">  6          86 LOAD_CONST              12 (4)</span><br><span class="line">             88 LOAD_CONST              30 (20)</span><br><span class="line">             90 LOAD_CONST              31 (36)</span><br><span class="line">             92 LOAD_CONST              32 (52)</span><br><span class="line">             94 LOAD_CONST               1 (5)</span><br><span class="line">             96 LOAD_CONST              33 (21)</span><br><span class="line">             98 LOAD_CONST              34 (37)</span><br><span class="line">            100 LOAD_CONST              35 (53)</span><br><span class="line">            102 LOAD_CONST               2 (6)</span><br><span class="line">            104 LOAD_CONST              36 (22)</span><br><span class="line">            106 LOAD_CONST              37 (38)</span><br><span class="line">            108 LOAD_CONST              38 (54)</span><br><span class="line">            110 LOAD_CONST              13 (7)</span><br><span class="line">            112 LOAD_CONST              39 (23)</span><br><span class="line">            114 LOAD_CONST              40 (39)</span><br><span class="line">            116 LOAD_CONST              41 (55)</span><br><span class="line"></span><br><span class="line">  7         118 LOAD_CONST              11 (8)</span><br><span class="line">            120 LOAD_CONST              42 (24)</span><br><span class="line">            122 LOAD_CONST              43 (40)</span><br><span class="line">            124 LOAD_CONST              44 (56)</span><br><span class="line">            126 LOAD_CONST               4 (9)</span><br><span class="line">            128 LOAD_CONST              45 (25)</span><br><span class="line">            130 LOAD_CONST              46 (41)</span><br><span class="line">            132 LOAD_CONST              47 (57)</span><br><span class="line">            134 LOAD_CONST               6 (10)</span><br><span class="line">            136 LOAD_CONST              48 (26)</span><br><span class="line">            138 LOAD_CONST              49 (42)</span><br><span class="line">            140 LOAD_CONST              50 (58)</span><br><span class="line">            142 LOAD_CONST               3 (11)</span><br><span class="line">            144 LOAD_CONST              51 (27)</span><br><span class="line">            146 LOAD_CONST              52 (43)</span><br><span class="line">            148 LOAD_CONST              53 (59)</span><br><span class="line"></span><br><span class="line">  8         150 LOAD_CONST               0 (12)</span><br><span class="line">            152 LOAD_CONST              54 (28)</span><br><span class="line">            154 LOAD_CONST              55 (44)</span><br><span class="line">            156 LOAD_CONST              56 (60)</span><br><span class="line">            158 LOAD_CONST               7 (13)</span><br><span class="line">            160 LOAD_CONST              57 (29)</span><br><span class="line">            162 LOAD_CONST              58 (45)</span><br><span class="line">            164 LOAD_CONST              59 (61)</span><br><span class="line">            166 LOAD_CONST               9 (14)</span><br><span class="line">            168 LOAD_CONST              60 (30)</span><br><span class="line">            170 LOAD_CONST              61 (46)</span><br><span class="line">            172 LOAD_CONST              62 (62)</span><br><span class="line">            174 LOAD_CONST              10 (15)</span><br><span class="line">            176 LOAD_CONST              63 (31)</span><br><span class="line">            178 LOAD_CONST              64 (47)</span><br><span class="line">            180 LOAD_CONST              65 (63)</span><br><span class="line"></span><br><span class="line">  5         182 BUILD_LIST              64</span><br><span class="line">            184 STORE_NAME               3 (PBox)</span><br><span class="line"></span><br><span class="line">  9         186 LOAD_CONST              66 (&lt;code object &lt;listcomp&gt; at 0x7fbf6f8f8660, file &quot;&quot;, line 9&gt;)</span><br><span class="line">            188 LOAD_CONST              17 (&#x27;&lt;listcomp&gt;&#x27;)</span><br><span class="line">            190 MAKE_FUNCTION            0</span><br><span class="line">            192 LOAD_NAME                1 (range)</span><br><span class="line">            194 LOAD_CONST              67 (64)</span><br><span class="line">            196 CALL_FUNCTION            1</span><br><span class="line">            198 GET_ITER</span><br><span class="line">            200 CALL_FUNCTION            1</span><br><span class="line">            202 STORE_NAME               4 (PBox_inv)</span><br><span class="line"></span><br><span class="line"> 11         204 LOAD_NAME                5 (marshal)</span><br><span class="line">            206 LOAD_METHOD              6 (loads)</span><br><span class="line">            208 LOAD_CONST              68 (b&#x27;c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x02\x00\x00\x00C\x00\x00\x00s\x08\x00\x00\x00|\x00|\x01A\x00S\x00)\x01N\xa9\x00)\x02\xda\x05stateZ\x08roundkeyr\x00\x00\x00\x00r\x00\x00\x00\x00\xda\x00\xda\x0baddRoundKey\x02\x00\x00\x00s\x02\x00\x00\x00\x00\x01r\x03\x00\x00\x00s,\t\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00\x06\x00\x00\x00C\x00\x00\x00s6\x00\x00\x00d\x01&#125;\x01t\x00d\x02\x83\x01D\x00]$&#125;\x02|\x01t\x01|\x00|\x02d\x03\x14\x00?\x00d\x04@\x00\x19\x00|\x02d\x03\x14\x00&gt;\x007\x00&#125;\x01q\x0c|\x01S\x00)\x05N\xe9\x00\x00\x00\x00\xe9\x10\x00\x00\x00\xe9\x04\x00\x00\x00\xe9\x0f\x00\x00\x00)\x02\xda\x05rangeZ\x04Sbox)\x03\xda\x05state\xda\x06output\xda\x01i\xa9\x00r\x08\x00\x00\x00\xda\x00\xda\tsBoxLayer\x02\x00\x00\x00s\x08\x00\x00\x00\x00\x01\x04\x01\x0c\x01&quot;\x01r\n\x00\x00\x00s\xe4\x07\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00\x05\x00\x00\x00C\x00\x00\x00s.\x00\x00\x00d\x01&#125;\x01t\x00d\x02\x83\x01D\x00]\x1c&#125;\x02|\x01|\x00|\x02?\x00d\x03@\x00t\x01|\x02\x19\x00&gt;\x007\x00&#125;\x01q\x0c|\x01S\x00)\x04N\xe9\x00\x00\x00\x00\xe9@\x00\x00\x00\xe9\x01\x00\x00\x00)\x02\xda\x05rangeZ\x04PBox)\x03\xda\x05state\xda\x06output\xda\x01i\xa9\x00r\x07\x00\x00\x00\xda\x00\xda\x06pLayer\x02\x00\x00\x00s\x08\x00\x00\x00\x00\x01\x04\x01\x0c\x01\x1a\x01r\t\x00\x00\x00s\xac\x06\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x04\x00\x00\x00\x03\x00\x00\x00s\x1a\x00\x00\x00t\x00\x87\x00f\x01d\x01d\x02\x84\x08t\x01d\x03\x83\x01D\x00\x83\x01\x83\x01S\x00)\x04Nc\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x05\x00\x00\x00\x13\x00\x00\x00s \x00\x00\x00g\x00|\x00]\x18&#125;\x01t\x00\x88\x00|\x01\x19\x00\x83\x01d\x00|\x01\x14\x00&gt;\x00\x91\x02q\x04S\x00)\x01\xe9\x08\x00\x00\x00)\x01\xda\x03ord)\x02\xda\x02.0\xda\x01c\xa9\x01\xda\x01i\xa9\x00\xda\x00\xda\n&lt;listcomp&gt;\x03\x00\x00\x00s\x04\x00\x00\x00\x06\x00\x02\x00z!string2number.&lt;locals&gt;.&lt;listcomp&gt;r\x00\x00\x00\x00)\x02\xda\x03sum\xda\x05ranger\x04\x00\x00\x00r\x06\x00\x00\x00r\x04\x00\x00\x00r\x07\x00\x00\x00\xda\rstring2number\x02\x00\x00\x00s\x02\x00\x00\x00\x00\x01r\x0b\x00\x00\x00s\x01\x05\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00@\x00\x00\x00s\x1e\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01\xa0\x02d\x02\xa1\x01Z\x03e\x04e\x03\x83\x01\x01\x00d\x03S\x00)\x04c\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04\x00\x00\x00\x05\x00\x00\x00C\x00\x00\x00st\x00\x00\x00g\x00&#125;\x02t\x00d\x01|\x01d\x01\x17\x00d\x01\x83\x03D\x00]Z&#125;\x03|\x02\xa0\x01|\x00d\x02?\x00\xa1\x01\x01\x00|\x00d\x03@\x00d\x04&gt;\x00|\x00d\x05?\x00\x17\x00&#125;\x00t\x02|\x00d\x06?\x00\x19\x00d\x06&gt;\x00|\x00d\x07d\x06\x13\x00d\x01\x18\x00@\x00\x17\x00&#125;\x00|\x00|\x03d\x08&gt;\x00|\x00d\x05?\x00A\x00N\x00&#125;\x00q\x14|\x02S\x00)\tN\xe9\x01\x00\x00\x00\xe9\x10\x00\x00\x00i\xff\xff\x07\x00\xe9=\x00\x00\x00\xe9\x13\x00\x00\x00\xe9L\x00\x00\x00\xe9\x02\x00\x00\x00\xe9\x0f\x00\x00\x00)\x03\xda\x05range\xda\x06appendZ\x04Sbox)\x04\xda\x03key\xda\x06roundsZ\troundkeys\xda\x01i\xa9\x00r\x0c\x00\x00\x00\xda\x00\xda\x13generateRoundkeys80\x02\x00\x00\x00s\x0e\x00\x00\x00\x00\x01\x04\x01\x14\x01\x0e\x01\x14\x01 \x01\x16\x01r\x0e\x00\x00\x00sF\x03\x00\x00c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00@\x00\x00\x00s\xa6\x00\x00\x00d\x00d\x01\x84\x00Z\x00e\x01d\x02\x83\x01Z\x02e\x03e\x02\x83\x01d\x03k\x03r,e\x04d\x04\x83\x01\x01\x00e\x05d\x05\x83\x01\x01\x00e\x02d\x06d\x07\x85\x02\x19\x00e\x02d\x07d\x08\x85\x02\x19\x00e\x02d\x08d\t\x85\x02\x19\x00e\x02d\td\x03\x85\x02\x19\x00g\x04Z\x06d\nd\x0bd\x0cd\rg\x04Z\x07e\x00e\x06\x83\x01Z\x08e\td\x0e\x83\x01D\x00]$Z\ne\x07e\n\x19\x00e\x08e\n\x19\x00k\x03rte\x04d\x04\x83\x01\x01\x00e\x05d\x05\x83\x01\x01\x00qte\x04d\x0f\x83\x01\x01\x00d\x06S\x00)\x10c\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x06\x00\x00\x00C\x00\x00\x00sp\x00\x00\x00d\x01&#125;\x01t\x00d\x02|\x01\x83\x02&#125;\x02g\x00&#125;\x03|\x00D\x00]T&#125;\x04t\x01|\x04\x83\x01&#125;\x05t\x02|\x01d\x03\x18\x00\x83\x01D\x00]&quot;&#125;\x06t\x03|\x05|\x02|\x06\x19\x00\x83\x02&#125;\x05t\x04|\x05\x83\x01&#125;\x05t\x05|\x05\x83\x01&#125;\x05q.t\x03|\x05|\x02d\x04\x19\x00\x83\x02&#125;\x07|\x03\xa0\x06|\x07\xa1\x01\x01\x00q\x16|\x03S\x00)\x05N\xe9 \x00\x00\x00l\x06\x00\x00\x00! 20\\X\xa8 1!\x02\x00\xe9\x01\x00\x00\x00\xe9\xff\xff\xff\xff)\x07Z\x13generateRoundkeys80Z\rstring2number\xda\x05rangeZ\x0baddRoundKeyZ\tsBoxLayerZ\x06pLayer\xda\x06append)\x08\xda\x06blocks\xda\x06roundsZ\troundkeysZ\x03outZ\x05block\xda\x05state\xda\x01iZ\x06cipher\xa9\x00r\t\x00\x00\x00\xda\x00\xda\x07encrypt\x02\x00\x00\x00s\x18\x00\x00\x00\x00\x01\x04\x01\n\x01\x04\x01\x08\x01\x08\x01\x10\x01\x0e\x01\x08\x01\n\x01\x0e\x01\x0c\x01r\x0b\x00\x00\x00z\x12pls input ur flag:r\x00\x00\x00\x00z\x0bwrong flag!\xe9\x00\x00\x00\x00N\xe9\x08\x00\x00\x00\xe9\x10\x00\x00\x00\xe9\x18\x00\x00\x00l\x04\x00\x00\x00\x9e\x1faH\xc4\x13d\rl\x05\x00\x00\x00b]t:\x94Z\x15\x18\x0e\x00l\x04\x00\x00\x000ek95\x04\xb2&quot;l\x05\x00\x00\x00\x88o\xeddY\x13\xb1L\x01\x00\xe9\x04\x00\x00\x00z\x08Correct!)\x0br\x0b\x00\x00\x00\xda\x05inputZ\x03inp\xda\x03len\xda\x05print\xda\x04exitr\x05\x00\x00\x00Z\x04cmpsZ\nout_blocksr\x03\x00\x00\x00r\x08\x00\x00\x00r\t\x00\x00\x00r\t\x00\x00\x00r\t\x00\x00\x00r\n\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x18\x00\x00\x00\x08\x0e\x08\x01\x0c\x01\x08\x01\x08\x01,\x01\x0c\x01\x08\x01\x0c\x01\x10\x01\x08\x01\n\x01N)\x05r\x0e\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x0c\x00\x00\x00r\x0c\x00\x00\x00r\x0c\x00\x00\x00r\r\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\t\n\x01N)\x05r\x0b\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x06\x00\x00\x00r\x06\x00\x00\x00r\x06\x00\x00\x00r\x07\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\x03\n\x01N)\x05r\t\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x07\x00\x00\x00r\x07\x00\x00\x00r\x07\x00\x00\x00r\x08\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\x06\n\x01N)\x05r\n\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x08\x00\x00\x00r\x08\x00\x00\x00r\x08\x00\x00\x00r\t\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\x06\n\x01N)\x05r\x03\x00\x00\x00\xda\x07marshal\xda\x05loads\xda\x02co\xda\x04execr\x00\x00\x00\x00r\x00\x00\x00\x00r\x00\x00\x00\x00r\x02\x00\x00\x00\xda\x08&lt;module&gt;\x02\x00\x00\x00s\x04\x00\x00\x00\x08\x03\n\x01&#x27;)</span><br><span class="line">            210 CALL_METHOD              1</span><br><span class="line">            212 STORE_NAME               7 (co)</span><br><span class="line"></span><br><span class="line"> 12         214 LOAD_NAME                8 (exec)</span><br><span class="line">            216 LOAD_NAME                7 (co)</span><br><span class="line">            218 CALL_FUNCTION            1</span><br><span class="line">            220 POP_TOP</span><br><span class="line">            222 LOAD_CONST              69 (None)</span><br><span class="line">            224 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object &lt;listcomp&gt; at 0x7fbf6f8f83a0, file &quot;&quot;, line 4&gt;:</span><br><span class="line">  4           0 BUILD_LIST               0</span><br><span class="line">              2 LOAD_FAST                0 (.0)</span><br><span class="line">        &gt;&gt;    4 FOR_ITER                14 (to 20)</span><br><span class="line">              6 STORE_FAST               1 (x)</span><br><span class="line">              8 LOAD_GLOBAL              0 (Sbox)</span><br><span class="line">             10 LOAD_METHOD              1 (index)</span><br><span class="line">             12 LOAD_FAST                1 (x)</span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 LIST_APPEND              2</span><br><span class="line">             18 JUMP_ABSOLUTE            4</span><br><span class="line">        &gt;&gt;   20 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object &lt;listcomp&gt; at 0x7fbf6f8f8660, file &quot;&quot;, line 9&gt;:</span><br><span class="line">  9           0 BUILD_LIST               0</span><br><span class="line">              2 LOAD_FAST                0 (.0)</span><br><span class="line">        &gt;&gt;    4 FOR_ITER                14 (to 20)</span><br><span class="line">              6 STORE_FAST               1 (x)</span><br><span class="line">              8 LOAD_GLOBAL              0 (PBox)</span><br><span class="line">             10 LOAD_METHOD              1 (index)</span><br><span class="line">             12 LOAD_FAST                1 (x)</span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 LIST_APPEND              2</span><br><span class="line">             18 JUMP_ABSOLUTE            4</span><br><span class="line">        &gt;&gt;   20 RETURN_VALUE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</details>

<p>注意到有几个显眼特征:</p>
<ul>
<li>Sbox</li>
<li>PBox</li>
<li>generateRoundkeys80<br>搜索可以得到:</li>
</ul>
<p><img src="https://s2.loli.net/2023/12/03/QR6G7gCuYtfhc1P.png" alt="B68_Z___PC67M0HVVJ2_DA8.png"></p>
<p>说明是present算法<br>那我们怎么得到那几个关键变量的值呢？<br>这里跟着官方WP学习了一手全局hook的思想<br>![&#96;BEPIHG0_C8_CY_@7@6~1L1.png](<a target="_blank" rel="noopener" href="https://s2.loli.net/2023/12/03/4wQCeFy9LIT2jms.png">https://s2.loli.net/2023/12/03/4wQCeFy9LIT2jms.png</a>)<br>但是实际用的时候会发现 在exec后用的话 程序会直接退出(调用了exit())<br><img src="https://s2.loli.net/2023/12/03/GPh2KRF5AdOcoBj.png" alt="O_DK_VOF3HP@PW0_O@RGN1Q.png"><br>而我们在exec执行前定义一个exit 相当于把系统的exit给覆盖掉 (利用全局特性 类似web get&#x2F;post修改全局变量)<br>但是这样运行还是报错 我们再加个try except块来保证能得到globals()<br><img src="https://s2.loli.net/2023/12/03/6zMsQ3kjYfnLX52.png" alt="HY65JZD_HH__3_U6_X1YF@L.png"></p>
<p>可以看到这时已经能得到一些关键值了<br>总结一下 : 现在得到了</p>
<ul>
<li>sbox</li>
<li>sbox_inv</li>
<li>pbox</li>
<li>pbox_inv</li>
<li>cmps</li>
</ul>
<p>发现这里还少了 key的值<br>说明key不在globals里 这里再次利用全局hook的技巧<br>key在<code>generateRoundkeys80</code>中被调用</p>
<p><img src="https://s2.loli.net/2023/12/03/1iHt5M7uEXzVw4A.png" alt="img"></p>
<p>所以我们修改generateRoundkeys80 使它输出传入的两个变量的值即可(使用lambda <del>python高级特征学到了</del>)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">generateRoundkeys80 = <span class="keyword">lambda</span> x1,x2: <span class="built_in">print</span>(x1,x2)</span><br></pre></td></tr></table></figure>
<p><img src="https://s2.loli.net/2023/12/03/lEFAxXu9cnajroK.png" alt="_G0380___9__SM1E_1O~LD0.png"><br>这就得到了key!<br>但是直接套会发现解出来不对…<br>那就只能看字节码 手动脱marshal(5,6次吧)<br>得到关键的generatekey80的字节码(最后一层才脱出来 说明关键应该在这里)</p>
<details>
<summary>点击查看代码</summary>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br></pre></td><td class="code"><pre><span class="line">  2           0 LOAD_CONST               0 (&lt;code object generateRoundkeys80 at 0x7fb5577493a0, file &quot;&quot;, line 2&gt;)</span><br><span class="line">              2 LOAD_CONST               1 (&#x27;generateRoundkeys80&#x27;)</span><br><span class="line">              4 MAKE_FUNCTION            0</span><br><span class="line">              6 STORE_NAME               0 (generateRoundkeys80)</span><br><span class="line"></span><br><span class="line"> 11           8 LOAD_NAME                1 (marshal)</span><br><span class="line">             10 LOAD_METHOD              2 (loads)</span><br><span class="line">             12 LOAD_CONST                 2           0 LOAD_CONST               0 (&lt;code object encrypt at 0x7f7a22c7c660, file &quot;&quot;, line 2&gt;)</span><br><span class="line">              2 LOAD_CONST               1 (&#x27;encrypt&#x27;)</span><br><span class="line">              4 MAKE_FUNCTION            0</span><br><span class="line">              6 STORE_NAME               0 (encrypt)</span><br><span class="line"></span><br><span class="line"> 16           8 LOAD_NAME                1 (input)</span><br><span class="line">             10 LOAD_CONST               2 (&#x27;pls input ur flag:&#x27;)</span><br><span class="line">             12 CALL_FUNCTION            1</span><br><span class="line">             14 STORE_NAME               2 (inp)</span><br><span class="line"></span><br><span class="line"> 17          16 LOAD_NAME                3 (len)</span><br><span class="line">             18 LOAD_NAME                2 (inp)</span><br><span class="line">             20 CALL_FUNCTION            1</span><br><span class="line">             22 LOAD_CONST               3 (32)</span><br><span class="line">             24 COMPARE_OP               3 (!=)</span><br><span class="line">             26 POP_JUMP_IF_FALSE       44</span><br><span class="line"></span><br><span class="line"> 18          28 LOAD_NAME                4 (print)</span><br><span class="line">             30 LOAD_CONST               4 (&#x27;wrong flag!&#x27;)</span><br><span class="line">             32 CALL_FUNCTION            1</span><br><span class="line">             34 POP_TOP</span><br><span class="line"></span><br><span class="line"> 19          36 LOAD_NAME                5 (exit)</span><br><span class="line">             38 LOAD_CONST               5 (0)</span><br><span class="line">             40 CALL_FUNCTION            1</span><br><span class="line">             42 POP_TOP</span><br><span class="line"></span><br><span class="line"> 20     &gt;&gt;   44 LOAD_NAME                2 (inp)</span><br><span class="line">             46 LOAD_CONST               6 (None)</span><br><span class="line">             48 LOAD_CONST               7 (8)</span><br><span class="line">             50 BUILD_SLICE              2</span><br><span class="line">             52 BINARY_SUBSCR</span><br><span class="line">             54 LOAD_NAME                2 (inp)</span><br><span class="line">             56 LOAD_CONST               7 (8)</span><br><span class="line">             58 LOAD_CONST               8 (16)</span><br><span class="line">             60 BUILD_SLICE              2</span><br><span class="line">             62 BINARY_SUBSCR</span><br><span class="line">             64 LOAD_NAME                2 (inp)</span><br><span class="line">             66 LOAD_CONST               8 (16)</span><br><span class="line">             68 LOAD_CONST               9 (24)</span><br><span class="line">             70 BUILD_SLICE              2</span><br><span class="line">             72 BINARY_SUBSCR</span><br><span class="line">             74 LOAD_NAME                2 (inp)</span><br><span class="line">             76 LOAD_CONST               9 (24)</span><br><span class="line">             78 LOAD_CONST               3 (32)</span><br><span class="line">             80 BUILD_SLICE              2</span><br><span class="line">             82 BINARY_SUBSCR</span><br><span class="line">             84 BUILD_LIST               4</span><br><span class="line">             86 STORE_NAME               6 (blocks)</span><br><span class="line"></span><br><span class="line"> 21          88 LOAD_CONST              10 (120617461261311902)</span><br><span class="line">             90 LOAD_CONST              11 (16357837616839286114)</span><br><span class="line">             92 LOAD_CONST              12 (312508749794633008)</span><br><span class="line">             94 LOAD_CONST              13 (1843701600916795272)</span><br><span class="line">             96 BUILD_LIST               4</span><br><span class="line">             98 STORE_NAME               7 (cmps)</span><br><span class="line"></span><br><span class="line"> 22         100 LOAD_NAME                0 (encrypt)</span><br><span class="line">            102 LOAD_NAME                6 (blocks)</span><br><span class="line">            104 CALL_FUNCTION            1</span><br><span class="line">            106 STORE_NAME               8 (out_blocks)</span><br><span class="line"></span><br><span class="line"> 23         108 LOAD_NAME                9 (range)</span><br><span class="line">            110 LOAD_CONST              14 (4)</span><br><span class="line">            112 CALL_FUNCTION            1</span><br><span class="line">            114 GET_ITER</span><br><span class="line">        &gt;&gt;  116 FOR_ITER                36 (to 154)</span><br><span class="line">            118 STORE_NAME              10 (i)</span><br><span class="line"></span><br><span class="line"> 24         120 LOAD_NAME                7 (cmps)</span><br><span class="line">            122 LOAD_NAME               10 (i)</span><br><span class="line">            124 BINARY_SUBSCR</span><br><span class="line">            126 LOAD_NAME                8 (out_blocks)</span><br><span class="line">            128 LOAD_NAME               10 (i)</span><br><span class="line">            130 BINARY_SUBSCR</span><br><span class="line">            132 COMPARE_OP               3 (!=)</span><br><span class="line">            134 POP_JUMP_IF_FALSE      116</span><br><span class="line"></span><br><span class="line"> 25         136 LOAD_NAME                4 (print)</span><br><span class="line">            138 LOAD_CONST               4 (&#x27;wrong flag!&#x27;)</span><br><span class="line">            140 CALL_FUNCTION            1</span><br><span class="line">            142 POP_TOP</span><br><span class="line"></span><br><span class="line"> 26         144 LOAD_NAME                5 (exit)</span><br><span class="line">            146 LOAD_CONST               5 (0)</span><br><span class="line">            148 CALL_FUNCTION            1</span><br><span class="line">            150 POP_TOP</span><br><span class="line">            152 JUMP_ABSOLUTE          116</span><br><span class="line"></span><br><span class="line"> 27     &gt;&gt;  154 LOAD_NAME                4 (print)</span><br><span class="line">            156 LOAD_CONST              15 (&#x27;Correct!&#x27;)</span><br><span class="line">            158 CALL_FUNCTION            1</span><br><span class="line">            160 POP_TOP</span><br><span class="line">            162 LOAD_CONST               6 (None)</span><br><span class="line">            164 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object encrypt at 0x7f7a22c7c660, file &quot;&quot;, line 2&gt;:</span><br><span class="line">  3           0 LOAD_CONST               1 (32)</span><br><span class="line">              2 STORE_FAST               1 (rounds)</span><br><span class="line"></span><br><span class="line">  4           4 LOAD_GLOBAL              0 (generateRoundkeys80)</span><br><span class="line">              6 LOAD_CONST               2 (85354531916197809168417)</span><br><span class="line">              8 LOAD_FAST                1 (rounds)</span><br><span class="line">             10 CALL_FUNCTION            2</span><br><span class="line">             12 STORE_FAST               2 (roundkeys)</span><br><span class="line"></span><br><span class="line">  5          14 BUILD_LIST               0</span><br><span class="line">             16 STORE_FAST               3 (out)</span><br><span class="line"></span><br><span class="line">  6          18 LOAD_FAST                0 (blocks)</span><br><span class="line">             20 GET_ITER</span><br><span class="line">        &gt;&gt;   22 FOR_ITER                84 (to 108)</span><br><span class="line">             24 STORE_FAST               4 (block)</span><br><span class="line"></span><br><span class="line">  7          26 LOAD_GLOBAL              1 (string2number)</span><br><span class="line">             28 LOAD_FAST                4 (block)</span><br><span class="line">             30 CALL_FUNCTION            1</span><br><span class="line">             32 STORE_FAST               5 (state)</span><br><span class="line"></span><br><span class="line">  8          34 LOAD_GLOBAL              2 (range)</span><br><span class="line">             36 LOAD_FAST                1 (rounds)</span><br><span class="line">             38 LOAD_CONST               3 (1)</span><br><span class="line">             40 BINARY_SUBTRACT</span><br><span class="line">             42 CALL_FUNCTION            1</span><br><span class="line">             44 GET_ITER</span><br><span class="line">        &gt;&gt;   46 FOR_ITER                34 (to 82)</span><br><span class="line">             48 STORE_FAST               6 (i)</span><br><span class="line"></span><br><span class="line">  9          50 LOAD_GLOBAL              3 (addRoundKey)</span><br><span class="line">             52 LOAD_FAST                5 (state)</span><br><span class="line">             54 LOAD_FAST                2 (roundkeys)</span><br><span class="line">             56 LOAD_FAST                6 (i)</span><br><span class="line">             58 BINARY_SUBSCR</span><br><span class="line">             60 CALL_FUNCTION            2</span><br><span class="line">             62 STORE_FAST               5 (state)</span><br><span class="line"></span><br><span class="line"> 10          64 LOAD_GLOBAL              4 (sBoxLayer)</span><br><span class="line">             66 LOAD_FAST                5 (state)</span><br><span class="line">             68 CALL_FUNCTION            1</span><br><span class="line">             70 STORE_FAST               5 (state)</span><br><span class="line"></span><br><span class="line"> 11          72 LOAD_GLOBAL              5 (pLayer)</span><br><span class="line">             74 LOAD_FAST                5 (state)</span><br><span class="line">             76 CALL_FUNCTION            1</span><br><span class="line">             78 STORE_FAST               5 (state)</span><br><span class="line">             80 JUMP_ABSOLUTE           46</span><br><span class="line"></span><br><span class="line"> 12     &gt;&gt;   82 LOAD_GLOBAL              3 (addRoundKey)</span><br><span class="line">             84 LOAD_FAST                5 (state)</span><br><span class="line">             86 LOAD_FAST                2 (roundkeys)</span><br><span class="line">             88 LOAD_CONST               4 (-1)</span><br><span class="line">             90 BINARY_SUBSCR</span><br><span class="line">             92 CALL_FUNCTION            2</span><br><span class="line">             94 STORE_FAST               7 (cipher)</span><br><span class="line"></span><br><span class="line"> 13          96 LOAD_FAST                3 (out)</span><br><span class="line">             98 LOAD_METHOD              6 (append)</span><br><span class="line">            100 LOAD_FAST                7 (cipher)</span><br><span class="line">            102 CALL_METHOD              1</span><br><span class="line">            104 POP_TOP</span><br><span class="line">            106 JUMP_ABSOLUTE           22</span><br><span class="line"></span><br><span class="line"> 14     &gt;&gt;  108 LOAD_FAST                3 (out)</span><br><span class="line">            110 RETURN_VALUE</span><br><span class="line">None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 STORE_NAME               3 (co)</span><br><span class="line"></span><br><span class="line"> 12          18 LOAD_NAME                4 (exec)</span><br><span class="line">             20 LOAD_NAME                3 (co)</span><br><span class="line">             22 CALL_FUNCTION            1</span><br><span class="line">             24 POP_TOP</span><br><span class="line">             26 LOAD_CONST               3 (None)</span><br><span class="line">             28 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object generateRoundkeys80 at 0x7fb5577493a0, file &quot;&quot;, line 2&gt;:</span><br><span class="line">  3           0 BUILD_LIST               0</span><br><span class="line">              2 STORE_FAST               2 (roundkeys)</span><br><span class="line"></span><br><span class="line">  4           4 LOAD_GLOBAL              0 (range)</span><br><span class="line">              6 LOAD_CONST               1 (1)</span><br><span class="line">              8 LOAD_FAST                1 (rounds)</span><br><span class="line">             10 LOAD_CONST               1 (1)</span><br><span class="line">             12 BINARY_ADD</span><br><span class="line">             14 LOAD_CONST               1 (1)</span><br><span class="line">             16 CALL_FUNCTION            3</span><br><span class="line">             18 GET_ITER</span><br><span class="line">        &gt;&gt;   20 FOR_ITER                90 (to 112)</span><br><span class="line">             22 STORE_FAST               3 (i)</span><br><span class="line"></span><br><span class="line">  5          24 LOAD_FAST                2 (roundkeys)</span><br><span class="line">             26 LOAD_METHOD              1 (append)</span><br><span class="line">             28 LOAD_FAST                0 (key)</span><br><span class="line">             30 LOAD_CONST               2 (16)</span><br><span class="line">             32 BINARY_RSHIFT</span><br><span class="line">             34 CALL_METHOD              1</span><br><span class="line">             36 POP_TOP</span><br><span class="line"></span><br><span class="line">  6          38 LOAD_FAST                0 (key)</span><br><span class="line">             40 LOAD_CONST               3 (524287)</span><br><span class="line">             42 BINARY_AND</span><br><span class="line">             44 LOAD_CONST               4 (61)</span><br><span class="line">             46 BINARY_LSHIFT</span><br><span class="line">             48 LOAD_FAST                0 (key)</span><br><span class="line">             50 LOAD_CONST               5 (19)</span><br><span class="line">             52 BINARY_RSHIFT</span><br><span class="line">             54 BINARY_ADD</span><br><span class="line">             56 STORE_FAST               0 (key)</span><br><span class="line"></span><br><span class="line">  7          58 LOAD_GLOBAL              2 (Sbox)</span><br><span class="line">             60 LOAD_FAST                0 (key)</span><br><span class="line">             62 LOAD_CONST               6 (76)</span><br><span class="line">             64 BINARY_RSHIFT</span><br><span class="line">             66 BINARY_SUBSCR</span><br><span class="line">             68 LOAD_CONST               6 (76)</span><br><span class="line">             70 BINARY_LSHIFT</span><br><span class="line">             72 LOAD_FAST                0 (key)</span><br><span class="line">             74 LOAD_CONST               7 (2)</span><br><span class="line">             76 LOAD_CONST               6 (76)</span><br><span class="line">             78 BINARY_POWER</span><br><span class="line">             80 LOAD_CONST               1 (1)</span><br><span class="line">             82 BINARY_SUBTRACT</span><br><span class="line">             84 BINARY_AND</span><br><span class="line">             86 BINARY_ADD</span><br><span class="line">             88 STORE_FAST               0 (key)</span><br><span class="line"></span><br><span class="line">  8          90 LOAD_FAST                0 (key)</span><br><span class="line">             92 LOAD_FAST                3 (i)</span><br><span class="line">             94 LOAD_CONST               8 (15)</span><br><span class="line">             96 BINARY_LSHIFT</span><br><span class="line">             98 LOAD_FAST                0 (key)</span><br><span class="line">            100 LOAD_CONST               5 (19)</span><br><span class="line">            102 BINARY_RSHIFT</span><br><span class="line">            104 BINARY_XOR</span><br><span class="line">            106 INPLACE_XOR</span><br><span class="line">            108 STORE_FAST               0 (key)</span><br><span class="line">            110 JUMP_ABSOLUTE           20</span><br><span class="line"></span><br><span class="line">  9     &gt;&gt;  112 LOAD_FAST                2 (roundkeys)</span><br><span class="line">            114 RETURN_VALUE</span><br><span class="line">None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</details>

<p><img src="https://s2.loli.net/2023/12/03/IOML12SXx45RyFU.png" alt="img"></p>
<p>这里也能解释为什么前面全局hook后调用encrypt(xxx)<br>结合标准roundkeys生成算法<br><img src="https://s2.loli.net/2023/12/03/Rusgx94JzwmIdvU.png" alt="img"></p>
<p>再对比字节码(通过特征参数定位)<br><img src="https://s2.loli.net/2023/12/03/OEBXFZSzy8VUcGt.png" alt="img"><br>可以发现在 <code>key ^= i &lt;&lt; 15</code> 的基础上变成了<br><code>key ^= (i&lt;&lt;15) ^ (key &gt;&gt; 19)</code><br>所以在标准代码上稍作修改:(直接搬官方的了 应该是对着字节码写的吧 网上找的都不好直接改 <del>还不如自己手搓字节码</del>)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sBoxLayer_dec</span>(<span class="params">state</span>):</span><br><span class="line">    output = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">            output += Sbox_inv[( state &gt;&gt; (i*<span class="number">4</span>)) &amp; <span class="number">0xF</span>] &lt;&lt; (i*<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pLayer_dec</span>(<span class="params">state</span>):</span><br><span class="line">    output = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">            output += ((state &gt;&gt; i) &amp; <span class="number">0x01</span>) &lt;&lt; PBox_inv[i]</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generateRoundkeys80</span>(<span class="params">key,rounds</span>):</span><br><span class="line">    roundkeys = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,rounds+<span class="number">1</span>,<span class="number">1</span>): </span><br><span class="line">            roundkeys.append(key &gt;&gt;<span class="number">16</span>)</span><br><span class="line">            key = ((key &amp; (<span class="number">2</span>**<span class="number">19</span>-<span class="number">1</span>)) &lt;&lt; <span class="number">61</span>) + (key &gt;&gt; <span class="number">19</span>)</span><br><span class="line">            key = (Sbox[key &gt;&gt; <span class="number">76</span>] &lt;&lt; <span class="number">76</span>)+(key &amp; (<span class="number">2</span>**<span class="number">76</span>-<span class="number">1</span>))</span><br><span class="line">            key ^= (i &lt;&lt; <span class="number">15</span>)^(key &gt;&gt; <span class="number">19</span>)</span><br><span class="line">    <span class="keyword">return</span> roundkeys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">string2number</span>(<span class="params">i</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span>([<span class="built_in">ord</span>(i[c])&lt;&lt;(<span class="number">8</span>*c) <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)])</span><br><span class="line"></span><br><span class="line"><span class="comment">#        0   1   2   3   4   5   6   7   8   9   a   b   c   d   e   f</span></span><br><span class="line">Sbox= [<span class="number">0xc</span>,<span class="number">0x5</span>,<span class="number">0x6</span>,<span class="number">0xb</span>,<span class="number">0x9</span>,<span class="number">0x0</span>,<span class="number">0xa</span>,<span class="number">0xd</span>,<span class="number">0x3</span>,<span class="number">0xe</span>,<span class="number">0xf</span>,<span class="number">0x8</span>,<span class="number">0x4</span>,<span class="number">0x7</span>,<span class="number">0x1</span>,<span class="number">0x2</span>]</span><br><span class="line">Sbox_inv = [Sbox.index(x) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line">PBox = [<span class="number">0</span>,<span class="number">16</span>,<span class="number">32</span>,<span class="number">48</span>,<span class="number">1</span>,<span class="number">17</span>,<span class="number">33</span>,<span class="number">49</span>,<span class="number">2</span>,<span class="number">18</span>,<span class="number">34</span>,<span class="number">50</span>,<span class="number">3</span>,<span class="number">19</span>,<span class="number">35</span>,<span class="number">51</span>,</span><br><span class="line">        <span class="number">4</span>,<span class="number">20</span>,<span class="number">36</span>,<span class="number">52</span>,<span class="number">5</span>,<span class="number">21</span>,<span class="number">37</span>,<span class="number">53</span>,<span class="number">6</span>,<span class="number">22</span>,<span class="number">38</span>,<span class="number">54</span>,<span class="number">7</span>,<span class="number">23</span>,<span class="number">39</span>,<span class="number">55</span>,</span><br><span class="line">        <span class="number">8</span>,<span class="number">24</span>,<span class="number">40</span>,<span class="number">56</span>,<span class="number">9</span>,<span class="number">25</span>,<span class="number">41</span>,<span class="number">57</span>,<span class="number">10</span>,<span class="number">26</span>,<span class="number">42</span>,<span class="number">58</span>,<span class="number">11</span>,<span class="number">27</span>,<span class="number">43</span>,<span class="number">59</span>,</span><br><span class="line">        <span class="number">12</span>,<span class="number">28</span>,<span class="number">44</span>,<span class="number">60</span>,<span class="number">13</span>,<span class="number">29</span>,<span class="number">45</span>,<span class="number">61</span>,<span class="number">14</span>,<span class="number">30</span>,<span class="number">46</span>,<span class="number">62</span>,<span class="number">15</span>,<span class="number">31</span>,<span class="number">47</span>,<span class="number">63</span>]</span><br><span class="line">PBox_inv = [PBox.index(x) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">addRoundKey</span>(<span class="params">state,roundkey</span>):</span><br><span class="line">    <span class="keyword">return</span> state ^ roundkey</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">blocks</span>):</span><br><span class="line">    rounds = <span class="number">32</span></span><br><span class="line">    roundkeys = generateRoundkeys80(<span class="number">85354531916197809168417</span>, rounds)</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> block <span class="keyword">in</span> blocks:</span><br><span class="line">        state = block</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds-<span class="number">1</span>):</span><br><span class="line">                state = addRoundKey(state, roundkeys[-i-<span class="number">1</span>])</span><br><span class="line">                state = pLayer_dec(state)</span><br><span class="line">                state = sBoxLayer_dec(state)</span><br><span class="line">        decipher = addRoundKey(state, roundkeys[<span class="number">0</span>])</span><br><span class="line">        flag += <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(decipher&gt;&gt;(c*<span class="number">8</span>) &amp; <span class="number">0xff</span>) <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)])</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line">cmps = [<span class="number">120617461261311902</span>, <span class="number">16357837616839286114</span>, <span class="number">312508749794633008</span>, <span class="number">1843701600916795272</span>]</span><br><span class="line">decrypt(cmps)</span><br><span class="line"><span class="comment"># 83ab766012aef9934c95ed93e9822a91</span></span><br></pre></td></tr></table></figure>

<p>想了想还是自己手搓一下(练习下字节码) 把加密代码写了下:<br>还复习了几个点:</p>
<ul>
<li>INPLACE_ADD: output +&#x3D;</li>
<li>BINARY_SUBSCR 用来划分块 避免字节码产生歧义</li>
</ul>
<p>自己写的时候 发现string2number直接看字节码是不太能写出来的 但知道原理自己写一下也差不了多少</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>():</span><br><span class="line">    rounds = <span class="number">32</span></span><br><span class="line">    generateRoundkeys80(<span class="number">85354531916197809168417</span>,rounds)</span><br><span class="line">    <span class="keyword">for</span> block <span class="keyword">in</span> blocks:</span><br><span class="line">        state = string2number(block)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds-<span class="number">1</span>):</span><br><span class="line">            state = addRoundKey(state,roundkeys[i]) <span class="comment"># roundkeys是数组</span></span><br><span class="line">            state = sBoxLayer(state)</span><br><span class="line">            state = pLayer(state)</span><br><span class="line">        cipher = addRoundKey(state,roundkeys[-<span class="number">1</span>])</span><br><span class="line">        out.append(cipher)</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">addRoundKey</span>(<span class="params">state,roundkey</span>):</span><br><span class="line">    <span class="keyword">return</span> state^roundkey</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">string2number</span>(<span class="params">i</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span>([<span class="built_in">ord</span>(i[c])&lt;&lt;(<span class="number">8</span>*c) <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sBoxLayer</span>(<span class="params">state</span>):</span><br><span class="line">    output = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        output += Sbox[(<span class="number">4</span>*i&gt;&gt;<span class="number">15</span>)&amp;<span class="number">15</span>]&lt;&lt;(<span class="number">4</span>*i)</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pLayer</span>(<span class="params">state</span>):</span><br><span class="line">    output = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        output += ((state&gt;&gt;i)&amp;<span class="number">1</span>)&lt;&lt;PBox[i]</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generateRoundkeys80</span>(<span class="params">key, rounds</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Generate the roundkeys for a 80-bit key</span></span><br><span class="line"><span class="string">    Input:</span></span><br><span class="line"><span class="string">            key:    the key as a 80-bit integer</span></span><br><span class="line"><span class="string">            rounds: the number of rounds as an integer</span></span><br><span class="line"><span class="string">    Output: list of 64-bit roundkeys as integers&quot;&quot;&quot;</span></span><br><span class="line">    roundkeys = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">1</span>, rounds + <span class="number">1</span>):  <span class="comment"># (K1 ... K32)</span></span><br><span class="line">        <span class="comment"># rawkey: used in comments to show what happens at bitlevel</span></span><br><span class="line">        <span class="comment"># rawKey[0:64]</span></span><br><span class="line">        roundkeys.append(key &gt;&gt; <span class="number">16</span>)</span><br><span class="line">        <span class="comment"># 1. Shift</span></span><br><span class="line">        <span class="comment"># rawKey[19:len(rawKey)]+rawKey[0:19]</span></span><br><span class="line">        key = ((key &amp; (<span class="number">2</span> ** <span class="number">19</span> - <span class="number">1</span>)) &lt;&lt; <span class="number">61</span>) + (key &gt;&gt; <span class="number">19</span>)</span><br><span class="line">        <span class="comment"># 2. SBox</span></span><br><span class="line">        <span class="comment"># rawKey[76:80] = S(rawKey[76:80])</span></span><br><span class="line">        key = (Sbox[key &gt;&gt; <span class="number">76</span>] &lt;&lt; <span class="number">76</span>) + (key &amp; (<span class="number">2</span> ** <span class="number">76</span> - <span class="number">1</span>))</span><br><span class="line">        <span class="comment">#3. Salt</span></span><br><span class="line">        <span class="comment">#rawKey[15:20] ^ i</span></span><br><span class="line">        key ^= (i &lt;&lt; <span class="number">15</span>)^(key&gt;&gt;<span class="number">19</span>)</span><br><span class="line">    <span class="keyword">return</span> roundkeys</span><br></pre></td></tr></table></figure>

<p>最后放一份手脱marshal的大致字节码:</p>
<details>
<summary>点击查看代码</summary>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br></pre></td><td class="code"><pre><span class="line">  3           0 LOAD_CONST               0 (12)</span><br><span class="line">              2 LOAD_CONST               1 (5)</span><br><span class="line">              4 LOAD_CONST               2 (6)</span><br><span class="line">              6 LOAD_CONST               3 (11)</span><br><span class="line">              8 LOAD_CONST               4 (9)</span><br><span class="line">             10 LOAD_CONST               5 (0)</span><br><span class="line">             12 LOAD_CONST               6 (10)</span><br><span class="line">             14 LOAD_CONST               7 (13)</span><br><span class="line">             16 LOAD_CONST               8 (3)</span><br><span class="line">             18 LOAD_CONST               9 (14)</span><br><span class="line">             20 LOAD_CONST              10 (15)</span><br><span class="line">             22 LOAD_CONST              11 (8)</span><br><span class="line">             24 LOAD_CONST              12 (4)</span><br><span class="line">             26 LOAD_CONST              13 (7)</span><br><span class="line">             28 LOAD_CONST              14 (1)</span><br><span class="line">             30 LOAD_CONST              15 (2)</span><br><span class="line">             32 BUILD_LIST              16</span><br><span class="line">             34 STORE_NAME               0 (Sbox)</span><br><span class="line"></span><br><span class="line">  4          36 LOAD_CONST              16 (&lt;code object &lt;listcomp&gt; at 0x7f7b29b00a80, file &quot;&quot;, line 4&gt;)</span><br><span class="line">             38 LOAD_CONST              17 (&#x27;&lt;listcomp&gt;&#x27;)</span><br><span class="line">             40 MAKE_FUNCTION            0</span><br><span class="line">             42 LOAD_NAME                1 (range)</span><br><span class="line">             44 LOAD_CONST              18 (16)</span><br><span class="line">             46 CALL_FUNCTION            1</span><br><span class="line">             48 GET_ITER</span><br><span class="line">             50 CALL_FUNCTION            1</span><br><span class="line">             52 STORE_NAME               2 (Sbox_inv)</span><br><span class="line"></span><br><span class="line">  5          54 LOAD_CONST               5 (0)</span><br><span class="line">             56 LOAD_CONST              18 (16)</span><br><span class="line">             58 LOAD_CONST              19 (32)</span><br><span class="line">             60 LOAD_CONST              20 (48)</span><br><span class="line">             62 LOAD_CONST              14 (1)</span><br><span class="line">             64 LOAD_CONST              21 (17)</span><br><span class="line">             66 LOAD_CONST              22 (33)</span><br><span class="line">             68 LOAD_CONST              23 (49)</span><br><span class="line">             70 LOAD_CONST              15 (2)</span><br><span class="line">             72 LOAD_CONST              24 (18)</span><br><span class="line">             74 LOAD_CONST              25 (34)</span><br><span class="line">             76 LOAD_CONST              26 (50)</span><br><span class="line">             78 LOAD_CONST               8 (3)</span><br><span class="line">             80 LOAD_CONST              27 (19)</span><br><span class="line">             82 LOAD_CONST              28 (35)</span><br><span class="line">             84 LOAD_CONST              29 (51)</span><br><span class="line"></span><br><span class="line">  6          86 LOAD_CONST              12 (4)</span><br><span class="line">             88 LOAD_CONST              30 (20)</span><br><span class="line">             90 LOAD_CONST              31 (36)</span><br><span class="line">             92 LOAD_CONST              32 (52)</span><br><span class="line">             94 LOAD_CONST               1 (5)</span><br><span class="line">             96 LOAD_CONST              33 (21)</span><br><span class="line">             98 LOAD_CONST              34 (37)</span><br><span class="line">            100 LOAD_CONST              35 (53)</span><br><span class="line">            102 LOAD_CONST               2 (6)</span><br><span class="line">            104 LOAD_CONST              36 (22)</span><br><span class="line">            106 LOAD_CONST              37 (38)</span><br><span class="line">            108 LOAD_CONST              38 (54)</span><br><span class="line">            110 LOAD_CONST              13 (7)</span><br><span class="line">            112 LOAD_CONST              39 (23)</span><br><span class="line">            114 LOAD_CONST              40 (39)</span><br><span class="line">            116 LOAD_CONST              41 (55)</span><br><span class="line"></span><br><span class="line">  7         118 LOAD_CONST              11 (8)</span><br><span class="line">            120 LOAD_CONST              42 (24)</span><br><span class="line">            122 LOAD_CONST              43 (40)</span><br><span class="line">            124 LOAD_CONST              44 (56)</span><br><span class="line">            126 LOAD_CONST               4 (9)</span><br><span class="line">            128 LOAD_CONST              45 (25)</span><br><span class="line">            130 LOAD_CONST              46 (41)</span><br><span class="line">            132 LOAD_CONST              47 (57)</span><br><span class="line">            134 LOAD_CONST               6 (10)</span><br><span class="line">            136 LOAD_CONST              48 (26)</span><br><span class="line">            138 LOAD_CONST              49 (42)</span><br><span class="line">            140 LOAD_CONST              50 (58)</span><br><span class="line">            142 LOAD_CONST               3 (11)</span><br><span class="line">            144 LOAD_CONST              51 (27)</span><br><span class="line">            146 LOAD_CONST              52 (43)</span><br><span class="line">            148 LOAD_CONST              53 (59)</span><br><span class="line"></span><br><span class="line">  8         150 LOAD_CONST               0 (12)</span><br><span class="line">            152 LOAD_CONST              54 (28)</span><br><span class="line">            154 LOAD_CONST              55 (44)</span><br><span class="line">            156 LOAD_CONST              56 (60)</span><br><span class="line">            158 LOAD_CONST               7 (13)</span><br><span class="line">            160 LOAD_CONST              57 (29)</span><br><span class="line">            162 LOAD_CONST              58 (45)</span><br><span class="line">            164 LOAD_CONST              59 (61)</span><br><span class="line">            166 LOAD_CONST               9 (14)</span><br><span class="line">            168 LOAD_CONST              60 (30)</span><br><span class="line">            170 LOAD_CONST              61 (46)</span><br><span class="line">            172 LOAD_CONST              62 (62)</span><br><span class="line">            174 LOAD_CONST              10 (15)</span><br><span class="line">            176 LOAD_CONST              63 (31)</span><br><span class="line">            178 LOAD_CONST              64 (47)</span><br><span class="line">            180 LOAD_CONST              65 (63)</span><br><span class="line"></span><br><span class="line">  5         182 BUILD_LIST              64</span><br><span class="line">            184 STORE_NAME               3 (PBox)</span><br><span class="line"></span><br><span class="line">  9         186 LOAD_CONST              66 (&lt;code object &lt;listcomp&gt; at 0x7f7b29a76a80, file &quot;&quot;, line 9&gt;)</span><br><span class="line">            188 LOAD_CONST              17 (&#x27;&lt;listcomp&gt;&#x27;)</span><br><span class="line">            190 MAKE_FUNCTION            0</span><br><span class="line">            192 LOAD_NAME                1 (range)</span><br><span class="line">            194 LOAD_CONST              67 (64)</span><br><span class="line">            196 CALL_FUNCTION            1</span><br><span class="line">            198 GET_ITER</span><br><span class="line">            200 CALL_FUNCTION            1</span><br><span class="line">            202 STORE_NAME               4 (PBox_inv)</span><br><span class="line"></span><br><span class="line"> 11         204 LOAD_NAME                5 (marshal)</span><br><span class="line">            206 LOAD_METHOD              6 (loads)</span><br><span class="line">              2           0 LOAD_CONST               0 (&lt;code object addRoundKey at 0x7f5223878a80, file &quot;&quot;, line 2&gt;)</span><br><span class="line">              2 LOAD_CONST               1 (&#x27;addRoundKey&#x27;)</span><br><span class="line">              4 MAKE_FUNCTION            0</span><br><span class="line">              6 STORE_NAME               0 (addRoundKey)</span><br><span class="line"></span><br><span class="line">  5           8 LOAD_NAME                1 (marshal)</span><br><span class="line">             10 LOAD_METHOD              2 (loads)</span><br><span class="line">               2           0 LOAD_CONST               0 (&lt;code object sBoxLayer at 0x7fab1d117a80, file &quot;&quot;, line 2&gt;)</span><br><span class="line">              2 LOAD_CONST               1 (&#x27;sBoxLayer&#x27;)</span><br><span class="line">              4 MAKE_FUNCTION            0</span><br><span class="line">              6 STORE_NAME               0 (sBoxLayer)</span><br><span class="line"></span><br><span class="line">  8           8 LOAD_NAME                1 (marshal)</span><br><span class="line">             10 LOAD_METHOD              2 (loads)</span><br><span class="line">               2           0 LOAD_CONST               0 (&lt;code object pLayer at 0x7f023882ba80, file &quot;&quot;, line 2&gt;)</span><br><span class="line">              2 LOAD_CONST               1 (&#x27;pLayer&#x27;)</span><br><span class="line">              4 MAKE_FUNCTION            0</span><br><span class="line">              6 STORE_NAME               0 (pLayer)</span><br><span class="line"></span><br><span class="line">  8           8 LOAD_NAME                1 (marshal)</span><br><span class="line">             10 LOAD_METHOD              2 (loads)</span><br><span class="line">               2           0 LOAD_CONST               0 (&lt;code object string2number at 0x7f7370421a80, file &quot;&quot;, line 2&gt;)</span><br><span class="line">              2 LOAD_CONST               1 (&#x27;string2number&#x27;)</span><br><span class="line">              4 MAKE_FUNCTION            0</span><br><span class="line">              6 STORE_NAME               0 (string2number)</span><br><span class="line"></span><br><span class="line">  5           8 LOAD_NAME                1 (marshal)</span><br><span class="line">             10 LOAD_METHOD              2 (loads)</span><br><span class="line">               2           0 LOAD_CONST               0 (&lt;code object generateRoundkeys80 at 0x7f133db26a80, file &quot;&quot;, line 2&gt;)</span><br><span class="line">              2 LOAD_CONST               1 (&#x27;generateRoundkeys80&#x27;)</span><br><span class="line">              4 MAKE_FUNCTION            0</span><br><span class="line">              6 STORE_NAME               0 (generateRoundkeys80)</span><br><span class="line"></span><br><span class="line"> 11           8 LOAD_NAME                1 (marshal)</span><br><span class="line">             10 LOAD_METHOD              2 (loads)</span><br><span class="line">               2           0 LOAD_CONST               0 (&lt;code object encrypt at 0x7f57c4c3aa80, file &quot;&quot;, line 2&gt;)</span><br><span class="line">              2 LOAD_CONST               1 (&#x27;encrypt&#x27;)</span><br><span class="line">              4 MAKE_FUNCTION            0</span><br><span class="line">              6 STORE_NAME               0 (encrypt)</span><br><span class="line"></span><br><span class="line"> 16           8 LOAD_NAME                1 (input)</span><br><span class="line">             10 LOAD_CONST               2 (&#x27;pls input ur flag:&#x27;)</span><br><span class="line">             12 CALL_FUNCTION            1</span><br><span class="line">             14 STORE_NAME               2 (inp)</span><br><span class="line"></span><br><span class="line"> 17          16 LOAD_NAME                3 (len)</span><br><span class="line">             18 LOAD_NAME                2 (inp)</span><br><span class="line">             20 CALL_FUNCTION            1</span><br><span class="line">             22 LOAD_CONST               3 (32)</span><br><span class="line">             24 COMPARE_OP               3 (!=)</span><br><span class="line">             26 POP_JUMP_IF_FALSE       44</span><br><span class="line"></span><br><span class="line"> 18          28 LOAD_NAME                4 (print)</span><br><span class="line">             30 LOAD_CONST               4 (&#x27;wrong flag!&#x27;)</span><br><span class="line">             32 CALL_FUNCTION            1</span><br><span class="line">             34 POP_TOP</span><br><span class="line"></span><br><span class="line"> 19          36 LOAD_NAME                5 (exit)</span><br><span class="line">             38 LOAD_CONST               5 (0)</span><br><span class="line">             40 CALL_FUNCTION            1</span><br><span class="line">             42 POP_TOP</span><br><span class="line"></span><br><span class="line"> 20     &gt;&gt;   44 LOAD_NAME                2 (inp)</span><br><span class="line">             46 LOAD_CONST               6 (None)</span><br><span class="line">             48 LOAD_CONST               7 (8)</span><br><span class="line">             50 BUILD_SLICE              2</span><br><span class="line">             52 BINARY_SUBSCR</span><br><span class="line">             54 LOAD_NAME                2 (inp)</span><br><span class="line">             56 LOAD_CONST               7 (8)</span><br><span class="line">             58 LOAD_CONST               8 (16)</span><br><span class="line">             60 BUILD_SLICE              2</span><br><span class="line">             62 BINARY_SUBSCR</span><br><span class="line">             64 LOAD_NAME                2 (inp)</span><br><span class="line">             66 LOAD_CONST               8 (16)</span><br><span class="line">             68 LOAD_CONST               9 (24)</span><br><span class="line">             70 BUILD_SLICE              2</span><br><span class="line">             72 BINARY_SUBSCR</span><br><span class="line">             74 LOAD_NAME                2 (inp)</span><br><span class="line">             76 LOAD_CONST               9 (24)</span><br><span class="line">             78 LOAD_CONST               3 (32)</span><br><span class="line">             80 BUILD_SLICE              2</span><br><span class="line">             82 BINARY_SUBSCR</span><br><span class="line">             84 BUILD_LIST               4</span><br><span class="line">             86 STORE_NAME               6 (blocks)</span><br><span class="line"></span><br><span class="line"> 21          88 LOAD_CONST              10 (120617461261311902)</span><br><span class="line">             90 LOAD_CONST              11 (16357837616839286114)</span><br><span class="line">             92 LOAD_CONST              12 (312508749794633008)</span><br><span class="line">             94 LOAD_CONST              13 (1843701600916795272)</span><br><span class="line">             96 BUILD_LIST               4</span><br><span class="line">             98 STORE_NAME               7 (cmps)</span><br><span class="line"></span><br><span class="line"> 22         100 LOAD_NAME                0 (encrypt)</span><br><span class="line">            102 LOAD_NAME                6 (blocks)</span><br><span class="line">            104 CALL_FUNCTION            1</span><br><span class="line">            106 STORE_NAME               8 (out_blocks)</span><br><span class="line"></span><br><span class="line"> 23         108 LOAD_NAME                9 (range)</span><br><span class="line">            110 LOAD_CONST              14 (4)</span><br><span class="line">            112 CALL_FUNCTION            1</span><br><span class="line">            114 GET_ITER</span><br><span class="line">        &gt;&gt;  116 FOR_ITER                36 (to 154)</span><br><span class="line">            118 STORE_NAME              10 (i)</span><br><span class="line"></span><br><span class="line"> 24         120 LOAD_NAME                7 (cmps)</span><br><span class="line">            122 LOAD_NAME               10 (i)</span><br><span class="line">            124 BINARY_SUBSCR</span><br><span class="line">            126 LOAD_NAME                8 (out_blocks)</span><br><span class="line">            128 LOAD_NAME               10 (i)</span><br><span class="line">            130 BINARY_SUBSCR</span><br><span class="line">            132 COMPARE_OP               3 (!=)</span><br><span class="line">            134 POP_JUMP_IF_FALSE      116</span><br><span class="line"></span><br><span class="line"> 25         136 LOAD_NAME                4 (print)</span><br><span class="line">            138 LOAD_CONST               4 (&#x27;wrong flag!&#x27;)</span><br><span class="line">            140 CALL_FUNCTION            1</span><br><span class="line">            142 POP_TOP</span><br><span class="line"></span><br><span class="line"> 26         144 LOAD_NAME                5 (exit)</span><br><span class="line">            146 LOAD_CONST               5 (0)</span><br><span class="line">            148 CALL_FUNCTION            1</span><br><span class="line">            150 POP_TOP</span><br><span class="line">            152 JUMP_ABSOLUTE          116</span><br><span class="line"></span><br><span class="line"> 27     &gt;&gt;  154 LOAD_NAME                4 (print)</span><br><span class="line">            156 LOAD_CONST              15 (&#x27;Correct!&#x27;)</span><br><span class="line">            158 CALL_FUNCTION            1</span><br><span class="line">            160 POP_TOP</span><br><span class="line">            162 LOAD_CONST               6 (None)</span><br><span class="line">            164 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object encrypt at 0x7f57c4c3aa80, file &quot;&quot;, line 2&gt;:</span><br><span class="line">  3           0 LOAD_CONST               1 (32)</span><br><span class="line">              2 STORE_FAST               1 (rounds)</span><br><span class="line"></span><br><span class="line">  4           4 LOAD_GLOBAL              0 (generateRoundkeys80)</span><br><span class="line">              6 LOAD_CONST               2 (85354531916197809168417)</span><br><span class="line">              8 LOAD_FAST                1 (rounds)</span><br><span class="line">             10 CALL_FUNCTION            2</span><br><span class="line">             12 STORE_FAST               2 (roundkeys)</span><br><span class="line"></span><br><span class="line">  5          14 BUILD_LIST               0</span><br><span class="line">             16 STORE_FAST               3 (out)</span><br><span class="line"></span><br><span class="line">  6          18 LOAD_FAST                0 (blocks)</span><br><span class="line">             20 GET_ITER</span><br><span class="line">        &gt;&gt;   22 FOR_ITER                84 (to 108)</span><br><span class="line">             24 STORE_FAST               4 (block)</span><br><span class="line"></span><br><span class="line">  7          26 LOAD_GLOBAL              1 (string2number)</span><br><span class="line">             28 LOAD_FAST                4 (block)</span><br><span class="line">             30 CALL_FUNCTION            1</span><br><span class="line">             32 STORE_FAST               5 (state)</span><br><span class="line"></span><br><span class="line">  8          34 LOAD_GLOBAL              2 (range)</span><br><span class="line">             36 LOAD_FAST                1 (rounds)</span><br><span class="line">             38 LOAD_CONST               3 (1)</span><br><span class="line">             40 BINARY_SUBTRACT</span><br><span class="line">             42 CALL_FUNCTION            1</span><br><span class="line">             44 GET_ITER</span><br><span class="line">        &gt;&gt;   46 FOR_ITER                34 (to 82)</span><br><span class="line">             48 STORE_FAST               6 (i)</span><br><span class="line"></span><br><span class="line">  9          50 LOAD_GLOBAL              3 (addRoundKey)</span><br><span class="line">             52 LOAD_FAST                5 (state)</span><br><span class="line">             54 LOAD_FAST                2 (roundkeys)</span><br><span class="line">             56 LOAD_FAST                6 (i)</span><br><span class="line">             58 BINARY_SUBSCR</span><br><span class="line">             60 CALL_FUNCTION            2</span><br><span class="line">             62 STORE_FAST               5 (state)</span><br><span class="line"></span><br><span class="line"> 10          64 LOAD_GLOBAL              4 (sBoxLayer)</span><br><span class="line">             66 LOAD_FAST                5 (state)</span><br><span class="line">             68 CALL_FUNCTION            1</span><br><span class="line">             70 STORE_FAST               5 (state)</span><br><span class="line"></span><br><span class="line"> 11          72 LOAD_GLOBAL              5 (pLayer)</span><br><span class="line">             74 LOAD_FAST                5 (state)</span><br><span class="line">             76 CALL_FUNCTION            1</span><br><span class="line">             78 STORE_FAST               5 (state)</span><br><span class="line">             80 JUMP_ABSOLUTE           46</span><br><span class="line"></span><br><span class="line"> 12     &gt;&gt;   82 LOAD_GLOBAL              3 (addRoundKey)</span><br><span class="line">             84 LOAD_FAST                5 (state)</span><br><span class="line">             86 LOAD_FAST                2 (roundkeys)</span><br><span class="line">             88 LOAD_CONST               4 (-1)</span><br><span class="line">             90 BINARY_SUBSCR</span><br><span class="line">             92 CALL_FUNCTION            2</span><br><span class="line">             94 STORE_FAST               7 (cipher)</span><br><span class="line"></span><br><span class="line"> 13          96 LOAD_FAST                3 (out)</span><br><span class="line">             98 LOAD_METHOD              6 (append)</span><br><span class="line">            100 LOAD_FAST                7 (cipher)</span><br><span class="line">            102 CALL_METHOD              1</span><br><span class="line">            104 POP_TOP</span><br><span class="line">            106 JUMP_ABSOLUTE           22</span><br><span class="line"></span><br><span class="line"> 14     &gt;&gt;  108 LOAD_FAST                3 (out)</span><br><span class="line">            110 RETURN_VALUE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 STORE_NAME               3 (co)</span><br><span class="line"></span><br><span class="line"> 12          18 LOAD_NAME                4 (exec)</span><br><span class="line">             20 LOAD_NAME                3 (co)</span><br><span class="line">             22 CALL_FUNCTION            1</span><br><span class="line">             24 POP_TOP</span><br><span class="line">             26 LOAD_CONST               3 (None)</span><br><span class="line">             28 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object generateRoundkeys80 at 0x7f133db26a80, file &quot;&quot;, line 2&gt;:</span><br><span class="line">  3           0 BUILD_LIST               0</span><br><span class="line">              2 STORE_FAST               2 (roundkeys)</span><br><span class="line"></span><br><span class="line">  4           4 LOAD_GLOBAL              0 (range)</span><br><span class="line">              6 LOAD_CONST               1 (1)</span><br><span class="line">              8 LOAD_FAST                1 (rounds)</span><br><span class="line">             10 LOAD_CONST               1 (1)</span><br><span class="line">             12 BINARY_ADD</span><br><span class="line">             14 LOAD_CONST               1 (1)</span><br><span class="line">             16 CALL_FUNCTION            3</span><br><span class="line">             18 GET_ITER</span><br><span class="line">        &gt;&gt;   20 FOR_ITER                90 (to 112)</span><br><span class="line">             22 STORE_FAST               3 (i)</span><br><span class="line"></span><br><span class="line">  5          24 LOAD_FAST                2 (roundkeys)</span><br><span class="line">             26 LOAD_METHOD              1 (append)</span><br><span class="line">             28 LOAD_FAST                0 (key)</span><br><span class="line">             30 LOAD_CONST               2 (16)</span><br><span class="line">             32 BINARY_RSHIFT</span><br><span class="line">             34 CALL_METHOD              1</span><br><span class="line">             36 POP_TOP</span><br><span class="line"></span><br><span class="line">  6          38 LOAD_FAST                0 (key)</span><br><span class="line">             40 LOAD_CONST               3 (524287)</span><br><span class="line">             42 BINARY_AND</span><br><span class="line">             44 LOAD_CONST               4 (61)</span><br><span class="line">             46 BINARY_LSHIFT</span><br><span class="line">             48 LOAD_FAST                0 (key)</span><br><span class="line">             50 LOAD_CONST               5 (19)</span><br><span class="line">             52 BINARY_RSHIFT</span><br><span class="line">             54 BINARY_ADD</span><br><span class="line">             56 STORE_FAST               0 (key)</span><br><span class="line"></span><br><span class="line">  7          58 LOAD_GLOBAL              2 (Sbox)</span><br><span class="line">             60 LOAD_FAST                0 (key)</span><br><span class="line">             62 LOAD_CONST               6 (76)</span><br><span class="line">             64 BINARY_RSHIFT</span><br><span class="line">             66 BINARY_SUBSCR</span><br><span class="line">             68 LOAD_CONST               6 (76)</span><br><span class="line">             70 BINARY_LSHIFT</span><br><span class="line">             72 LOAD_FAST                0 (key)</span><br><span class="line">             74 LOAD_CONST               7 (2)</span><br><span class="line">             76 LOAD_CONST               6 (76)</span><br><span class="line">             78 BINARY_POWER</span><br><span class="line">             80 LOAD_CONST               1 (1)</span><br><span class="line">             82 BINARY_SUBTRACT</span><br><span class="line">             84 BINARY_AND</span><br><span class="line">             86 BINARY_ADD</span><br><span class="line">             88 STORE_FAST               0 (key)</span><br><span class="line"></span><br><span class="line">  8          90 LOAD_FAST                0 (key)</span><br><span class="line">             92 LOAD_FAST                3 (i)</span><br><span class="line">             94 LOAD_CONST               8 (15)</span><br><span class="line">             96 BINARY_LSHIFT</span><br><span class="line">             98 LOAD_FAST                0 (key)</span><br><span class="line">            100 LOAD_CONST               5 (19)</span><br><span class="line">            102 BINARY_RSHIFT</span><br><span class="line">            104 BINARY_XOR</span><br><span class="line">            106 INPLACE_XOR</span><br><span class="line">            108 STORE_FAST               0 (key)</span><br><span class="line">            110 JUMP_ABSOLUTE           20</span><br><span class="line"></span><br><span class="line">  9     &gt;&gt;  112 LOAD_FAST                2 (roundkeys)</span><br><span class="line">            114 RETURN_VALUE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 STORE_NAME               3 (co)</span><br><span class="line"></span><br><span class="line">  6          18 LOAD_NAME                4 (exec)</span><br><span class="line">             20 LOAD_NAME                3 (co)</span><br><span class="line">             22 CALL_FUNCTION            1</span><br><span class="line">             24 POP_TOP</span><br><span class="line">             26 LOAD_CONST               3 (None)</span><br><span class="line">             28 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object string2number at 0x7f7370421a80, file &quot;&quot;, line 2&gt;:</span><br><span class="line">  3           0 LOAD_GLOBAL              0 (sum)</span><br><span class="line">              2 LOAD_CLOSURE             0 (i)</span><br><span class="line">              4 BUILD_TUPLE              1</span><br><span class="line">              6 LOAD_CONST               1 (&lt;code object &lt;listcomp&gt; at 0x7f73704aba80, file &quot;&quot;, line 3&gt;)</span><br><span class="line">              8 LOAD_CONST               2 (&#x27;string2number.&lt;locals&gt;.&lt;listcomp&gt;&#x27;)</span><br><span class="line">             10 MAKE_FUNCTION            8 (closure)</span><br><span class="line">             12 LOAD_GLOBAL              1 (range)</span><br><span class="line">             14 LOAD_CONST               3 (8)</span><br><span class="line">             16 CALL_FUNCTION            1</span><br><span class="line">             18 GET_ITER</span><br><span class="line">             20 CALL_FUNCTION            1</span><br><span class="line">             22 CALL_FUNCTION            1</span><br><span class="line">             24 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object &lt;listcomp&gt; at 0x7f73704aba80, file &quot;&quot;, line 3&gt;:</span><br><span class="line">  3           0 BUILD_LIST               0</span><br><span class="line">              2 LOAD_FAST                0 (.0)</span><br><span class="line">        &gt;&gt;    4 FOR_ITER                24 (to 30)</span><br><span class="line">              6 STORE_FAST               1 (c)</span><br><span class="line">              8 LOAD_GLOBAL              0 (ord)</span><br><span class="line">             10 LOAD_DEREF               0 (i)</span><br><span class="line">             12 LOAD_FAST                1 (c)</span><br><span class="line">             14 BINARY_SUBSCR</span><br><span class="line">             16 CALL_FUNCTION            1</span><br><span class="line">             18 LOAD_CONST               0 (8)</span><br><span class="line">             20 LOAD_FAST                1 (c)</span><br><span class="line">             22 BINARY_MULTIPLY</span><br><span class="line">             24 BINARY_LSHIFT</span><br><span class="line">             26 LIST_APPEND              2</span><br><span class="line">             28 JUMP_ABSOLUTE            4</span><br><span class="line">        &gt;&gt;   30 RETURN_VALUE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 STORE_NAME               3 (co)</span><br><span class="line"></span><br><span class="line">  9          18 LOAD_NAME                4 (exec)</span><br><span class="line">             20 LOAD_NAME                3 (co)</span><br><span class="line">             22 CALL_FUNCTION            1</span><br><span class="line">             24 POP_TOP</span><br><span class="line">             26 LOAD_CONST               3 (None)</span><br><span class="line">             28 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object pLayer at 0x7f023882ba80, file &quot;&quot;, line 2&gt;:</span><br><span class="line">  3           0 LOAD_CONST               1 (0)</span><br><span class="line">              2 STORE_FAST               1 (output)</span><br><span class="line"></span><br><span class="line">  4           4 LOAD_GLOBAL              0 (range)</span><br><span class="line">              6 LOAD_CONST               2 (64)</span><br><span class="line">              8 CALL_FUNCTION            1</span><br><span class="line">             10 GET_ITER</span><br><span class="line">        &gt;&gt;   12 FOR_ITER                28 (to 42)</span><br><span class="line">             14 STORE_FAST               2 (i)</span><br><span class="line"></span><br><span class="line">  5          16 LOAD_FAST                1 (output)</span><br><span class="line">             18 LOAD_FAST                0 (state)</span><br><span class="line">             20 LOAD_FAST                2 (i)</span><br><span class="line">             22 BINARY_RSHIFT</span><br><span class="line">             24 LOAD_CONST               3 (1)</span><br><span class="line">             26 BINARY_AND</span><br><span class="line">             28 LOAD_GLOBAL              1 (PBox)</span><br><span class="line">             30 LOAD_FAST                2 (i)</span><br><span class="line">             32 BINARY_SUBSCR</span><br><span class="line">             34 BINARY_LSHIFT</span><br><span class="line">             36 INPLACE_ADD</span><br><span class="line">             38 STORE_FAST               1 (output)</span><br><span class="line">             40 JUMP_ABSOLUTE           12</span><br><span class="line"></span><br><span class="line">  6     &gt;&gt;   42 LOAD_FAST                1 (output)</span><br><span class="line">             44 RETURN_VALUE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 STORE_NAME               3 (co)</span><br><span class="line"></span><br><span class="line">  9          18 LOAD_NAME                4 (exec)</span><br><span class="line">             20 LOAD_NAME                3 (co)</span><br><span class="line">             22 CALL_FUNCTION            1</span><br><span class="line">             24 POP_TOP</span><br><span class="line">             26 LOAD_CONST               3 (None)</span><br><span class="line">             28 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object sBoxLayer at 0x7fab1d117a80, file &quot;&quot;, line 2&gt;:</span><br><span class="line">  3           0 LOAD_CONST               1 (0)</span><br><span class="line">              2 STORE_FAST               1 (output)</span><br><span class="line"></span><br><span class="line">  4           4 LOAD_GLOBAL              0 (range)</span><br><span class="line">              6 LOAD_CONST               2 (16)</span><br><span class="line">              8 CALL_FUNCTION            1</span><br><span class="line">             10 GET_ITER</span><br><span class="line">        &gt;&gt;   12 FOR_ITER                36 (to 50)</span><br><span class="line">             14 STORE_FAST               2 (i)</span><br><span class="line"></span><br><span class="line">  5          16 LOAD_FAST                1 (output)</span><br><span class="line">             18 LOAD_GLOBAL              1 (Sbox)</span><br><span class="line">             20 LOAD_FAST                0 (state)</span><br><span class="line">             22 LOAD_FAST                2 (i)</span><br><span class="line">             24 LOAD_CONST               3 (4)</span><br><span class="line">             26 BINARY_MULTIPLY</span><br><span class="line">             28 BINARY_RSHIFT</span><br><span class="line">             30 LOAD_CONST               4 (15)</span><br><span class="line">             32 BINARY_AND</span><br><span class="line">             34 BINARY_SUBSCR</span><br><span class="line">             36 LOAD_FAST                2 (i)</span><br><span class="line">             38 LOAD_CONST               3 (4)</span><br><span class="line">             40 BINARY_MULTIPLY</span><br><span class="line">             42 BINARY_LSHIFT</span><br><span class="line">             44 INPLACE_ADD</span><br><span class="line">             46 STORE_FAST               1 (output)</span><br><span class="line">             48 JUMP_ABSOLUTE           12</span><br><span class="line"></span><br><span class="line">  6     &gt;&gt;   50 LOAD_FAST                1 (output)</span><br><span class="line">             52 RETURN_VALUE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 STORE_NAME               3 (co)</span><br><span class="line"></span><br><span class="line">  6          18 LOAD_NAME                4 (exec)</span><br><span class="line">             20 LOAD_NAME                3 (co)</span><br><span class="line">             22 CALL_FUNCTION            1</span><br><span class="line">             24 POP_TOP</span><br><span class="line">             26 LOAD_CONST               3 (None)</span><br><span class="line">             28 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object addRoundKey at 0x7f5223878a80, file &quot;&quot;, line 2&gt;:</span><br><span class="line">  3           0 LOAD_FAST                0 (state)</span><br><span class="line">              2 LOAD_FAST                1 (roundkey)</span><br><span class="line">              4 BINARY_XOR</span><br><span class="line">              6 RETURN_VALUE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            210 CALL_METHOD              1</span><br><span class="line">            212 STORE_NAME               7 (co)</span><br><span class="line"></span><br><span class="line"> 12         214 LOAD_NAME                8 (exec)</span><br><span class="line">            216 LOAD_NAME                7 (co)</span><br><span class="line">            218 CALL_FUNCTION            1</span><br><span class="line">            220 POP_TOP</span><br><span class="line">            222 LOAD_CONST              69 (None)</span><br><span class="line">            224 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object &lt;listcomp&gt; at 0x7f7b29b00a80, file &quot;&quot;, line 4&gt;:</span><br><span class="line">  4           0 BUILD_LIST               0</span><br><span class="line">              2 LOAD_FAST                0 (.0)</span><br><span class="line">        &gt;&gt;    4 FOR_ITER                14 (to 20)</span><br><span class="line">              6 STORE_FAST               1 (x)</span><br><span class="line">              8 LOAD_GLOBAL              0 (Sbox)</span><br><span class="line">             10 LOAD_METHOD              1 (index)</span><br><span class="line">             12 LOAD_FAST                1 (x)</span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 LIST_APPEND              2</span><br><span class="line">             18 JUMP_ABSOLUTE            4</span><br><span class="line">        &gt;&gt;   20 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object &lt;listcomp&gt; at 0x7f7b29a76a80, file &quot;&quot;, line 9&gt;:</span><br><span class="line">  9           0 BUILD_LIST               0</span><br><span class="line">              2 LOAD_FAST                0 (.0)</span><br><span class="line">        &gt;&gt;    4 FOR_ITER                14 (to 20)</span><br><span class="line">              6 STORE_FAST               1 (x)</span><br><span class="line">              8 LOAD_GLOBAL              0 (PBox)</span><br><span class="line">             10 LOAD_METHOD              1 (index)</span><br><span class="line">             12 LOAD_FAST                1 (x)</span><br><span class="line">             14 CALL_METHOD              1</span><br><span class="line">             16 LIST_APPEND              2</span><br><span class="line">             18 JUMP_ABSOLUTE            4</span><br><span class="line">        &gt;&gt;   20 RETURN_VALUE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</details>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">首页</a></li>
        
          <li><a href="/about/">关于</a></li>
        
          <li><a href="/archives/">归档</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://github.com/N0zoM1z0">项目</a></li>
        
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-number">1.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#rsa"><span class="toc-number">1.1.</span> <span class="toc-text">rsa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#backpack"><span class="toc-number">1.2.</span> <span class="toc-text">backpack</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Re"><span class="toc-number">2.</span> <span class="toc-text">Re</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#auuuu3"><span class="toc-number">2.1.</span> <span class="toc-text">auuuu3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#marshal"><span class="toc-number">2.2.</span> <span class="toc-text">marshal</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/&text=DASCTF X CBCTF 2023 10"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/&title=DASCTF X CBCTF 2023 10"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/&is_video=false&description=DASCTF X CBCTF 2023 10"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=DASCTF X CBCTF 2023 10&body=Check out this article: http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/&title=DASCTF X CBCTF 2023 10"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/&title=DASCTF X CBCTF 2023 10"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/&title=DASCTF X CBCTF 2023 10"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/&title=DASCTF X CBCTF 2023 10"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/&name=DASCTF X CBCTF 2023 10&description=&lt;p&gt;能力有限 只能复现能做的一些题 其他的慢慢补&lt;/p&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://n0zom1z0.github.io/DASCTF-X-CBCTF-2023-10/&t=DASCTF X CBCTF 2023 10"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2024
    N0zoM1z0
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
      --><li><a href="/">首页</a></li><!--
    --><!--
      --><li><a href="/about/">关于</a></li><!--
    --><!--
      --><li><a href="/archives/">归档</a></li><!--
    --><!--
      --><li><a target="_blank" rel="noopener" href="http://github.com/N0zoM1z0">项目</a></li><!--
    --><!--
      --><li><a href="/search/">搜索</a></li><!--
    -->
      </ul>
      <ul>
        
          <!-- 不蒜子统计 -->
          <span id="busuanzi_container_site_pv">
              Friend Link: Kasaki·Nozomi
          </span>
          <span class="post-meta-divider">|</span>
          <span id="busuanzi_container_site_uv" style='display:none'>
                  Yoroizuka·Mizore
          </span>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        
      </ul>
    </nav>
  </div>
  
</footer>


    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>

<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="è®°å½•ä¸€äº›reverseé¢˜ç›®">
<meta property="og:type" content="article">
<meta property="og:title" content="Reverse-Other">
<meta property="og:url" content="http://n0zom1z0.github.io/Reverse-Other/index.html">
<meta property="og:site_name" content="N0zoM1z0">
<meta property="og:description" content="è®°å½•ä¸€äº›reverseé¢˜ç›®">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2023/12/17/YpD7sKfL3v5MNCT.png">
<meta property="og:image" content="https://s2.loli.net/2024/01/04/5DfGocJ3RINlFEs.png">
<meta property="og:image" content="https://s2.loli.net/2024/01/24/wjebRFKkmsa3dL7.png">
<meta property="og:image" content="http://n0zom1z0.github.io/Reverse-Other/images/image.png">
<meta property="og:image" content="http://n0zom1z0.github.io/Reverse-Other/images/image-1.png">
<meta property="og:image" content="http://n0zom1z0.github.io/Reverse-Other/images/image-2.png">
<meta property="og:image" content="http://n0zom1z0.github.io/Reverse-Other/images/image-3.png">
<meta property="og:image" content="http://n0zom1z0.github.io/Reverse-Other/images/image-4.png">
<meta property="article:published_time" content="2023-12-08T09:49:26.000Z">
<meta property="article:modified_time" content="2024-02-23T23:38:52.743Z">
<meta property="article:author" content="N0zoM1z0">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2023/12/17/YpD7sKfL3v5MNCT.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Reverse-Other</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.1.1"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="ç›®å½•"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="ç›®å½•"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="é¡¶éƒ¨" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">é¦–é¡µ</a></li><!--
     --><!--
       --><li><a href="/about/">å…³äº</a></li><!--
     --><!--
       --><li><a href="/archives/">å½’æ¡£</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/N0zoM1z0">é¡¹ç›®</a></li><!--
     --><!--
       --><li><a href="/search/">æœç´¢</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="ä¸Šä¸€ç¯‡" href="/Crypto-ECC/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="ä¸‹ä¸€ç¯‡" href="/ISCTF2023/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="è¿”å›é¡¶éƒ¨" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="åˆ†äº«æ–‡ç« " href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">ä¸Šä¸€ç¯‡</span>
      <span id="i-next" class="info" style="display:none;">ä¸‹ä¸€ç¯‡</span>
      <span id="i-top" class="info" style="display:none;">è¿”å›é¡¶éƒ¨</span>
      <span id="i-share" class="info" style="display:none;">åˆ†äº«æ–‡ç« </span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://n0zom1z0.github.io/Reverse-Other/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://n0zom1z0.github.io/Reverse-Other/&text=Reverse-Other"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://n0zom1z0.github.io/Reverse-Other/&title=Reverse-Other"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://n0zom1z0.github.io/Reverse-Other/&is_video=false&description=Reverse-Other"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Reverse-Other&body=Check out this article: http://n0zom1z0.github.io/Reverse-Other/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://n0zom1z0.github.io/Reverse-Other/&title=Reverse-Other"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://n0zom1z0.github.io/Reverse-Other/&title=Reverse-Other"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://n0zom1z0.github.io/Reverse-Other/&title=Reverse-Other"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://n0zom1z0.github.io/Reverse-Other/&title=Reverse-Other"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://n0zom1z0.github.io/Reverse-Other/&name=Reverse-Other&description=&lt;p&gt;è®°å½•ä¸€äº›reverseé¢˜ç›®&lt;/p&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://n0zom1z0.github.io/Reverse-Other/&t=Reverse-Other"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#moectf2023"><span class="toc-number">1.</span> <span class="toc-text">moectf2023</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#GUI"><span class="toc-number">1.1.</span> <span class="toc-text">GUI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#unwind"><span class="toc-number">1.2.</span> <span class="toc-text">unwind</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#miniLCTF2021"><span class="toc-number">2.</span> <span class="toc-text">miniLCTF2021</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sub"><span class="toc-number">2.1.</span> <span class="toc-text">sub</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#miniLCTF2022"><span class="toc-number">3.</span> <span class="toc-text">miniLCTF2022</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#lemon"><span class="toc-number">3.1.</span> <span class="toc-text">lemon</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NOTRC4"><span class="toc-number">3.2.</span> <span class="toc-text">NOTRC4</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NCTF2022"><span class="toc-number">4.</span> <span class="toc-text">NCTF2022</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-rev"><span class="toc-number">4.1.</span> <span class="toc-text">ez_rev</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#just-run-it"><span class="toc-number">4.2.</span> <span class="toc-text">just_run_it</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NCTF2018"><span class="toc-number">5.</span> <span class="toc-text">NCTF2018</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#wcyvm"><span class="toc-number">5.1.</span> <span class="toc-text">wcyvm</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NUAACTF2020"><span class="toc-number">6.</span> <span class="toc-text">NUAACTF2020</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#demium"><span class="toc-number">6.1.</span> <span class="toc-text">demium</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DUCTF2023"><span class="toc-number">7.</span> <span class="toc-text">DUCTF2023</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#nt-flag-checker"><span class="toc-number">7.1.</span> <span class="toc-text">nt_flag_checker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wrong-signal"><span class="toc-number">7.2.</span> <span class="toc-text">wrong-signal</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SPACEGAME"><span class="toc-number">7.3.</span> <span class="toc-text">SPACEGAME</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF2022"><span class="toc-number">8.</span> <span class="toc-text">ACTF2022</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#dropper"><span class="toc-number">8.1.</span> <span class="toc-text">dropper</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF2023-Week5"><span class="toc-number">9.</span> <span class="toc-text">NewStarCTF2023 Week5</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Fish"><span class="toc-number">9.1.</span> <span class="toc-text">Fish</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Genshin"><span class="toc-number">9.2.</span> <span class="toc-text">Genshin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-js2"><span class="toc-number">9.3.</span> <span class="toc-text">easy_js2</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2023%E5%BC%BA%E7%BD%91%E6%9D%AF"><span class="toc-number">10.</span> <span class="toc-text">2023å¼ºç½‘æ¯</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-re"><span class="toc-number">10.1.</span> <span class="toc-text">ez_re</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SM4%E7%9A%84%E5%AF%86%E9%92%A5%E6%89%A9%E5%B1%95%E7%AE%97%E6%B3%95"><span class="toc-number">10.1.1.</span> <span class="toc-text">SM4çš„å¯†é’¥æ‰©å±•ç®—æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%B8%8E%E7%B3%BB%E7%BB%9F%E5%8F%82%E6%95%B0%E5%BC%82%E6%88%96%E2%80%94%E2%80%94%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AF%86%E9%92%A5"><span class="toc-number">10.1.1.1.</span> <span class="toc-text">1.ä¸ç³»ç»Ÿå‚æ•°å¼‚æˆ–â€”â€”åˆå§‹åŒ–å¯†é’¥</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%BD%AE%E8%BF%AD%E4%BB%A3%E7%94%9F%E6%88%90%E8%BD%AE%E5%AF%86%E9%92%A5"><span class="toc-number">10.1.1.2.</span> <span class="toc-text">2.è½®è¿­ä»£ç”Ÿæˆè½®å¯†é’¥</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezre-%E5%BC%BA%E7%BD%91%E5%85%88%E9%94%8B"><span class="toc-number">10.2.</span> <span class="toc-text">ezre(å¼ºç½‘å…ˆé”‹)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GDOUCTF2023"><span class="toc-number">11.</span> <span class="toc-text">GDOUCTF2023</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#L-S"><span class="toc-number">11.1.</span> <span class="toc-text">L!S!</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#TPCTF2023"><span class="toc-number">12.</span> <span class="toc-text">TPCTF2023</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#maze"><span class="toc-number">12.1.</span> <span class="toc-text">maze</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nanoPyEnc"><span class="toc-number">12.2.</span> <span class="toc-text">nanoPyEnc</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GXYCTF2019"><span class="toc-number">13.</span> <span class="toc-text">GXYCTF2019</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#minecraft"><span class="toc-number">13.1.</span> <span class="toc-text">minecraft</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RoarCTF2019"><span class="toc-number">14.</span> <span class="toc-text">RoarCTF2019</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Polyre"><span class="toc-number">14.1.</span> <span class="toc-text">Polyre</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF2018"><span class="toc-number">15.</span> <span class="toc-text">ç½‘é¼æ¯2018</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%A5%BD%E7%9A%84%E8%AF%AD%E8%A8%80"><span class="toc-number">15.1.</span> <span class="toc-text">æœ€å¥½çš„è¯­è¨€</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF2023"><span class="toc-number">16.</span> <span class="toc-text">ç¾ŠåŸæ¯2023</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#CSGO"><span class="toc-number">16.1.</span> <span class="toc-text">CSGO</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Blast"><span class="toc-number">16.2.</span> <span class="toc-text">Blast</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vm-wo"><span class="toc-number">16.3.</span> <span class="toc-text">vm_wo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EZ%E5%8A%A0%E5%AF%86%E5%99%A8"><span class="toc-number">16.4.</span> <span class="toc-text">EZåŠ å¯†å™¨</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#V-N2020%E5%85%AC%E5%BC%80%E8%B5%9B"><span class="toc-number">17.</span> <span class="toc-text">V&amp;N2020å…¬å¼€èµ›</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#strangeCPP"><span class="toc-number">17.1.</span> <span class="toc-text">strangeCPP</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BJDCTF-2nd"><span class="toc-number">18.</span> <span class="toc-text">BJDCTF 2nd</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#guessgame"><span class="toc-number">18.1.</span> <span class="toc-text">guessgame</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy"><span class="toc-number">18.2.</span> <span class="toc-text">easy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8086"><span class="toc-number">18.3.</span> <span class="toc-text">8086</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#justCTF2020"><span class="toc-number">19.</span> <span class="toc-text">justCTF2020</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Rusty"><span class="toc-number">19.1.</span> <span class="toc-text">Rusty</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF2022"><span class="toc-number">20.</span> <span class="toc-text">NewStarCTF2022</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK4"><span class="toc-number">20.1.</span> <span class="toc-text">WEEK4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Exception"><span class="toc-number">20.1.1.</span> <span class="toc-text">Exception</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HelpMe"><span class="toc-number">20.1.2.</span> <span class="toc-text">HelpMe</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK5"><span class="toc-number">20.2.</span> <span class="toc-text">WEEK5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Virtual-Self"><span class="toc-number">20.2.1.</span> <span class="toc-text">Virtual Self</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BUUCTF-N1BOOK"><span class="toc-number">21.</span> <span class="toc-text">BUUCTF&#x2F;N1BOOK</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-rust"><span class="toc-number">21.1.</span> <span class="toc-text">easy_rust</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-go"><span class="toc-number">21.2.</span> <span class="toc-text">easy_go</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-mfc"><span class="toc-number">21.3.</span> <span class="toc-text">easy_mfc</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NPUCTF2020"><span class="toc-number">22.</span> <span class="toc-text">NPUCTF2020</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#BasicASM"><span class="toc-number">22.1.</span> <span class="toc-text">BasicASM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Baby-Obfuscation"><span class="toc-number">22.2.</span> <span class="toc-text">Baby Obfuscation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8A%9C%E6%B9%96%F0%9F%9B%AB"><span class="toc-number">22.3.</span> <span class="toc-text">èŠœæ¹–ğŸ›«</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF2019"><span class="toc-number">23.</span> <span class="toc-text">å®‰æ´µæ¯2019</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#crackMe"><span class="toc-number">23.1.</span> <span class="toc-text">crackMe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Game"><span class="toc-number">23.2.</span> <span class="toc-text">Game</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF2021"><span class="toc-number">24.</span> <span class="toc-text">å®‰æ´µæ¯2021</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sign-in"><span class="toc-number">24.1.</span> <span class="toc-text">sign_in</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MTCTF2021"><span class="toc-number">25.</span> <span class="toc-text">MTCTF2021</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#wow"><span class="toc-number">25.1.</span> <span class="toc-text">wow</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Superflat"><span class="toc-number">25.2.</span> <span class="toc-text">Superflat</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GKCTF2021"><span class="toc-number">26.</span> <span class="toc-text">GKCTF2021</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#QQQQT"><span class="toc-number">26.1.</span> <span class="toc-text">QQQQT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#App-debug"><span class="toc-number">26.2.</span> <span class="toc-text">App-debug</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GWCTF2019"><span class="toc-number">27.</span> <span class="toc-text">GWCTF2019</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#babyvm"><span class="toc-number">27.1.</span> <span class="toc-text">babyvm</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HGAME2022"><span class="toc-number">28.</span> <span class="toc-text">HGAME2022</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#week4-ezvm"><span class="toc-number">28.1.</span> <span class="toc-text">week4 ezvm</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FSCTF2023"><span class="toc-number">29.</span> <span class="toc-text">FSCTF2023</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ezbroke"><span class="toc-number">29.1.</span> <span class="toc-text">ezbroke</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SWPU2019"><span class="toc-number">30.</span> <span class="toc-text">SWPU2019</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#EasiestRe"><span class="toc-number">30.1.</span> <span class="toc-text">EasiestRe</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HGAME2023"><span class="toc-number">31.</span> <span class="toc-text">HGAME2023</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#week4-vm"><span class="toc-number">31.1.</span> <span class="toc-text">week4 vm</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BA%A2%E5%B8%BD%E6%9D%AF2019"><span class="toc-number">32.</span> <span class="toc-text">çº¢å¸½æ¯2019</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#xx"><span class="toc-number">32.1.</span> <span class="toc-text">xx</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#calc"><span class="toc-number">32.2.</span> <span class="toc-text">calc</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CISCN-2022-%E4%B8%9C%E5%8C%97"><span class="toc-number">33.</span> <span class="toc-text">CISCN 2022 ä¸œåŒ—</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#hana"><span class="toc-number">33.1.</span> <span class="toc-text">hana</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912022"><span class="toc-number">34.</span> <span class="toc-text">è¥¿æ¹–è®ºå‰‘2022</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#EasyVT"><span class="toc-number">34.1.</span> <span class="toc-text">EasyVT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#babyRe"><span class="toc-number">34.2.</span> <span class="toc-text">babyRe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DualPersonality"><span class="toc-number">34.3.</span> <span class="toc-text">DualPersonality</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%AA%E7%9F%A5%E6%9D%A5%E6%BA%90"><span class="toc-number">35.</span> <span class="toc-text">æœªçŸ¥æ¥æº</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ctfshow-reverse-%E6%AF%94%E8%B5%9B%E5%8E%9F%E9%A2%98-snake"><span class="toc-number">35.1.</span> <span class="toc-text">ctfshow-reverse-æ¯”èµ›åŸé¢˜-snake</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NSSCTF-2022-Spring-Recruit-easy-Pe"><span class="toc-number">35.2.</span> <span class="toc-text">[NSSCTF 2022 Spring Recruit]easy Pe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ctfshow-%E5%8D%B7%E7%8E%8B%E6%9D%AF-babyoc"><span class="toc-number">35.3.</span> <span class="toc-text">ctfshow-å·ç‹æ¯-babyoc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SUCTF2019-hardCpp"><span class="toc-number">35.4.</span> <span class="toc-text">SUCTF2019 hardCpp</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Reverse-Other
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">N0zoM1z0</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-12-08T09:49:26.000Z" class="dt-published" itemprop="datePublished">2023-12-08</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/CTF-Reverse/">CTF-Reverse</a>
    </div>


      

    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>è®°å½•ä¸€äº›reverseé¢˜ç›®</p>
<span id="more"></span>

<h1 id="moectf2023"><a href="#moectf2023" class="headerlink" title="moectf2023"></a>moectf2023</h1><h2 id="GUI"><a href="#GUI" class="headerlink" title="GUI"></a>GUI</h2><p>IDAæ‰“å¼€è·Ÿè¿› å¾ˆå®¹æ˜“å‘ç°å…³é”®ä»£ç :</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( Msg != <span class="number">273</span> )</span><br><span class="line">        <span class="keyword">return</span> DefWindowProcW(hWndParent, Msg, wParam, lParam);</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int16)wParam == <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        DlgItem = GetDlgItem(hWndParent, <span class="number">2</span>);</span><br><span class="line">        GetWindowTextW(DlgItem, String, <span class="number">1024</span>);</span><br><span class="line">        sub_150C94(String);</span><br><span class="line">        v13 = <span class="number">0</span>;</span><br><span class="line">        sub_150A0A(v7, v8);</span><br><span class="line">        LOBYTE(v13) = <span class="number">1</span>;</span><br><span class="line">        sub_150C94(a91);</span><br><span class="line">        <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)sub_1531AB(v7, v6) )</span><br><span class="line">          MessageBoxW(hWndParent, Text, <span class="string">L&quot;hint&quot;</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          MessageBoxW(hWndParent, <span class="string">L&quot;Sorry, flag error.&quot;</span>, <span class="string">L&quot;hint&quot;</span>, <span class="number">0</span>);</span><br><span class="line">        sub_1529B8(v6);</span><br><span class="line">        LOBYTE(v13) = <span class="number">0</span>;</span><br><span class="line">        sub_1529B8(v7);</span><br><span class="line">        v13 = <span class="number">-1</span>;</span><br><span class="line">        sub_1529B8(v8);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
<p>è·Ÿè¿› sub_150A0A(v7, v8); ä¼šå‘ç°é‡Œé¢è¿›è¡Œäº† (-5)^0x51 æ“ä½œ<br>åé¢è¿›è¡Œäº†strcmpçš„check<br>è¿™é‡Œæ¯”è¾ƒçš„å¦ä¸€ä¸ªæ•°ç»„æå–æœ‰ç‚¹å¥‡æ€ª<br>åŠ¨è°ƒä¼šè¢«åè°ƒè¯•æ‰ setipè·³åˆ°è¿™é‡Œä¹‹å‰å¾—åˆ°çš„å€¼ä¹Ÿä¸å¯¹<br>æ³¨æ„åˆ°checkå‰é¢è¿˜æœ‰å¥: <code>sub_150C94(a91);</code><br>æŸ¥çœ‹a91çš„å€¼çŒœæƒ³å¯èƒ½æ˜¯æ¯”è¾ƒæ•°ç»„ å› ä¸ºè¿™ä¸ª sub_150c94æ²¡æœ‰æ”¹å˜å€¼<br>æ‰€ä»¥æœ€åexp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">0x39</span>, <span class="number">0x00</span>, <span class="number">0x3B</span>, <span class="number">0x00</span>, <span class="number">0x31</span>, <span class="number">0x00</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, <span class="number">0x3E</span>, <span class="number">0x00</span>, <span class="number">0x30</span>, <span class="number">0x00</span>, <span class="number">0x27</span>, <span class="number">0x00</span>, <span class="number">0x13</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x7D</span>, <span class="number">0x00</span>, <span class="number">0x70</span>, <span class="number">0x00</span>, <span class="number">0x70</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x7D</span>, <span class="number">0x00</span>, <span class="number">0x38</span>, <span class="number">0x00</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x7A</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x00</span>, <span class="number">0x7C</span>, <span class="number">0x00</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>, <span class="number">0x1A</span>, <span class="number">0x00</span>, <span class="number">0x3C</span>, <span class="number">0x00</span>, <span class="number">0x7D</span>, <span class="number">0x00</span>, <span class="number">0x39</span>, <span class="number">0x00</span>, <span class="number">0x7F</span>, <span class="number">0x00</span>, <span class="number">0x3C</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x29</span>]</span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> enc:</span><br><span class="line">    <span class="keyword">if</span>(x!=<span class="number">0</span>):</span><br><span class="line">        c.append(x)</span><br><span class="line">enc = c</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> enc:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>((x^<span class="number">0x51</span>)+<span class="number">5</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># moectf&#123;GU1&amp;&amp;W1nd0w2_Pr1m3r!!!&#125;</span></span><br></pre></td></tr></table></figure>
<p>çœ‹WPè¯´å¯ä»¥ç›´æ¥è¾“å…¥æ‰€ä»¥å¯èƒ½å­—ç¬¦å¾—åˆ°åŠ å¯†å€¼æ¥æ¯”è¾ƒå¾—åˆ°(å› ä¸ºæ˜¯å•å­—èŠ‚åŠ å¯†) ä½†æ˜¯æˆ‘åŠ¨è°ƒæˆªä¸åˆ°å¯¹åº”å€¼â€¦ ä»¥åå†æ¥çœ‹å§</p>
<h2 id="unwind"><a href="#unwind" class="headerlink" title="unwind"></a>unwind</h2><p>main</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [esp+0h] [ebp-100h]</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_ECC063);</span><br><span class="line">  sub_EC13E3();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Welcome to moectf2023!!! Now you find YunZh1Jun&#x27;s revenge!!!&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Do you know TEA(an encryption algorithm)? Do you know unwind in SEH? &quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;I believe you can understand them! So let me check your flag~&quot;</span>);</span><br><span class="line">  sub_EC10CD(<span class="string">&quot;Input:&quot;</span>, v4);</span><br><span class="line">  sub_EC13CA(<span class="string">&quot;%64s&quot;</span>, (<span class="type">char</span>)&amp;byte_ECA578);</span><br><span class="line">  MEMORY[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  sub_EC10FF();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Right flag! Have fun in moectf2023~&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¤§å¤§çš„çº¢è‰² MEMORYæ¥è§¦å‘å†…å­˜è®¿é—®å¼‚å¸¸<br>æ ¹æ®å¼‚å¸¸å¤„ç†å¯ä»¥æ‰¾åˆ°ä¼šè·³è½¬åˆ°è¿™é‡Œ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">loc_EC5928:</span><br><span class="line">;   __except(loc_EC5922) <span class="comment">// owned by EC5908</span></span><br><span class="line">mov     esp, [ebp+ms_exc.old_esp]</span><br><span class="line">push    offset aDx3906  ; <span class="string">&quot;DX3906&quot;</span></span><br><span class="line">push    offset byte_ECA578 ; <span class="type">unsigned</span> <span class="type">int</span> *</span><br><span class="line">call    j_XXTEA</span><br><span class="line">add     esp, <span class="number">8</span></span><br><span class="line">push    offset aDoctor3 ; <span class="string">&quot;doctor3&quot;</span></span><br><span class="line">push    offset dword_ECA580 ; <span class="type">unsigned</span> <span class="type">int</span> *</span><br><span class="line">call    j_XXTEA</span><br><span class="line">add     esp, <span class="number">8</span></span><br><span class="line">push    offset aFux1aoyun ; <span class="string">&quot;FUX1AOYUN&quot;</span></span><br><span class="line">push    offset dword_ECA588 ; <span class="type">unsigned</span> <span class="type">int</span> *</span><br><span class="line">call    j_XXTEA</span><br><span class="line">add     esp, <span class="number">8</span></span><br><span class="line">push    offset aR3verier ; <span class="string">&quot;R3verier&quot;</span></span><br><span class="line">push    offset dword_ECA590 ; <span class="type">unsigned</span> <span class="type">int</span> *</span><br><span class="line">call    j_XXTEA</span><br><span class="line">add     esp, <span class="number">8</span></span><br><span class="line">mov     [ebp+ms_exc.registration.TryLevel], <span class="number">0F</span>FFFFFFEh</span><br></pre></td></tr></table></figure>

<p>ä»£ç é‚£å„¿æ ‡æ³¨é”™äº†(åº”è¯¥åªæ˜¯tea&#x2F;xtea)<br>æ€»ä¹‹ä¼šå…ˆç»è¿‡ç¬¬ä¸€éçš„å››æ¬¡teaåŠ å¯†</p>
<p>åŠ¨è°ƒä¼šå‘ç°è¾“å…¥çš„inputä¼šè¢«åˆ†æˆ8ç»„ (æ¯ç»„ä¸¤ä¸ª)<br>æŸ¥çœ‹äº¤å‰å¼•ç”¨ä¼šå‘ç°åé¢è¿˜è°ƒç”¨äº†teaåŠ å¯† åœ¨è¿™é‡Œ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">; <span class="keyword">struct</span> _EXCEPTION_REGISTRATION_RECORD *<span class="title function_">sub_EC1820</span><span class="params">()</span></span><br><span class="line">sub_EC1820 proc near</span><br><span class="line"></span><br><span class="line">var_E4= dword ptr <span class="number">-0E4</span>h</span><br><span class="line">var_10= byte ptr <span class="number">-10</span>h</span><br><span class="line">var_C= dword ptr <span class="number">-0</span>Ch</span><br><span class="line">var_4= dword ptr <span class="number">-4</span></span><br><span class="line"></span><br><span class="line">push    ebp</span><br><span class="line">mov     ebp, esp</span><br><span class="line">sub     esp, <span class="number">0</span>D0h</span><br><span class="line">push    ebx</span><br><span class="line">push    esi</span><br><span class="line">push    edi</span><br><span class="line">lea     edi, [ebp+var_10]</span><br><span class="line">mov     ecx, <span class="number">4</span></span><br><span class="line">mov     eax, <span class="number">0</span>CCCCCCCCh</span><br><span class="line">rep stosd</span><br><span class="line">mov     eax, ___security_cookie</span><br><span class="line">xor     eax, ebp</span><br><span class="line">mov     [ebp+var_4], eax</span><br><span class="line">mov     [ebp+var_C], offset j_ENCRPYT</span><br><span class="line">push    [ebp+var_C]</span><br><span class="line">push    large dword ptr fs:<span class="number">0</span></span><br><span class="line">mov     large fs:<span class="number">0</span>, esp</span><br><span class="line"><span class="type">int</span>     <span class="number">3</span>               ; Trap to Debugger</span><br><span class="line">mov     eax, [esp+<span class="number">0E4</span>h+var_E4]</span><br><span class="line">mov     large fs:<span class="number">0</span>, eax</span><br><span class="line">add     esp, <span class="number">8</span></span><br><span class="line">pop     edi</span><br><span class="line">pop     esi</span><br><span class="line">pop     ebx</span><br><span class="line">mov     ecx, [ebp+var_4]</span><br><span class="line">xor     ecx, ebp        ; StackCookie</span><br><span class="line">call    j_@__security_check_cookie@<span class="number">4</span> ; __security_check_cookie(x)</span><br><span class="line">add     esp, <span class="number">0</span>D0h</span><br><span class="line">cmp     ebp, esp</span><br><span class="line">call    j___RTC_CheckEsp</span><br><span class="line">mov     esp, ebp</span><br><span class="line">pop     ebp</span><br><span class="line">retn</span><br><span class="line">sub_EC1820 endp</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„åˆ°è¿™é‡Œçš„</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mov     eax, ___security_cookie</span><br><span class="line">xor     eax, ebp</span><br><span class="line">mov     [ebp+var_4], eax</span><br><span class="line">mov     [ebp+var_C], offset j_ENCRYPT</span><br><span class="line">push    [ebp+var_C]</span><br><span class="line">push    large dword ptr fs:<span class="number">0</span></span><br><span class="line">mov     large fs:<span class="number">0</span>, esp</span><br></pre></td></tr></table></figure>

<p>æ˜¯åœ¨xorè¿˜åŸscopetableæ£€æŸ¥æ ˆå¸§å®Œæ•´æ€§è¿‡å æ–°çš„ä¸€ä¸ª__tryå—ä¹‹å‰ æ’å…¥äº†ä¸€ä¸ªå¼‚å¸¸é“¾è¡¨èŠ‚ç‚¹(è¿™é‡Œæˆ‘æ”¹åäº†)<br>ç¬¬ä¸€æ¬¡è¢« RtlDispatchException è°ƒç”¨ï¼Œç´§æ¥ç€åœ¨æ ˆå±•å¼€æ—¶åˆè¢«è°ƒç”¨ä¸€æ¬¡ (è¢«åŠ å…¥å¼‚å¸¸é“¾è¡¨çš„å‡½æ•°æ¯æ¬¡å¼‚å¸¸è§¦å‘ä¼šè¢«è°ƒç”¨ä¸¤æ¬¡!!!)<br>æ‰€ä»¥è¯´è¿™ä¸ªENCRYPT(tea)è¢«è°ƒç”¨äº†ä¸¤æ¬¡ ä¹Ÿå°±æ˜¯å4ç»„æ˜¯è¿ç»­teaäº†ä¸¤æ¬¡çš„!!!</p>
<p>è€Œç¬¬ä¸€æ¬¡çš„å››æ¬¡teaåŠ å¯†åªæœ‰ä¸€éæ˜¯å› ä¸ºè¿™æ—¶åªæ˜¯è§¦å‘å¼‚å¸¸è·³åˆ°å¯¹åº”çš„except handleråœ°æ–¹ ç›´æ¥è°ƒç”¨äº†4æ¬¡tea(ä¸æ˜¯ä½œä¸ºå¼‚å¸¸é“¾è¡¨ä¸­çš„handler function)<br>æ‰€ä»¥ä¸ä¼šåœ¨å±•å¼€çš„æ—¶å€™å†éå†ä¸€é<br>åŒæ—¶ä¹Ÿè¦æ³¨æ„åˆ°</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">00</span>EC598F                         loc_EC598F:                             ; DATA XREF: .rdata:stru_EC92E8â†“o</span><br><span class="line">.text:<span class="number">00</span>EC598F                         ;   __except filter <span class="comment">// owned by EC597A</span></span><br><span class="line">.text:<span class="number">00</span>EC598F B8 <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>                          mov     eax, <span class="number">1</span></span><br><span class="line">.text:<span class="number">00</span>EC5994 C3                                      retn</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„è¿”å›å€¼1å°±æ˜¯ EXCEPTION_EXECUTE_HANDLER æ‰€ä»¥ä¼šè¿›è¡Œå…¨å±€å±•å¼€<br>å†å€Ÿæ–‡ç« çš„è¯æ¥é˜é‡Šæ›´æ¸…æ¥šä¸€ç‚¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">æ—¢ç„¶æœ‰äº†å‰é¢çŸ¥è¯†çš„é“ºå«ï¼Œé‚£ä¹ˆè¿™ä¸€æ®µæ±‡ç¼–ä»£ç ç†è§£èµ·æ¥åº”è¯¥æ²¡æœ‰ä»€ä¹ˆéš¾åº¦ï¼š</span><br><span class="line">æ³¨æ„åˆ° .text:0041590F å¤„ä¼šè§¦å‘äº†ä¸€ä¸ªè¯»å†™éæ³•åœ°å€å¼‚å¸¸ï¼Œå¾€ä¸‹ç´§æ¥ç€å°±æ˜¯ __except filterï¼Œå®ƒç›´æ¥è¿”å›äº† 1ï¼Œ</span><br><span class="line">ä¹Ÿå°±æ˜¯ EXCEPTION_EXECUTE_HANDLERï¼Œæ ¹æ®å‰é¢çš„çŸ¥è¯†ï¼Œ</span><br><span class="line">__except_handler4 åœ¨è·å– FilterFunc åä¼šæ ¹æ®è°ƒç”¨ filter å¹¶æ ¹æ® FilterResult å†³å®šä¸‹ä¸€æ­¥çš„æ“ä½œï¼Œ</span><br><span class="line">è¿™é‡Œä¸º 1ï¼Œæ•…ä¼šè¿›è¡Œå…¨å±€å±•å¼€ï¼Œä¹Ÿå°±æ˜¯æ¥ç€è°ƒç”¨ RtlUnwindï¼Œ</span><br><span class="line">RtlUnwind åˆä¼šèµ·ä¸€ä¸ª EH4_EXCEPTION_REGISTRATION-&gt;Handlerï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¿™é‡Œçš„ __except å—</span><br></pre></td></tr></table></figure>


<p>ç„¶åå°†é‚£å››ä¸ªå­—ç¬¦ä¸²åˆ†åˆ«å¯¹åº”4ä¸ªDWORD KEY[] é€†å°±è¡Œäº†</p>
<h1 id="miniLCTF2021"><a href="#miniLCTF2021" class="headerlink" title="miniLCTF2021"></a>miniLCTF2021</h1><h2 id="sub"><a href="#sub" class="headerlink" title="sub"></a>sub</h2><p>å‚è€ƒ:<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_41890599/article/details/102642043"> + </a></p>
<p>è€ƒå¯Ÿç‚¹æ˜¯å‚€å„¡è¿›ç¨‹æ³¨å…¥<br>åœ¨trackå¸ˆå‚…åšå®¢ç…åˆ° å°±åšäº†åš</p>
<p>é¦–å…ˆç”¨CFFæŸ¥çœ‹ å‘ç°æœ‰ä¸€ä¸ªèŠ‚åŒºæ¯”è¾ƒå¥‡æ€ª èŠ‚åŒºåä¸º  .what?<br>IDAæŸ¥çœ‹main<br>å¾ˆç»å…¸çš„è¿›ç¨‹æ³¨å…¥ç»“æ„</p>
<ol>
<li>ä»¥æŒ‚èµ·çš„æ–¹å¼åˆ›å»ºä¸€ä¸ªè¿›ç¨‹</li>
<li>å¸è½½è¯¥è¿›ç¨‹çš„å†…å­˜æ˜ å°„ i.e æ¸…ç©ºè¿›ç¨‹è™šæ‹Ÿå†…å­˜ç©ºé—´ä¸­çš„å†…å®¹</li>
<li>è·å–è¯¥è¿›ç¨‹çš„CONTEXTä¸Šä¸‹æ–‡ç»“æ„</li>
<li>å°†è¦æ³¨å…¥çš„å†…å­˜è¯»å–åˆ°å†…å­˜ä¸­</li>
<li>åœ¨å‚€å„¡è¿›ç¨‹ä¸­ç”³è¯·è¶³å¤Ÿçš„å†…å­˜ç©ºé—´</li>
<li>å°†è¦æ³¨å…¥çš„ç¨‹åºå†™å…¥ç”³è¯·çš„ç©ºé—´</li>
<li>è®¾ç½®CONTEXTä¸Šä¸‹æ–‡çš„eaxä¸ºç¨‹åºå…¥å£ç‚¹ ebx+8ä¸ºç¨‹åºåŸºå€</li>
<li>æ¢å¤çº¿ç¨‹</li>
</ol>
<p>ç†è§£è¿™ä¸€ç‚¹å æ³¨æ„åˆ°<br>sub_401000((int)Block, ElementCount);<br>æ˜¯å¯¹ æ®µè¿›è¡Œxor 0x64 æ“ä½œ<br>å°† .what?æ®µdumpå‡ºæ¥ xoråå¾—åˆ°éšè—PEæ–‡ä»¶<br>IDAé€†å‘<br>ä¸€ä¸ªç®€å•çš„å˜æ¢æ“ä½œ<br>æ­£å¸¸æµç¨‹è§£å‡ºæ¥æ˜¯å‡flag<br>æ³¨æ„åˆ°æœ‰Tls æŸ¥çœ‹å‘ç°æ›¿æ¢äº†å‡½æ•°åœ°å€<br>ç”¨çœŸæ­£çš„åŠ å¯†å‡½æ•°é€†å‘å¾—åˆ°çœŸflag<br><strong>miniLctf{Re_1s_s0_1nt4r4st1ng!!}</strong></p>
<hr>
<hr>
<p>æºç çš„å‡½æ•°æ›¿æ¢å®ç°:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bool</span> (*check)(<span class="type">char</span>* flag, <span class="type">int</span> len) = fake_check;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">fake_check</span><span class="params">(...)</span>...</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">true_check</span><span class="params">(...)</span>...</span></span><br></pre></td></tr></table></figure>

<h1 id="miniLCTF2022"><a href="#miniLCTF2022" class="headerlink" title="miniLCTF2022"></a>miniLCTF2022</h1><h2 id="lemon"><a href="#lemon" class="headerlink" title="lemon"></a>lemon</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line">0: const 25 ; &lt;module &#x27;main&#x27;&gt; </span><br><span class="line">5: module 1 590</span><br><span class="line">11: const 26 ; &lt;module &#x27;src&#x27;&gt; </span><br><span class="line">16: store 0 0</span><br><span class="line">19: const 26 ; &lt;module &#x27;src&#x27;&gt; </span><br><span class="line">24: module 6 590</span><br><span class="line">30: const 27 ; 221492336 </span><br><span class="line">35: store 0 0</span><br><span class="line">38: const 28 ; next </span><br><span class="line">43: define 0 0 0 0 80</span><br><span class="line">52: load 1 0</span><br><span class="line">55: const 29 ; 3735928559 </span><br><span class="line">60: mul</span><br><span class="line">61: const 30 ; 2974593325 </span><br><span class="line">66: add</span><br><span class="line">67: const 31 ; 4294967295 </span><br><span class="line">72: mod</span><br><span class="line">73: store 1 0</span><br><span class="line">76: load 1 0</span><br><span class="line">79: return</span><br><span class="line">80: store 0 1</span><br><span class="line">83: const 32 ; n </span><br><span class="line">88: const 33 ; __init__ </span><br><span class="line">93: define 0 0 1 2 377</span><br><span class="line">102: array 0</span><br><span class="line">107: self</span><br><span class="line">108: const 34 ; enc </span><br><span class="line">113: setattr</span><br><span class="line">114: array 0</span><br><span class="line">119: self</span><br><span class="line">120: const 35 ; flag </span><br><span class="line">125: setattr</span><br><span class="line">126: const 36 ; 330150339 </span><br><span class="line">131: const 37 ; 665229750 </span><br><span class="line">136: const 38 ; 1030425184 </span><br><span class="line">141: const 39 ; 626644061 </span><br><span class="line">146: const 40 ; 861166604 </span><br><span class="line">151: const 41 ; 521761774 </span><br><span class="line">156: const 42 ; 586337393 </span><br><span class="line">161: const 43 ; 167708778 </span><br><span class="line">166: const 44 ; 495518230 </span><br><span class="line">171: const 45 ; 459905620 </span><br><span class="line">176: const 46 ; 47689903 </span><br><span class="line">181: const 47 ; 541128627 </span><br><span class="line">186: const 48 ; 735310319 </span><br><span class="line">191: const 49 ; 924471115 </span><br><span class="line">196: const 50 ; 66957703 </span><br><span class="line">201: const 51 ; 827308967 </span><br><span class="line">206: const 52 ; 4680810 </span><br><span class="line">211: const 53 ; 618187854 </span><br><span class="line">216: const 54 ; 1041878913 </span><br><span class="line">221: const 55 ; 424705310 </span><br><span class="line">226: const 56 ; 258515107 </span><br><span class="line">231: const 57 ; 301365991 </span><br><span class="line">236: const 58 ; 238089888 </span><br><span class="line">241: const 59 ; 126810196 </span><br><span class="line">246: const 60 ; 160092960 </span><br><span class="line">251: const 61 ; 333469062 </span><br><span class="line">256: const 62 ; 524809386 </span><br><span class="line">261: const 63 ; 334234642 </span><br><span class="line">266: const 64 ; 532732060 </span><br><span class="line">271: const 65 ; 701306806 </span><br><span class="line">276: const 66 ; 755999918 </span><br><span class="line">281: const 67 ; 219942343 </span><br><span class="line">286: const 68 ; 37219027 </span><br><span class="line">291: const 69 ; 76267819 </span><br><span class="line">296: const 70 ; 2141786733 </span><br><span class="line">301: array 35</span><br><span class="line">306: self</span><br><span class="line">307: const 71 ; res </span><br><span class="line">312: setattr</span><br><span class="line">313: const 72 ; 0 </span><br><span class="line">318: store 0 1</span><br><span class="line">321: load 0 1</span><br><span class="line">324: load 0 0</span><br><span class="line">327: lt</span><br><span class="line">328: jz 371</span><br><span class="line">333: self</span><br><span class="line">334: const 34 ; enc </span><br><span class="line">339: getattr</span><br><span class="line">340: const 73 ; append </span><br><span class="line">345: getattr</span><br><span class="line">346: load 1 1</span><br><span class="line">349: call 0</span><br><span class="line">351: call 1</span><br><span class="line">353: pop</span><br><span class="line">354: load 0 1</span><br><span class="line">357: const 74 ; 1 </span><br><span class="line">362: add</span><br><span class="line">363: store 0 1</span><br><span class="line">366: jmp 321</span><br><span class="line">371: const 75 ; nil </span><br><span class="line">376: return</span><br><span class="line">377: const 33 ; __init__ </span><br><span class="line">382: const 76 ; x </span><br><span class="line">387: const 77 ; y </span><br><span class="line">392: const 78 ; sign </span><br><span class="line">397: define 0 0 2 3 482</span><br><span class="line">406: const 72 ; 0 </span><br><span class="line">411: store 0 2</span><br><span class="line">414: load 0 2</span><br><span class="line">417: const 79 ; 35 </span><br><span class="line">422: lt</span><br><span class="line">423: jz 476</span><br><span class="line">428: self</span><br><span class="line">429: const 35 ; flag </span><br><span class="line">434: getattr</span><br><span class="line">435: const 73 ; append </span><br><span class="line">440: getattr</span><br><span class="line">441: load 0 0</span><br><span class="line">444: load 0 2</span><br><span class="line">447: getitem</span><br><span class="line">448: load 0 1</span><br><span class="line">451: load 0 2</span><br><span class="line">454: getitem</span><br><span class="line">455: bxor</span><br><span class="line">456: call 1</span><br><span class="line">458: pop</span><br><span class="line">459: load 0 2</span><br><span class="line">462: const 74 ; 1 </span><br><span class="line">467: add</span><br><span class="line">468: store 0 2</span><br><span class="line">471: jmp 414</span><br><span class="line">476: const 75 ; nil </span><br><span class="line">481: return</span><br><span class="line">482: const 78 ; sign </span><br><span class="line">487: const 80 ; RunMe </span><br><span class="line">492: class 4 0</span><br><span class="line">495: store 0 2</span><br><span class="line">498: const 23 ; &lt;function &#x27;print&#x27;&gt; </span><br><span class="line">503: const 81 ; [+] Starting... </span><br><span class="line">508: call 1</span><br><span class="line">510: pop</span><br><span class="line">511: load 0 2</span><br><span class="line">514: const 79 ; 35 </span><br><span class="line">519: call 1</span><br><span class="line">521: store 0 5</span><br><span class="line">524: load 0 5</span><br><span class="line">527: const 78 ; sign </span><br><span class="line">532: getattr</span><br><span class="line">533: load 0 5</span><br><span class="line">536: const 71 ; res </span><br><span class="line">541: getattr</span><br><span class="line">542: load 0 5</span><br><span class="line">545: const 34 ; enc </span><br><span class="line">550: getattr</span><br><span class="line">551: call 2</span><br><span class="line">553: pop</span><br><span class="line">554: const 23 ; &lt;function &#x27;print&#x27;&gt; </span><br><span class="line">559: load 0 5</span><br><span class="line">562: const 35 ; flag </span><br><span class="line">567: getattr</span><br><span class="line">568: call 1</span><br><span class="line">570: pop</span><br><span class="line">571: const 23 ; &lt;function &#x27;print&#x27;&gt; </span><br><span class="line">576: const 82 ; [+] Done! </span><br><span class="line">581: call 1</span><br><span class="line">583: pop</span><br><span class="line">584: const 75 ; nil </span><br><span class="line">589: return</span><br></pre></td></tr></table></figure>

<p>lemonå®˜æ–¹æ–‡æ¡£å…¨æŒ‚äº†ã€‚ã€‚ã€‚<br>ç£•ç£•ç»Šç»Šè¿˜åŸä¸€ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">seed = <span class="number">0xd33b470</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">next</span>():</span><br><span class="line">    <span class="keyword">global</span> seed</span><br><span class="line">    seed = (seed * <span class="number">0xdeadbeef</span> + <span class="number">0xb14cb12d</span>) % <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">return</span> seed</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RunMe</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,n</span>):</span><br><span class="line">        self.enc = []</span><br><span class="line">        self.flag = []</span><br><span class="line">        self.res = [<span class="number">2141786733</span>, <span class="number">76267819</span>, <span class="number">37219027</span>, <span class="number">219942343</span>, <span class="number">755999918</span>, <span class="number">701306806</span>, <span class="number">532732060</span>, <span class="number">334234642</span>, <span class="number">524809386</span>, <span class="number">333469062</span>, <span class="number">160092960</span>, <span class="number">126810196</span>, <span class="number">238089888</span>, <span class="number">301365991</span>, <span class="number">258515107</span>, <span class="number">424705310</span>, <span class="number">1041878913</span>, <span class="number">618187854</span>, <span class="number">4680810</span>, <span class="number">827308967</span>, <span class="number">66957703</span>, <span class="number">924471115</span>, <span class="number">735310319</span>, <span class="number">541128627</span>, <span class="number">47689903</span>, <span class="number">459905620</span>, <span class="number">495518230</span>, <span class="number">167708778</span>, <span class="number">586337393</span>, <span class="number">521761774</span>, <span class="number">861166604</span>, <span class="number">626644061</span>, <span class="number">1030425184</span>, <span class="number">665229750</span>, <span class="number">330150339</span>]</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> (i &lt; n):</span><br><span class="line">            self.enc.append(<span class="built_in">next</span>())</span><br><span class="line">            i = i + <span class="number">1</span></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">self,x,y</span>):</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> (i &lt; <span class="number">35</span>) :</span><br><span class="line">            self.flag.append(x[i] ^ y[i])</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] Starting...&quot;</span>)</span><br><span class="line"></span><br><span class="line">my_run = RunMe(<span class="number">35</span>)</span><br><span class="line">my_run.sign(my_run.enc, my_run.res)</span><br><span class="line"><span class="built_in">print</span>(my_run.flag)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] Done!&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ç”¨pythonè¿è¡Œå¾—ä¸åˆ°ç»“æœâ€¦ è²Œä¼¼æ˜¯å–æ¨¡è¿ç®—ä¸å¤ªä¸€æ ·? æ€»ä¹‹è¦è¿˜åŸæˆlemonåç”¨å®ƒè‡ªå·±çš„ç¼–è¯‘å™¨è¿è¡Œ</p>
<p>å¤§è‡´è®°å½•ä¸€ä¸‹å§</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">const 27 ; 221492336    // LCG</span><br><span class="line">35: store 0 0 </span><br><span class="line">38: const 28 ; next </span><br><span class="line">43: define 0 0 0 0 80</span><br><span class="line">52: load 1 0</span><br><span class="line">55: const 29 ; 3735928559 </span><br><span class="line">60: mul</span><br><span class="line">61: const 30 ; 2974593325 </span><br><span class="line">66: add</span><br><span class="line">67: const 31 ; 4294967295 </span><br><span class="line">72: mod</span><br><span class="line">73: store 1 0  // (a*3735928559+2974593325)%4294967295</span><br><span class="line">76: load 1 0</span><br><span class="line">79: return</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œdefineå°±æ˜¯lemonå®šä¹‰å‡½æ•°çš„æ ¼å¼ å‰é¢çš„constå°±æ˜¯å‡½æ•°å<br>è¿™é‡Œçš„ load 1 0 åŠ è½½çš„æ˜¯å…¨å±€å˜é‡const 27<br>å°±æ˜¯ä¸€ä¸ªLCGçš„è¿‡ç¨‹ åˆå§‹seedä¸º const 27</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">self</span><br><span class="line">120: const 35 ; flag </span><br><span class="line">125: setattr</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">296: const 70 ; 2141786733 </span><br><span class="line">301: array 35</span><br><span class="line">306: self</span><br><span class="line">307: const 71 ; res </span><br><span class="line">312: setattr</span><br><span class="line">313: const 72 ; 0 </span><br><span class="line">318: store 0 1</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ˜¯å°†è¿™ä¸€å¤§å †æ•°å¾ªç¯å­˜å…¥ resé‡Œ<br>è€Œä¸”è¦æ³¨æ„ ç”±äºæ˜¯å‹æ ˆ æ‰€ä»¥è¿™æ•°ç»„æ˜¯å€’åºçš„ ä¹Ÿå°±æ˜¯ [2141786733,â€¦,330150339]!!!</p>
<p>ç„¶åæ˜¯è¿™ä¸€æ®µ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">321: load 0 1</span><br><span class="line">324: load 0 0</span><br><span class="line">327: lt</span><br><span class="line">328: jz 371</span><br><span class="line">333: self</span><br><span class="line">334: const 34 ; enc      // å¾ªç¯å­˜å‚¨åˆ° enc[]</span><br><span class="line">339: getattr</span><br><span class="line">340: const 73 ; append </span><br><span class="line">345: getattr</span><br><span class="line">346: load 1 1</span><br><span class="line">349: call 0</span><br><span class="line">351: call 1     </span><br><span class="line">353: pop</span><br><span class="line">354: load 0 1</span><br><span class="line">357: const 74 ; 1 </span><br><span class="line">362: add</span><br><span class="line">363: store 0 1   // +=1</span><br><span class="line">366: jmp 321</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„call 0  call 1   æ˜¯ append å’Œ next<br>æ‰€ä»¥æ˜¯ enc.append(next()) ä¹Ÿå°±æ˜¯æŠŠLCGæ¯æ¬¡å˜æ¢çš„seedå­˜å…¥encæ•°ç»„</p>
<p>ç„¶åæ˜¯è¿™æ®µ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">377: const 33 ; __init__ </span><br><span class="line">382: const 76 ; x </span><br><span class="line">387: const 77 ; y </span><br><span class="line">392: const 78 ; sign </span><br><span class="line">397: define 0 0 2 3 482</span><br><span class="line">406: const 72 ; 0 </span><br><span class="line">411: store 0 2</span><br><span class="line">414: load 0   // loop 414-471</span><br><span class="line">417: const 79 ; 35 </span><br><span class="line">422: lt</span><br><span class="line">423: jz          // for 0~35</span><br><span class="line">428: self</span><br><span class="line">429: const 35 ; flag </span><br><span class="line">434: getattr</span><br><span class="line">435: const 73 ; append         // flag.append()</span><br><span class="line">440: getattr</span><br><span class="line">441: load 0 0</span><br><span class="line">444: load 0 2</span><br><span class="line">447: getitem</span><br><span class="line">448: load 0 1</span><br><span class="line">451: load 0 2</span><br><span class="line">454: getitem</span><br><span class="line">455: bxor      // xor!</span><br><span class="line">456: call 1</span><br><span class="line">458: pop</span><br><span class="line">459: load 0 2</span><br><span class="line">462: const 74 ; 1 </span><br><span class="line">467: add</span><br><span class="line">468: store 0 2</span><br><span class="line">471: jmp 414</span><br><span class="line">476: const 75 ; nil </span><br><span class="line">481: return</span><br></pre></td></tr></table></figure>

<p>å®šä¹‰äº†ä¸€ä¸ªsignå‡½æ•°<br>ä»¥åŠx y<br>é€ä½xoråå­˜å…¥flagæ•°ç»„</p>
<p>æœ€åå°±æ˜¯åˆ›å»ºä¸€ä¸ªRunMe CLASS<br>è°ƒç”¨å…¶ä¸­çš„å‡½æ•°æ‰“å°flag<br>å¤§è‡´æµç¨‹å°±è¿™æ ·å§ è¿™é¬¼lemonå®˜æ–¹æ–‡æ¡£æŒ‚äº†ç¡®å®éš¾æâ€¦</p>
<h2 id="NOTRC4"><a href="#NOTRC4" class="headerlink" title="NOTRC4"></a>NOTRC4</h2><p>å¥½é¢˜æ¬¸<br>RISC-VæŒ‡ä»¤é›†<br>ç¥å¥‡çš„Ghidraå¯ä»¥åç¼–è¯‘â€¦<br>ç¬¬ä¸€æ¬¡ä½¿ç”¨ é¦–å…ˆè¦newä¸€ä¸ªproject ç„¶åImportFileå°±å¯ä»¥åˆ†æäº†<br>åœ¨IDAä¸­ä¹Ÿèƒ½çœ‹å‡ºæ¥è¿™æ˜¯ä¸€ä¸ªopcodeçš„é¢˜<br>æŸ¥çœ‹å‡½æ•°(å…¶ä¸­æœ‰è‡ªå·±å†™çš„æ³¨é‡Š)<br>main</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/* WARNING: Globals starting with &#x27;_&#x27; overlap smaller symbols at the same address */</span></span><br><span class="line"></span><br><span class="line"><span class="function">undefined8 <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  undefined8 uVar1;</span><br><span class="line">  undefined8 OPCODE;</span><br><span class="line">  undefined8 local_78;</span><br><span class="line">  undefined8 local_70;</span><br><span class="line">  undefined8 local_68;</span><br><span class="line">  undefined8 local_60;</span><br><span class="line">  undefined8 local_58;</span><br><span class="line">  undefined8 local_50;</span><br><span class="line">  undefined8 local_48;</span><br><span class="line">  undefined8 local_40;</span><br><span class="line">  undefined8 local_38;</span><br><span class="line">  undefined8 local_30;</span><br><span class="line">  undefined8 local_28;</span><br><span class="line">  undefined8 local_20;</span><br><span class="line">  <span class="type">long</span> local_18;</span><br><span class="line">  </span><br><span class="line">  local_18 = ___stack_chk_guard;</span><br><span class="line">  OPCODE = <span class="number">0</span>;</span><br><span class="line">  local_78 = <span class="number">0</span>;</span><br><span class="line">  local_70 = <span class="number">0</span>;</span><br><span class="line">  local_68 = <span class="number">0</span>;</span><br><span class="line">  local_60 = <span class="number">0</span>;</span><br><span class="line">  local_58 = <span class="number">0</span>;</span><br><span class="line">  local_50 = <span class="number">0</span>;</span><br><span class="line">  local_48 = <span class="number">0</span>;</span><br><span class="line">  local_40 = <span class="number">0</span>;</span><br><span class="line">  local_38 = <span class="number">0</span>;</span><br><span class="line">  local_30 = <span class="number">0</span>;</span><br><span class="line">  local_28 = <span class="number">0</span>;</span><br><span class="line">  local_20 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">FUN_00100740</span>(<span class="string">&quot;Input your flag&quot;</span>,<span class="number">0</span>);</span><br><span class="line">  <span class="built_in">FUN_00100720</span>(&amp;DAT_00100d78,&amp;INPUT_VALUE);</span><br><span class="line">  <span class="built_in">SET_OPCODE_AND_FUNCTIONS</span>((undefined4 *)&amp;OPCODE);</span><br><span class="line">  <span class="built_in">EXECUTE_UNDER_OPCODE</span>((<span class="type">int</span> *)&amp;OPCODE);</span><br><span class="line">  <span class="built_in">FUN_00100760</span>(<span class="string">&quot;Right!&quot;</span>);</span><br><span class="line">  uVar1 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> (___stack_chk_guard != local_18) &#123;</span><br><span class="line">    <span class="built_in">FUN_00100730</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> uVar1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è®¾ç½®opcodeä»¥åŠå¯¹åº”å‡½æ•°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">SET_OPCODE_AND_FUNCTIONS</span><span class="params">(undefined4 *param_1)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  *param_1 = <span class="number">0</span>;</span><br><span class="line">  *(undefined *)(param_1 + <span class="number">6</span>) = <span class="number">0xf1</span>;</span><br><span class="line">  *(code **)(param_1 + <span class="number">8</span>) = F1_CHECK_FLAG;</span><br><span class="line">  *(undefined *)(param_1 + <span class="number">10</span>) = <span class="number">0xf2</span>;</span><br><span class="line">  *(code **)(param_1 + <span class="number">0xc</span>) = F2_FUN_00100bfe;</span><br><span class="line">  *(undefined *)(param_1 + <span class="number">0xe</span>) = <span class="number">0xf3</span>;</span><br><span class="line">  *(code **)(param_1 + <span class="number">0x10</span>) = F3_FUN_00100974;</span><br><span class="line">  *(undefined *)(param_1 + <span class="number">0x12</span>) = <span class="number">0xf4</span>;</span><br><span class="line">  *(code **)(param_1 + <span class="number">0x14</span>) = F4_FUN_00100a10;</span><br><span class="line">  *(undefined *)(param_1 + <span class="number">0x16</span>) = <span class="number">0xf5</span>;</span><br><span class="line">  *(code **)(param_1 + <span class="number">0x18</span>) = F5_SAVE_CHANGED_VALUE;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">EXECUTE_UNDER_OPCODE</span><span class="params">(<span class="type">int</span> *param_1)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span> ((&amp;DAT_00102018)[*param_1] != <span class="number">-1</span>) &#123;</span><br><span class="line">    <span class="built_in">EXECUTE</span>(param_1);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„-1å°±æ˜¯0xff ç»“æŸæ¡ä»¶<br>å…ˆå¯¼å‡ºopcode<br>è¿™ä¸ªå¯ä»¥é€šè¿‡åé¢å‡½æ•°ç¡®å®šæ˜¯ DAT_00102018 å¤„çš„æ•°æ®<br>å¯¼å‡º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f3 00 f4 e1 f4 e2 f2 04 0b f5 f3 02 f4 e1 f4 e2 f2 04 0b f5 f1 ff</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°å…¶å®æ˜¯ä¸¤ç»„é‡å¤</p>
<p>F3å‡½æ•°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/* WARNING: Unknown calling convention -- yet parameter storage is locked */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">F3_FUN_00100974</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> *in_a0;</span><br><span class="line">  </span><br><span class="line">                    <span class="comment">/* 21 74 62 64  dbt! */</span></span><br><span class="line">  *(<span class="type">long</span> *)(in_a0 + <span class="number">2</span>) =</span><br><span class="line">       *(<span class="type">long</span> *)(&amp;INPUT_VALUE + (<span class="type">long</span>)(<span class="type">int</span>)(uint)(byte)(&amp;DAT_00102018)[*in_a0 + <span class="number">1</span>] * <span class="number">8</span>) +</span><br><span class="line">       DAT_00102008;</span><br><span class="line">                    <span class="comment">/* 73 64 79 79  yyds */</span></span><br><span class="line">  *(<span class="type">long</span> *)(in_a0 + <span class="number">4</span>) =</span><br><span class="line">       *(<span class="type">long</span> *)(&amp;INPUT_VALUE + (<span class="type">long</span>)(<span class="type">int</span>)((byte)(&amp;DAT_00102018)[*in_a0 + <span class="number">1</span>] + <span class="number">1</span>) * <span class="number">8</span>) +</span><br><span class="line">       DAT_00102010;</span><br><span class="line">  *in_a0 = *in_a0 + <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°†å†…å­˜ä¸­æ•°æ®æ³¨é‡Šå‡ºæ¥ è¿™é‡Œç»“åˆmainä¸­çš„è¾“å…¥çŸ¥é“æ˜¯å°†è¾“å…¥åˆ†åˆ«åŠ ä¸Šäº†åå…­è¿›åˆ¶å€¼ 0x64627421 0x79796473</p>
<p>F4å‡½æ•°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/* WARNING: Unknown calling convention -- yet parameter storage is locked */</span></span><br><span class="line"><span class="comment">/* 0xe1 0xe2åˆ†åˆ«å¯¹åº”æ¯æ¬¡åŠ å¯†çš„ä¸¤è½® */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">F4_FUN_00100a10</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> *in_a0;</span><br><span class="line">  </span><br><span class="line">                    <span class="comment">/* 0xe1 */</span></span><br><span class="line">  <span class="keyword">if</span> ((&amp;DAT_00102018)[*in_a0 + <span class="number">1</span>] == <span class="number">-0x1f</span>) &#123;</span><br><span class="line">    *(ulong *)(in_a0 + <span class="number">2</span>) =</span><br><span class="line">         DAT_00102008 +</span><br><span class="line">         ((*(ulong *)(in_a0 + <span class="number">4</span>) ^ *(ulong *)(in_a0 + <span class="number">2</span>)) &gt;&gt;</span><br><span class="line">          ((<span class="type">long</span>)-(<span class="type">int</span>)*(undefined8 *)(in_a0 + <span class="number">4</span>) &amp; <span class="number">0x3f</span>U) |</span><br><span class="line">         (*(ulong *)(in_a0 + <span class="number">4</span>) ^ *(ulong *)(in_a0 + <span class="number">2</span>)) &lt;&lt;</span><br><span class="line">         ((<span class="type">long</span>)(<span class="type">int</span>)*(undefined8 *)(in_a0 + <span class="number">4</span>) &amp; <span class="number">0x3f</span>U));</span><br><span class="line">  &#125;</span><br><span class="line">                    <span class="comment">/* 0xe2 */</span></span><br><span class="line">  <span class="keyword">if</span> ((&amp;DAT_00102018)[*in_a0 + <span class="number">1</span>] == <span class="number">-0x1e</span>) &#123;</span><br><span class="line">    *(ulong *)(in_a0 + <span class="number">4</span>) =</span><br><span class="line">         DAT_00102010 +</span><br><span class="line">         ((*(ulong *)(in_a0 + <span class="number">4</span>) ^ *(ulong *)(in_a0 + <span class="number">2</span>)) &gt;&gt;</span><br><span class="line">          ((<span class="type">long</span>)-(<span class="type">int</span>)*(undefined8 *)(in_a0 + <span class="number">2</span>) &amp; <span class="number">0x3f</span>U) |</span><br><span class="line">         (*(ulong *)(in_a0 + <span class="number">4</span>) ^ *(ulong *)(in_a0 + <span class="number">2</span>)) &lt;&lt;</span><br><span class="line">         ((<span class="type">long</span>)(<span class="type">int</span>)*(undefined8 *)(in_a0 + <span class="number">2</span>) &amp; <span class="number">0x3f</span>U));</span><br><span class="line">  &#125;</span><br><span class="line">  *in_a0 = *in_a0 + <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åˆšå¥½å¯¹åº”opcodeé‡Œçš„ä¸¤ä¸ªF4 åˆ†åˆ«æ˜¯ä¸¤ç»„ç›¸ä¼¼çš„åŠ å¯† ç»“åˆä¸Šä¸€ä¸ªå‡½æ•°çŸ¥é“è¿™é‡Œçš„ <code>*int_a0+2 *int_a0+4</code> å°±æ˜¯ä¸¤ä¸ªinput<br>ç„¶ååˆ°F2å‡½æ•°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/* WARNING: Unknown calling convention -- yet parameter storage is locked */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">F2_FUN_00100bfe</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> *in_a0;</span><br><span class="line">  </span><br><span class="line">                    <span class="comment">/* if xxx&lt;0b */</span></span><br><span class="line">  <span class="keyword">if</span> (DAT_00102108 &lt; (<span class="type">int</span>)(uint)(byte)(&amp;DAT_00102018)[*in_a0 + <span class="number">2</span>]) &#123;</span><br><span class="line">                    <span class="comment">/* opcode-4 --&gt; å›åˆ°å‰é¢ä¸¤ä¸ªf4å¼€å¤´çš„åœ°æ–¹</span></span><br><span class="line"><span class="comment">                       ä¹Ÿå°±æ˜¯è¯´ä¸¤æ¬¡f4é‡å¤äº†12éï¼ï¼ï¼ */</span></span><br><span class="line">    *in_a0 = *in_a0 - (uint)(byte)(&amp;DAT_00102018)[*in_a0 + <span class="number">1</span>];</span><br><span class="line">    DAT_00102108 = DAT_00102108 + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    DAT_00102108 = <span class="number">0</span>;</span><br><span class="line">    *in_a0 = *in_a0 + <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡ŒæŒºå·§å¦™çš„  ç»“åˆopcodeçš„æ•°æ® f2 04 0b<br>çŸ¥é“è¿™é‡Œå…¶å®æ˜¯ä¸€ä¸ª 0bæ¬¡çš„å¾ªç¯ è‹¥&lt;0båˆ™PC-4 ä¹Ÿå°±æ˜¯å›åˆ°å‰é¢ä¸¤ä¸ªF4å¼€å§‹çš„åœ°æ–¹<br>æ‰€ä»¥å‰é¢çš„ä¸¤æ¬¡F4é‡å¤äº†12æ¬¡</p>
<p>åé¢çš„å’Œç¬¬ä¸€è½®ç›¸ä¼¼ åªæ˜¯F3å–æ•°æ®ä»02å¼€å§‹å–å¾— ä¹Ÿå°±æ˜¯inputçš„åä¸¤ä¸ª</p>
<p>æœ€åF1å‡½æ•° checkå‡½æ•°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/* WARNING: Unknown calling convention -- yet parameter storage is locked */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">F1_CHECK_FLAG</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> *in_a0;</span><br><span class="line">  <span class="type">int</span> local_14;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span> (local_14 = <span class="number">0</span>; local_14 &lt; <span class="number">4</span>; local_14 = local_14 + <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (*(<span class="type">long</span> *)(&amp;DAT_001020c8 + (<span class="type">long</span>)local_14 * <span class="number">8</span>) !=</span><br><span class="line">        *(<span class="type">long</span> *)(&amp;DAT_00102030 + (<span class="type">long</span>)local_14 * <span class="number">8</span>)) &#123;</span><br><span class="line">      <span class="built_in">FUN_00100760</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">      <span class="built_in">FUN_00100750</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  *in_a0 = *in_a0 + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å°† 0x001020c8ä¸0x00102030çš„å€¼æ¯”è¾ƒ<br>åœ¨Ghidraä¸­è½¬åˆ°bytesæŸ¥çœ‹ c8å¤„æ˜¯?è¯´æ˜æ˜¯æˆ‘ä»¬è¾“å…¥çš„æ•°æ® å¯¼å‡º30å¤„çš„å€¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ca 82 ef 95 bb 1d c2 4b be 47 b5 71 ae ec 7b f5 </span><br><span class="line">cd f6 e7 15 ab bd a1 80 85 63 77 e1 d7 93 c7 a3</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„å®ƒçš„æ¯”è¾ƒæ–¹å¼ long å’Œ +8 è¯´æ˜è¿™æ˜¯å››ä¸ªæ•°æ®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0x4bc21dbb95ef82ca 0xf57becae71b547be</span><br><span class="line">0x80a1bdab15e7f6cd 0xa3c793d7e1776385</span><br></pre></td></tr></table></figure>

<p>å¯¹åº”è¿˜åŸåŠ å¯†ä»£ç :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    <span class="comment"># f3</span></span><br><span class="line">    <span class="built_in">input</span>[i*<span class="number">2</span>] += <span class="number">0x64627421</span></span><br><span class="line">    <span class="built_in">input</span>[i*<span class="number">2</span>+<span class="number">1</span>] += <span class="number">0x79796473</span></span><br><span class="line">    v1 = <span class="built_in">input</span>[i*<span class="number">2</span>]</span><br><span class="line">    v2 = <span class="built_in">input</span>[i*<span class="number">2</span>+<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>): <span class="comment"># f4</span></span><br><span class="line">        <span class="comment"># 0xe1</span></span><br><span class="line">        v1 = <span class="number">0x64627421</span>+(((v2^v1)&gt;&gt;((-v2)&amp;<span class="number">0x3f</span>))|((v2^v1)&lt;&lt;(v2&amp;<span class="number">0x3f</span>)))</span><br><span class="line">        v1 &amp;= <span class="number">0xffffffffffffffff</span> <span class="comment"># ulong</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 0xe2</span></span><br><span class="line">        v2 = <span class="number">0x79796473</span>+(((v2^v1)&gt;&gt;((-v1)&amp;<span class="number">0x3f</span>))|((v2^v1)&lt;&lt;(v1&amp;<span class="number">0x3f</span>)))</span><br><span class="line">        v1 &amp;= <span class="number">0xffffffffffffffff</span> <span class="comment"># ulong</span></span><br></pre></td></tr></table></figure>

<p>è¿™ç§åŠ å¯†è²Œä¼¼ä¹Ÿæ˜¯ä¸€ç§feistelç»“æ„å§ æ‰€ä»¥åŠ è§£å¯†å¯¹ç§°çš„ åŸæ¥çš„å·¦ç§»æ”¹ä¸ºå³ç§» è°ƒæ¢è¯­å¥å—é¡ºåºå°±èƒ½é€†å›æ¥v1^v2çš„å€¼</p>
<p>è§£å¯†ä»£ç :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">opcode:</span></span><br><span class="line"><span class="string">f3 00 f4 e1 f4 e2 f2 04 0b f5 f3 02 f4 e1 f4 e2 f2 04 0b f5 f1 ff</span></span><br><span class="line"><span class="string">checkå€¼:</span></span><br><span class="line"><span class="string">ca 82 ef 95 bb 1d c2 4b be 47 b5 71 ae ec 7b f5 cd f6 e7 15 ab bd a1 80 85 63 77 e1 d7 93 c7 a3</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="built_in">input</span> = [</span><br><span class="line">    <span class="number">0x4BC21DBB95EF82CA</span>,</span><br><span class="line">    <span class="number">0xF57BECAE71B547BE</span>,</span><br><span class="line">    <span class="number">0x80A1BDAB15E7F6CD</span>,</span><br><span class="line">    <span class="number">0xA3C793D7E1776385</span></span><br><span class="line">]</span><br><span class="line"><span class="comment"># åŠ å¯†</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">v1,v2</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        <span class="comment"># f3</span></span><br><span class="line">        v1 = <span class="built_in">input</span>[i*<span class="number">2</span>]</span><br><span class="line">        v2 = <span class="built_in">input</span>[i*<span class="number">2</span>+<span class="number">1</span>]</span><br><span class="line">        v1 += <span class="number">0x64627421</span></span><br><span class="line">        v2 += <span class="number">0x79796473</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>): <span class="comment"># f4</span></span><br><span class="line">            <span class="comment"># 0xe1</span></span><br><span class="line">            v1 = <span class="number">0x64627421</span>+(((v2^v1)&gt;&gt;((-v2)&amp;<span class="number">0x3f</span>))|((v2^v1)&lt;&lt;(v2&amp;<span class="number">0x3f</span>)))</span><br><span class="line">            v1 &amp;= <span class="number">0xffffffffffffffff</span> <span class="comment"># ulong</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 0xe2</span></span><br><span class="line">            v2 = <span class="number">0x79796473</span>+(((v2^v1)&gt;&gt;((-v1)&amp;<span class="number">0x3f</span>))|((v2^v1)&lt;&lt;(v1&amp;<span class="number">0x3f</span>)))</span><br><span class="line">            v1 &amp;= <span class="number">0xffffffffffffffff</span> <span class="comment"># ulong</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v1,v2</span>):</span><br><span class="line">    v2 -= <span class="number">0x79796473</span></span><br><span class="line">    v = (v2&lt;&lt;((-v1)&amp;<span class="number">0x3f</span>))|(v2&gt;&gt;(v1&amp;<span class="number">0x3f</span>))</span><br><span class="line">    v &amp;= <span class="number">0xffffffffffffffff</span></span><br><span class="line">    v2 = v^v1</span><br><span class="line">    v2 &amp;= <span class="number">0xffffffffffffffff</span></span><br><span class="line">    v1 -= <span class="number">0x64627421</span></span><br><span class="line">    v = (v1&lt;&lt;((-v2)&amp;<span class="number">0x3f</span>))|(v1&gt;&gt;(v2&amp;<span class="number">0x3f</span>))</span><br><span class="line">    v &amp;= <span class="number">0xffffffffffffffff</span></span><br><span class="line">    v1 = v^v2</span><br><span class="line">    v1 &amp;= <span class="number">0xffffffffffffffff</span></span><br><span class="line">    <span class="keyword">return</span> v1,v2</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    v1 = <span class="built_in">input</span>[i*<span class="number">2</span>]</span><br><span class="line">    v2 = <span class="built_in">input</span>[i*<span class="number">2</span>+<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        v1,v2 = decrypt(v1,v2)</span><br><span class="line">    v1 -= <span class="number">0x64627421</span></span><br><span class="line">    v2 -= <span class="number">0x79796473</span></span><br><span class="line">    <span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(v1)[::-<span class="number">1</span>]+long_to_bytes(v2)[::-<span class="number">1</span>])</span><br><span class="line"><span class="comment"># I_hate_U_r1sc-V!</span></span><br></pre></td></tr></table></figure>

<h1 id="NCTF2022"><a href="#NCTF2022" class="headerlink" title="NCTF2022"></a>NCTF2022</h1><h2 id="ez-rev"><a href="#ez-rev" class="headerlink" title="ez_rev"></a>ez_rev</h2><p>å¹³æ—¶å¾—å¤šå†™è„šæœ¬ è¿˜æœ‰ç«¯åºé—®é¢˜å•Šï¼ï¼ï¼ å†™ä¸ªä»£ç å†™äº†å¥½ä¹… éš¾ç»·â€¦<br>è¿›IDA<br>main</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int8 *v4; <span class="comment">// rbx</span></span><br><span class="line">  __int128 *v5; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *v6; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v7; <span class="comment">// rdx</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Input:&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, &amp;dword_55EC99F560A0);</span><br><span class="line">  <span class="keyword">if</span> ( dword_55EC99F560A0 == <span class="string">&#x27;FTCN&#x27;</span> &amp;&amp; byte_55EC99F560A4 == <span class="string">&#x27;&#123;&#x27;</span> &amp;&amp; byte_55EC99F560C9 == <span class="string">&#x27;&#125;&#x27;</span> &amp;&amp; !byte_55EC99F560CA )</span><br><span class="line">  &#123;                                             <span class="comment">// len=42</span></span><br><span class="line">    v4 = (<span class="type">unsigned</span> __int8 *)&amp;unk_55EC99F560A5;  <span class="comment">// input å»å¤´</span></span><br><span class="line">    v5 = &amp;xmmword_55EC99F560E0;                 <span class="comment">// åˆå§‹ä¸º0</span></span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v6 = v4;</span><br><span class="line">      v4 += <span class="number">4</span>;</span><br><span class="line">      <span class="built_in">sub_55EC99F53290</span>(v6, &amp;asc_55EC99F56060, v5);<span class="comment">// v6 ~ v5  å››ä¸ªå­—ç¬¦ä¸€æ¬¡å˜æ¢ æ¯æ¬¡å˜æ¢ä¼šæ”¹å˜v5çš„å€¼ ç„¶ååé¢checkçš„xmmwordå°±æ˜¯v5å€¼çš„æ‹¼æ¥</span></span><br><span class="line">      v5 = (__int128 *)(v7 + <span class="number">4</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v4 != (<span class="type">unsigned</span> __int8 *)((<span class="type">char</span> *)&amp;unk_55EC99F560A5 + <span class="number">36</span>) );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( xmmword_55EC99F560E0 == xmmword_55EC99F56020</span><br><span class="line">    &amp;&amp; xmmword_55EC99F560F0 == xmmword_55EC99F56030</span><br><span class="line">    &amp;&amp; dword_55EC99F56040 == dword_55EC99F56100 )</span><br><span class="line">  &#123;</span><br><span class="line">    __printf_chk(<span class="number">1LL</span>, <span class="string">&quot;Right!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŠ å¯†å‡½æ•°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_55EC99F53290</span><span class="params">(<span class="type">unsigned</span> __int8 *a1, <span class="type">char</span> *a2, _BYTE *a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// ebx</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v4; <span class="comment">// r8</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// r10</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// r11d</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v7; <span class="comment">// al</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// ebp</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v9; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">char</span> v10; <span class="comment">// cl</span></span><br><span class="line">  <span class="type">char</span> v11; <span class="comment">// si</span></span><br><span class="line">  <span class="type">char</span> v12; <span class="comment">// di</span></span><br><span class="line">  <span class="type">char</span> v13; <span class="comment">// al</span></span><br><span class="line">  <span class="type">char</span> v14; <span class="comment">// si</span></span><br><span class="line">  <span class="type">char</span> v15; <span class="comment">// r8</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  v3 = (<span class="type">unsigned</span> __int8)a2[<span class="number">3</span>];                  <span class="comment">// v3=0x75</span></span><br><span class="line">  v4 = a1[<span class="number">3</span>];</span><br><span class="line">  v5 = *a2;                                     <span class="comment">// v5=0x7E</span></span><br><span class="line">  v6 = *a1;</span><br><span class="line">  v7 = a1[<span class="number">1</span>];</span><br><span class="line">  v8 = (<span class="type">unsigned</span> __int8)a2[<span class="number">1</span>];                  <span class="comment">// v8=0x1F</span></span><br><span class="line">  v9 = a1[<span class="number">2</span>];</span><br><span class="line">  v10 = (v6 + v4) * (*a2 + v3);                 <span class="comment">// a2[0]=0x7E</span></span><br><span class="line">  v11 = a2[<span class="number">2</span>];</span><br><span class="line">  v12 = v3 * (v6 + v7);</span><br><span class="line">  v13 = (v3 + v11) * (v7 - v4);</span><br><span class="line">  v14 = v4 * (v11 - v5);</span><br><span class="line">  v15 = v5 * (v9 + v4);</span><br><span class="line">  *a3 = v14 + v10 + v13 - v12;</span><br><span class="line">  a3[<span class="number">2</span>] = v15 + v14;</span><br><span class="line">  result = (<span class="type">unsigned</span> <span class="type">int</span>)(v6 * (v8 - v3));</span><br><span class="line">  a3[<span class="number">1</span>] = v6 * (v8 - v3) + v12;</span><br><span class="line">  a3[<span class="number">3</span>] = v6 * (v8 - v3) + (v8 + v5) * (v9 - v6) + v10 - v15;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŠ¨è°ƒå‘ç°é€»è¾‘å°±æ˜¯å–å››ä¸ªå­—ç¬¦ä¸€ç»„è¿›è¡ŒåŠ å¯†å¤„ç† ç›´æ¥æšä¸¾çˆ†ç ´</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">enc</span><span class="params">(<span class="type">unsigned</span> __int8 *a1,<span class="type">unsigned</span> <span class="type">char</span> *a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// ebx</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v4; <span class="comment">// r8</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// r10</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// r11d</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v7; <span class="comment">// al</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// ebp</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v9; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">char</span> v10; <span class="comment">// cl</span></span><br><span class="line">  <span class="type">char</span> v11; <span class="comment">// si</span></span><br><span class="line">  <span class="type">char</span> v12; <span class="comment">// di</span></span><br><span class="line">  <span class="type">char</span> v13; <span class="comment">// al</span></span><br><span class="line">  <span class="type">char</span> v14; <span class="comment">// si</span></span><br><span class="line">  <span class="type">char</span> v15; <span class="comment">// r8</span></span><br><span class="line"></span><br><span class="line">	v3=<span class="number">0x75</span>;</span><br><span class="line">  v4 = a1[<span class="number">3</span>];</span><br><span class="line">	v5=<span class="number">0x7E</span>;</span><br><span class="line">  v6 = *a1;</span><br><span class="line">  v7 = a1[<span class="number">1</span>];</span><br><span class="line">	v8=<span class="number">0x1F</span>;</span><br><span class="line">  v9 = a1[<span class="number">2</span>];</span><br><span class="line">  v10 = (v6 + v4) * (<span class="number">0x7E</span> + <span class="number">0x75</span>);                 <span class="comment">// a2[0]=0x7E</span></span><br><span class="line">  v11 = <span class="number">0x19</span>;</span><br><span class="line">  v12 = <span class="number">0x75</span> * (v6 + v7);</span><br><span class="line">  v13 = (<span class="number">0x75</span> + <span class="number">0x19</span>) * (v7 - v4);</span><br><span class="line">  v14 = v4 * (<span class="number">0x19</span> - <span class="number">0x7E</span>);</span><br><span class="line">  v15 = <span class="number">0x7E</span> * (v9 + v4);</span><br><span class="line">  a3[<span class="number">0</span>] = v14 + v10 + v13 - v12;</span><br><span class="line">  a3[<span class="number">2</span>] = v15 + v14;</span><br><span class="line">  a3[<span class="number">1</span>] = v6 * (<span class="number">0x1F</span> - <span class="number">0X75</span>) + v12;</span><br><span class="line">  a3[<span class="number">3</span>] = v6 * (<span class="number">0x1F</span> - <span class="number">0x75</span>) + (<span class="number">0x1f</span> + <span class="number">0x7e</span>) * (v9 - v6) + v10 - v15;</span><br><span class="line">	a3[<span class="number">0</span>]&amp;=<span class="number">0xff</span>;</span><br><span class="line">	a3[<span class="number">1</span>]&amp;=<span class="number">0xff</span>;</span><br><span class="line">	a3[<span class="number">2</span>]&amp;=<span class="number">0xff</span>;</span><br><span class="line">	a3[<span class="number">3</span>]&amp;=<span class="number">0xff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> a1[<span class="number">4</span>],a3[<span class="number">4</span>];</span><br><span class="line">	<span class="type">int</span> c1[]=&#123;<span class="number">122</span>,<span class="number">173</span>,<span class="number">239</span>,<span class="number">153</span>,<span class="number">5</span>,<span class="number">109</span>,<span class="number">118</span>,<span class="number">172</span>,<span class="number">117</span></span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="type">int</span> c2[]=&#123;</span><br><span class="line">		<span class="number">8</span>,<span class="number">175</span>,<span class="number">216</span>,<span class="number">235</span>,<span class="number">67</span>,<span class="number">10</span>,<span class="number">100</span>,<span class="number">242</span>,<span class="number">117</span></span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="type">int</span> c3[]=&#123;</span><br><span class="line">		<span class="number">46</span>,<span class="number">130</span>,<span class="number">13</span>,<span class="number">42</span>,<span class="number">159</span>,<span class="number">127</span>,<span class="number">47</span>,<span class="number">201</span>,<span class="number">181</span></span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="type">int</span> c4[]=&#123;</span><br><span class="line">		<span class="number">186</span>,<span class="number">140</span>,<span class="number">248</span>,<span class="number">22</span>,<span class="number">200</span>,<span class="number">190</span>,<span class="number">169</span>,<span class="number">71</span>,<span class="number">51</span></span><br><span class="line">	&#125;;</span><br><span class="line">	string flag=<span class="string">&quot;&quot;</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> _=<span class="number">0</span>;_&lt;<span class="number">9</span>;_++)&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> a=<span class="number">32</span>;a&lt;=<span class="number">128</span>;a++)</span><br><span class="line">		&#123;</span><br><span class="line"><span class="comment">//		cout&lt;&lt;a&lt;&lt;&quot;\n&quot;;</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> b=<span class="number">32</span>;b&lt;=<span class="number">128</span>;b++)</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> c=<span class="number">32</span>;c&lt;=<span class="number">128</span>;c++)</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> d=<span class="number">32</span>;d&lt;=<span class="number">128</span>;d++)</span><br><span class="line">				&#123;</span><br><span class="line">					a1[<span class="number">0</span>]=a,a1[<span class="number">1</span>]=b,a1[<span class="number">2</span>]=c,a1[<span class="number">3</span>]=d;</span><br><span class="line">					<span class="built_in">enc</span>(a1,a3);</span><br><span class="line">					<span class="keyword">if</span>(a3[<span class="number">0</span>]==c1[_]&amp;&amp;a3[<span class="number">1</span>]==c2[_]&amp;&amp;a3[<span class="number">2</span>]==c3[_]&amp;&amp;a3[<span class="number">3</span>]==c4[_])&#123;</span><br><span class="line">						cout&lt;&lt;<span class="built_in">char</span>(a)&lt;&lt;<span class="string">&quot;&quot;</span>&lt;&lt;<span class="built_in">char</span>(b)&lt;&lt;<span class="string">&quot;&quot;</span>&lt;&lt;<span class="built_in">char</span>(c)&lt;&lt;<span class="string">&quot;&quot;</span>&lt;&lt;<span class="built_in">char</span>(d)&lt;&lt;<span class="string">&quot;&quot;</span>;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;&#125;</span><br></pre></td></tr></table></figure>
<p><strong>flag</strong> : NCTF{f6dffab6-173f-4bb1-a973-62f3f8254eba}</p>
<h2 id="just-run-it"><a href="#just-run-it" class="headerlink" title="just_run_it"></a>just_run_it</h2><p>ç¥å¥‡çš„cosmopolitan Linux Windowséƒ½èƒ½è·‘<br>æ‰¾åˆ°å…³é”®å‡½æ•° å…ˆè¾“ä¸€ä¸ª16çš„key å†è¾“flag<br>è¾“å…¥çš„keyåšäº†ä¸€ä¸ªä¹±åºçš„æ˜ å°„ å¯ä»¥é€šè¿‡åŠ¨è°ƒæ‰¾åˆ°å¯¹åº”å…³ç³»</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">428100: 1234567890abcdef</span><br><span class="line">428180: 1267358c49bd0aef</span><br></pre></td></tr></table></figure>

<p>keyçš„é€»è¾‘æ˜¯å…ˆä¹±åºä¸€é“ ç„¶åä½œäº†ä¸ªxor å†ä¹±åºä¸€é“ ç„¶åä¸unk_425180 check<br>å¯¹åº”è¿˜åŸ å¾—åˆ°<br><code>W1lc0menctf2o2o!</code></p>
<p>ç„¶ååé¢çš„åŠ å¯†å‘ç°sbox Googleå¸¸é‡å‘ç°æ˜¯sm4<br>æ‰¾åˆ°encå€¼ <a target="_blank" rel="noopener" href="https://the-x.cn/zh-cn/cryptography/Sm4.aspx">åœ¨çº¿ç½‘ç«™</a> è§£å°±å®Œäº†</p>
<p><strong>NCTF{b23a271e-2b15-4bb5-9719-738cffb83919}</strong></p>
<h1 id="NCTF2018"><a href="#NCTF2018" class="headerlink" title="NCTF2018"></a>NCTF2018</h1><h2 id="wcyvm"><a href="#wcyvm" class="headerlink" title="wcyvm"></a>wcyvm</h2><p>ä¸€é“è™šæ‹Ÿæœºopcodeçš„é¢˜<br>é€†å‡ºflagä¸éš¾(äº‹å®ä¸Š æ„å¤–çš„ç®€å•â€¦) ä½†æ˜¯æ•´ä½“opcodeæœ‰äº›ç‚¹è¿˜æ˜¯éœ€è¦ä»”ç»†ç¢ç£¨çš„<br>åœ¨ä¹‹å‰åšçš„å‡ é“åŸºç¡€ä¸Šå¢åŠ äº†ä¸€ç‚¹å¯»å€æ–¹å¼çš„è€ƒå¯Ÿ</p>
<p>é€ä¸ªåˆ†æ:<br>case 0x8<br>å¯„å­˜å™¨èµ‹å€¼<br>case 0x9<br>è¿™é‡Œæ²¡æ€ä¹ˆææ‡‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sub_40096D</span>(v4[*(_DWORD *)(v5[<span class="number">0</span>] + <span class="number">4</span>) - <span class="number">1</span>], &amp;v4[<span class="number">4</span>], v5);</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_QWORD *__fastcall <span class="title">sub_40096D</span><span class="params">(_DWORD *a1, _DWORD **a2, _QWORD *a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _QWORD *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  *a1 = *(*a2)++;</span><br><span class="line">  result = a3;</span><br><span class="line">  *a3 += <span class="number">8LL</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»“åˆcase 0xaçš„ç±»ä¼¼ä»£ç  æˆ‘æ˜¯æŠŠè¿™é‡Œå½’ä¸ºç±»ä¼¼push&#x2F;pop è¿™ç§å †æ ˆæ“ä½œ</p>
<p>case 0xa</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sub_400927</span>(v4[*(_DWORD *)(v5[<span class="number">0</span>] + <span class="number">4</span>) - <span class="number">1</span>], &amp;v4[<span class="number">4</span>], v5);</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_QWORD *__fastcall <span class="title">sub_400927</span><span class="params">(_DWORD *a1, _QWORD *a2, _QWORD *a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _QWORD *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  *a2 -= <span class="number">4LL</span>;</span><br><span class="line">  *(_DWORD *)*a2 = *a1;</span><br><span class="line">  result = a3;</span><br><span class="line">  *a3 += <span class="number">8LL</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>case 0xb<br>getchar<br>case 0xc<br>putchar<br>case 0xd<br>cmp åªæ˜¯è¿™é‡Œç½®æ ‡å¿—ä½çš„æ–¹æ³•æ¯”è¾ƒç‹¬ç‰¹ ç»“åˆåé¢je&#x2F;jneåˆ†æå…¶å®è·Ÿæ­£å¸¸ç½®0&#x2F;1ä½œç”¨æ˜¯ä¸€æ ·çš„<br>case 0xe<br>jmp<br>case 0xf<br>jne<br>case 0x10<br>je<br>case 0x11<br>inc<br>case 0x12<br>dec<br>case 0x13<br>add<br>case 0x14<br>sub<br>case 0x15<br>xor<br>case 0x16<br>and<br>case 0x17<br>or<br>case 0x19 ~ case 0x1c<br>å››ç§ä¸åŒçš„èµ‹å€¼(å˜é‡ç±»å‹ä¸åŒ)<br>case 0x1d<br>mul<br>case 0x64<br>check_flag</p>
<p>è¿™ä¹ˆå¤„ç† æ‰“å°å‡ºæ¥çš„å­—èŠ‚ç å°±æ˜¯è¿™ç§:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">0 mov v4[0] 0</span><br><span class="line">3 mov v4[2] 70</span><br><span class="line">6 jmp 13</span><br><span class="line">8 push v4[0]</span><br><span class="line">10 pop v4[1]</span><br><span class="line">12 mov v4[0] getchar()</span><br><span class="line">13 push v4[0]</span><br><span class="line">15 push v4[1]</span><br><span class="line">17 pop v4[0]</span><br><span class="line">19 inc v4[0]</span><br><span class="line">21 cmp v4[0] v4[2]</span><br><span class="line">24 jne 8</span><br><span class="line">26 mov v4[0] 0</span><br><span class="line">29 mov v4[2] 71</span><br><span class="line">32 jmp 13</span><br><span class="line">34 push v4[0]</span><br><span class="line">36 mov v4[1] v4[5]</span><br><span class="line">39 mul v4[0] 4</span><br><span class="line">42 sub v4[1] v4[0]</span><br><span class="line">45 mov v4[0] v4[1]</span><br><span class="line">48 mov v4[0] v4[0]</span><br><span class="line">51 mul v4[0] 110</span><br><span class="line">54 add v4[0] 99</span><br><span class="line">57 xor v4[0] 116</span><br><span class="line">60 add v4[0] 102</span><br><span class="line">63 mov v4[1] v4[0]</span><br><span class="line">66 pop v4[0]</span><br><span class="line">68 inc v4[0]</span><br><span class="line">70 cmp v4[0] v4[2]</span><br><span class="line">73 jne 34</span><br><span class="line">75 check_flag</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç° æœ‰å‡ ä¸ªç‚¹çœŸçš„å¾ˆå¥‡æ€ª ä½†æ˜¯å¯¹äºinputçš„å˜æ¢ä¸€çœ¼å°±èƒ½çœ‹å‡ºæ¥â€¦<br>åŒæ—¶ åœ¨check_flagä¸­èƒ½æ‰¾åˆ°å¯¹åº”çš„enc[] çˆ†ç ´è§£å°±å®Œäº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">0x000036D3</span>, <span class="number">0x00002AFF</span>, <span class="number">0x00002ACB</span>, <span class="number">0x00002B95</span>, <span class="number">0x00002B95</span>, <span class="number">0x00002B95</span>, <span class="number">0x0000169F</span>, <span class="number">0x0000186D</span>, <span class="number">0x000018D7</span>, <span class="number">0x00001611</span>, <span class="number">0x000018D7</span>, <span class="number">0x00002B95</span>, <span class="number">0x00002C23</span>, <span class="number">0x00002CA9</span>, <span class="number">0x00001611</span>, <span class="number">0x00001611</span>, <span class="number">0x000018D7</span>, <span class="number">0x00002AFF</span>, <span class="number">0x00001849</span>, <span class="number">0x000018FB</span>, <span class="number">0x00002ACB</span>, <span class="number">0x00002A71</span>, <span class="number">0x00001735</span>, <span class="number">0x000018D7</span>, <span class="number">0x00001611</span>, <span class="number">0x00002ACB</span>, <span class="number">0x000015DD</span>, <span class="number">0x000018D7</span>, <span class="number">0x00002C23</span>, <span class="number">0x0000169F</span>, <span class="number">0x000015DD</span>, <span class="number">0x00002B95</span>, <span class="number">0x0000169F</span>, <span class="number">0x0000156B</span>, <span class="number">0x0000186D</span>, <span class="number">0x00002AFF</span>, <span class="number">0x00001611</span>, <span class="number">0x00001611</span>, <span class="number">0x000015DD</span>, <span class="number">0x00002AFF</span>, <span class="number">0x00002C23</span>, <span class="number">0x00002ACB</span>, <span class="number">0x000015DD</span>, <span class="number">0x000015DD</span>, <span class="number">0x0000186D</span>, <span class="number">0x00001849</span>, <span class="number">0x00002B95</span>, <span class="number">0x0000156B</span>, <span class="number">0x00001735</span>, <span class="number">0x000018FB</span>, <span class="number">0x000018FB</span>, <span class="number">0x00002A71</span>, <span class="number">0x00002AFF</span>, <span class="number">0x00001735</span>, <span class="number">0x00002C23</span>, <span class="number">0x000015DD</span>, <span class="number">0x000018D7</span>, <span class="number">0x00002A71</span>, <span class="number">0x000018D7</span>, <span class="number">0x000018D7</span>, <span class="number">0x00002C23</span>, <span class="number">0x00002AFF</span>, <span class="number">0x0000156B</span>, <span class="number">0x00002C23</span>, <span class="number">0x0000169F</span>, <span class="number">0x000035AF</span>, <span class="number">0x00002CA9</span>, <span class="number">0x000032B5</span>, <span class="number">0x00002AFF</span>, <span class="number">0x00003039</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>]</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> enc:</span><br><span class="line">    <span class="keyword">if</span>(c==<span class="number">0</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        y = (<span class="number">110</span>*x+<span class="number">99</span>)^<span class="number">116</span></span><br><span class="line">        y += <span class="number">102</span></span><br><span class="line">        <span class="keyword">if</span>(y==c):</span><br><span class="line">            flag += <span class="built_in">chr</span>(x)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(flag[::-<span class="number">1</span>])</span><br><span class="line"><span class="comment"># nctf&#123;3e1ce77b70e4cb9941d6800aec022c813d03e70a274ba96c722fed72783dddac&#125;</span></span><br></pre></td></tr></table></figure>

<p>flag:<br><strong>nctf{3e1ce77b70e4cb9941d6800aec022c813d03e70a274ba96c722fed72783dddac}</strong></p>
<hr>
<hr>
<p>è‡³äºä¸ºä»€ä¹ˆå€’åº å…¶å®å­—èŠ‚ç å¯ä»¥çœ‹å‡ºæ¥<br>è¿™é‡Œ:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">36 mov v4[1] v4[5]</span><br><span class="line">39 mul v4[0] 4</span><br><span class="line">42 sub v4[1] v4[0]</span><br><span class="line">45 mov v4[0] v4[1]</span><br><span class="line">48 mov v4[0] v4[0]</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„v4[5]å°±æ˜¯æˆ‘ä»¬inputæ”¾å…¥çš„æ ˆçš„æ ˆé¡¶æŒ‡é’ˆ<br>å¯ä»¥çœ‹åˆ°è¿™é‡Œæ˜¯ sub v4[1] v4[0] æ‰€ä»¥æ˜¯ä»æ ˆé¡¶å–çš„ ä¹Ÿå°±æ˜¯å…¥æ ˆé¡ºåºå€’åº<br>48å¤„é‚£ä¸ªçœ‹ä¼¼æ²¡ç”¨çš„è¯­å¥æ˜¯å°†v4[0]åœ°å€å¯¹åº”çš„å€¼èµ‹ç»™v4[0] ç›¸å½“äºå–åœ°å€<br>è¿™å°±æ˜¯å‰é¢é‚£4ä¸ªå˜é‡ç±»å‹ä¸åŒçš„èµ‹å€¼</p>
<p>æœ€å å¾—åˆ°flagåˆå»çœ‹äº†çœ‹å…¶ä»–å¸ˆå‚…çš„å†™æ³• å¯¹é‚£å››ä¸ªèµ‹å€¼åŒºåˆ«æœ‰äº†æ›´æ·±äº†è§£<br>0x19:<br>ç›´æ¥èµ‹å€¼ mov a1 a2</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_QWORD *__fastcall <span class="title">sub_400858</span><span class="params">(_DWORD *a1, _DWORD *a2, _QWORD *a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _QWORD *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  *a1 = *a2;</span><br><span class="line">  result = a3;</span><br><span class="line">  *a3 += <span class="number">12LL</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>0x1a:<br>å–a2çš„åœ°å€ç»™a1 lea a1 a2</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_QWORD *__fastcall <span class="title">sub_400889</span><span class="params">(_DWORD *a1, <span class="type">int</span> a2, _QWORD *a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _QWORD *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  *a1 = a2;</span><br><span class="line">  result = a3;</span><br><span class="line">  *a3 += <span class="number">12LL</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>0x1b:<br>å¯„å­˜å™¨é—´æ¥å¯»å€ mov a1 [a2]</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_QWORD *__fastcall <span class="title">sub_4008BA</span><span class="params">(_DWORD *a1, <span class="type">unsigned</span> <span class="type">int</span> *a2, _QWORD *a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _QWORD *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  *a1 = *(_DWORD *)*a2;</span><br><span class="line">  result = a3;</span><br><span class="line">  *a3 += <span class="number">12LL</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>0x1c:<br>mov [a1] a2</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_QWORD *__fastcall <span class="title">sub_4008EF</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a1, _DWORD *a2, _QWORD *a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _QWORD *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  *(_DWORD *)*a1 = *a2;</span><br><span class="line">  result = a3;</span><br><span class="line">  *a3 += <span class="number">12LL</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è™½è¯´å­—èŠ‚ç è¿˜æ˜¯æœ‰ç‚¹æ€ª ä½†æ˜¯ç†è§£opcodeæœ¬è´¨å é¢˜ç›®çš„è®­ç»ƒç›®çš„å°±è¾¾åˆ°äº†</p>
<h1 id="NUAACTF2020"><a href="#NUAACTF2020" class="headerlink" title="NUAACTF2020"></a>NUAACTF2020</h1><h2 id="demium"><a href="#demium" class="headerlink" title="demium"></a>demium</h2><p>32ä½.NET<br>dnspyæ‰¾åŠå¤©æ‰¾ä¸åˆ°å…³é”®å‡½æ•° æç€å°±æ²¡æ‰¾åˆ°å…¥å£ç‚¹â€¦<br>çç¿»å‡½æ•°åˆ—è¡¨ ç¿»åˆ°ä¸ª 	internal unsafe static void EncryptStr(char* input)</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">internal</span> <span class="keyword">unsafe</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">EncryptStr</span>(<span class="params"><span class="built_in">char</span>* input</span>)</span></span><br><span class="line">    &#123; <span class="comment">// H[]ä½œä¸ºç´¢å¼•  Wä¸­çš„ä¸‹æ ‡å–å¾—æ˜¯ H[xxx]*2  åˆšå¥½H:0~69      W: 0~136</span></span><br><span class="line">        $ArrayType$$$BY0EF@H $ArrayType$$$BY0EF@H = <span class="number">45</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">4</span>) = <span class="number">15</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">8</span>) = <span class="number">67</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">12</span>) = <span class="number">61</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">16</span>) = <span class="number">8</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">20</span>) = <span class="number">68</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">24</span>) = <span class="number">9</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">28</span>) = <span class="number">39</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">32</span>) = <span class="number">60</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">36</span>) = <span class="number">2</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">40</span>) = <span class="number">56</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">44</span>) = <span class="number">63</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">48</span>) = <span class="number">36</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">52</span>) = <span class="number">38</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">56</span>) = <span class="number">28</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">60</span>) = <span class="number">29</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">64</span>) = <span class="number">57</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">68</span>) = <span class="number">50</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">72</span>) = <span class="number">1</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">76</span>) = <span class="number">0</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">80</span>) = <span class="number">51</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">84</span>) = <span class="number">52</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">88</span>) = <span class="number">17</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">92</span>) = <span class="number">3</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">96</span>) = <span class="number">26</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">100</span>) = <span class="number">21</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">104</span>) = <span class="number">40</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">108</span>) = <span class="number">11</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">112</span>) = <span class="number">37</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">116</span>) = <span class="number">16</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">120</span>) = <span class="number">31</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">124</span>) = <span class="number">22</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">128</span>) = <span class="number">32</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">132</span>) = <span class="number">19</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">136</span>) = <span class="number">33</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">140</span>) = <span class="number">4</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">144</span>) = <span class="number">66</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">148</span>) = <span class="number">53</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">152</span>) = <span class="number">65</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">156</span>) = <span class="number">25</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">160</span>) = <span class="number">41</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">164</span>) = <span class="number">44</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">168</span>) = <span class="number">20</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">172</span>) = <span class="number">7</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">176</span>) = <span class="number">12</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">180</span>) = <span class="number">18</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">184</span>) = <span class="number">64</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">188</span>) = <span class="number">30</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">192</span>) = <span class="number">49</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">196</span>) = <span class="number">58</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">200</span>) = <span class="number">10</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">204</span>) = <span class="number">62</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">208</span>) = <span class="number">24</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">212</span>) = <span class="number">43</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">216</span>) = <span class="number">48</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">220</span>) = <span class="number">46</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">224</span>) = <span class="number">6</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">228</span>) = <span class="number">47</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">232</span>) = <span class="number">13</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">236</span>) = <span class="number">35</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">240</span>) = <span class="number">42</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">244</span>) = <span class="number">14</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">248</span>) = <span class="number">59</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">252</span>) = <span class="number">23</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">256</span>) = <span class="number">27</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">260</span>) = <span class="number">34</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">264</span>) = <span class="number">54</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">268</span>) = <span class="number">55</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@H + <span class="number">272</span>) = <span class="number">5</span>;</span><br><span class="line">        $ArrayType$$$BY0EF@_W $ArrayType$$$BY0EF@_W = <span class="number">65</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">2</span>) = <span class="number">66</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">4</span>) = <span class="number">67</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">6</span>) = <span class="number">68</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">8</span>) = <span class="number">69</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">10</span>) = <span class="number">70</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">12</span>) = <span class="number">71</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">14</span>) = <span class="number">72</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">16</span>) = <span class="number">73</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">18</span>) = <span class="number">74</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">20</span>) = <span class="number">75</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">22</span>) = <span class="number">76</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">24</span>) = <span class="number">77</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">26</span>) = <span class="number">78</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">28</span>) = <span class="number">79</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">30</span>) = <span class="number">80</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">32</span>) = <span class="number">81</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">34</span>) = <span class="number">82</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">36</span>) = <span class="number">83</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">38</span>) = <span class="number">84</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">40</span>) = <span class="number">85</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">42</span>) = <span class="number">86</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">44</span>) = <span class="number">87</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">46</span>) = <span class="number">88</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">48</span>) = <span class="number">89</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">50</span>) = <span class="number">90</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">52</span>) = <span class="number">97</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">54</span>) = <span class="number">98</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">56</span>) = <span class="number">99</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">58</span>) = <span class="number">100</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">60</span>) = <span class="number">101</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">62</span>) = <span class="number">102</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">64</span>) = <span class="number">103</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">66</span>) = <span class="number">104</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">68</span>) = <span class="number">105</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">70</span>) = <span class="number">106</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">72</span>) = <span class="number">107</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">74</span>) = <span class="number">108</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">76</span>) = <span class="number">109</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">78</span>) = <span class="number">110</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">80</span>) = <span class="number">111</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">82</span>) = <span class="number">112</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">84</span>) = <span class="number">113</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">86</span>) = <span class="number">114</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">88</span>) = <span class="number">115</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">90</span>) = <span class="number">116</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">92</span>) = <span class="number">117</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">94</span>) = <span class="number">118</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">96</span>) = <span class="number">119</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">98</span>) = <span class="number">120</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">100</span>) = <span class="number">121</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">102</span>) = <span class="number">122</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">104</span>) = <span class="number">48</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">106</span>) = <span class="number">49</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">108</span>) = <span class="number">50</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">110</span>) = <span class="number">51</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">112</span>) = <span class="number">52</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">114</span>) = <span class="number">53</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">116</span>) = <span class="number">54</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">118</span>) = <span class="number">55</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">120</span>) = <span class="number">56</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">122</span>) = <span class="number">57</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">124</span>) = <span class="number">92</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">126</span>) = <span class="number">47</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">128</span>) = <span class="number">43</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">130</span>) = <span class="number">45</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">132</span>) = <span class="number">95</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">134</span>) = <span class="number">123</span>;</span><br><span class="line">        *(<span class="keyword">ref</span> $ArrayType$$$BY0EF@_W + <span class="number">136</span>) = <span class="number">125</span>;</span><br><span class="line">        <span class="built_in">char</span>* ptr = input;</span><br><span class="line">        <span class="keyword">if</span> (*input != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">do</span></span><br><span class="line">            &#123;</span><br><span class="line">                ptr++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (*(<span class="built_in">short</span>*)ptr != <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">int</span> num = ptr - input / <span class="number">2</span> &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">string</span> text = <span class="literal">null</span>;</span><br><span class="line">        <span class="built_in">int</span> num2 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">0</span> &lt; num)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (;;)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">int</span> num3 = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span> (;;)</span><br><span class="line">                &#123;</span><br><span class="line">                    $ArrayType$$$BY0EF@_W* ptr2 = &amp;$ArrayType$$$BY0EF@_W;</span><br><span class="line">                    <span class="keyword">do</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        ptr2 += <span class="number">2</span> / <span class="keyword">sizeof</span>($ArrayType$$$BY0EF@_W);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">while</span> (*(<span class="built_in">short</span>*)ptr2 != <span class="number">0</span>);</span><br><span class="line">                    <span class="keyword">if</span> (num3 &gt;= ptr2 - <span class="keyword">ref</span> $ArrayType$$$BY0EF@_W / <span class="keyword">sizeof</span>($ArrayType$$$BY0EF@_W) &gt;&gt; <span class="number">1</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">goto</span> IL_52F;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (*(num2 * <span class="number">2</span> + input) == *(num3 * <span class="number">2</span> + <span class="keyword">ref</span> $ArrayType$$$BY0EF@_W))</span><br><span class="line">                    <span class="comment">// æ‰¾ç´¢å¼•    input[num2] == W[num3]</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">goto</span> IL_510;</span><br><span class="line">                    &#125;</span><br><span class="line">                    num3++;</span><br><span class="line">                &#125;</span><br><span class="line">                IL_53B:</span><br><span class="line">                num2++;</span><br><span class="line">                <span class="keyword">if</span> (num2 &gt;= num)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">                IL_510:</span><br><span class="line">                <span class="keyword">if</span> (num3 != <span class="number">-1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    text += (<span class="built_in">char</span>)(*(*(num3 * <span class="number">4</span> + <span class="keyword">ref</span> $ArrayType$$$BY0EF@H) * <span class="number">2</span> + <span class="keyword">ref</span> $ArrayType$$$BY0EF@_W));</span><br><span class="line">                    <span class="comment">// text += W[ 2*H[num3] ]</span></span><br><span class="line">                    <span class="keyword">goto</span> IL_53B;</span><br><span class="line">                &#125;</span><br><span class="line">                IL_52F:</span><br><span class="line">                text += <span class="string">&quot;=&quot;</span>;   <span class="comment">// base64???</span></span><br><span class="line">                <span class="keyword">goto</span> IL_53B;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Console.WriteLine(text);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå¤§è‡´åˆ†æä¸‹å°±çŸ¥é“æ˜¯ä¸¤æ¬¡ç´¢å¼•å˜æ¢ é€†å›å»å³å¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">$ArrayType$$$BY0EF@_W $ArrayType$$$BY0EF@_W = 65;</span></span><br><span class="line"><span class="string">        ...</span></span><br><span class="line"><span class="string">        ...</span></span><br><span class="line"><span class="string">        *(ref $ArrayType$$$BY0EF@_W + 136) = 125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">s = s.split(<span class="string">&quot;;&quot;</span>)</span><br><span class="line">s = s[:-<span class="number">1</span>]</span><br><span class="line">W = []</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">    c = c.split(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">    W.append(c[<span class="number">1</span>].strip())</span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">$ArrayType$$$BY0EF@H $ArrayType$$$BY0EF@H = 45;</span></span><br><span class="line"><span class="string">        ...</span></span><br><span class="line"><span class="string">        ...</span></span><br><span class="line"><span class="string">        *(ref $ArrayType$$$BY0EF@H + 272) = 5;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">s = s.split(<span class="string">&quot;;&quot;</span>)</span><br><span class="line">s = s[:-<span class="number">1</span>]</span><br><span class="line">H = []</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">    c = c.split(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">    H.append(c[<span class="number">1</span>].strip())</span><br><span class="line">W = [<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> W]</span><br><span class="line">H = [<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> H]</span><br><span class="line"></span><br><span class="line">enc = <span class="string">&quot;W1og39p2Kp+2_Zpx2&#123;/yF&quot;</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    x = <span class="built_in">ord</span>(enc[i])</span><br><span class="line">    pos = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">69</span>):</span><br><span class="line">        <span class="keyword">if</span> W[j]==x:</span><br><span class="line">            pos = j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    poss = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">69</span>):</span><br><span class="line">        <span class="keyword">if</span>(H[j]==pos):</span><br><span class="line">            poss = j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(W[poss]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># flag&#123;Do_you_know_CLR&#125;</span></span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°flagä¸­çš„CLR å»å­¦ä¹ äº†ä¸€æ³¢<br>CLR: å…¬å…±è¯­è¨€è¿è¡Œåº“</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å…¬å…±è¯­è¨€è¿è¡Œåº“ (CLR) æ˜¯ .NET Framework çš„æ ¸å¿ƒï¼Œä¸ºæ‰€æœ‰ .NET Framework ä»£ç æä¾›æ‰§è¡Œç¯å¢ƒã€‚ åœ¨ CLR ä¸­è¿è¡Œçš„ä»£ç ç§°ä¸ºæ‰˜ç®¡ä»£ç ã€‚ </span><br><span class="line">CLR æä¾›æ‰§è¡Œç¨‹åºæ‰€éœ€çš„å„ç§å‡½æ•°å’ŒæœåŠ¡ï¼ŒåŒ…æ‹¬å®æ—¶ (JIT) ç¼–è¯‘ã€åˆ†é…å’Œç®¡ç†å†…å­˜ã€å¼ºåˆ¶ç±»å‹å®‰å…¨ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹ç®¡ç†å’Œå®‰å…¨æ€§ã€‚</span><br></pre></td></tr></table></figure>

<p>è¿™â€¦ çœ‹äº†çœ‹å®˜æ–¹é¢˜è§£ è¯´çš„æ˜¯è¿™é‡Œçš„exeæ˜¯ä¸€ä¸ªå¸¦æœ‰.netç¯å¢ƒçš„exeï¼Œä¹Ÿå°±æ˜¯è¿è¡Œåœ¨CLRç¯å¢ƒä¸‹çš„ä»£ç <br>ç„¶åé¢˜è§£è¯´ä»IDAæ‰“å¼€å¯ä»¥å®šä½åˆ°å¯ä»¥å‡½æ•°çš„token: 6000008h å¹¶ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„åœ°å€ï¼Œè€Œæ˜¯C#ä¸­çš„å‡½æ•°metatokenï¼Œæ˜¯C#ç”¨äºå®šä½å‡½æ•°é›†ä¸­æ¯ä¸ªå‡½æ•°çš„ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„æ ‡è¯†ç¬¦<br>æ‰€ä»¥å†ç”¨dnspyæ‰“å¼€æ—¶å°±å¯ä»¥ç”¨tokenæ¥å¿«é€Ÿå®šä½äº† ç¡®å®æ‰“å¼€&lt; Module &gt;ä¸‹èƒ½æ‰¾åˆ°ä¸€ç³»åˆ—å¸¦æœ‰tokençš„å‡½æ•° å­¦åˆ°äº†</p>
<h1 id="DUCTF2023"><a href="#DUCTF2023" class="headerlink" title="DUCTF2023"></a>DUCTF2023</h1><h2 id="nt-flag-checker"><a href="#nt-flag-checker" class="headerlink" title="nt_flag_checker"></a>nt_flag_checker</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Q 7937</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ZETA 2805</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 256</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> POINTS[N] = &#123;<span class="number">4074</span>, <span class="number">1455</span>, <span class="number">891</span>, <span class="number">5096</span>, <span class="number">28</span>, <span class="number">6122</span>, <span class="number">2068</span>, <span class="number">704</span>, <span class="number">4580</span>, <span class="number">6480</span>, <span class="number">4182</span>, <span class="number">5243</span>, <span class="number">2685</span>, <span class="number">1102</span>, <span class="number">2504</span>, <span class="number">3812</span>, <span class="number">211</span>, <span class="number">1006</span>, <span class="number">7596</span>, <span class="number">1530</span>, <span class="number">799</span>, <span class="number">5539</span>, <span class="number">727</span>, <span class="number">3313</span>, <span class="number">1335</span>, <span class="number">1226</span>, <span class="number">6120</span>, <span class="number">2296</span>, <span class="number">2504</span>, <span class="number">447</span>, <span class="number">1902</span>, <span class="number">3393</span>, <span class="number">6614</span>, <span class="number">3827</span>, <span class="number">1532</span>, <span class="number">116</span>, <span class="number">5742</span>, <span class="number">7236</span>, <span class="number">80</span>, <span class="number">2688</span>, <span class="number">7754</span>, <span class="number">1563</span>, <span class="number">1918</span>, <span class="number">3739</span>, <span class="number">6177</span>, <span class="number">6805</span>, <span class="number">4307</span>, <span class="number">2005</span>, <span class="number">5423</span>, <span class="number">611</span>, <span class="number">2984</span>, <span class="number">7520</span>, <span class="number">1011</span>, <span class="number">6977</span>, <span class="number">4891</span>, <span class="number">3979</span>, <span class="number">5721</span>, <span class="number">539</span>, <span class="number">4055</span>, <span class="number">4990</span>, <span class="number">2175</span>, <span class="number">564</span>, <span class="number">4938</span>, <span class="number">4655</span>, <span class="number">6569</span>, <span class="number">7444</span>, <span class="number">6491</span>, <span class="number">2228</span>, <span class="number">4736</span>, <span class="number">1548</span>, <span class="number">5946</span>, <span class="number">6654</span>, <span class="number">4460</span>, <span class="number">4072</span>, <span class="number">6491</span>, <span class="number">7305</span>, <span class="number">2156</span>, <span class="number">2147</span>, <span class="number">3373</span>, <span class="number">4322</span>, <span class="number">6628</span>, <span class="number">4691</span>, <span class="number">6763</span>, <span class="number">6320</span>, <span class="number">37</span>, <span class="number">4509</span>, <span class="number">7870</span>, <span class="number">4644</span>, <span class="number">4028</span>, <span class="number">7076</span>, <span class="number">2827</span>, <span class="number">1921</span>, <span class="number">2992</span>, <span class="number">7316</span>, <span class="number">4806</span>, <span class="number">1375</span>, <span class="number">7264</span>, <span class="number">1471</span>, <span class="number">7446</span>, <span class="number">3743</span>, <span class="number">4069</span>, <span class="number">7613</span>, <span class="number">1284</span>, <span class="number">7933</span>, <span class="number">3439</span>, <span class="number">6909</span>, <span class="number">4150</span>, <span class="number">1543</span>, <span class="number">2862</span>, <span class="number">3452</span>, <span class="number">5114</span>, <span class="number">131</span>, <span class="number">246</span>, <span class="number">1700</span>, <span class="number">5230</span>, <span class="number">6932</span>, <span class="number">7176</span>, <span class="number">6984</span>, <span class="number">6837</span>, <span class="number">183</span>, <span class="number">2960</span>, <span class="number">2006</span>, <span class="number">6865</span>, <span class="number">1741</span>, <span class="number">3669</span>, <span class="number">7709</span>, <span class="number">7777</span>, <span class="number">5212</span>, <span class="number">6425</span>, <span class="number">3948</span>, <span class="number">5257</span>, <span class="number">7185</span>, <span class="number">4391</span>, <span class="number">4539</span>, <span class="number">2458</span>, <span class="number">1407</span>, <span class="number">2293</span>, <span class="number">1669</span>, <span class="number">3473</span>, <span class="number">5785</span>, <span class="number">6692</span>, <span class="number">7882</span>, <span class="number">4209</span>, <span class="number">4828</span>, <span class="number">3434</span>, <span class="number">4506</span>, <span class="number">5839</span>, <span class="number">6578</span>, <span class="number">6587</span>, <span class="number">7797</span>, <span class="number">2449</span>, <span class="number">6569</span>, <span class="number">3129</span>, <span class="number">1508</span>, <span class="number">4449</span>, <span class="number">6797</span>, <span class="number">1769</span>, <span class="number">4347</span>, <span class="number">7250</span>, <span class="number">751</span>, <span class="number">3892</span>, <span class="number">4899</span>, <span class="number">2216</span>, <span class="number">1746</span>, <span class="number">926</span>, <span class="number">1803</span>, <span class="number">3985</span>, <span class="number">705</span>, <span class="number">7416</span>, <span class="number">7029</span>, <span class="number">3965</span>, <span class="number">732</span>, <span class="number">4212</span>, <span class="number">175</span>, <span class="number">5538</span>, <span class="number">5673</span>, <span class="number">7441</span>, <span class="number">1352</span>, <span class="number">233</span>, <span class="number">1949</span>, <span class="number">7343</span>, <span class="number">2137</span>, <span class="number">3740</span>, <span class="number">1802</span>, <span class="number">3616</span>, <span class="number">6728</span>, <span class="number">5792</span>, <span class="number">433</span>, <span class="number">606</span>, <span class="number">6487</span>, <span class="number">4409</span>, <span class="number">4080</span>, <span class="number">1699</span>, <span class="number">967</span>, <span class="number">2789</span>, <span class="number">6314</span>, <span class="number">3146</span>, <span class="number">7452</span>, <span class="number">510</span>, <span class="number">4973</span>, <span class="number">1970</span>, <span class="number">5900</span>, <span class="number">5413</span>, <span class="number">1254</span>, <span class="number">146</span>, <span class="number">7665</span>, <span class="number">5124</span>, <span class="number">3622</span>, <span class="number">6258</span>, <span class="number">4063</span>, <span class="number">3456</span>, <span class="number">5228</span>, <span class="number">1387</span>, <span class="number">7359</span>, <span class="number">5885</span>, <span class="number">997</span>, <span class="number">3072</span>, <span class="number">884</span>, <span class="number">2780</span>, <span class="number">0</span>, <span class="number">222</span>, <span class="number">4840</span>, <span class="number">1193</span>, <span class="number">4913</span>, <span class="number">984</span>, <span class="number">2608</span>, <span class="number">2291</span>, <span class="number">1551</span>, <span class="number">6595</span>, <span class="number">7810</span>, <span class="number">5811</span>, <span class="number">7147</span>, <span class="number">682</span>, <span class="number">5000</span>, <span class="number">4413</span>, <span class="number">7743</span>, <span class="number">6106</span>, <span class="number">4231</span>, <span class="number">4336</span>, <span class="number">6047</span>, <span class="number">3478</span>, <span class="number">1935</span>, <span class="number">6396</span>, <span class="number">2303</span>, <span class="number">4407</span>, <span class="number">6919</span>, <span class="number">4488</span>, <span class="number">5276</span>, <span class="number">2171</span>, <span class="number">5376</span>, <span class="number">7662</span>, <span class="number">700</span>, <span class="number">3059</span>, <span class="number">1277</span>, <span class="number">4674</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">br</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">    <span class="type">int</span> y = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">7</span>; i++) &#123;</span><br><span class="line">        y &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">        y |= (x &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">powmod</span><span class="params">(<span class="type">int</span> base, <span class="type">int</span> <span class="built_in">exp</span>, <span class="type">int</span> mod)</span> &#123;</span><br><span class="line">    base %= mod;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">exp</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">exp</span> &amp; <span class="number">1</span>) &#123;</span><br><span class="line">            res = (res * base) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">        base = (base * base) % mod;</span><br><span class="line">        <span class="built_in">exp</span> &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">transform</span><span class="params">(<span class="type">int</span> r[N])</span> &#123;</span><br><span class="line">    <span class="type">int</span> j;</span><br><span class="line">    <span class="type">int</span> k = <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">128</span>;</span><br><span class="line">    <span class="keyword">while</span>(l &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="type">int</span> start = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(start &lt; <span class="number">256</span>) &#123;</span><br><span class="line">            <span class="type">int</span> zeta = powmod(ZETA, br(k++), Q);</span><br><span class="line">            <span class="keyword">for</span>(j = start; j &lt; start + l; j++) &#123;</span><br><span class="line">                <span class="type">int</span> t = (zeta * r[j + l]) % Q;</span><br><span class="line">                r[j + l] = (r[j] - t) % Q;</span><br><span class="line">                r[j] = (r[j] + t) % Q;</span><br><span class="line">            &#125;</span><br><span class="line">            start = j + l;</span><br><span class="line">        &#125;</span><br><span class="line">        l &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">poly_eval</span><span class="params">(<span class="type">int</span> r[N], <span class="type">int</span> x)</span> &#123;</span><br><span class="line">    <span class="type">int</span> s = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">        s *= x;</span><br><span class="line">        s += r[N - i - <span class="number">1</span>];</span><br><span class="line">        s %= Q;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;What is the flag? &quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> inp[N];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%256s&quot;</span>, inp);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> poly[N] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> len = <span class="built_in">strlen</span>(inp);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        poly[i] = inp[i] * <span class="number">61</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    transform(poly);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> good = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; N; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>((poly_eval(poly, i) - POINTS[i<span class="number">-1</span>]) % Q != <span class="number">0</span>) &#123;</span><br><span class="line">            good = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(good) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Incorrect!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<h2 id="wrong-signal"><a href="#wrong-signal" class="headerlink" title="wrong-signal"></a>wrong-signal</h2><p>æ²¡ææ‡‚é€»è¾‘å•Š è™½è¯´çŒœåˆ°æ˜¯ä¸ªmaze ä½†æ˜¯è¿™ä¸ªsigactionå±å®æ²¡ææ‡‚<br>ç­‰æ‰¾åˆ°WP(å¸¦ç‚¹è§£æçš„â€¦)å†æ¥çœ‹å§</p>
<h2 id="SPACEGAME"><a href="#SPACEGAME" class="headerlink" title="SPACEGAME"></a>SPACEGAME</h2><p>luaé€†å‘â€¦<br>æ€è·¯å€’æ˜¯å­¦åˆ°äº† å…¨å±€hookçš„æ€æƒ³ æ‰“å°å…³é”®ä¿¡æ¯(å“ªä¸ªå‡½æ•°killäº†è¿›ç¨‹)<br>ç„¶åç»™ä»–overrideæ‰ å¼€å¯æ— æ•Œæ¨¡å¼<br>ä½†æ˜¯å¯¹luaä¸ç†Ÿæ‚‰ ä»¥åå†æ¥çœ‹å§</p>
<h1 id="ACTF2022"><a href="#ACTF2022" class="headerlink" title="ACTF2022"></a>ACTF2022</h1><h2 id="dropper"><a href="#dropper" class="headerlink" title="dropper"></a>dropper</h2><p>é€†äº†å¥½ä¹…å¥½ä¹…â€¦</p>
<p>IDAæ‰“å¼€ main<br>å°†å‡½æ•°ç¬¦å·åŒ–åé€»è¾‘æ¯”è¾ƒæ¸…æ™°</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">char</span> v6; <span class="comment">// [rsp+30h] [rbp+0h] BYREF</span></span><br><span class="line">  HMODULE ModuleHandleW; <span class="comment">// [rsp+38h] [rbp+8h]</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+58h] [rbp+28h]</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp+78h] [rbp+48h]</span></span><br><span class="line">  __int64 v10[<span class="number">3</span>]; <span class="comment">// [rsp+98h] [rbp+68h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v11; <span class="comment">// [rsp+B4h] [rbp+84h]</span></span><br><span class="line">  <span class="type">int</span> ExitCode[<span class="number">9</span>]; <span class="comment">// [rsp+D4h] [rbp+A4h] BYREF</span></span><br><span class="line">  HANDLE hHandle[<span class="number">3</span>]; <span class="comment">// [rsp+F8h] [rbp+C8h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v14[<span class="number">26</span>]; <span class="comment">// [rsp+130h] [rbp+100h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// [rsp+1B4h] [rbp+184h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3 = &amp;v6;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">106</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v3 = <span class="number">-858993460</span>;</span><br><span class="line">    v3 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_7FF6D0925100, argv, envp);</span><br><span class="line">  sub_7FF6D09013D4();</span><br><span class="line">  ModuleHandleW = GetModuleHandleW(<span class="number">0</span>i64);</span><br><span class="line">  v8 = FindResourceWqword_7FF6D091AA58(ModuleHandleW, <span class="number">101</span>i64, <span class="number">256</span>i64);<span class="comment">// åŠ è½½äº†è‡ªå¸¦resource 256</span></span><br><span class="line">  v9 = LoadResourceqword_7FF6D091AA60(ModuleHandleW, v8);</span><br><span class="line">  v10[<span class="number">0</span>] = LockResourceqword_7FF6D091AA68(v9);</span><br><span class="line">  v11 = SizeOfResourceqword_7FF6D091AA70(ModuleHandleW, v8);</span><br><span class="line">  v10[<span class="number">0</span>] = sub_7FF6D09013D9(v10[<span class="number">0</span>], v11);       <span class="comment">// ^=0x73 è§£å¯†</span></span><br><span class="line">  ExitCode[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  j_memset(hHandle, <span class="number">0</span>, <span class="keyword">sizeof</span>(hHandle));</span><br><span class="line">  j_memset(v14, <span class="number">0</span>, <span class="keyword">sizeof</span>(v14));</span><br><span class="line">  LOWORD(v15) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !(<span class="type">unsigned</span> <span class="type">int</span>)sub_7FF6D09015C3((<span class="type">int</span>)hHandle, (<span class="type">int</span>)v14, v10[<span class="number">0</span>], (<span class="type">int</span>)&amp;v15, <span class="number">2u</span>i64) )</span><br><span class="line">  &#123;</span><br><span class="line">    WaitForSingleObject(hHandle[<span class="number">0</span>], <span class="number">0xFFFFFFFF</span>);</span><br><span class="line">    GetExitCodeProcess(hHandle[<span class="number">0</span>], (LPDWORD)ExitCode);</span><br><span class="line">    CloseHandle(hHandle[<span class="number">1</span>]);</span><br><span class="line">    CloseHandle(hHandle[<span class="number">0</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  sub_7FF6D09014B0();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡ŒåŠ è½½äº†ç¨‹åºå†…çš„èµ„æº 256  ç„¶åxor 0x73è¿›è¡Œè§£å¯†<br>æ‰¾åˆ°256èµ„æºxorådumpå‡ºæ¥</p>
<p>main å‡½æ•°</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v5; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v6; <span class="comment">// r8</span></span><br><span class="line">  __int64 v7; <span class="comment">// rax</span></span><br><span class="line">  __int64 BASE64_INPUT; <span class="comment">// rax</span></span><br><span class="line">  __int64 v9; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v10; <span class="comment">// r8</span></span><br><span class="line">  __int64 v11; <span class="comment">// rax</span></span><br><span class="line">  __int64 v12; <span class="comment">// rax</span></span><br><span class="line">  __int64 v13; <span class="comment">// rax</span></span><br><span class="line">  __int64 v14; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v16; <span class="comment">// [rsp+20h] [rbp+0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v17[<span class="number">72</span>]; <span class="comment">// [rsp+28h] [rbp+8h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v18[<span class="number">2040</span>]; <span class="comment">// [rsp+70h] [rbp+50h] BYREF</span></span><br><span class="line">  <span class="type">void</span> (__fastcall ***v19)(_QWORD, __int64); <span class="comment">// [rsp+868h] [rbp+848h]</span></span><br><span class="line">  __int64 v20; <span class="comment">// [rsp+888h] [rbp+868h]</span></span><br><span class="line">  <span class="type">char</span> v21[<span class="number">3576</span>]; <span class="comment">// [rsp+8B0h] [rbp+890h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v22[<span class="number">64</span>]; <span class="comment">// [rsp+16A8h] [rbp+1688h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v23[<span class="number">64</span>]; <span class="comment">// [rsp+16E8h] [rbp+16C8h] BYREF</span></span><br><span class="line">  <span class="type">char</span> *v24; <span class="comment">// [rsp+1728h] [rbp+1708h]</span></span><br><span class="line">  <span class="type">void</span> (__fastcall ***v25)(_QWORD, _QWORD); <span class="comment">// [rsp+1748h] [rbp+1728h]</span></span><br><span class="line">  <span class="type">void</span> *v26; <span class="comment">// [rsp+1768h] [rbp+1748h]</span></span><br><span class="line">  <span class="type">char</span> v27; <span class="comment">// [rsp+1788h] [rbp+1768h] BYREF</span></span><br><span class="line">  <span class="type">char</span> *v28; <span class="comment">// [rsp+1F78h] [rbp+1F58h]</span></span><br><span class="line">  <span class="type">char</span> v29[<span class="number">64</span>]; <span class="comment">// [rsp+1F98h] [rbp+1F78h] BYREF</span></span><br><span class="line">  __int64 v30; <span class="comment">// [rsp+1FD8h] [rbp+1FB8h]</span></span><br><span class="line">  <span class="type">void</span> *v31; <span class="comment">// [rsp+1FF8h] [rbp+1FD8h]</span></span><br><span class="line">  <span class="type">char</span> v32[<span class="number">64</span>]; <span class="comment">// [rsp+2018h] [rbp+1FF8h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v33[<span class="number">64</span>]; <span class="comment">// [rsp+2058h] [rbp+2038h] BYREF</span></span><br><span class="line">  <span class="type">void</span> (__fastcall ***v34)(_QWORD, _QWORD); <span class="comment">// [rsp+2098h] [rbp+2078h]</span></span><br><span class="line">  <span class="type">int</span> v35; <span class="comment">// [rsp+20B4h] [rbp+2094h]</span></span><br><span class="line">  <span class="type">int</span> v36; <span class="comment">// [rsp+20D4h] [rbp+20B4h]</span></span><br><span class="line">  __int64 tmp_string; <span class="comment">// [rsp+20E8h] [rbp+20C8h]</span></span><br><span class="line">  __int64 v38; <span class="comment">// [rsp+20F0h] [rbp+20D0h]</span></span><br><span class="line">  <span class="type">void</span> (__fastcall ***v39)(_QWORD, _QWORD); <span class="comment">// [rsp+20F8h] [rbp+20D8h]</span></span><br><span class="line"></span><br><span class="line">  v3 = &amp;v16;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">1726</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v3 = <span class="number">0xCCCCCCCC</span>;</span><br><span class="line">    v3 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v36 = <span class="number">0</span>;</span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_7FF7ECAF60F2, argv, envp);</span><br><span class="line">  tmp_string = sub_7FF7ECAD128A((__int64)v22, (__int64)&amp;unk_7FF7ECAEE168, <span class="number">5</span>i64);</span><br><span class="line">  v38 = tmp_string;</span><br><span class="line">  sub_7FF7ECAD1735(<span class="built_in">std</span>::<span class="built_in">cout</span>, tmp_string);</span><br><span class="line">  sub_7FF7ECAD119A((__int64)v22);</span><br><span class="line">  sub_7FF7ECAD17DF((__int64)v17);</span><br><span class="line">  sub_7FF7ECAD1032(<span class="built_in">std</span>::<span class="built_in">cin</span>, v17);</span><br><span class="line">  tmp_string = STRLEN_0((__int64)v17);</span><br><span class="line">  v7 = GET_C_STR((__int64)v17, v5, v6);</span><br><span class="line">  BASE64_INPUT = sub_7FF7ECAD1320(v7, (<span class="type">unsigned</span> <span class="type">int</span>)tmp_string);<span class="comment">// base64</span></span><br><span class="line">  sub_7FF7ECAD1050((__int64)v17, BASE64_INPUT); <span class="comment">// v13=v6 ?</span></span><br><span class="line">  v24 = v23;</span><br><span class="line">  tmp_string = sub_7FF7ECAD1136((__int64)v23, (__int64)v17);</span><br><span class="line">  sub_7FF7ECAD1244(v18, tmp_string);</span><br><span class="line">  v26 = operator new(<span class="number">2016u</span>i64);</span><br><span class="line">  <span class="keyword">if</span> ( v26 )</span><br><span class="line">  &#123;</span><br><span class="line">    v28 = &amp;v27;</span><br><span class="line">    tmp_string = sub_7FF7ECAD128A((__int64)v29, (__int64)&amp;unk_7FF7ECAEF300, <span class="number">360</span>i64);</span><br><span class="line">    v38 = tmp_string;</span><br><span class="line">    v36 |= <span class="number">1u</span>;</span><br><span class="line">    v11 = GET_C_STR(tmp_string, v9, v10);</span><br><span class="line">    v12 = STRING_TO_BIGNUM((__int64)v28, v11);</span><br><span class="line">    v39 = (<span class="type">void</span> (__fastcall ***)(_QWORD, _QWORD))sub_7FF7ECAD1433((__int64)v26, v12);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v39 = <span class="number">0</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">  v25 = v39;</span><br><span class="line">  v19 = v39;</span><br><span class="line">  <span class="keyword">if</span> ( (v36 &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v36 &amp;= ~<span class="number">1u</span>;</span><br><span class="line">    sub_7FF7ECAD119A((__int64)v29);</span><br><span class="line">  &#125;</span><br><span class="line">  j_TO_CALCULATION((__int64)v19);               <span class="comment">// calcultaion</span></span><br><span class="line">  v31 = operator new(<span class="number">0x7D4</span>ui64);</span><br><span class="line">  <span class="keyword">if</span> ( v31 )</span><br><span class="line">    tmp_string = STR_COPY_0((__int64)v31, (__int64)v18);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    tmp_string = <span class="number">0</span>i64;</span><br><span class="line">  v30 = tmp_string;</span><br><span class="line">  v20 = tmp_string;</span><br><span class="line">  (**v19)(v19, tmp_string);</span><br><span class="line">  SUB(v20, (__int64)v21, (__int64)(v19 + <span class="number">1</span>));   <span class="comment">// !</span></span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)sub_7FF7ECAD1014((__int64)v21) )</span><br><span class="line">  &#123;</span><br><span class="line">    tmp_string = sub_7FF7ECAD128A((__int64)v32, (__int64)&amp;unk_7FF7ECAEF910, <span class="number">4</span>i64);</span><br><span class="line">    v38 = tmp_string;</span><br><span class="line">    v13 = sub_7FF7ECAD1735(<span class="built_in">std</span>::<span class="built_in">cout</span>, tmp_string);</span><br><span class="line">    <span class="built_in">std</span>::ostream::operator&lt;&lt;(v13, sub_7FF7ECAD105A);</span><br><span class="line">    sub_7FF7ECAD119A((__int64)v32);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    tmp_string = sub_7FF7ECAD128A((__int64)v33, (__int64)&amp;unk_7FF7ECAEF920, <span class="number">5</span>i64);</span><br><span class="line">    v38 = tmp_string;</span><br><span class="line">    v14 = sub_7FF7ECAD1735(<span class="built_in">std</span>::<span class="built_in">cout</span>, tmp_string);</span><br><span class="line">    <span class="built_in">std</span>::ostream::operator&lt;&lt;(v14, sub_7FF7ECAD105A);</span><br><span class="line">    sub_7FF7ECAD119A((__int64)v33);</span><br><span class="line">  &#125;</span><br><span class="line">  v34 = v19;</span><br><span class="line">  <span class="keyword">if</span> ( v19 )</span><br><span class="line">    tmp_string = sub_7FF7ECAD1316((__int64)v34, <span class="number">1</span>i64);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    tmp_string = <span class="number">0</span>i64;</span><br><span class="line">  v35 = <span class="number">0</span>;</span><br><span class="line">  sub_7FF7ECAD119A((__int64)v17);</span><br><span class="line">  <span class="keyword">return</span> v35;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå¾ˆè€ƒå¯ŸåŸºæœ¬åŠŸ èƒ½å¦å°†ä¸€äº›å‡½æ•°æ­£ç¡®ç¬¦å·åŒ–ä¾¿äºå®¡ä»£ç <br>STRLEN:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_7FF7ECADCEA0</span><span class="params">(__int64 a1, __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_7FF7ECAF604A, a2, a3);</span><br><span class="line">  <span class="keyword">return</span> *(_QWORD *)(a1 + <span class="number">24</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>GET_C_STR:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_7FF7ECADA8E0</span><span class="params">(__int64 a1, __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v4; <span class="comment">// [rsp+28h] [rbp+8h]</span></span><br><span class="line"></span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_7FF7ECAF604A, a2, a3);</span><br><span class="line">  v4 = a1 + <span class="number">8</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)sub_7FF7ECAD17C1(a1) )</span><br><span class="line">    <span class="keyword">return</span> sub_7FF7ECAD17FD(*(_QWORD *)(a1 + <span class="number">8</span>));</span><br><span class="line">  <span class="keyword">return</span> v4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é‡ç‚¹æ˜¯è¦è¯†åˆ«å‡ºif(v26)ä¸­çš„é‚£ä¸ªSTRING_TO_NUMï¼</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">_DWORD *__fastcall <span class="title function_">sub_7FF7ECAD6890</span><span class="params">(_DWORD *a1, <span class="type">const</span> <span class="type">char</span> *a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+A4h] [rbp+84h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+C4h] [rbp+A4h]</span></span><br><span class="line"></span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_7FF7ECAF60F2, a2, a3);</span><br><span class="line">  j_memset(a1, <span class="number">0</span>, <span class="number">0x7D0</span>ui64);</span><br><span class="line">  v7 = j_strlen(a2);</span><br><span class="line">  a1[<span class="number">500</span>] = v7 / <span class="number">4</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v7 % <span class="number">4</span> )</span><br><span class="line">    ++a1[<span class="number">500</span>];</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = v7 - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i -= <span class="number">4</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = <span class="number">0</span>;</span><br><span class="line">    v5 = i - <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span> ( i - <span class="number">3</span> &lt; <span class="number">0</span> )</span><br><span class="line">      v5 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( j = v5; j &lt;= i; ++j )</span><br><span class="line">      v4 = <span class="number">10</span> * v4 + a2[j] - <span class="number">48</span>;                <span class="comment">// char -&gt; num!!!</span></span><br><span class="line">    a1[v6++] = v4;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> a1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨sub_7FF7ECAD1433ä¸­å¯ä»¥çœ‹åˆ°æœ‰ä¸ªè™šå‡½æ•°è¡¨<br>èƒ½è·³è½¬åˆ°å…³é”®å‡½æ•°</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">_DWORD *__fastcall <span class="title function_">CALCALCAL</span><span class="params">(__int64 a1, _DWORD *a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  ...</span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  v3 = &amp;v78;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">10918</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v3 = <span class="number">-858993460</span>;</span><br><span class="line">    v3 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_7FF7ECAF60F2, a2, a3);</span><br><span class="line">  v110 = sub_7FF7ECAD128A((__int64)v90, (__int64)&amp;unk_7FF7ECAEE000, <span class="number">48</span>i64);</span><br><span class="line">  v111 = v110;</span><br><span class="line">  v7 = GET_C_STR(v110, v5, v6);</span><br><span class="line">  STRING_TO_BIGNUM((__int64)v79, v7);</span><br><span class="line">  sub_7FF7ECAD119A(v90, v8, v9);</span><br><span class="line">  v110 = sub_7FF7ECAD128A((__int64)v91, (__int64)&amp;unk_7FF7ECAEE0C0, <span class="number">42</span>i64);</span><br><span class="line">  v111 = v110;</span><br><span class="line">  v12 = GET_C_STR(v110, v10, v11);</span><br><span class="line">  STRING_TO_BIGNUM((__int64)v80, v12);</span><br><span class="line">  sub_7FF7ECAD119A(v91, v13, v14);</span><br><span class="line">  v110 = sub_7FF7ECAD128A((__int64)v92, (__int64)&amp;unk_7FF7ECAEE180, <span class="number">42</span>i64);</span><br><span class="line">  v111 = v110;</span><br><span class="line">  v17 = GET_C_STR(v110, v15, v16);</span><br><span class="line">  STRING_TO_BIGNUM((__int64)v81, v17);</span><br><span class="line">  sub_7FF7ECAD119A(v92, v18, v19);</span><br><span class="line">  v110 = sub_7FF7ECAD128A((__int64)v93, (__int64)&amp;unk_7FF7ECAEE230, <span class="number">36</span>i64);</span><br><span class="line">  v111 = v110;</span><br><span class="line">  v22 = GET_C_STR(v110, v20, v21);</span><br><span class="line">  STRING_TO_BIGNUM((__int64)v82, v22);</span><br><span class="line">  sub_7FF7ECAD119A(v93, v23, v24);</span><br><span class="line">  v110 = sub_7FF7ECAD128A((__int64)v94, (__int64)&amp;unk_7FF7ECAEE2C0, <span class="number">42</span>i64);</span><br><span class="line">  v111 = v110;</span><br><span class="line">  v27 = GET_C_STR(v110, v25, v26);</span><br><span class="line">  STRING_TO_BIGNUM((__int64)v83, v27);</span><br><span class="line">  sub_7FF7ECAD119A(v94, v28, v29);</span><br><span class="line">  v110 = sub_7FF7ECAD128A((__int64)v95, (__int64)&amp;unk_7FF7ECAEE370, <span class="number">36</span>i64);</span><br><span class="line">  v111 = v110;</span><br><span class="line">  v32 = GET_C_STR(v110, v30, v31);</span><br><span class="line">  STRING_TO_BIGNUM((__int64)v84, v32);</span><br><span class="line">  sub_7FF7ECAD119A(v95, v33, v34);</span><br><span class="line">  v110 = sub_7FF7ECAD128A((__int64)v96, (__int64)&amp;unk_7FF7ECAEE400, <span class="number">36</span>i64);</span><br><span class="line">  v111 = v110;</span><br><span class="line">  v37 = GET_C_STR(v110, v35, v36);</span><br><span class="line">  STRING_TO_BIGNUM((__int64)v85, v37);</span><br><span class="line">  sub_7FF7ECAD119A(v96, v38, v39);</span><br><span class="line">  v110 = sub_7FF7ECAD128A((__int64)v97, (__int64)&amp;unk_7FF7ECAEE490, <span class="number">36</span>i64);</span><br><span class="line">  v111 = v110;</span><br><span class="line">  v42 = GET_C_STR(v110, v40, v41);</span><br><span class="line">  STRING_TO_BIGNUM((__int64)v86, v42);</span><br><span class="line">  sub_7FF7ECAD119A(v97, v43, v44);</span><br><span class="line">  v110 = sub_7FF7ECAD128A((__int64)v98, (__int64)&amp;unk_7FF7ECAEE520, <span class="number">42</span>i64);</span><br><span class="line">  v111 = v110;</span><br><span class="line">  v47 = GET_C_STR(v110, v45, v46);</span><br><span class="line">  STRING_TO_BIGNUM((__int64)v87, v47);</span><br><span class="line">  sub_7FF7ECAD119A(v98, v48, v49);</span><br><span class="line">  v110 = sub_7FF7ECAD128A((__int64)v99, (__int64)&amp;unk_7FF7ECAEE5D0, <span class="number">42</span>i64);</span><br><span class="line">  v111 = v110;</span><br><span class="line">  v52 = GET_C_STR(v110, v50, v51);</span><br><span class="line">  STRING_TO_BIGNUM((__int64)v88, v52);</span><br><span class="line">  sub_7FF7ECAD119A(v99, v53, v54);</span><br><span class="line">  STR_COPY_0(v89, (__int64)a2, v55);</span><br><span class="line">  v56 = j_ADD((__int64)v89, (__int64)v100, (__int64)v79);</span><br><span class="line">  STR_COPY(v89, v56, v57);</span><br><span class="line">  v58 = j_MUL((__int64)v89, (__int64)v101, (__int64)v80);</span><br><span class="line">  STR_COPY(v89, v58, v59);</span><br><span class="line">  v60 = SUB((__int64)v89, (__int64)v102, (__int64)v81);</span><br><span class="line">  STR_COPY(v89, v60, v61);</span><br><span class="line">  v62 = j_ADD((__int64)v89, (__int64)v103, (__int64)v82);</span><br><span class="line">  STR_COPY(v89, v62, v63);</span><br><span class="line">  v64 = j_MUL((__int64)v89, (__int64)v104, (__int64)v83);</span><br><span class="line">  STR_COPY(v89, v64, v65);</span><br><span class="line">  v66 = SUB((__int64)v89, (__int64)v105, (__int64)v84);</span><br><span class="line">  STR_COPY(v89, v66, v67);</span><br><span class="line">  v68 = j_ADD((__int64)v89, (__int64)v106, (__int64)v85);</span><br><span class="line">  STR_COPY(v89, v68, v69);</span><br><span class="line">  v70 = SUB((__int64)v89, (__int64)v107, (__int64)v86);</span><br><span class="line">  STR_COPY(v89, v70, v71);</span><br><span class="line">  v72 = j_ADD((__int64)v89, (__int64)v108, (__int64)v87);</span><br><span class="line">  STR_COPY(v89, v72, v73);</span><br><span class="line">  v74 = SUB((__int64)v89, (__int64)v109, (__int64)v88);</span><br><span class="line">  STR_COPY(v89, v74, v75);</span><br><span class="line">  <span class="keyword">return</span> STR_COPY(a2, (__int64)v89, v76);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œé€šè¿‡å‰é¢åˆ†æå¾—åˆ°çš„SRTING_TO_NUMç­‰å‡½æ•°å¯ä»¥çŸ¥é“è¿™é‡Œæ˜¯ä»¥ä¸‡è¿›åˆ¶åœ¨åšå¤§æ•°è¿ç®—</p>
<p>ADD</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">ADD</span><span class="params">(__int64 a1, __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">char</span> v6; <span class="comment">// [rsp+20h] [rbp+0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v7[<span class="number">500</span>]; <span class="comment">// [rsp+30h] [rbp+10h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [rsp+800h] [rbp+7E0h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+824h] [rbp+804h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+844h] [rbp+824h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+C14h] [rbp+BF4h]</span></span><br><span class="line"></span><br><span class="line">  v3 = &amp;v6;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">530</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v3 = <span class="number">-858993460</span>;</span><br><span class="line">    v3 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_7FF7ECAF60F2, a2, a3);</span><br><span class="line">  STR_COPY_0((__int64)v7, a1);</span><br><span class="line">  <span class="keyword">if</span> ( *(_DWORD *)(a3 + <span class="number">2000</span>) &lt;= *(_DWORD *)(a1 + <span class="number">2000</span>) )</span><br><span class="line">    v11 = *(_DWORD *)(a1 + <span class="number">2000</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v11 = *(_DWORD *)(a3 + <span class="number">2000</span>);</span><br><span class="line">  v10 = v11;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; v10; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v7[j] += *(_DWORD *)(a3 + <span class="number">4</span>i64 * j);</span><br><span class="line">    <span class="keyword">if</span> ( v7[j] &gt; <span class="number">9999</span> )                         <span class="comment">// è¿›ä½</span></span><br><span class="line">    &#123;</span><br><span class="line">      ++v7[j + <span class="number">1</span>];</span><br><span class="line">      v7[j] -= <span class="number">10000</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v7[v10] )</span><br><span class="line">    v8 = v10 + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v8 = v10;</span><br><span class="line">  STR_COPY_0(a2, (__int64)v7);</span><br><span class="line">  <span class="keyword">return</span> a2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>MUL:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">MUL</span><span class="params">(__int64 a1, __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">char</span> v6; <span class="comment">// [rsp+20h] [rbp+0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v7[<span class="number">500</span>]; <span class="comment">// [rsp+30h] [rbp+10h] BYREF</span></span><br><span class="line">  <span class="type">int</span> m; <span class="comment">// [rsp+800h] [rbp+7E0h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+824h] [rbp+804h]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+844h] [rbp+824h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+864h] [rbp+844h]</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [rsp+884h] [rbp+864h]</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// [rsp+8A4h] [rbp+884h]</span></span><br><span class="line">  <span class="type">char</span> v14; <span class="comment">// [rsp+C84h] [rbp+C64h]</span></span><br><span class="line"></span><br><span class="line">  v3 = &amp;v6;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">562</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v3 = <span class="number">-858993460</span>;</span><br><span class="line">    v3 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v14 = <span class="number">0</span>;</span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_7FF7ECAF60F2, a2, a3);</span><br><span class="line">  sub_7FF7ECAD14B5((__int64)v7);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; *(_DWORD *)(a1 + <span class="number">2000</span>); ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v11 = <span class="number">0</span>;</span><br><span class="line">    v14 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; *(_DWORD *)(a3 + <span class="number">2000</span>); ++k )</span><br><span class="line">    &#123;</span><br><span class="line">      v12 = v11 + v7[k + j] + *(_DWORD *)(a3 + <span class="number">4</span>i64 * k) * *(_DWORD *)(a1 + <span class="number">4</span>i64 * j);</span><br><span class="line">      <span class="keyword">if</span> ( v12 &lt;= <span class="number">9999</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v11 = <span class="number">0</span>;</span><br><span class="line">        v7[k + j] = v12;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        v13 = v12 % <span class="number">10000</span>;</span><br><span class="line">        v11 = v12 / <span class="number">10000</span>;</span><br><span class="line">        v7[k + j] = v12 % <span class="number">10000</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      v14 = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v11 )</span><br><span class="line">      v7[k + j] = v11;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( m = k + j; !v7[m - <span class="number">1</span>] &amp;&amp; m &gt; <span class="number">1</span>; --m )</span><br><span class="line">    ;</span><br><span class="line">  STR_COPY_0(a2, (__int64)v7);</span><br><span class="line">  <span class="keyword">return</span> a2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>SUB:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_7FF7ECAD8500</span><span class="params">(__int64 a1, __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">char</span> v6; <span class="comment">// [rsp+20h] [rbp+0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">char</span> v10; <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line">  <span class="type">int</span> v11[<span class="number">500</span>]; <span class="comment">// [rsp+B0h] [rbp+90h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [rsp+880h] [rbp+860h]</span></span><br><span class="line">  <span class="type">int</span> v13[<span class="number">890</span>]; <span class="comment">// [rsp+8B0h] [rbp+890h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3 = &amp;v6;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">1058</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v3 = <span class="number">-858993460</span>;</span><br><span class="line">    v3 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_7FF7ECAF60F2, a2, a3);</span><br><span class="line">  sub_7FF7ECAD14B5((__int64)v11);</span><br><span class="line">  sub_7FF7ECAD14B5((__int64)v13);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)sub_7FF7ECAD140B(a1, a3) )</span><br><span class="line">  &#123;</span><br><span class="line">    STR_COPY((__int64)v11, a1);</span><br><span class="line">    STR_COPY((__int64)v13, a3);</span><br><span class="line">    v10 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    STR_COPY((__int64)v11, a3);</span><br><span class="line">    STR_COPY((__int64)v13, a1);</span><br><span class="line">    v10 = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v9 = v12;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; v9; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v11[j] &gt;= v13[j] )</span><br><span class="line">    &#123;</span><br><span class="line">      v11[j] -= v13[j];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( k = j + <span class="number">1</span>; !v11[k]; ++k )</span><br><span class="line">        ;</span><br><span class="line">      --v11[k--];</span><br><span class="line">      <span class="keyword">while</span> ( k &gt; j )</span><br><span class="line">        v11[k--] += <span class="number">9999</span>;</span><br><span class="line">      v11[j] += <span class="number">10000</span> - v13[j];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  v12 = v9;</span><br><span class="line">  <span class="keyword">while</span> ( !v11[v12 - <span class="number">1</span>] &amp;&amp; v12 &gt; <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    --v12;</span><br><span class="line">    --v9;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v10 )</span><br><span class="line">    v11[v9 - <span class="number">1</span>] = -v11[v9 - <span class="number">1</span>];</span><br><span class="line">  STR_COPY_0(a2, (__int64)v11);</span><br><span class="line">  <span class="keyword">return</span> a2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¬¦å·åŒ–å‡½æ•°åä¼šå‘ç°92è¡Œåˆè°ƒç”¨äº†SUB è€Œä¸”å‚æ•°æ˜¯v19å’Œv21<br>ç»“åˆåé¢ç´§è·Ÿç€çš„sub_7FF7ECAD1014å‡½æ•°å‘ç°æ˜¯ä¸€ä¸ªcheckå‡½æ•° æ£€æŸ¥å€¼æ˜¯å¦ä¸º0<br>é‚£ä¹ˆå‰é¢çš„SUBçš„å€¼å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„æœ€ç»ˆå€¼<br>æœ€ååŠ¨è°ƒæŠŠéœ€è¦çš„å¤§æ•´æ•°å€¼å…¨éƒ¨æå–å‡ºæ¥ æŒ‰ç…§åˆå§‹ <code>+*-+*-+*-+-+-</code> çš„é€†åºé€†å›å»<br>å°±èƒ½å¾—åˆ°inputbase64å¤„ç†åçš„å€¼<br>æ³¨æ„åˆ°æœ€åcheckå¤„ v20-&gt;tmp_string-&gt;v18 æ‰¾åˆ°v18å‡ºç°çš„åœ°æ–¹ <code> sub_7FF7ECAD1244(v18, tmp_string);</code><br>æŸ¥çœ‹è¿™ä¸ªå‡½æ•°</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_7FF7ECADBC50</span><span class="params">(__int64 a1, __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> *v6; <span class="comment">// rax</span></span><br><span class="line">  __int64 v7; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v9; <span class="comment">// [rsp+20h] [rbp+0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v10[<span class="number">2036</span>]; <span class="comment">// [rsp+30h] [rbp+10h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v11[<span class="number">11</span>]; <span class="comment">// [rsp+824h] [rbp+804h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v12[<span class="number">2048</span>]; <span class="comment">// [rsp+850h] [rbp+830h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v13[<span class="number">2048</span>]; <span class="comment">// [rsp+1050h] [rbp+1030h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v14[<span class="number">2048</span>]; <span class="comment">// [rsp+1850h] [rbp+1830h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v15[<span class="number">3584</span>]; <span class="comment">// [rsp+2050h] [rbp+2030h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v16[<span class="number">2024</span>]; <span class="comment">// [rsp+2E50h] [rbp+2E30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v17; <span class="comment">// [rsp+3638h] [rbp+3618h]</span></span><br><span class="line"></span><br><span class="line">  v3 = &amp;v9;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">3086</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v3 = <span class="number">-858993460</span>;</span><br><span class="line">    v3 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_7FF7ECAF60F2, a2, a3);</span><br><span class="line">  sub_7FF7ECAD14B5((__int64)v10);</span><br><span class="line">  <span class="keyword">for</span> ( v11[<span class="number">0</span>] = <span class="number">0</span>; ; ++v11[<span class="number">0</span>] )                <span class="comment">// å¯¹base64inputè½¬æ¢</span></span><br><span class="line">  &#123;</span><br><span class="line">    v17 = v11[<span class="number">0</span>];</span><br><span class="line">    v5 = STRLEN_0(a2);</span><br><span class="line">    <span class="keyword">if</span> ( v17 &gt;= v5 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    sub_7FF7ECAD16E5(v12, <span class="number">128</span>i64);              <span class="comment">// 128ï¼š asciiç </span></span><br><span class="line">    sub_7FF7ECAD1578(v12, v13, v11);</span><br><span class="line">    v6 = (<span class="type">char</span> *)sub_7FF7ECAD1118(a2, v11[<span class="number">0</span>]);</span><br><span class="line">    sub_7FF7ECAD16E5(v14, (<span class="type">unsigned</span> <span class="type">int</span>)*v6);</span><br><span class="line">    j_MUL(v14, v15, v13);</span><br><span class="line">    v7 = j_ADD(v10, v16, v15);</span><br><span class="line">    STR_COPY((__int64)v10, v7);</span><br><span class="line">  &#125;</span><br><span class="line">  STR_COPY_0(a1, (__int64)v10);</span><br><span class="line">  sub_7FF7ECAD119A(a2);</span><br><span class="line">  <span class="keyword">return</span> a1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶å®å°±æ˜¯å°†base64inputçš„æ¯ä¸ªASCIIç ä»¥128è¿›åˆ¶å˜æˆå¤§æ•´æ•°</p>
<p>æ‰€ä»¥æœ€åå¾—åˆ°çš„å¤§æ•´æ•°é™¤128å–ä½™å°±èƒ½å¾—åˆ°base64input</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">keys = [<span class="number">0</span>,</span><br><span class="line">        <span class="number">64584540291872516627894939590684951703479643371381420434698676192916126802789388</span>,</span><br><span class="line">        <span class="number">11783410410469738048283152171898507679537812634841032055361622989575562121323526</span>,</span><br><span class="line">        <span class="number">55440851777679184418972581091796582321001517732868509947716453414109025036506793</span>,</span><br><span class="line">        <span class="number">17867047589171477574847737912328753108849304549280205992204587760361310317983607</span>,</span><br><span class="line">        <span class="number">7537302706582391238853817483600228733479333152488218477840149847189049516952787</span>,</span><br><span class="line">        <span class="number">80793226935699295824618519685638809874579343342564712419235587177713165502121664</span>,</span><br><span class="line">        <span class="number">14385283226689171523445844388769467232023411467394422980403729848631619308579599</span>,</span><br><span class="line">        <span class="number">55079029772840138145785005601340325789675668817561045403173659223377346727295749</span>,</span><br><span class="line">        <span class="number">71119332457202863671922045224905384620742912949065190274173724688764272313900465</span>,</span><br><span class="line">        <span class="number">57705573952449699620072104055030025886984180500734382250587152417040141679598894</span>]</span><br><span class="line">key11 = <span class="number">834572051814337070469744559761199605121805728622619480039894407167152612470842477813941120780374570205930952883661000998715107231695919001238818879944773516507366865633886966330912156402063735306303966193481658066437563587241718036562480496368592194719092339868512773222711600878782903109949779245500098606570248830570792028831133949440164219842871034275938433</span></span><br><span class="line">t = <span class="number">0</span></span><br><span class="line">t += key11</span><br><span class="line">t += keys[<span class="number">10</span>]</span><br><span class="line">t -= keys[<span class="number">9</span>]</span><br><span class="line">t += keys[<span class="number">8</span>]</span><br><span class="line">t -= keys[<span class="number">7</span>]</span><br><span class="line">t += keys[<span class="number">6</span>]</span><br><span class="line">t //= keys[<span class="number">5</span>]</span><br><span class="line">t -= keys[<span class="number">4</span>]</span><br><span class="line">t += keys[<span class="number">3</span>]</span><br><span class="line">t //= keys[<span class="number">2</span>]</span><br><span class="line">t -= keys[<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"><span class="keyword">while</span> t%<span class="number">128</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(t%<span class="number">128</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    t//=<span class="number">128</span></span><br><span class="line"><span class="comment"># QUNURntkcjBwcDNyXzFzX3YzcnlfaW50M3Izc3QxbmdfMWQ3YTkwYTYzMDM5ODMxYzdmY2FhNTNiNzY2ZDViMmQhISEhIX0=</span></span><br><span class="line"><span class="comment"># ACTF&#123;dr0pp3r_1s_v3ry_int3r3st1ng_1d7a90a63039831c7fcaa53b766d5b2d!!!!!&#125;</span></span><br></pre></td></tr></table></figure>

<hr>
<hr>
<p>çœŸå°±ACTFçš„easyéš¾åº¦(æŒ‡31solves)ã€‚ã€‚ã€‚ orz<br>æ°´å¹³è¿˜å·®å¾ˆå¤š è¿˜å¾—ç»§ç»­å­¦</p>
<h1 id="NewStarCTF2023-Week5"><a href="#NewStarCTF2023-Week5" class="headerlink" title="NewStarCTF2023 Week5"></a>NewStarCTF2023 Week5</h1><p>è¿™å°±æ˜¯ â€œ<strong>æ–°ç”Ÿèµ›</strong>â€œ éš¾åº¦å—??? ã€‚ã€‚ã€‚</p>
<h2 id="Fish"><a href="#Fish" class="headerlink" title="Fish"></a>Fish</h2><p>éš”äº†å¥½ä¹…å†æ¥çœ‹ç†Ÿç»ƒå¤šäº†<br>IDAæ‰“å¼€ mainå•¥éƒ½æ²¡æœ‰<br>çœ‹æ±‡ç¼–<br>å¤§é‡çš„è¿™ç§ç±»å‹çš„èŠ±æŒ‡ä»¤</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">0000000000401</span>A12                 jz      <span class="type">short</span> near ptr loc_401A16+<span class="number">1</span></span><br><span class="line">.text:<span class="number">0000000000401</span>A14                 jnz     <span class="type">short</span> near ptr loc_401A16+<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>ä»¥å‰æˆ‘çš„åšæ³•æ˜¯å°†è¿™ä¸¤ä¸ªå…¨éƒ¨patchæ‰ ä½†è¿™ç§åªé€‚ç”¨äºä¸€ä¸¤ä¸ªè¿™ç§â€çš„æƒ…å†µ<br>å¦‚æœæœ‰å¾ˆå¤šçš„è¯è¿™ç§patchä¼šå½±å“åˆ°IDAå¯¹åç»­è¯­å¥çš„è¯†åˆ« æ¯”å¦‚è¿™é¢˜å¦‚æœè¿™ä¹ˆpatché‚£ä¹ˆå…³é”®å¸¸é‡å°±æ‰¾ä¸åˆ°äº†<br>æ­£ç¡®åšæ³•æ˜¯å°†jnzåçš„é‚£ä¸ªæŒ‡ä»¤å­—èŠ‚patchä¸ºnop(90)<br>ä¸ºäº†æ–¹ä¾¿æ‰¹é‡åŒ–æ“ä½œ generalæ‰“å¼€æ“ä½œç æ˜¾ç¤º</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">0000000000401</span>A12 <span class="number">74</span> <span class="number">03</span>                                   jz      <span class="type">short</span> near ptr loc_401A16+<span class="number">1</span></span><br><span class="line">.text:<span class="number">0000000000401</span>A14 <span class="number">75</span> <span class="number">01</span>                                   jnz     <span class="type">short</span> near ptr loc_401A16+<span class="number">1</span></span><br><span class="line">.text:<span class="number">0000000000401</span>A16</span><br></pre></td></tr></table></figure>

<p>å½“æˆ‘ä»¬è¯†åˆ«åˆ° 74 75 åå°†ä¹‹åçš„ä½ç½®è®¾ä¸º90å³å¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">start = <span class="number">0x4019FC</span></span><br><span class="line">end = <span class="number">0x401AD8</span></span><br><span class="line"><span class="keyword">while</span> start&lt;end:</span><br><span class="line">    <span class="keyword">if</span>((get_wide_byte(start)==<span class="number">0x74</span>) <span class="keyword">and</span> (get_wide_byte(start+<span class="number">2</span>)==<span class="number">0x75</span>)):</span><br><span class="line">        ida_bytes.patch_byte(start+<span class="number">4</span>,<span class="number">0x90</span>)</span><br><span class="line">    start += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] OK !&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·patchåå†å°†mainå…¨éƒ¨é€‰ä¸­æŒ‰C Forceä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°æ­£å¸¸çš„æºç äº†<br>è¿™æ ·çš„è¯æ±‡ç¼–å¤§è‡´æ˜¯è¿™ç§å½¢å¼</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">0000000000401</span>A17                                                                 ; sub_4019FE+<span class="number">16</span>â†‘j</span><br><span class="line">.text:<span class="number">0000000000401</span>A17 <span class="number">48</span> B8 <span class="number">4</span>E <span class="number">65</span> <span class="number">77</span> <span class="number">53</span> <span class="number">74</span> <span class="number">61</span>                 mov     rax, <span class="number">7261745377654</span>Eh</span><br><span class="line">.text:<span class="number">0000000000401</span>A17 <span class="number">72</span> <span class="number">00</span></span><br><span class="line">.text:<span class="number">0000000000401</span>A21 <span class="number">48</span> <span class="number">89</span> <span class="number">45</span> <span class="number">10</span>                             mov     [rbp+<span class="number">30</span>h+var_20], rax</span><br><span class="line">.text:<span class="number">0000000000401</span>A25 <span class="number">74</span> <span class="number">03</span>                                   jz      <span class="type">short</span> loc_401A2A</span><br><span class="line">.text:<span class="number">0000000000401</span>A27 <span class="number">75</span> <span class="number">01</span>                                   jnz     <span class="type">short</span> loc_401A2A</span><br><span class="line">.text:<span class="number">0000000000401</span>A29 <span class="number">90</span>                                      nop</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œmov rax â€¦ è¿™é‡Œçš„å€¼å°±æ˜¯ <code>NewStar</code> è¿™æ˜¯æœ€åˆpatchä¼šå½±å“åˆ°çš„è¯­å¥å—ï¼<br>ç„¶åmainæ˜¯è¿™ä¸ªæ ·å­</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// positive sp value has been detected, the output may be wrong!</span></span><br><span class="line">__int64 __fastcall <span class="title function_">sub_4019FE</span><span class="params">(__int64 a1, __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> Str1[<span class="number">96</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+80h] [rbp+0h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+84h] [rbp+4h] BYREF</span></span><br><span class="line">  __int64 v7[<span class="number">4</span>]; <span class="comment">// [rsp+90h] [rbp+10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_402660(a1, a2, a3);</span><br><span class="line">  v7[<span class="number">0</span>] = <span class="number">0x7261745377654E</span>i64;</span><br><span class="line">  <span class="built_in">memset</span>(Str1, <span class="number">0</span>, <span class="keyword">sizeof</span>(Str1));</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  sub_401951(<span class="number">0</span>i64, &amp;v6);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, Str1);</span><br><span class="line">  sub_4016C1(v7);</span><br><span class="line">  ((<span class="type">void</span> (__fastcall *)(<span class="type">char</span> *))sub_40188B)(Str1);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(Str1, &amp;Str2) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;WOW!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;I believe you can do it!&quot;</span>);</span><br><span class="line">  system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”¨FindCryptæ’ä»¶Ctrl+Fä¸€çœ‹å‘ç°æ˜¯BlowFishåŠ å¯†<br>åœ¨strcmpé‚£å„¿å¯ä»¥æ‹¿åˆ°checkå€¼ keyçŒœæµ‹æ˜¯ â€œNewStarâ€<br>æ‰¾ä¸ª<a href="https://www.lddgo.net/encrypt/blowfish" target="_blank">åœ¨çº¿ç½‘ç«™</a>è§£å°±å®Œäº†<br>æ³¨æ„é€‰æ‹© nopadding</p>
<p>flag : flag{YouGotit!!Yougoit!!!!TheFifthPZGALAXYLEVEL}</p>
<p>å…¶å®æœ€åå‘ç°å¯ä»¥å°†æ•´ä¸ªç¨‹åºæŒ‰ç…§è¿™ç§patchå¤„ç†åForceä¸€ä¸‹èƒ½çœ‹åˆ°å®Œæ•´ç¨‹åºæµ<br>MAIN</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">MAIN</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> Str1[<span class="number">96</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+80h] [rbp+0h]</span></span><br><span class="line">  __int64 v6[<span class="number">4</span>]; <span class="comment">// [rsp+90h] [rbp+10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_402660(argc, argv, envp);</span><br><span class="line">  v6[<span class="number">0</span>] = <span class="number">0x7261745377654E</span>i64;</span><br><span class="line">  <span class="built_in">memset</span>(Str1, <span class="number">0</span>, <span class="keyword">sizeof</span>(Str1));</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  sub_401951();</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, Str1);</span><br><span class="line">  sub_4016C1((<span class="type">const</span> <span class="type">char</span> *)v6);</span><br><span class="line">  sub_40188B(Str1);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(Str1, (<span class="type">const</span> <span class="type">char</span> *)&amp;loc_40403F + <span class="number">1</span>) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;WOW!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;I believe you can do it!&quot;</span>);</span><br><span class="line">  system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sub_4016C1 åº”è¯¥å°±æ˜¯æ ¹æ®NewStaræ¥ç”Ÿæˆåç»­å¯†é’¥</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *__fastcall <span class="title function_">sub_4016C1</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// [rsp+24h] [rbp-1Ch] BYREF</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [rsp+28h] [rbp-18h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+2Ch] [rbp-14h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+34h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+3Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  result = (<span class="type">char</span> *)<span class="built_in">strlen</span>(a1);</span><br><span class="line">  v4 = (<span class="type">int</span>)result;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  j = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( j &lt;= <span class="number">17</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = (v5 &lt;&lt; <span class="number">8</span>) | (<span class="type">unsigned</span> __int8)a1[v6];</span><br><span class="line">      v6 = (v6 + <span class="number">1</span>) % v4;</span><br><span class="line">    &#125;</span><br><span class="line">    result = (<span class="type">char</span> *)&amp;loc_40407F + <span class="number">1</span>;</span><br><span class="line">    *(_DWORD *)((<span class="type">char</span> *)&amp;loc_40407F + <span class="number">4</span> * j++ + <span class="number">1</span>) ^= v5;</span><br><span class="line">  &#125;</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">17</span>; j += <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_4015DE(&amp;v3, &amp;v2);</span><br><span class="line">    *(_DWORD *)((<span class="type">char</span> *)&amp;loc_40407F + <span class="number">4</span> * j + <span class="number">1</span>) = v3;</span><br><span class="line">    result = (<span class="type">char</span> *)&amp;loc_40407F + <span class="number">1</span>;</span><br><span class="line">    *(_DWORD *)((<span class="type">char</span> *)&amp;loc_40407F + <span class="number">4</span> * j + <span class="number">5</span>) = v2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">3</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">255</span>; i += <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_4015DE(&amp;v3, &amp;v2);</span><br><span class="line">      *(_DWORD *)((<span class="type">char</span> *)&amp;loc_4040FF + <span class="number">1024</span> * (__int64)j + <span class="number">4</span> * i + <span class="number">1</span>) = v3;</span><br><span class="line">      result = (<span class="type">char</span> *)&amp;loc_4040FF + <span class="number">1</span>;</span><br><span class="line">      *(_DWORD *)((<span class="type">char</span> *)&amp;loc_4040FF + <span class="number">1024</span> * (__int64)j + <span class="number">4</span> * i + <span class="number">5</span>) = v2;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sub_40188B æ ‡å‡†BlowFishåŠ å¯†</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_40188B</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  _DWORD *v1; <span class="comment">// rbx</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// [rsp+24h] [rbp-5Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// [rsp+28h] [rbp-58h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+2Ch] [rbp-54h]</span></span><br><span class="line">  <span class="type">char</span> *v6; <span class="comment">// [rsp+30h] [rbp-50h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+3Ch] [rbp-44h]</span></span><br><span class="line"></span><br><span class="line">  v5 = <span class="built_in">strlen</span>(a1) / <span class="number">8</span>;</span><br><span class="line">  v6 = (<span class="type">char</span> *)a1;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">int</span>)i &gt;= v5 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v4 = sub_403000(*(<span class="type">unsigned</span> <span class="type">int</span> *)v6);</span><br><span class="line">    v3 = sub_403000(*((<span class="type">unsigned</span> <span class="type">int</span> *)v6 + <span class="number">1</span>));</span><br><span class="line">    sub_4015DE(&amp;v4, &amp;v3);</span><br><span class="line">    *(_DWORD *)v6 = sub_403000(v4);</span><br><span class="line">    v1 = v6 + <span class="number">4</span>;</span><br><span class="line">    *v1 = sub_403000(v3);</span><br><span class="line">    v6 += <span class="number">8</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨sub_4015DEä¸­å¯ä»¥çœ‹åˆ°BlowFishçš„å¸¸é‡ 0x9216D5D9 å’Œ 0x8979FB1B(dword_4040C4)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> *__fastcall <span class="title function_">sub_4015DE</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a1, <span class="type">unsigned</span> <span class="type">int</span> *a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> *result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+2Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    *a1 ^= *(_DWORD *)((<span class="type">char</span> *)&amp;loc_40407F + <span class="number">4</span> * i + <span class="number">1</span>);</span><br><span class="line">    *a2 ^= sub_401530(*a1);</span><br><span class="line">    v3 = *a1;</span><br><span class="line">    *a1 = *a2;</span><br><span class="line">    *a2 = v3;</span><br><span class="line">  &#125;</span><br><span class="line">  v4 = *a1;</span><br><span class="line">  *a1 = *a2;</span><br><span class="line">  *a2 = v4;</span><br><span class="line">  *a2 ^= <span class="number">0x9216D5D9</span>;</span><br><span class="line">  result = a1;</span><br><span class="line">  *a1 ^= dword_4040C4;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Genshin"><a href="#Genshin" class="headerlink" title="Genshin"></a>Genshin</h2><p>è€ƒå¯Ÿçš„æ˜¯erlang beamæ–‡ä»¶é€†å‘<br>å…ˆä¸‹è½½å¥½erlangç¼–è¯‘å™¨å·¥å…·<br>ç„¶åé€šè¿‡è¿™ç§æ–¹å¼(æœäº†ä¸€åœˆä¹Ÿä¸çŸ¥é“æ€ä¹ˆæ‰¾åˆ°è¿™æ¡åæ±‡ç¼–å‘½ä»¤çš„â€¦)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">io:format(<span class="string">&quot;~p~n&quot;</span>,[beam_disasm:file(<span class="string">&quot;genshin.beam&quot;</span>)]).</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ç»“å°¾è¦æœ‰â€™.â€™ !!!<br>å¯ä»¥å¾—åˆ°æ–‡ä»¶çš„å­—èŠ‚ç </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">&#123;beam_file,genshin,</span><br><span class="line">    [&#123;main,<span class="number">1</span>,<span class="number">2</span>&#125;,&#123;module_info,<span class="number">0</span>,<span class="number">11</span>&#125;,&#123;module_info,<span class="number">1</span>,<span class="number">13</span>&#125;],</span><br><span class="line">    [&#123;vsn,[<span class="number">294325075297162417208450880208266398775</span>]&#125;],</span><br><span class="line">    [&#123;version,<span class="string">&quot;8.3.1&quot;</span>&#125;,</span><br><span class="line">     &#123;options,[]&#125;,</span><br><span class="line">     &#123;source,</span><br><span class="line">         [<span class="number">47</span>,<span class="number">109</span>,<span class="number">110</span>,<span class="number">116</span>,<span class="number">47</span>,<span class="number">100</span>,<span class="number">47</span>,<span class="number">67</span>,<span class="number">84</span>,<span class="number">70</span>,<span class="number">47</span>,<span class="number">20986</span>,<span class="number">39064</span>,<span class="number">47</span>,<span class="number">50</span>,<span class="number">48</span>,<span class="number">50</span>,<span class="number">51</span>,<span class="number">45</span>,</span><br><span class="line">          <span class="number">56</span>,<span class="number">45</span>,<span class="number">100</span>,<span class="number">117</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">101</span>,<span class="number">105</span>,<span class="number">115</span>,<span class="number">97</span>,<span class="number">105</span>,<span class="number">47</span>,<span class="number">103</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">115</span>,<span class="number">104</span>,<span class="number">105</span>,</span><br><span class="line">          <span class="number">110</span>,<span class="number">46</span>,<span class="number">101</span>,<span class="number">114</span>,<span class="number">108</span>]&#125;],</span><br><span class="line">    [&#123;function,main,<span class="number">1</span>,<span class="number">2</span>,</span><br><span class="line">         [&#123;label,<span class="number">1</span>&#125;,</span><br><span class="line">          &#123;line,<span class="number">1</span>&#125;,</span><br><span class="line">          &#123;func_info,&#123;atom,genshin&#125;,&#123;atom,main&#125;,<span class="number">1</span>&#125;,</span><br><span class="line">          &#123;label,<span class="number">2</span>&#125;,</span><br><span class="line">          &#123;test,is_nonempty_list,&#123;f,<span class="number">3</span>&#125;,[&#123;x,<span class="number">0</span>&#125;]&#125;,</span><br><span class="line">          &#123;get_list,&#123;x,<span class="number">0</span>&#125;,&#123;x,<span class="number">1</span>&#125;,&#123;x,<span class="number">0</span>&#125;&#125;,</span><br><span class="line">          &#123;test,is_nil,&#123;f,<span class="number">3</span>&#125;,[&#123;x,<span class="number">0</span>&#125;]&#125;,</span><br><span class="line">          &#123;move,&#123;x,<span class="number">1</span>&#125;,&#123;x,<span class="number">0</span>&#125;&#125;,</span><br><span class="line">          &#123;call_only,<span class="number">1</span>,&#123;genshin,check,<span class="number">1</span>&#125;&#125;,</span><br><span class="line">          &#123;label,<span class="number">3</span>&#125;,</span><br><span class="line">          &#123;move,</span><br><span class="line">              &#123;literal,<span class="string">&quot;Usage: xxxxxxxx genshin.beam &lt;input_string&gt;~n&quot;</span>&#125;,</span><br><span class="line">              &#123;x,<span class="number">0</span>&#125;&#125;,</span><br><span class="line">          &#123;line,<span class="number">2</span>&#125;,</span><br><span class="line">          &#123;call_ext_only,<span class="number">1</span>,&#123;extfunc,io,format,<span class="number">1</span>&#125;&#125;]&#125;,</span><br><span class="line">     &#123;function,check,<span class="number">1</span>,<span class="number">5</span>,</span><br><span class="line">         [&#123;line,<span class="number">3</span>&#125;,</span><br><span class="line">          &#123;label,<span class="number">4</span>&#125;,</span><br><span class="line">          &#123;func_info,&#123;atom,genshin&#125;,&#123;atom,check&#125;,<span class="number">1</span>&#125;,</span><br><span class="line">          &#123;label,<span class="number">5</span>&#125;,</span><br><span class="line">          &#123;test,is_list,&#123;f,<span class="number">4</span>&#125;,[&#123;x,<span class="number">0</span>&#125;]&#125;,</span><br><span class="line">          &#123;allocate,<span class="number">1</span>,<span class="number">1</span>&#125;,</span><br><span class="line">          &#123;move,&#123;x,<span class="number">0</span>&#125;,&#123;y,<span class="number">0</span>&#125;&#125;,</span><br><span class="line">          &#123;move,&#123;literal,[<span class="number">21407</span>,<span class="number">31070</span>,<span class="number">46</span>,<span class="number">46</span>,<span class="number">46</span>,<span class="number">126</span>,<span class="number">110</span>]&#125;,&#123;x,<span class="number">0</span>&#125;&#125;,</span><br><span class="line">          &#123;line,<span class="number">4</span>&#125;,</span><br><span class="line">          &#123;call_ext,<span class="number">1</span>,&#123;extfunc,io,format,<span class="number">1</span>&#125;&#125;,</span><br><span class="line">          &#123;move,&#123;integer,<span class="number">1</span>&#125;,&#123;x,<span class="number">1</span>&#125;&#125;,</span><br><span class="line">          &#123;move,nil,&#123;x,<span class="number">2</span>&#125;&#125;,</span><br><span class="line">          &#123;move,&#123;y,<span class="number">0</span>&#125;,&#123;x,<span class="number">0</span>&#125;&#125;,</span><br><span class="line">          &#123;init_yregs,&#123;<span class="built_in">list</span>,[&#123;y,<span class="number">0</span>&#125;]&#125;&#125;,</span><br><span class="line">          &#123;line,<span class="number">5</span>&#125;,</span><br><span class="line">          &#123;call,<span class="number">3</span>,&#123;genshin,transform,<span class="number">3</span>&#125;&#125;,</span><br><span class="line">          &#123;line,<span class="number">6</span>&#125;,</span><br><span class="line">          &#123;call_ext,<span class="number">1</span>,&#123;extfunc,erlang,list_to_binary,<span class="number">1</span>&#125;&#125;,</span><br><span class="line">          &#123;test,is_eq_exact,</span><br><span class="line">              &#123;f,<span class="number">6</span>&#125;,</span><br><span class="line">              [&#123;tr,&#123;x,<span class="number">0</span>&#125;,&#123;t_bitstring,<span class="number">8</span>,<span class="literal">false</span>&#125;&#125;,</span><br><span class="line">               &#123;literal,</span><br><span class="line">                   &lt;&lt;<span class="number">107</span>,<span class="number">114</span>,<span class="number">102</span>,<span class="number">103</span>,<span class="number">130</span>,<span class="number">68</span>,<span class="number">118</span>,<span class="number">106</span>,<span class="number">107</span>,<span class="number">119</span>,<span class="number">88</span>,<span class="number">109</span>,<span class="number">131</span>,<span class="number">70</span>,</span><br><span class="line">                     <span class="number">114</span>,<span class="number">130</span>,<span class="number">122</span>,<span class="number">81</span>,<span class="number">111</span>,<span class="number">40</span>,<span class="number">107</span>,<span class="number">77</span>,<span class="number">76</span>,<span class="number">38</span>,<span class="number">52</span>,<span class="number">73</span>,<span class="number">72</span>,<span class="number">101</span>&gt;&gt;&#125;]&#125;,</span><br><span class="line">          &#123;move,&#123;literal,[<span class="number">21551</span>,<span class="number">21160</span>,<span class="number">65281</span>,<span class="number">126</span>,<span class="number">110</span>]&#125;,&#123;x,<span class="number">0</span>&#125;&#125;,</span><br><span class="line">          &#123;line,<span class="number">7</span>&#125;,</span><br><span class="line">          &#123;call_ext_last,<span class="number">1</span>,&#123;extfunc,io,format,<span class="number">1</span>&#125;,<span class="number">1</span>&#125;,</span><br><span class="line">          &#123;label,<span class="number">6</span>&#125;,</span><br><span class="line">          &#123;move,&#123;literal,[<span class="number">20851</span>,<span class="number">38381</span>,<span class="number">126</span>,<span class="number">110</span>]&#125;,&#123;x,<span class="number">0</span>&#125;&#125;,</span><br><span class="line">          &#123;line,<span class="number">8</span>&#125;,</span><br><span class="line">          &#123;call_ext_last,<span class="number">1</span>,&#123;extfunc,io,format,<span class="number">1</span>&#125;,<span class="number">1</span>&#125;]&#125;,</span><br><span class="line">     &#123;function,transform,<span class="number">3</span>,<span class="number">8</span>,</span><br><span class="line">         [&#123;line,<span class="number">9</span>&#125;,</span><br><span class="line">          &#123;label,<span class="number">7</span>&#125;,</span><br><span class="line">          &#123;func_info,&#123;atom,genshin&#125;,&#123;atom,transform&#125;,<span class="number">3</span>&#125;,</span><br><span class="line">          &#123;label,<span class="number">8</span>&#125;,</span><br><span class="line">          &#123;test,is_nonempty_list,&#123;f,<span class="number">9</span>&#125;,[&#123;x,<span class="number">0</span>&#125;]&#125;,</span><br><span class="line">          &#123;get_list,&#123;x,<span class="number">0</span>&#125;,&#123;x,<span class="number">3</span>&#125;,&#123;x,<span class="number">0</span>&#125;&#125;,</span><br><span class="line">          &#123;line,<span class="number">10</span>&#125;,</span><br><span class="line">          &#123;gc_bif,<span class="string">&#x27;bxor&#x27;</span>,</span><br><span class="line">              &#123;f,<span class="number">0</span>&#125;,</span><br><span class="line">              <span class="number">4</span>,</span><br><span class="line">              [&#123;x,<span class="number">3</span>&#125;,&#123;tr,&#123;x,<span class="number">1</span>&#125;,&#123;t_integer,&#123;<span class="number">1</span>,<span class="string">&#x27;+inf&#x27;</span>&#125;&#125;&#125;],</span><br><span class="line">              &#123;x,<span class="number">3</span>&#125;&#125;,</span><br><span class="line">          &#123;gc_bif,<span class="string">&#x27;+&#x27;</span>,&#123;f,<span class="number">0</span>&#125;,<span class="number">4</span>,[&#123;tr,&#123;x,<span class="number">3</span>&#125;,&#123;t_integer,any&#125;&#125;,&#123;integer,<span class="number">4</span>&#125;],&#123;x,<span class="number">3</span>&#125;&#125;,</span><br><span class="line">          &#123;line,<span class="number">11</span>&#125;,</span><br><span class="line">          &#123;gc_bif,<span class="string">&#x27;+&#x27;</span>,</span><br><span class="line">              &#123;f,<span class="number">0</span>&#125;,</span><br><span class="line">              <span class="number">4</span>,</span><br><span class="line">              [&#123;tr,&#123;x,<span class="number">1</span>&#125;,&#123;t_integer,&#123;<span class="number">1</span>,<span class="string">&#x27;+inf&#x27;</span>&#125;&#125;&#125;,&#123;integer,<span class="number">1</span>&#125;],</span><br><span class="line">              &#123;x,<span class="number">1</span>&#125;&#125;,</span><br><span class="line">          &#123;test_heap,<span class="number">2</span>,<span class="number">4</span>&#125;,</span><br><span class="line">          &#123;put_list,&#123;x,<span class="number">3</span>&#125;,&#123;x,<span class="number">2</span>&#125;,&#123;x,<span class="number">2</span>&#125;&#125;,</span><br><span class="line">          &#123;call_only,<span class="number">3</span>,&#123;genshin,transform,<span class="number">3</span>&#125;&#125;,</span><br><span class="line">          &#123;label,<span class="number">9</span>&#125;,</span><br><span class="line">          &#123;test,is_nil,&#123;f,<span class="number">7</span>&#125;,[&#123;x,<span class="number">0</span>&#125;]&#125;,</span><br><span class="line">          &#123;move,&#123;x,<span class="number">2</span>&#125;,&#123;x,<span class="number">0</span>&#125;&#125;,</span><br><span class="line">          &#123;line,<span class="number">9</span>&#125;,</span><br><span class="line">          &#123;call_ext_only,<span class="number">1</span>,&#123;extfunc,lists,reverse,<span class="number">1</span>&#125;&#125;]&#125;,</span><br><span class="line">     &#123;function,module_info,<span class="number">0</span>,<span class="number">11</span>,</span><br><span class="line">         [&#123;line,<span class="number">0</span>&#125;,</span><br><span class="line">          &#123;label,<span class="number">10</span>&#125;,</span><br><span class="line">          &#123;func_info,&#123;atom,genshin&#125;,&#123;atom,module_info&#125;,<span class="number">0</span>&#125;,</span><br><span class="line">          &#123;label,<span class="number">11</span>&#125;,</span><br><span class="line">          &#123;move,&#123;atom,genshin&#125;,&#123;x,<span class="number">0</span>&#125;&#125;,</span><br><span class="line">          &#123;call_ext_only,<span class="number">1</span>,&#123;extfunc,erlang,get_module_info,<span class="number">1</span>&#125;&#125;]&#125;,</span><br><span class="line">     &#123;function,module_info,<span class="number">1</span>,<span class="number">13</span>,</span><br><span class="line">         [&#123;line,<span class="number">0</span>&#125;,</span><br><span class="line">          &#123;label,<span class="number">12</span>&#125;,</span><br><span class="line">          &#123;func_info,&#123;atom,genshin&#125;,&#123;atom,module_info&#125;,<span class="number">1</span>&#125;,</span><br><span class="line">          &#123;label,<span class="number">13</span>&#125;,</span><br><span class="line">          &#123;move,&#123;x,<span class="number">0</span>&#125;,&#123;x,<span class="number">1</span>&#125;&#125;,</span><br><span class="line">          &#123;move,&#123;atom,genshin&#125;,&#123;x,<span class="number">0</span>&#125;&#125;,</span><br><span class="line">          &#123;call_ext_only,<span class="number">2</span>,&#123;extfunc,erlang,get_module_info,<span class="number">2</span>&#125;&#125;]&#125;]&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ…¢æ…¢åˆ†æå­—èŠ‚ç å§â€¦</p>
<p>è¿™é‡Œæ˜¯æœ€åçš„check is_eq_exact</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;test,is_eq_exact,</span><br><span class="line">              &#123;f,<span class="number">6</span>&#125;,</span><br><span class="line">              [&#123;tr,&#123;x,<span class="number">0</span>&#125;,&#123;t_bitstring,<span class="number">8</span>,<span class="literal">false</span>&#125;&#125;,</span><br><span class="line">               &#123;literal,</span><br><span class="line">                   &lt;&lt;<span class="number">107</span>,<span class="number">114</span>,<span class="number">102</span>,<span class="number">103</span>,<span class="number">130</span>,<span class="number">68</span>,<span class="number">118</span>,<span class="number">106</span>,<span class="number">107</span>,<span class="number">119</span>,<span class="number">88</span>,<span class="number">109</span>,<span class="number">131</span>,<span class="number">70</span>,</span><br><span class="line">                     <span class="number">114</span>,<span class="number">130</span>,<span class="number">122</span>,<span class="number">81</span>,<span class="number">111</span>,<span class="number">40</span>,<span class="number">107</span>,<span class="number">77</span>,<span class="number">76</span>,<span class="number">38</span>,<span class="number">52</span>,<span class="number">73</span>,<span class="number">72</span>,<span class="number">101</span>&gt;&gt;&#125;]&#125;,</span><br></pre></td></tr></table></figure>

<p>æ¥ç€å¾€å‰æ‰¾åˆ°transformå‡½æ•°<br>åœ¨ç½‘ä¸Šæœäº†æœbeamå­—èŠ‚ç  æ‰¾åˆ°ä¸€äº›ä¾‹å­</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;gc_bif,<span class="built_in">abs</span>,&#123;f,<span class="number">0</span>&#125;,<span class="number">2</span>,[&#123;x,<span class="number">0</span>&#125;],&#123;x,<span class="number">0</span>&#125;&#125;. <span class="comment">//ç”¨x0å»è°ƒç”¨bifå‡½æ•°absï¼Œå­˜å‚¨ç»“æœåˆ°x0å¯„å­˜å™¨ï¼Œ</span></span><br><span class="line"></span><br><span class="line">&#123;gc_bif,<span class="built_in">abs</span>,&#123;f,<span class="number">0</span>&#125;,<span class="number">2</span>,[&#123;x,<span class="number">1</span>&#125;],&#123;x,<span class="number">1</span>&#125;&#125;. <span class="comment">//ç”¨x1å»è°ƒç”¨bifå‡½æ•°absï¼Œå­˜å‚¨ç»“æœåˆ°x1å¯„å­˜å™¨ï¼Œ</span></span><br><span class="line"></span><br><span class="line">&#123;gc_bif,<span class="string">&#x27;+&#x27;</span>,&#123;f,<span class="number">0</span>&#125;,<span class="number">2</span>,[&#123;x,<span class="number">0</span>&#125;,&#123;x,<span class="number">1</span>&#125;],&#123;x,<span class="number">0</span>&#125;&#125;. <span class="comment">//æ‰§è¡Œbifå‡½æ•°+ï¼Œ x0+x1ï¼Œç»“æœæ”¾å…¥x0å¯„å­˜å™¨</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æœ‰äº†è¿™äº›ä¾‹å­å†çœ‹transform</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#123;function,transform,<span class="number">3</span>,<span class="number">8</span>,</span><br><span class="line">         [&#123;line,<span class="number">9</span>&#125;,</span><br><span class="line">          &#123;label,<span class="number">7</span>&#125;,</span><br><span class="line">          &#123;func_info,&#123;atom,genshin&#125;,&#123;atom,transform&#125;,<span class="number">3</span>&#125;,</span><br><span class="line">          &#123;label,<span class="number">8</span>&#125;,</span><br><span class="line">          &#123;test,is_nonempty_list,&#123;f,<span class="number">9</span>&#125;,[&#123;x,<span class="number">0</span>&#125;]&#125;,</span><br><span class="line">          &#123;get_list,&#123;x,<span class="number">0</span>&#125;,&#123;x,<span class="number">3</span>&#125;,&#123;x,<span class="number">0</span>&#125;&#125;,</span><br><span class="line">          &#123;line,<span class="number">10</span>&#125;,</span><br><span class="line">          &#123;gc_bif,<span class="string">&#x27;bxor&#x27;</span>,</span><br><span class="line">              &#123;f,<span class="number">0</span>&#125;,</span><br><span class="line">              <span class="number">4</span>,</span><br><span class="line">              [&#123;x,<span class="number">3</span>&#125;,&#123;tr,&#123;x,<span class="number">1</span>&#125;,&#123;t_integer,&#123;<span class="number">1</span>,<span class="string">&#x27;+inf&#x27;</span>&#125;&#125;&#125;],</span><br><span class="line">              &#123;x,<span class="number">3</span>&#125;&#125;,</span><br><span class="line">          &#123;gc_bif,<span class="string">&#x27;+&#x27;</span>,&#123;f,<span class="number">0</span>&#125;,<span class="number">4</span>,[&#123;tr,&#123;x,<span class="number">3</span>&#125;,&#123;t_integer,any&#125;&#125;,&#123;integer,<span class="number">4</span>&#125;],&#123;x,<span class="number">3</span>&#125;&#125;,</span><br><span class="line">          &#123;line,<span class="number">11</span>&#125;,</span><br><span class="line">          &#123;gc_bif,<span class="string">&#x27;+&#x27;</span>,</span><br><span class="line">              &#123;f,<span class="number">0</span>&#125;,</span><br><span class="line">              <span class="number">4</span>,</span><br><span class="line">              [&#123;tr,&#123;x,<span class="number">1</span>&#125;,&#123;t_integer,&#123;<span class="number">1</span>,<span class="string">&#x27;+inf&#x27;</span>&#125;&#125;&#125;,&#123;integer,<span class="number">1</span>&#125;],</span><br><span class="line">              &#123;x,<span class="number">1</span>&#125;&#125;,</span><br><span class="line">          &#123;test_heap,<span class="number">2</span>,<span class="number">4</span>&#125;,</span><br><span class="line">          &#123;put_list,&#123;x,<span class="number">3</span>&#125;,&#123;x,<span class="number">2</span>&#125;,&#123;x,<span class="number">2</span>&#125;&#125;,</span><br><span class="line">          &#123;call_only,<span class="number">3</span>,&#123;genshin,transform,<span class="number">3</span>&#125;&#125;,</span><br><span class="line">          &#123;label,<span class="number">9</span>&#125;,</span><br><span class="line">          &#123;test,is_nil,&#123;f,<span class="number">7</span>&#125;,[&#123;x,<span class="number">0</span>&#125;]&#125;,</span><br><span class="line">          &#123;move,&#123;x,<span class="number">2</span>&#125;,&#123;x,<span class="number">0</span>&#125;&#125;,</span><br><span class="line">          &#123;line,<span class="number">9</span>&#125;,</span><br><span class="line">          &#123;call_ext_only,<span class="number">1</span>,&#123;extfunc,lists,reverse,<span class="number">1</span>&#125;&#125;]&#125;,</span><br></pre></td></tr></table></figure>

<p>é‡ç‚¹åœ¨è¿™ä¸€éƒ¨åˆ†:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;line,<span class="number">10</span>&#125;,</span><br><span class="line">          &#123;gc_bif,<span class="string">&#x27;bxor&#x27;</span>,</span><br><span class="line">              &#123;f,<span class="number">0</span>&#125;,</span><br><span class="line">              <span class="number">4</span>,</span><br><span class="line">              [&#123;x,<span class="number">3</span>&#125;,&#123;tr,&#123;x,<span class="number">1</span>&#125;,&#123;t_integer,&#123;<span class="number">1</span>,<span class="string">&#x27;+inf&#x27;</span>&#125;&#125;&#125;],</span><br><span class="line">              &#123;x,<span class="number">3</span>&#125;&#125;,</span><br><span class="line">          &#123;gc_bif,<span class="string">&#x27;+&#x27;</span>,&#123;f,<span class="number">0</span>&#125;,<span class="number">4</span>,[&#123;tr,&#123;x,<span class="number">3</span>&#125;,&#123;t_integer,any&#125;&#125;,&#123;integer,<span class="number">4</span>&#125;],&#123;x,<span class="number">3</span>&#125;&#125;,</span><br><span class="line">          &#123;line,<span class="number">11</span>&#125;,</span><br><span class="line">          &#123;gc_bif,<span class="string">&#x27;+&#x27;</span>,</span><br><span class="line">              &#123;f,<span class="number">0</span>&#125;,</span><br><span class="line">              <span class="number">4</span>,</span><br><span class="line">              [&#123;tr,&#123;x,<span class="number">1</span>&#125;,&#123;t_integer,&#123;<span class="number">1</span>,<span class="string">&#x27;+inf&#x27;</span>&#125;&#125;&#125;,&#123;integer,<span class="number">1</span>&#125;],</span><br><span class="line">              &#123;x,<span class="number">1</span>&#125;&#125;,</span><br></pre></td></tr></table></figure>

<p>bxorè¿™é‡Œ:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;gc_bif,<span class="string">&#x27;bxor&#x27;</span>,</span><br><span class="line">    &#123;f,<span class="number">0</span>&#125;,</span><br><span class="line">    <span class="number">4</span>,</span><br><span class="line">    [&#123;x,<span class="number">3</span>&#125;,&#123;tr,&#123;x,<span class="number">1</span>&#125;,&#123;t_integer,&#123;<span class="number">1</span>,<span class="string">&#x27;+inf&#x27;</span>&#125;&#125;&#125;],</span><br><span class="line">    &#123;x,<span class="number">3</span>&#125;&#125;,</span><br></pre></td></tr></table></figure>
<p>å¤§è‡´æ˜¯ {x,1} xor (t_integer+1)  ç„¶åç»“æœå­˜ç»™ {x,3}</p>
<p>å†çœ‹ä¸‹é¢çš„â€™+â€™: </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;gc_bif,<span class="string">&#x27;+&#x27;</span>,&#123;f,<span class="number">0</span>&#125;,<span class="number">4</span>,[&#123;tr,&#123;x,<span class="number">3</span>&#125;,&#123;t_integer,any&#125;&#125;,&#123;integer,<span class="number">4</span>&#125;],&#123;x,<span class="number">3</span>&#125;&#125;,</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ˜¯ {x,3}+4è¿™ç§è¿ç®— æœ€åç»“æœå­˜å› {x,3}<br>å†ä¸‹é¢çš„â€™+â€™åº”è¯¥æ˜¯å¾ªç¯çš„ecx++</p>
<p>æ‰€ä»¥åŠ å¯†é€»è¾‘:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag[i] = (flag[i]^(i+<span class="number">1</span>))+<span class="number">4</span></span><br></pre></td></tr></table></figure>

<p>ä»enc[]é€†å›å»å³å¯å¾—åˆ°flag<br>flag: <strong>flag{Funny_erLang_x0r__:)__}</strong></p>
<hr>
<hr>
<p>è¿™ç§æœç´¢èµ„æ–™çš„èƒ½åŠ›å’Œé€šè¿‡ä¾‹å­å­¦ä¹ æ–°çŸ¥è¯†çš„èƒ½åŠ›ä¹Ÿè¦å¤šåŸ¹å…» ç»ƒä¹ <br>ä¸å¾—ä¸æ„Ÿæ…¨èµ›æ—¶åšå‡ºäº†çš„3ä½ä½¬tql orz</p>
<h2 id="easy-js2"><a href="#easy-js2" class="headerlink" title="easy_js2"></a>easy_js2</h2><p>wasmæ–‡ä»¶é€†å‘<br>è¿™ç§ç±»å‹ç¡®å®ä¹Ÿè§è¿‡å¥½å¤šæ¬¡äº†<br>EdgeæŸ¥çœ‹æºä»£ç æŠŠoutput.wasm dumpä¸‹æ¥<br>è·Ÿç€<a href="https://xz.aliyun.com/t/5170" target="_blank">è¿™ç¯‡</a>æ“ä½œ<br>ç›´æ¥ç”¨ .&#x2F;wasm2c wasm.wasm -o wasm.c åç¼–è¯‘å¾—åˆ°cä»£ç <br>è¿™é‡Œå®¹æ˜“å‡ºç°ç¼ºå¤±libcrypto-1_1-x64.dll ç½‘ä¸Šä¸‹ä¸€ä¸ªè´´åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹å°±è¡Œäº†(<del>å¸å–ç»éªŒæ•™è®­ åˆ«ä¹±å¾€C:&#x2F;&#x2F;system32é‡ŒåŠ dllâ€¦</del>)<br>ä½†è¿™é‡Œä¸€ç›´å‡ºç° 0000004: error: bad magic value â€¦.<br>è¿˜æ˜¯å…ˆæŒ‚ç€å§ ä»¥åå†æ¥çœ‹</p>
<h1 id="2023å¼ºç½‘æ¯"><a href="#2023å¼ºç½‘æ¯" class="headerlink" title="2023å¼ºç½‘æ¯"></a>2023å¼ºç½‘æ¯</h1><p>èµ›æ—¶è·Ÿç€å­¦æ ¡é˜Ÿä¼æ‰“äº†æ‰“ å°±åšäº†é“reç­¾åˆ°â€¦</p>
<h2 id="ez-re"><a href="#ez-re" class="headerlink" title="ez_re"></a>ez_re</h2><p>èµ›æ—¶çœ‹äº†çœ‹ ä¸€å¤§å †while å½“æ—¶ä»¥ä¸ºè€ƒå¯Ÿçš„æ˜¯ç±»ä¼¼opcodeçš„vm<br>â€¦<br>IDAæ‰“å¼€ çœ‹main å®Œå…¨æ²¡å¤´ç»ª é™¤äº†ä¸€ä¸ªå‡flag checkå’Œä¸€å¤§å †whileä¼¼ä¹æ‰¾ä¸åˆ°å…¶ä»–æœ‰ç”¨çš„ç‚¹<br>å¥½åœ¨å‡½æ•°å¾ˆå°‘ ä¸€ä¸ªä¸ªç‚¹å¼€çœ‹</p>
<p>sub_1260:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">sub_1260</span><span class="params">(__int64 a1, _QWORD *a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+20h] [rbp-20h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+24h] [rbp-1Ch]</span></span><br><span class="line"></span><br><span class="line">  *a2 = <span class="number">0LL</span>;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v4 = <span class="number">1605141220</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( v4 == <span class="number">-1641808572</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      *a2 ^= (<span class="type">unsigned</span> __int64)*(<span class="type">unsigned</span> __int8 *)(a1 + v5) &lt;&lt; (<span class="number">24</span> - <span class="number">8</span> * (<span class="type">unsigned</span> __int8)v5);</span><br><span class="line">      v4 = <span class="number">-27338749</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v4 == <span class="number">-285296236</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v4 == <span class="number">-27338749</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      ++v5;</span><br><span class="line">      v4 = <span class="number">1605141220</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v2 = <span class="number">-285296236</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v5 &lt; <span class="number">4</span> )</span><br><span class="line">        v2 = <span class="number">-1641808572</span>;</span><br><span class="line">      v4 = v2;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆæ˜¯ç”¨æ¥æ··æ·†çš„v4â€¦ å…¶å®æ ¸å¿ƒå°± <code>*a2 ^= xxx&lt;&lt;(24/16/8/0)</code><br>ä¹Ÿå°±æ˜¯å°†char-&gt;intä¹‹ç±»çš„</p>
<p>sub_13A0:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">sub_13A0</span><span class="params">(__int64 a1, <span class="type">unsigned</span> __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// esi</span></span><br><span class="line">  __int64 *v7; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v8; <span class="comment">// [rsp+0h] [rbp-70h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+Ch] [rbp-64h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+10h] [rbp-60h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+14h] [rbp-5Ch]</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [rsp+18h] [rbp-58h]</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// [rsp+1Ch] [rbp-54h]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [rsp+20h] [rbp-50h]</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// [rsp+24h] [rbp-4Ch]</span></span><br><span class="line">  <span class="type">int</span> v16; <span class="comment">// [rsp+28h] [rbp-48h]</span></span><br><span class="line">  <span class="type">int</span> v17; <span class="comment">// [rsp+2Ch] [rbp-44h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v18; <span class="comment">// [rsp+30h] [rbp-40h]</span></span><br><span class="line">  __int64 v19; <span class="comment">// [rsp+38h] [rbp-38h]</span></span><br><span class="line">  <span class="type">int</span> v20; <span class="comment">// [rsp+40h] [rbp-30h]</span></span><br><span class="line">  <span class="type">bool</span> v21; <span class="comment">// [rsp+46h] [rbp-2Ah]</span></span><br><span class="line">  <span class="type">bool</span> v22; <span class="comment">// [rsp+47h] [rbp-29h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 *v23; <span class="comment">// [rsp+48h] [rbp-28h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 *v24; <span class="comment">// [rsp+50h] [rbp-20h]</span></span><br><span class="line">  __int64 *v25; <span class="comment">// [rsp+58h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v26; <span class="comment">// [rsp+60h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v26 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v21 = ((((_BYTE)dword_8100 - <span class="number">1</span>) * (_BYTE)dword_8100) &amp; <span class="number">1</span>) == <span class="number">0</span>;</span><br><span class="line">  v22 = dword_80D0 &lt; <span class="number">10</span>;</span><br><span class="line">  v20 = <span class="number">-1362590688</span>;</span><br><span class="line">  v19 = a1;</span><br><span class="line">  v18 = a2;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v17 = v20;</span><br><span class="line">          v16 = v20 + <span class="number">1362590688</span>;</span><br><span class="line">          <span class="keyword">if</span> ( v20 != <span class="number">-1362590688</span> )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v2 = <span class="number">68268958</span>;</span><br><span class="line">          <span class="keyword">if</span> ( v22 || v21 )</span><br><span class="line">            v2 = <span class="number">-1082117606</span>;</span><br><span class="line">          v20 = v2;</span><br><span class="line">        &#125;</span><br><span class="line">        v15 = v17 + <span class="number">1082117606</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v17 != <span class="number">-1082117606</span> )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        v3 = <span class="number">68268958</span>;</span><br><span class="line">        v23 = &amp;v8;</span><br><span class="line">        v24 = &amp;v8;</span><br><span class="line">        v25 = (__int64 *)(&amp;v8 - <span class="number">2</span>);</span><br><span class="line">        v8 = v18;</span><br><span class="line">        *(_DWORD *)v25 = <span class="number">0</span>;</span><br><span class="line">        *(_DWORD *)v25 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> ( dword_80D0 &lt; <span class="number">10</span> || ((((_BYTE)dword_8100 - <span class="number">1</span>) * (_BYTE)dword_8100) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">          v3 = <span class="number">753533903</span>;</span><br><span class="line">        v20 = v3;</span><br><span class="line">      &#125;</span><br><span class="line">      v14 = v17 - <span class="number">68268958</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v17 != <span class="number">68268958</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v7 = (__int64 *)(&amp;v8 - <span class="number">2</span>);</span><br><span class="line">      v8 = v18;</span><br><span class="line">      *(_DWORD *)v7 = <span class="number">0</span>;</span><br><span class="line">      *(_DWORD *)v7 = <span class="number">0</span>;</span><br><span class="line">      v20 = <span class="number">-1082117606</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v13 = v17 - <span class="number">462079399</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v17 == <span class="number">462079399</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v12 = v17 - <span class="number">753533903</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v17 == <span class="number">753533903</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v20 = <span class="number">949053677</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v11 = v17 - <span class="number">949053677</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v17 == <span class="number">949053677</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v4 = <span class="number">462079399</span>;</span><br><span class="line">        <span class="keyword">if</span> ( *(<span class="type">int</span> *)v25 &lt; <span class="number">4</span> )</span><br><span class="line">          v4 = <span class="number">1315991260</span>;</span><br><span class="line">        v20 = v4;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        v10 = v17 - <span class="number">1315991260</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v17 == <span class="number">1315991260</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v5 = <span class="number">8</span> * *(_DWORD *)v25;</span><br><span class="line">          v8 = *v23;</span><br><span class="line">          *(_BYTE *)(*v24 + *(<span class="type">int</span> *)v25) = v8 &gt;&gt; (<span class="number">24</span> - (<span class="type">unsigned</span> __int8)v5);</span><br><span class="line">          v20 = <span class="number">1547077251</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          v9 = v17 - <span class="number">1547077251</span>;</span><br><span class="line">          <span class="keyword">if</span> ( v17 == <span class="number">1547077251</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            ++*(_DWORD *)v25;</span><br><span class="line">            v20 = <span class="number">949053677</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç±»ä¼¼ ä¸€å¤§å †whileæ··æ·† å®åˆ™å°±æ˜¯ int-&gt;charä¹‹ç±»çš„åŠŸèƒ½</p>
<p>sub_1670:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">sub_1670</span><span class="params">(<span class="type">unsigned</span> __int64 a1, <span class="type">char</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> (a1 &gt;&gt; (<span class="number">32</span> - a2)) ^ (a1 &lt;&lt; a2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç§»ä½xoræ“ä½œ å¤šåŠæ˜¯è·ŸåŠ å¯†æœ‰å…³</p>
<p>sub_16F0:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">sub_16F0</span><span class="params">(__int64 a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v9; <span class="comment">// [rsp+8h] [rbp-B8h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v10; <span class="comment">// [rsp+10h] [rbp-B0h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v11; <span class="comment">// [rsp+20h] [rbp-A0h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v12; <span class="comment">// [rsp+28h] [rbp-98h]</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// [rsp+88h] [rbp-38h]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [rsp+8Ch] [rbp-34h]</span></span><br><span class="line">  <span class="type">bool</span> v15; <span class="comment">// [rsp+9Fh] [rbp-21h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v16; <span class="comment">// [rsp+A0h] [rbp-20h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v17; <span class="comment">// [rsp+A8h] [rbp-18h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v18[<span class="number">4</span>]; <span class="comment">// [rsp+B0h] [rbp-10h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">4</span>]; <span class="comment">// [rsp+B4h] [rbp-Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v20; <span class="comment">// [rsp+B8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v20 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v17 = <span class="number">0LL</span>;</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">  <span class="built_in">memset</span>(v18, <span class="number">0</span>, <span class="keyword">sizeof</span>(v18));</span><br><span class="line">  sub_13A0(a1, (<span class="type">unsigned</span> __int64)s);</span><br><span class="line">  v14 = <span class="number">0</span>;</span><br><span class="line">  v13 = <span class="number">1269377601</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="keyword">while</span> ( v13 == <span class="number">-1404100861</span> )</span><br><span class="line">                    v13 = <span class="number">1269377601</span>;</span><br><span class="line">                  <span class="keyword">if</span> ( v13 != <span class="number">-1075359453</span> )</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                  ++v14;</span><br><span class="line">                  v13 = <span class="number">1980171296</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> ( v13 != <span class="number">-979710400</span> )</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                v2 = <span class="number">-80865339</span>;</span><br><span class="line">                v15 = v14 &lt; <span class="number">4</span>;</span><br><span class="line">                <span class="keyword">if</span> ( dword_811C &lt; <span class="number">10</span> || ((((_BYTE)dword_80EC - <span class="number">1</span>) * (_BYTE)dword_80EC) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">                  v2 = <span class="number">-741238317</span>;</span><br><span class="line">                v13 = v2;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">if</span> ( v13 != <span class="number">-741238317</span> )</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">              v3 = <span class="number">-424386296</span>;</span><br><span class="line">              <span class="keyword">if</span> ( v15 )</span><br><span class="line">                v3 = <span class="number">1085063542</span>;</span><br><span class="line">              v13 = v3;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( v13 != <span class="number">-424386296</span> )</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            v6 = <span class="number">957279085</span>;</span><br><span class="line">            <span class="keyword">if</span> ( dword_811C &lt; <span class="number">10</span> || ((((_BYTE)dword_80EC - <span class="number">1</span>) * (_BYTE)dword_80EC) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">              v6 = <span class="number">-243308292</span>;</span><br><span class="line">            v13 = v6;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( v13 != <span class="number">-418270464</span> )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v4 = <span class="number">-1075359453</span>;</span><br><span class="line">          <span class="keyword">if</span> ( dword_811C &lt; <span class="number">10</span> || ((((_BYTE)dword_80EC - <span class="number">1</span>) * (_BYTE)dword_80EC) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">            v4 = <span class="number">1980171296</span>;</span><br><span class="line">          v13 = v4;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( v13 != <span class="number">-243308292</span> )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        sub_1260((__int64)v18, &amp;v17);</span><br><span class="line">        v12 = v17;</span><br><span class="line">        v11 = sub_1670(v17, <span class="number">13</span>) ^ v12;</span><br><span class="line">        v7 = <span class="number">957279085</span>;</span><br><span class="line">        v17 = sub_1670(v17, <span class="number">23</span>) ^ v11;</span><br><span class="line">        v16 = v17;</span><br><span class="line">        <span class="keyword">if</span> ( dword_811C &lt; <span class="number">10</span> || ((((_BYTE)dword_80EC - <span class="number">1</span>) * (_BYTE)dword_80EC) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">          v7 = <span class="number">218969482</span>;</span><br><span class="line">        v13 = v7;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( v13 != <span class="number">-80865339</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v13 = <span class="number">-979710400</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v13 == <span class="number">218969482</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">switch</span> ( v13 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">957279085</span>:</span><br><span class="line">        sub_1260((__int64)v18, &amp;v17);</span><br><span class="line">        v10 = v17;</span><br><span class="line">        v9 = sub_1670(v17, <span class="number">13</span>) ^ v10;</span><br><span class="line">        v17 = sub_1670(v17, <span class="number">23</span>) ^ v9;</span><br><span class="line">        v13 = <span class="number">-243308292</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1085063542</span>:</span><br><span class="line">        v18[v14] = byte_6130[(<span class="type">unsigned</span> __int8)s[v14]];</span><br><span class="line">        v13 = <span class="number">-418270464</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1269377601</span>:</span><br><span class="line">        v1 = <span class="number">-80865339</span>;</span><br><span class="line">        <span class="keyword">if</span> ( dword_811C &lt; <span class="number">10</span> || ((((_BYTE)dword_80EC - <span class="number">1</span>) * (_BYTE)dword_80EC) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">          v1 = <span class="number">-979710400</span>;</span><br><span class="line">        v13 = v1;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        v5 = <span class="number">-1075359453</span>;</span><br><span class="line">        ++v14;</span><br><span class="line">        <span class="keyword">if</span> ( dword_811C &lt; <span class="number">10</span> || ((((_BYTE)dword_80EC - <span class="number">1</span>) * (_BYTE)dword_80EC) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">          v5 = <span class="number">-1404100861</span>;</span><br><span class="line">        v13 = v5;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v16;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„è¿™é‡Œå‡ºç°äº† byte_6130<br>ç‚¹å‡»æŸ¥çœ‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">.rodata:0000000000006130 byte_6130       db 0D6h, 90h, 0E9h, 0FEh, 0CCh, 0E1h, 3Dh, 0B7h, 16h, 0B6h</span><br><span class="line">.rodata:0000000000006130                                         ; DATA XREF: sub_16F0:loc_1954â†‘o</span><br><span class="line">.rodata:0000000000006130                                         ; sub_1BC0+339â†‘o ...</span><br><span class="line">.rodata:000000000000613A                 db 14h, 0C2h, 28h, 0FBh, 2Ch, 5, 2Bh, 67h, 9Ah, 76h, 2Ah</span><br><span class="line">.rodata:0000000000006145                 db 0BEh, 4, 0C3h, 0AAh, 44h, 13h, 26h, 49h, 86h, 6, 99h</span><br><span class="line">.rodata:0000000000006150                 db 9Ch, 42h, 50h, 0F4h, 91h, 0EFh, 98h, 7Ah, 33h, 54h</span><br><span class="line">.rodata:000000000000615A                 db 0Bh, 43h, 0EDh, 0CFh, 0ACh, 62h, 0E4h, 0B3h, 1Ch, 0A9h</span><br><span class="line">.rodata:0000000000006164                 db 0C9h, 8, 0E8h, 95h, 80h, 0DFh, 94h, 0FAh, 75h, 8Fh</span><br><span class="line">.rodata:000000000000616E                 db 3Fh, 0A6h, 47h, 7, 0A7h, 0FCh, 0F3h, 73h, 17h, 0BAh</span><br><span class="line">.rodata:0000000000006178                 db 83h, 59h, 3Ch, 19h, 0E6h, 85h, 4Fh, 0A8h, 68h, 6Bh</span><br><span class="line">.rodata:0000000000006182                 db 81h, 0B2h, 71h, 64h, 0DAh, 8Bh, 0F8h, 0EBh, 0Fh, 4Bh</span><br><span class="line">.rodata:000000000000618C                 db 70h, 56h, 9Dh, 35h, 1Eh, 24h, 0Eh, 5Eh, 63h, 58h, 0D1h</span><br><span class="line">.rodata:0000000000006197                 db 0A2h, 25h, 22h, 7Ch, 3Bh, 1, 21h, 78h, 87h, 0D4h, 0</span><br><span class="line">.rodata:00000000000061A2                 db 46h, 57h, 9Fh, 0D3h, 27h, 52h, 4Ch, 36h, 2, 0E7h, 0A0h</span><br><span class="line">.rodata:00000000000061AD                 db 0C4h, 0C8h, 9Eh, 0EAh, 0BFh, 8Ah, 0D2h, 40h, 0C7h, 38h</span><br><span class="line">.rodata:00000000000061B7                 db 0B5h, 0A3h, 0F7h, 0F2h, 0CEh, 0F9h, 61h, 15h, 0A1h</span><br><span class="line">.rodata:00000000000061C0                 db 0E0h, 0AEh, 5Dh, 0A4h, 9Bh, 34h, 1Ah, 55h, 0ADh, 93h</span><br><span class="line">.rodata:00000000000061CA                 db 32h, 30h, 0F5h, 8Ch, 0B1h, 0E3h, 1Dh, 0F6h, 0E2h, 2Eh</span><br><span class="line">.rodata:00000000000061D4                 db 82h, 66h, 0CAh, 60h, 0C0h, 29h, 23h, 0ABh, 0Dh, 53h</span><br><span class="line">.rodata:00000000000061DE                 db 4Eh, 6Fh, 0D5h, 0DBh, 37h, 45h, 0DEh, 0FDh, 8Eh, 2Fh</span><br><span class="line">.rodata:00000000000061E8                 db 3, 0FFh, 6Ah, 72h, 6Dh, 6Ch, 5Bh, 51h, 8Dh, 1Bh, 0AFh</span><br><span class="line">.rodata:00000000000061F3                 db 92h, 0BBh, 0DDh, 0BCh, 7Fh, 11h, 0D9h, 5Ch, 41h, 1Fh</span><br><span class="line">.rodata:00000000000061FD                 db 10h, 5Ah, 0D8h, 0Ah, 0C1h, 31h, 88h, 0A5h, 0CDh, 7Bh</span><br><span class="line">.rodata:0000000000006207                 db 0BDh, 2Dh, 74h, 0D0h, 12h, 0B8h, 0E5h, 0B4h, 0B0h, 89h</span><br><span class="line">.rodata:0000000000006211                 db 69h, 97h, 4Ah, 0Ch, 96h, 77h, 7Eh, 65h, 0B9h, 0F1h</span><br><span class="line">.rodata:000000000000621B                 db 9, 0C5h, 6Eh, 0C6h, 84h, 18h, 0F0h, 7Dh, 0ECh, 3Ah</span><br><span class="line">.rodata:0000000000006225                 db 0DCh, 4Dh, 20h, 79h, 0EEh, 5Fh, 3Eh, 0D7h, 0CBh, 39h</span><br><span class="line">.rodata:000000000000622F                 db 48h</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸€çœ‹å°±æ˜¯æŸç§ç®—æ³•çš„SBOXå•Šâ€¦ æŠŠå‰å‡ ä¸ªå€¼googleä¸€ä¸‹ å°±èƒ½å¾—åˆ°æ˜¯SM4ç®—æ³•â€¦</p>
<p>sub_1BC0 è·Ÿä¸Šä¸€ä¸ªå·®ä¸å¤š</p>
<p>sub_2220 è¿™é‡Œè°ƒç”¨äº†è¯¸å¦‚char_2_int SM4ç­‰å‡½æ•°<br>çŒœæµ‹è¿™å°±æ˜¯ä¸»åŠ å¯†éƒ¨åˆ†<br>é‚£ä¹ˆäº¤å‰å¼•ç”¨æŸ¥çœ‹å“ªä¸ªåœ°æ–¹è°ƒç”¨äº†sub_2220<br>æ‰¾åˆ°è¿™é‡Œ:<br>sub_3580</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_3580</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  _BOOL4 v1; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v2; <span class="comment">// al</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">size_t</span> v9; <span class="comment">// [rsp+38h] [rbp-C8h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+5Ch] [rbp-A4h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+60h] [rbp-A0h]</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [rsp+68h] [rbp-98h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v13; <span class="comment">// [rsp+7Ch] [rbp-84h]</span></span><br><span class="line">  __int64 v14[<span class="number">4</span>]; <span class="comment">// [rsp+80h] [rbp-80h]</span></span><br><span class="line">  __int64 v15[<span class="number">2</span>]; <span class="comment">// [rsp+A0h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">64</span>]; <span class="comment">// [rsp+B0h] [rbp-50h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v17; <span class="comment">// [rsp+F0h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v17 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0x32</span>uLL);</span><br><span class="line">  v15[<span class="number">0</span>] = <span class="number">0xEFCDAB8967452301</span>LL;</span><br><span class="line">  v15[<span class="number">1</span>] = <span class="number">0xEFCDAB8967452301</span>LL;</span><br><span class="line">  v14[<span class="number">0</span>] = <span class="number">0x7C88631647197506</span>LL;</span><br><span class="line">  v14[<span class="number">1</span>] = <span class="number">0x4A0D7D3FFF55668B</span>LL;</span><br><span class="line">  v14[<span class="number">2</span>] = <span class="number">0xDEC2E93F384ED2F5</span>LL;</span><br><span class="line">  v14[<span class="number">3</span>] = <span class="number">0x3C1FB1746F7F7CDB</span>LL;</span><br><span class="line">  v12 = <span class="number">1</span>;</span><br><span class="line">  v9 = <span class="number">16</span> * (<span class="built_in">strlen</span>(a1) &gt;&gt; <span class="number">4</span>);</span><br><span class="line">  v1 = (<span class="built_in">strlen</span>(a1) &amp; <span class="number">0xF</span>) != <span class="number">0</span>;</span><br><span class="line">  v2 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  sub_2220(v2, (__int64)v15, (__int64)a1, (__int64)s);</span><br><span class="line">  ...</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå¯ä»¥å¾—åˆ°6ä¸ªå¸¸é‡å€¼<br>å¤§è‡´æœç´¢ä¸€ä¸‹<a href="https://zhuanlan.zhihu.com/p/363900323" target="_blank">SM4ç®—æ³•</a> çœ‹çœ‹æ¯ä¸ªæ¨¡å—æœ‰æ²¡æœ‰é­”æ”¹</p>
<p>è¿™é‡Œè·Ÿç€æµç¨‹èµ°ä¸€é</p>
<h3 id="SM4çš„å¯†é’¥æ‰©å±•ç®—æ³•"><a href="#SM4çš„å¯†é’¥æ‰©å±•ç®—æ³•" class="headerlink" title="SM4çš„å¯†é’¥æ‰©å±•ç®—æ³•"></a>SM4çš„å¯†é’¥æ‰©å±•ç®—æ³•</h3><h4 id="1-ä¸ç³»ç»Ÿå‚æ•°å¼‚æˆ–â€”â€”åˆå§‹åŒ–å¯†é’¥"><a href="#1-ä¸ç³»ç»Ÿå‚æ•°å¼‚æˆ–â€”â€”åˆå§‹åŒ–å¯†é’¥" class="headerlink" title="1.ä¸ç³»ç»Ÿå‚æ•°å¼‚æˆ–â€”â€”åˆå§‹åŒ–å¯†é’¥"></a>1.ä¸ç³»ç»Ÿå‚æ•°å¼‚æˆ–â€”â€”åˆå§‹åŒ–å¯†é’¥</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sub_1260(a2, &amp;s);</span><br><span class="line">sub_1260(a2 + <span class="number">4</span>, &amp;v38);</span><br><span class="line">sub_1260(a2 + <span class="number">8</span>, &amp;v39);</span><br><span class="line">sub_1260(a2 + <span class="number">12</span>, &amp;v40);</span><br><span class="line">v36[<span class="number">0</span>] = s ^ <span class="number">0xA3B1BAC6</span>LL;</span><br><span class="line">v36[<span class="number">1</span>] = v38 ^ <span class="number">0x56AA3350</span>;</span><br><span class="line">v36[<span class="number">2</span>] = v39 ^ <span class="number">0x677D9197</span>;</span><br><span class="line">v36[<span class="number">3</span>] = v40 ^ <span class="number">0xB27022DC</span>LL;</span><br></pre></td></tr></table></figure>

<p>ä¸æ­£å¸¸å‚æ•°å¯¹æ¯”å‘ç°æ²¡æœ‰æ”¹</p>
<h4 id="2-è½®è¿­ä»£ç”Ÿæˆè½®å¯†é’¥"><a href="#2-è½®è¿­ä»£ç”Ÿæˆè½®å¯†é’¥" class="headerlink" title="2.è½®è¿­ä»£ç”Ÿæˆè½®å¯†é’¥"></a>2.è½®è¿­ä»£ç”Ÿæˆè½®å¯†é’¥</h4><p>è¿™é‡Œæµç¨‹æ¯”è¾ƒå¤š<br>é€ä¸ªæ£€æŸ¥<br>å…ˆçœ‹å›ºå®šå‚æ•°CKiçš„å€¼</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.rodata:<span class="number">0000000000006030</span> ; _QWORD qword_6030[<span class="number">32</span>]</span><br><span class="line">.rodata:<span class="number">0000000000006030</span> qword_6030      dq <span class="number">70E15</span>h, <span class="number">1</span>C232A31h, <span class="number">383F</span>464Dh, <span class="number">545B</span>6269h, <span class="number">70777E85</span>h</span><br><span class="line">.rodata:<span class="number">0000000000006030</span>                                         ; DATA XREF: sub_2220:loc_282Câ†‘o</span><br><span class="line">.rodata:<span class="number">0000000000006058</span>                 dq <span class="number">8</span>C939AA1h, <span class="number">0</span>A8AFB6BDh, <span class="number">0</span>C4CBD2D9h, <span class="number">0E0</span>E7EEF5h, <span class="number">0F</span>C030A11h</span><br><span class="line">.rodata:<span class="number">0000000000006080</span>                 dq <span class="number">181F</span>262Dh, <span class="number">343B</span>4249h, <span class="number">50575E65</span>h, <span class="number">6</span>C737A81h, <span class="number">888F</span>969Dh</span><br><span class="line">.rodata:<span class="number">00000000000060</span>A8                 dq <span class="number">0</span>A4ABB2B9h, <span class="number">0</span>C0C7CED5h, <span class="number">0</span>DCE3EAF1h, <span class="number">0F</span>8FF060Dh, <span class="number">141B</span>2229h</span><br><span class="line">.rodata:<span class="number">00000000000060</span>D0                 dq <span class="number">30373E45</span>h, <span class="number">4</span>C535A61h, <span class="number">686F</span>767Dh, <span class="number">848B</span>9299h, <span class="number">0</span>A0A7AEB5h</span><br><span class="line">.rodata:<span class="number">00000000000060F</span>8                 dq <span class="number">0B</span>CC3CAD1h, <span class="number">0</span>D8DFE6EDh, <span class="number">0F</span>4FB0209h, <span class="number">10171E25</span>h, <span class="number">2</span>C333A41h</span><br><span class="line">.rodata:<span class="number">0000000000006120</span>                 dq <span class="number">484F</span>565Dh, <span class="number">646B</span>7279h</span><br></pre></td></tr></table></figure>

<p>æ²¡æœ‰é­”æ”¹</p>
<p>å†æ£€æŸ¥ç½®æ¢Tâ€™</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">v12 = v17;</span><br><span class="line">v11 = sub_1670(v17, <span class="number">13</span>) ^ v12;</span><br><span class="line">v7 = <span class="number">957279085</span>;</span><br><span class="line">v17 = sub_1670(v17, <span class="number">23</span>) ^ v11;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„sub_1670å°±æ˜¯å‰é¢çš„ç§»ä½xorå‡½æ•° ä¹Ÿæ²¡æœ‰é­”æ”¹</p>
<p>æœ€åå¤§è‡´çœ‹çœ‹è¿­ä»£æ–¹å¼å’Œè½®æ•°ä¹Ÿæ²¡æœ‰æ”¹</p>
<p>ç¡®å®šæ˜¯æ ‡å‡†SM4å æ‰¾ä¸ªåœ¨çº¿ç½‘ç«™<br>éœ€è¦keyå’Œiv</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">v15[<span class="number">0</span>] = <span class="number">0xEFCDAB8967452301</span>LL;</span><br><span class="line">v15[<span class="number">1</span>] = <span class="number">0xEFCDAB8967452301</span>LL;</span><br><span class="line">v14[<span class="number">0</span>] = <span class="number">0x7C88631647197506</span>LL;</span><br><span class="line">v14[<span class="number">1</span>] = <span class="number">0x4A0D7D3FFF55668B</span>LL;</span><br><span class="line">v14[<span class="number">2</span>] = <span class="number">0xDEC2E93F384ED2F5</span>LL;</span><br><span class="line">v14[<span class="number">3</span>] = <span class="number">0x3C1FB1746F7F7CDB</span>LL;</span><br></pre></td></tr></table></figure>

<p>key: 0123456789ABCDEF0123456789ABCDEF<br>è¿™é‡Œkeyå’Œå¯†æ–‡éƒ½è¦ä»å°ç«¯å–(æ³¨æ„)<br>è¿™é‡Œæœ‰æ²¡æœ‰IVæ¶‰åŠåˆ°æ˜¯ECBæ¨¡å¼è¿˜æ˜¯CBCæ¨¡å¼ æ—¢ç„¶æ‰¾ä¸åˆ°IVå°±å½“ECBæ¥è§£<br>ç„¶åé€‰æ‹©nopadding<br><img src="https://s2.loli.net/2023/12/17/YpD7sKfL3v5MNCT.png" alt="img"></p>
<p>flag: flag{h3kk0_w0rld_sur3_3n0ugh}</p>
<hr>
<hr>
<p>æ€»ç»“ï¼š åˆç†googleæŸäº›å¸¸é‡å€¼(SBOX&#x2F;CONSTANTâ€¦) ä¼šå¸¦æ¥æ„å¤–ä¹‹å–œâ€¦</p>
<h2 id="ezre-å¼ºç½‘å…ˆé”‹"><a href="#ezre-å¼ºç½‘å…ˆé”‹" class="headerlink" title="ezre(å¼ºç½‘å…ˆé”‹)"></a>ezre(å¼ºç½‘å…ˆé”‹)</h2><p>ollvmç›´æ¥æ’ä»¶å»æ··æ·†</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">size_t</span> v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+12Ch] [rbp-114h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+130h] [rbp-110h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+134h] [rbp-10Ch]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+13Ch] [rbp-104h]</span></span><br><span class="line">  <span class="type">char</span> v11[<span class="number">64</span>]; <span class="comment">// [rsp+140h] [rbp-100h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v12[<span class="number">64</span>]; <span class="comment">// [rsp+180h] [rbp-C0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v13[<span class="number">64</span>]; <span class="comment">// [rsp+1C0h] [rbp-80h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">52</span>]; <span class="comment">// [rsp+200h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// [rsp+234h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">size_t</span> v16; <span class="comment">// [rsp+238h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v15 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Welcome to the CTF world:&quot;</span>);</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0x32</span>uLL);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, s);</span><br><span class="line">  v16 = <span class="built_in">strlen</span>(s);</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(s);</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">base64encode</span>(s, v11, v3);                     <span class="comment">// å˜è¡¨base64åŠ å¯†</span></span><br><span class="line">  <span class="keyword">while</span> ( v10 &lt; <span class="number">4</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">srand</span>(byte_406132);                         <span class="comment">// srand(&#x27;U&#x27;) æ¯æ¬¡çš„éšæœºç§å­è¦å˜...</span></span><br><span class="line">    v4 = <span class="built_in">strlen</span>((<span class="type">const</span> <span class="type">char</span> *)(<span class="type">unsigned</span> <span class="type">int</span>)byte_406130);</span><br><span class="line">    <span class="built_in">sub_401D10</span>(byte_406130, v4);                <span class="comment">// shuffleæ‰“ä¹±base64è¡¨</span></span><br><span class="line">    <span class="keyword">if</span> ( (v10 &amp; <span class="number">1</span>) != <span class="number">0</span> )                       <span class="comment">// v10=1,3</span></span><br><span class="line">    &#123;</span><br><span class="line">      v5 = <span class="built_in">strlen</span>(v11);</span><br><span class="line">      <span class="built_in">base64encode</span>(v11, v12, v5);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">base64decode</span>(v11, v12);                   <span class="comment">// å˜è¡¨base64è§£å¯†</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(v11, <span class="number">0</span>, <span class="number">0x32</span>uLL);</span><br><span class="line">    <span class="built_in">memcpy</span>(v11, v12, <span class="number">0x32</span>uLL);</span><br><span class="line">    ++v10;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( dword_4062C0 == <span class="number">1</span> )                      <span class="comment">// sub_402230è¿™é‡ŒæŠŠdword_4062C0ç½®ä¸º1äº†é¡ºå¸¦æŠŠæœ€åçš„å¯†æ–‡æ•°ç»„ä¹Ÿxoräº†ä¸€é“</span></span><br><span class="line">  &#123;                                             <span class="comment">// æ‰€ä»¥åº”è¯¥æ˜¯èµ°çš„è¿™ä¸ªåˆ†æ”¯</span></span><br><span class="line">    <span class="built_in">sub_402EE0</span>(byte_406130, &amp;byte_406130[<span class="number">64</span>]);  <span class="comment">// copy</span></span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">64</span>; ++i )</span><br><span class="line">      byte_406130[i] = (<span class="number">5</span> * (byte_406130[i] + <span class="number">3</span>)) ^ <span class="number">0x15</span>;<span class="comment">// å¯¹base64è¡¨å†å˜æ¢</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">64</span>; ++j )</span><br><span class="line">      byte_406130[j] ^= <span class="number">0x27</span>u;                  <span class="comment">// å¯¹base64è¡¨å˜æ¢</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sub_401EB0</span>(v12, v13);                         <span class="comment">// åˆæœ‰ä¸€å±‚åŠ å¯†</span></span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="number">0</span>; ; ++k )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( k &gt;= <span class="built_in">strlen</span>(v12) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;right!&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( byte_406180[k] != v13[k] )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;wrong!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…³äºflagçš„é•¿åº¦ æ‰¾äº†ä¸€åœˆéƒ½æ²¡æ‰¾åˆ°checkç‚¹<br>å…¶å®å¯ä»¥è¿™ä¹ˆæ¥åˆ¤æ–­ ç”±äºæœ€åçš„encæ˜¯48å­—ç¬¦<br>&#x3D;&gt; input paddingåæ˜¯36é•¿åº¦ æ„é€ 34,35,36çš„paddingè¯•ä¸€è¯•çœ‹é€€ä¸é€€å‡ºç¨‹åºå°±è¡Œäº†</p>
<p>è¿™é‡Œé™æ€å¾ˆéº»çƒ¦ ç›´æ¥åŠ¨è°ƒæå–æ•°æ®<br>æ³¨æ„åˆ°ä¸‹é¢æœ‰ä¸ª</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( dword_4062C0 == <span class="number">1</span> )                      <span class="comment">// sub_402230è¿™é‡ŒæŠŠdword_4062C0ç½®ä¸º1äº†é¡ºå¸¦æŠŠæœ€åçš„å¯†æ–‡æ•°ç»„ä¹Ÿxoräº†ä¸€é“ ç„¶è€Œè¿™æ˜¯åè°ƒè¯•ã€‚ã€‚ã€‚</span></span><br><span class="line">&#123;                                             <span class="comment">// æ‰€ä»¥åº”è¯¥æ˜¯èµ°çš„è¿™ä¸ªåˆ†æ”¯ ä¸ªé¬¼ã€‚ã€‚ã€‚</span></span><br><span class="line">  <span class="built_in">sub_402EE0</span>(byte_406130, &amp;byte_406130[<span class="number">64</span>]);  <span class="comment">// copy</span></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">64</span>; ++i )</span><br><span class="line">    byte_406130[i] = (<span class="number">5</span> * (byte_406130[i] + <span class="number">3</span>)) ^ <span class="number">0x15</span>;<span class="comment">// å¯¹base64è¡¨å†å˜æ¢</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">64</span>; ++j )</span><br><span class="line">    byte_406130[j] ^= <span class="number">0x27</span>u;                  <span class="comment">// å¯¹base64è¡¨å˜æ¢</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¾ˆå®¹æ˜“æƒ³åˆ°è·Ÿè¸ªdword_4062C0å˜é‡<br>ä¹‹å‰å”¯ä¸€å‡ºç°è¿‡çš„åœ°æ–¹</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">sub_402230</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+48h] [rbp-118h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v2; <span class="comment">// [rsp+4Ch] [rbp-114h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">256</span>]; <span class="comment">// [rsp+50h] [rbp-110h] BYREF</span></span><br><span class="line">  FILE *stream; <span class="comment">// [rsp+150h] [rbp-10h]</span></span><br><span class="line">  FILE *v5; <span class="comment">// [rsp+158h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  stream = <span class="built_in">fopen</span>(<span class="string">&quot;/proc/self/status&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  v5 = stream;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="built_in">fgets</span>(s, <span class="number">256</span>, stream) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(s, <span class="string">&quot;TracerPid:&quot;</span>, <span class="number">0xA</span>uLL) )</span><br><span class="line">    &#123;</span><br><span class="line">      __isoc99_sscanf(s, <span class="string">&quot;TracerPid:\t%d&quot;</span>, &amp;v2);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">fclose</span>(stream);</span><br><span class="line">  <span class="keyword">if</span> ( v2 )                                     <span class="comment">// å±®... åè°ƒè¯•...</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; (<span class="type">unsigned</span> __int64)i &lt; <span class="number">0x30</span>; ++i )</span><br><span class="line">      byte_406180[i] ^= <span class="number">0x34</span>u;</span><br><span class="line">    dword_4062C0 = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸ä»”ç»†çœ‹ä»¥ä¸ºè¿™é‡Œæ½œåœ¨çš„è®¾ç½®äº†1ä¸”ä¿®æ”¹äº†æœ€åçš„encæ•°ç»„<br>å…¶å®è¿™é‡Œæ˜¯ä¸ªåè°ƒè¯• å› ä¸ºv2åˆå§‹å€¼æ˜¯0çš„ è€Œå¦‚æœè°ƒè¯•çš„è¯ä¼šå‘ç°è¿™é‡Œçš„å€¼ä¼šå˜æˆéé›¶<br>å½“ç„¶ è¿™é‡Œä¸å½±å“base64è¡¨çš„shuffleå˜æ¢ æ‰€ä»¥æå–å‡ºè¡¨</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">table4=<span class="string">&quot;plxXOZtaiUneJIhk7qSYEjD1Km94o0FTu52VQgNL3vCBH8zsA/b+dycGPRMwWfr6&quot;</span></span><br><span class="line">table3=<span class="string">&quot;pnHQwlAveo4DhGg1jE3SsIqJ2mrzxCiNb+Mf0YVd5L8c97/WkOTtuKFZyRBUPX6a&quot;</span></span><br><span class="line">table2=<span class="string">&quot;Hc0xwuZmy3DpQnSgj2LhUtrlVvNYks+BX/MOoETaKqR4eb9WF8ICGzf6id1P75JA&quot;</span></span><br><span class="line">table1=<span class="string">&quot;FGseVD3ibtHWR1czhLnUfJK6SEZ2OyPAIpQoqgY0w49u+7rad5CxljMXvNTBkm/8&quot;</span></span><br><span class="line">table0=<span class="string">&quot;l+USN4J5Rfj0TaVOcnzXiPGZIBpoAExuQtHyKD692hwmqe7/Mgk8v1sdCW3bYFLr&quot;</span></span><br></pre></td></tr></table></figure>

<p>æœ€åè¿˜æœ‰ä¸€å±‚åŠ å¯†</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_401EB0</span><span class="params">(<span class="type">char</span> *a1, <span class="type">char</span> *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> v3; <span class="comment">// [rsp+8Eh] [rbp-52h]</span></span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [rsp+8Fh] [rbp-51h]</span></span><br><span class="line">  <span class="type">char</span> v5[<span class="number">52</span>]; <span class="comment">// [rsp+90h] [rbp-50h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+C4h] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [rsp+C8h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [rsp+CCh] [rbp-14h]</span></span><br><span class="line">  <span class="type">char</span> *v9; <span class="comment">// [rsp+D0h] [rbp-10h]</span></span><br><span class="line">  <span class="type">char</span> *s; <span class="comment">// [rsp+D8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  s = a1;</span><br><span class="line">  v9 = a2;</span><br><span class="line">  v8 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  v7 = <span class="number">2023</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v5, <span class="number">0</span>, <span class="number">0x32</span>uLL);</span><br><span class="line">  <span class="built_in">strncpy</span>(v5, &amp;byte_406130[<span class="number">6</span>], <span class="number">21uLL</span>);</span><br><span class="line">  v5[<span class="number">21</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">strcpy</span>(v9, s);</span><br><span class="line">  <span class="keyword">while</span> ( v6 &lt; v8 - <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v6 % <span class="number">3</span> == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v7 = (v7 + <span class="number">5</span>) % <span class="number">20</span>;</span><br><span class="line">      v3 = v5[v7 + <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( v6 % <span class="number">3</span> == <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v7 = (v7 + <span class="number">7</span>) % <span class="number">19</span>;</span><br><span class="line">      v3 = v5[v7 + <span class="number">2</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v7 = (v7 + <span class="number">3</span>) % <span class="number">17</span>;</span><br><span class="line">      v3 = v5[v7 + <span class="number">3</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    v9[v6] ^= v3;</span><br><span class="line">    v4 = v9[v6++];</span><br><span class="line">    v9[v6] ^= v4;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€†å›å»å°±å¥½äº†<br>æœ€åçš„base64tableåšçš„æ˜¯xor 0x27çš„æ“ä½œ</p>
<p>æœ€ç»ˆexp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#...</span></span><br><span class="line"><span class="comment">#...</span></span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">base64_decode</span>(<span class="params">string,table=<span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span>):</span><br><span class="line">    result=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> string:</span><br><span class="line">        <span class="keyword">if</span> i!=<span class="string">&#x27;=&#x27;</span>:</span><br><span class="line">            index=table.index(i)</span><br><span class="line">            result+=(<span class="built_in">bin</span>(index)[<span class="number">2</span>:]).zfill(<span class="number">6</span>)</span><br><span class="line">        <span class="keyword">elif</span> i==<span class="string">&#x27;=&#x27;</span>:</span><br><span class="line">            result=result[:-<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">return</span> n2s(<span class="built_in">int</span>(result,<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">base64_encode</span>(<span class="params">input_string,table = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span>):</span><br><span class="line">    input_bytes = input_string</span><br><span class="line">    padding = (<span class="number">3</span> - <span class="built_in">len</span>(input_bytes) % <span class="number">3</span>) % <span class="number">3</span></span><br><span class="line">    input_bytes+=padding*<span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line">    encoded_chars = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(input_bytes), <span class="number">3</span>):</span><br><span class="line">        chunk = (input_bytes[i] &lt;&lt; <span class="number">16</span>) | (input_bytes[i + <span class="number">1</span>] &lt;&lt; <span class="number">8</span>) | input_bytes[i + <span class="number">2</span>]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">            index = (chunk &gt;&gt; (j * <span class="number">6</span>)) &amp; <span class="number">63</span></span><br><span class="line">            encoded_chars.append(table[index])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,padding+<span class="number">1</span>):</span><br><span class="line">        encoded_chars[-i]=<span class="string">&#x27;=&#x27;</span></span><br><span class="line">    encoded_string = <span class="string">&#x27;&#x27;</span>.join(encoded_chars)</span><br><span class="line">    <span class="keyword">return</span> encoded_string</span><br><span class="line"></span><br><span class="line">base64_table0 = <span class="string">&quot;l+USN4J5Rfj0TaVOcnzXiPGZIBpoAExuQtHyKD692hwmqe7/Mgk8v1sdCW3bYFLr&quot;</span></span><br><span class="line">base64_table1 = <span class="string">&quot;FGseVD3ibtHWR1czhLnUfJK6SEZ2OyPAIpQoqgY0w49u+7rad5CxljMXvNTBkm/8&quot;</span></span><br><span class="line">base64_table2 = <span class="string">&quot;Hc0xwuZmy3DpQnSgj2LhUtrlVvNYks+BX/MOoETaKqR4eb9WF8ICGzf6id1P75JA&quot;</span></span><br><span class="line">base64_table3 = <span class="string">&quot;pnHQwlAveo4DhGg1jE3SsIqJ2mrzxCiNb+Mf0YVd5L8c97/WkOTtuKFZyRBUPX6a&quot;</span></span><br><span class="line">base64_table4 = <span class="string">&quot;plxXOZtaiUneJIhk7qSYEjD1Km94o0FTu52VQgNL3vCBH8zsA/b+dycGPRMwWfr6&quot;</span></span><br><span class="line"></span><br><span class="line">enc = [<span class="number">0x3A</span>, <span class="number">0x2C</span>, <span class="number">0x4B</span>, <span class="number">0x51</span>, <span class="number">0x68</span>, <span class="number">0x46</span>, <span class="number">0x59</span>, <span class="number">0x63</span>, <span class="number">0x24</span>, <span class="number">0x04</span>, <span class="number">0x5E</span>, <span class="number">0x5F</span>, <span class="number">0x00</span>, <span class="number">0x0C</span>, <span class="number">0x2B</span>, <span class="number">0x03</span>, <span class="number">0x29</span>, <span class="number">0x5C</span>, <span class="number">0x74</span>, <span class="number">0x70</span>, <span class="number">0x6A</span>, <span class="number">0x62</span>, <span class="number">0x7F</span>, <span class="number">0x3D</span>, <span class="number">0x2C</span>, <span class="number">0x4E</span>, <span class="number">0x6F</span>, <span class="number">0x13</span>, <span class="number">0x06</span>, <span class="number">0x0D</span>, <span class="number">0x06</span>, <span class="number">0x0C</span>, <span class="number">0x4D</span>, <span class="number">0x56</span>, <span class="number">0x0F</span>, <span class="number">0x28</span>, <span class="number">0x4D</span>, <span class="number">0x51</span>, <span class="number">0x76</span>, <span class="number">0x70</span>, <span class="number">0x2B</span>, <span class="number">0x05</span>, <span class="number">0x51</span>, <span class="number">0x68</span>, <span class="number">0x48</span>, <span class="number">0x55</span>, <span class="number">0x24</span>, <span class="number">0x19</span>]</span><br><span class="line">v5 = [<span class="built_in">ord</span>(x)^<span class="number">0x27</span> <span class="keyword">for</span> x <span class="keyword">in</span> base64_table4]</span><br><span class="line">v5 = v5[<span class="number">6</span>:<span class="number">6</span>+<span class="number">21</span>]+[<span class="number">0</span>]</span><br><span class="line">flag = enc</span><br><span class="line">v6 = <span class="number">48</span>-<span class="number">2</span></span><br><span class="line">v7 = <span class="number">8</span></span><br><span class="line">v7s = [<span class="number">3</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">8</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> v6&gt;=<span class="number">0</span>:</span><br><span class="line">    v7  = v7s[v6]</span><br><span class="line">    <span class="comment"># print(v7,end=&#x27;,&#x27;)</span></span><br><span class="line">    flag[v6+<span class="number">1</span>] ^= flag[v6]</span><br><span class="line">    <span class="keyword">if</span> v6%<span class="number">3</span>==<span class="number">1</span>:</span><br><span class="line">        flag[v6] ^= v5[v7+<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">elif</span> v6%<span class="number">3</span>==<span class="number">2</span>:</span><br><span class="line">        flag[v6] ^= v5[v7+<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag[v6] ^= v5[v7+<span class="number">3</span>]</span><br><span class="line">    v6 -= <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(x),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line">flag = <span class="string">&quot;WZqSWcUtWBLlOriEfcajWBSRstLlkEfFWR7j/R7dMCDGnp==&quot;</span></span><br><span class="line">flag = base64_decode(flag,table=base64_table4)</span><br><span class="line">flag = base64_encode(flag,table=base64_table3)</span><br><span class="line">flag = base64_decode(flag,table=base64_table2)</span><br><span class="line">flag = base64_encode(flag,table=base64_table1)</span><br><span class="line">flag = base64_decode(flag,table=base64_table0)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(flag))</span><br><span class="line"><span class="comment"># b&#x27;flag&#123;3ea590ccwxehg715264fzxnzepqz\x7f&#x27;</span></span><br></pre></td></tr></table></figure>

<p>æœ‰ç‚¹æ®‹ç¼º ä½†æœ€åä¸€ä½è‚¯å®šæ˜¯} æ‰€ä»¥æ— å…³ç´§è¦</p>
<hr>
<hr>
<p>è¿™é¢˜çš„åè°ƒè¯•é‚£é‡Œç¡®å®æŠŠæˆ‘å‘åˆ° æ‰€ä»¥è¿˜æ˜¯è¦åŠ¨è°ƒçœ‹é€»è¾‘ ä¸è¦ç›²ç›®ä¸‹è®ºæ–­<br>è¿˜æœ‰æœ€åä¸€æ­¥åŠ å¯†çš„æ—¶å€™ å„ç§ä¸‹æ ‡çš„+1&#x2F;+0 å…³ç³»ä¸è¦å¼„é”™äº†â€¦</p>
<h1 id="GDOUCTF2023"><a href="#GDOUCTF2023" class="headerlink" title="GDOUCTF2023"></a>GDOUCTF2023</h1><h2 id="L-S"><a href="#L-S" class="headerlink" title="L!S!"></a>L!S!</h2><p>â€¦<br>æ ¹æ®æç¤º ç”¨IDAçš„bindiffæ’ä»¶æŸ¥çœ‹ä¸¤ä¸ªæ–‡ä»¶çš„ä¸åŒå¤„<br>å®šä½åˆ°è¿™é‡Œ</p>
<p>origin:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = (<span class="type">void</span> **)*((_QWORD *)sorted_file + v4);</span><br><span class="line">      v7 = *((_DWORD *)v6 + <span class="number">42</span>);</span><br><span class="line">      <span class="keyword">if</span> ( v7 != <span class="number">3</span> &amp;&amp; v7 != <span class="number">9</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_6;</span><br><span class="line">      v8 = *v6;</span><br><span class="line">      <span class="keyword">if</span> ( !src )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_19;</span><br><span class="line">      component = (_BYTE *)last_component(*v6);</span><br><span class="line">      <span class="keyword">if</span> ( *component == <span class="number">46</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v16 = component[(component[<span class="number">1</span>] == <span class="number">46</span>) + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> ( !v16 || v16 == <span class="number">47</span> )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_6;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( *v8 == <span class="number">47</span> )</span><br><span class="line">      &#123;</span><br><span class="line">LABEL_19:</span><br><span class="line">        queue_directory(v8, v6[<span class="number">1</span>]);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        v10 = (<span class="type">void</span> *)file_name_concat(src, v8, <span class="number">0LL</span>);</span><br><span class="line">        queue_directory(v10, v6[<span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">free</span>(v10);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( *((_DWORD *)v6 + <span class="number">42</span>) == <span class="number">9</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      ...</span><br><span class="line">    &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>patched:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = (<span class="type">void</span> **)*((_QWORD *)sorted_file + v4);</span><br><span class="line">      v7 = *((_DWORD *)v6 + <span class="number">42</span>);</span><br><span class="line">      v8 = *v6;</span><br><span class="line">      <span class="keyword">if</span> ( v7 != <span class="number">3</span> &amp;&amp; v7 != <span class="number">9</span> )</span><br><span class="line">      &#123;</span><br><span class="line">LABEL_7:</span><br><span class="line">        <span class="keyword">if</span> ( v8 &amp;&amp; !v8[<span class="number">1</span>] )</span><br><span class="line">        &#123;</span><br><span class="line">          v19[<span class="number">1</span>] = <span class="number">0x3F7D132A2A252822</span>LL;</span><br><span class="line">          v19[<span class="number">0</span>] = <span class="number">0x7D2E370A180F1604</span>LL;</span><br><span class="line">          v20 = <span class="number">0x31207C7C381320</span>LL;</span><br><span class="line">          v19[<span class="number">2</span>] = <span class="number">0x392A7F3F39132D13</span>LL;</span><br><span class="line">          v18 = v19;</span><br><span class="line">          <span class="keyword">do</span></span><br><span class="line">          &#123;</span><br><span class="line">            *(_BYTE *)v18 ^= *(_BYTE *)*v6;</span><br><span class="line">            v18 = (__int64 *)((<span class="type">char</span> *)v18 + <span class="number">1</span>);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">while</span> ( (__int64 *)((<span class="type">char</span> *)&amp;v20 + <span class="number">7</span>) != v18 );</span><br><span class="line">          <span class="built_in">puts</span>((<span class="type">const</span> <span class="type">char</span> *)v19);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_9;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( !src )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_21;</span><br><span class="line">      component = (_BYTE *)last_component(*v6);</span><br><span class="line">      <span class="keyword">if</span> ( *component == <span class="number">46</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v17 = component[(component[<span class="number">1</span>] == <span class="number">46</span>) + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> ( !v17 || v17 == <span class="number">47</span> )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_7;</span><br><span class="line">      &#125;</span><br><span class="line">      ...&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>å‘ç°è¿™é‡Œv6æ˜¯ä¸€ä¸ªå®šå€¼ å®Œå…¨å¯ä»¥çˆ†ç ´(range(256))<br>ç„¶åå°ç«¯åºå–å‡ºv19[0,1,2],v20[0]çˆ†ç ´å³å¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="string">&quot;04160F180A372E7D&quot;</span>,<span class="string">&quot;2228252A2A137D3F&quot;</span>,<span class="string">&quot;132D13393F7F2A39&quot;</span>,<span class="string">&quot;2013387C7C2031&quot;</span>]</span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> enc:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)//<span class="number">2</span>):</span><br><span class="line">        c.append(<span class="built_in">int</span>(s[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>],<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    flag = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> cc <span class="keyword">in</span> c:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            flag+=<span class="built_in">chr</span>(cc^key)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;CTF&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># HZCTF&#123;b1ndiff_1s_a_us3ful_t00l&#125;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é¢˜å¼€å§‹æˆ‘è¿˜æƒ³ç€åŠ¨è°ƒæ‰¾v6çš„å€¼ å‘ç°ç¨‹åºç»™æˆ‘lsåå°±å¡ç€äº†â€¦</p>
<h1 id="TPCTF2023"><a href="#TPCTF2023" class="headerlink" title="TPCTF2023"></a>TPCTF2023</h1><p>å‚è€ƒ:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/0nJHKJjDFrWHgspoVF23xA"> + </a></li>
</ul>
<h2 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h2><p>è¦ç”¨pyinsxxxæå–å‡ºpyz å¿…é¡»æ»¡è¶³pythonç‰ˆæœ¬ä¸€è‡´<br>Linuxä¸‹è½½ä¸€ä¸ªpython3.8 ç„¶å</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3.8 pyxxx.py maze</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å°±èƒ½æˆåŠŸè§£åŒ…<br>ç„¶åç»ˆç«¯è¿è¡Œpython3.8 ä¹Ÿèƒ½import maze æ¥æŸ¥çœ‹å†…éƒ¨é€»è¾‘<br>è¿è¡Œ help(maze)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">Help on module maze:</span><br><span class="line"></span><br><span class="line">NAME</span><br><span class="line">    maze</span><br><span class="line"></span><br><span class="line">CLASSES</span><br><span class="line">    builtins.object</span><br><span class="line">        Q2Fy</span><br><span class="line">        Q2VsbA</span><br><span class="line">        TWF6ZUxhbmc</span><br><span class="line">    </span><br><span class="line">    class Q2Fy(builtins.object)</span><br><span class="line">     |  Q2Fy(value, x, y)</span><br><span class="line">     |  </span><br><span class="line">     |  Methods defined here:</span><br><span class="line">     |  </span><br><span class="line">     |  __init__(self, value, x, y)</span><br><span class="line">     |  </span><br><span class="line">     |  __repr__(self)</span><br><span class="line">     |  </span><br><span class="line">     |  ----------------------------------------------------------------------</span><br><span class="line">     |  Data descriptors defined here:</span><br><span class="line">     |  </span><br><span class="line">     |  __dict__</span><br><span class="line">     |      dictionary for instance variables (if defined)</span><br><span class="line">     |  </span><br><span class="line">     |  __weakref__</span><br><span class="line">:</span><br><span class="line">     |      list of weak references to the object (if defined)</span><br><span class="line">    </span><br><span class="line">    class Q2VsbA(builtins.object)</span><br><span class="line">     |  Q2VsbA(name, value)</span><br><span class="line">     |  </span><br><span class="line">     |  Methods defined here:</span><br><span class="line">     |  </span><br><span class="line">     |  __init__(self, name, value)</span><br><span class="line">     |  </span><br><span class="line">     |  __repr__(self)</span><br><span class="line">     |  </span><br><span class="line">     |  ----------------------------------------------------------------------</span><br><span class="line">     |  Data descriptors defined here:</span><br><span class="line">     |  </span><br><span class="line">     |  __dict__</span><br><span class="line">     |      dictionary for instance variables (if defined)</span><br><span class="line">     |  </span><br><span class="line">     |  __weakref__</span><br><span class="line">     |      list of weak references to the object (if defined)</span><br><span class="line">    </span><br><span class="line">    class TWF6ZUxhbmc(builtins.object)</span><br><span class="line">     |  TWF6ZUxhbmc(code)</span><br><span class="line">     |  </span><br><span class="line">     |  Methods defined here:</span><br><span class="line">     |  </span><br><span class="line">     |  YWRkX2NlbGw(self, code)</span><br><span class="line">     |  </span><br><span class="line">     |  </span><br><span class="line">     |  YWRkX2Z1bmN0aW9u(self, code)</span><br><span class="line">     |  </span><br><span class="line">     |  Z2V0X2NlbGw(self, code)</span><br><span class="line">     |  </span><br><span class="line">     |  Z2V0X3Bvcw(self, pos, direction)</span><br><span class="line">     |  </span><br><span class="line">     |  __init__(self, code)</span><br><span class="line">     |  </span><br><span class="line">     |  aW5pdA(self)</span><br><span class="line">     |  </span><br><span class="line">     |  b3Bw(self, direction)</span><br><span class="line">     |  </span><br><span class="line">     |  c3RlcA(self)</span><br><span class="line">     |  </span><br><span class="line">     |  cnVuX3RpbGxfb3V0cHV0(self)</span><br><span class="line">     |  </span><br><span class="line">     |  ----------------------------------------------------------------------</span><br><span class="line">     |  Data descriptors defined here:</span><br><span class="line">     |  </span><br><span class="line">     |  __dict__</span><br><span class="line">     |      dictionary for instance variables (if defined)</span><br><span class="line">     |  </span><br><span class="line">     |  __weakref__</span><br><span class="line">     |      list of weak references to the object (if defined)</span><br><span class="line">:</span><br><span class="line">     |      list of weak references to the object (if defined)</span><br><span class="line"></span><br><span class="line">FUNCTIONS</span><br><span class="line">    aW5pdF9zZWNyZXQ()</span><br><span class="line">    </span><br><span class="line">    c29sdmU(SvL6VEBRwx) -&gt; &#x27;int&#x27;</span><br><span class="line">    </span><br><span class="line">    exit(status=None, /)</span><br><span class="line">        Exit the interpreter by raising SystemExit(status).</span><br><span class="line">        </span><br><span class="line">        If the status is omitted or None, it defaults to zero (i.e., success).</span><br><span class="line">        If the status is an integer, it will be used as the system exit status.</span><br><span class="line">        If it is another kind of object, it will be printed and the system</span><br><span class="line">        exit status will be one (i.e., failure).</span><br><span class="line">    </span><br><span class="line">    run()</span><br><span class="line"></span><br><span class="line">DATA</span><br><span class="line">    EqdU3uQNCi = [18, 17, 15, 0, 27, 31, 10, 19, 14, 21, 25, 22, 6, 3, 30,...</span><br><span class="line">    UJ9mxXxeoS = &#x27;IyMgIyMgIyMgIyMgIyMgIyMgIyMKIyMgIyMgIyMgXl4gIyMg...gLT4g...</span><br><span class="line">    __test__ = &#123;&#125;</span><br><span class="line">    c2VjcmV0 = [7, 47, 60, 28, 39, 11, 23, 5, 49, 49, 26, 11, 63, 4, 9, 2,...</span><br><span class="line">    regexes = &#123;&#x27;direction&#x27;: &#x27;%[LRUDNlrudn]&#x27;, &#x27;function&#x27;: &#x27;[A-Za-z][A-Za-z0...</span><br><span class="line"></span><br><span class="line">FILE</span><br><span class="line">    /mnt/hgfs/c/Users/asus/Desktop/tmp/c447cfe2-3b00-4b1a-b109-c511fdb23766/maze_extracted/maze.so</span><br><span class="line"></span><br><span class="line">(END)</span><br></pre></td></tr></table></figure>

<p>å¯¼å‡ºå…³é”®æ•°æ®:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">EqdU3uQNCi =  [<span class="number">18</span>, <span class="number">17</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">27</span>, <span class="number">31</span>, <span class="number">10</span>, <span class="number">19</span>, <span class="number">14</span>, <span class="number">21</span>, <span class="number">25</span>, <span class="number">22</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">30</span>, <span class="number">8</span>, <span class="number">24</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">29</span>, <span class="number">9</span>, <span class="number">26</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">28</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">32</span>, <span class="number">12</span>, <span class="number">23</span>, <span class="number">11</span>]</span><br><span class="line"></span><br><span class="line">UJ9mxXxeoS =  IyMgIyMgIyMgIyMgIyMgIyMgIyMKIyMgIyMgIyMgXl4gIyMgXl4gIyMKIyMgIyMgIyMgLi4gIyMgSVogIyMgIyMgIyMgIyMKIyMgJVIgLi4gJUQgIyMgJUQgLi4gLi4gJUwgIyMKIyMgPj4gIyMgLi4gIyMgRUEgKiogUFAgJVUgIyMKIyMgJVUgSUEgVEEgIyMgRUIgKiogUFAgJVUgIyMKIyMgJVUgSUIgVEIgIyMgRUMgKiogUFAgJVUgIyMKIyMgJVUgSUMgVEMgIyMgRUQgKiogUFAgJVUgIyMKIyMgJVUgSUQgVEQgIyMgRUUgKiogUFAgJVUgIyMKIyMgJVUgSUUgVEUgIyMgRUYgKiogUFAgJVUgIyMKIyMgJVUgSUYgVEYgIyMgJVIgKiogSVogJVUgIyMKIyMgJVUgSUcgJUwgIyMgIyMgIyMgIyMgIyMgIyMKIyMgIyMgIyMgIyMgIyMgIyMKClBQIC0+ICs9MQpNTSAtPiAtPTEKSVogLT4gPTAKRUEgLT4gSUYgPT0wIFRIRU4gJVIgRUxTRSAlRApFQiAtPiBJRiA9PTEgVEhFTiAlUiBFTFNFICVECkVDIC0+IElGID09MiBUSEVOICVSIEVMU0UgJUQKRUQgLT4gSUYgPT0zIFRIRU4gJVIgRUxTRSAlRApFRSAtPiBJRiA9PTQgVEhFTiAlUiBFTFNFICVECkVGIC0+IElGID09NSBUSEVOICVSIEVMU0UgJUQKVEEgLT4gSUYgKiogVEhFTiAlTCBFTFNFICVECklBIC0+ID03MgpUQiAtPiBJRiAqKiBUSEVOICVMIEVMU0UgJUQKSUIgLT4gPTczClRDIC0+IElGICoqIFRIRU4gJUwgRUxTRSAlRApJQyAtPiA9ODQKVEQgLT4gSUYgKiogVEhFTiAlTCBFTFNFICVECklEIC0+ID04MApURSAtPiBJRiAqKiBUSEVOICVMIEVMU0UgJUQKSUUgLT4gPTY3ClRGIC0+IElGICoqIFRIRU4gJUwgRUxTRSAlRApJRiAtPiA9ODQKSUcgLT4gPTcwCkxUIC0+IElGID09NiBUSEVOICVEIEVMU0UgJUwK</span><br><span class="line"></span><br><span class="line">c2VjcmV0 =  [<span class="number">7</span>, <span class="number">47</span>, <span class="number">60</span>, <span class="number">28</span>, <span class="number">39</span>, <span class="number">11</span>, <span class="number">23</span>, <span class="number">5</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">26</span>, <span class="number">11</span>, <span class="number">63</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">25</span>, <span class="number">61</span>, <span class="number">36</span>, <span class="number">112</span>, <span class="number">25</span>, <span class="number">15</span>, <span class="number">62</span>, <span class="number">25</span>, <span class="number">3</span>, <span class="number">16</span>, <span class="number">102</span>, <span class="number">38</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">37</span>, <span class="number">4</span>, <span class="number">40</span>]</span><br><span class="line"></span><br><span class="line">regexes =  &#123;<span class="string">&#x27;wall&#x27;</span>: <span class="string">&#x27;##|``&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;\\.\\.&#x27;</span>, <span class="string">&#x27;splitter&#x27;</span>: <span class="string">&#x27;&lt;&gt;&#x27;</span>, <span class="string">&#x27;pause&#x27;</span>: <span class="string">&#x27;[0-9]&#123;2&#125;&#x27;</span>, <span class="string">&#x27;start&#x27;</span>: <span class="string">&#x27;\\^\\^&#x27;</span>, <span class="string">&#x27;hole&#x27;</span>: <span class="string">&#x27;\\(\\)&#x27;</span>, <span class="string">&#x27;out&#x27;</span>: <span class="string">&#x27;&gt;&gt;&#x27;</span>, <span class="string">&#x27;in&#x27;</span>: <span class="string">&#x27;&lt;&lt;&#x27;</span>, <span class="string">&#x27;one-use&#x27;</span>: <span class="string">&#x27;--&#x27;</span>, <span class="string">&#x27;direction&#x27;</span>: <span class="string">&#x27;%[LRUDNlrudn]&#x27;</span>, <span class="string">&#x27;signal&#x27;</span>: <span class="string">&#x27;(?&lt;=\\*)[\\*A-Za-z0-9]&#x27;</span>, <span class="string">&#x27;function&#x27;</span>: <span class="string">&#x27;[A-Za-z][A-Za-z0-9]&#x27;</span>&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç„¶åå°±éœ€è¦ç¡¬é€†maze.so<br>å‰é¢å¯¹mazeå¾—ä¿¡æ¯æ”¶é›†çŸ¥é“åªæœ‰ä¸¤ä¸ªå‡½æ•° ä¸”åå­—éƒ½æ˜¯ç›´æ¥base64ç¼–ç å¾— init_secretå’Œsolve<br>æ…¢æ…¢é€† solve<br>å¯ä»¥å‘ç°å¼€å§‹æ˜¯ä¸€ä¸ªb64decode ç„¶åcheck len&#x3D;&#x3D;33<br>æ¥ä¸‹æ¥è°ƒç”¨äº†init_secret ç„¶åè¿›è¡Œäº†ä¸€ä¸ªxor<br>xoråå¯ä»¥å‘ç°ç”¨åˆ°äº† _c2VjcmV0ä½œä¸ºcheck<br>ç”¨mazelangè§£é‡Šå™¨è¿è¡Œä¸€ä¸‹base64è§£ç å‡ºçš„.mz<br>å‘ç°æ²¡æœ‰è¾“å‡º ctrl+cç»ˆæ­¢å‘ç°ä¸€ç›´é‡å¤è¾“å‡º 72738480678470<br>å¾ˆå®¹æ˜“å‘ç°å°±æ˜¯HITPCTF<br>æ‰€ä»¥æˆ‘ä»¬è°ƒç”¨init_secretå å°†c2VjcmV0[i]ä¸key[i]å¼‚æˆ–å³å¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Python <span class="number">3.8</span><span class="number">.18</span> (default, Aug <span class="number">25</span> <span class="number">2023</span>, <span class="number">13</span>:<span class="number">20</span>:<span class="number">30</span>) </span><br><span class="line">[GCC <span class="number">11.4</span><span class="number">.0</span>] on linux</span><br><span class="line"><span class="type">Type</span> <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> <span class="keyword">or</span> <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> maze <span class="keyword">import</span> *</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>key = <span class="string">&quot;HITPCTF&quot;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>aW5pdF9zZWNyZXQ()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>):</span><br><span class="line"><span class="meta">... </span>    x = c2VjcmV0[i]^<span class="built_in">ord</span>(key[i%<span class="number">7</span>])</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(<span class="built_in">chr</span>((x&amp;<span class="number">0xff</span>)),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="meta">... </span></span><br><span class="line">TPCTF&#123;yOu_@re_m@sT3r_OF_mAZElaN6&#125;&gt;&gt;&gt; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>TPCTF{yOu_@re_m@sT3r_OF_mAZElaN6}</strong></p>
<h2 id="nanoPyEnc"><a href="#nanoPyEnc" class="headerlink" title="nanoPyEnc"></a>nanoPyEnc</h2><p>å¾ˆæœ‰æ„æ€çš„é¢˜<br>ä¸€æ ·çš„ python3.8è¿è¡Œpyinsxxxxxè§£åŒ…<br>ä¸»çš„run.pyä»secretè·å–key,enc å¯¹è¾“å…¥è¿›è¡Œä¸€ä¸ªAES_ECBåŠ å¯† ä¸encæ¯”è¾ƒ<br>åœ¨PYZæ‰¾åˆ°secret æ‹¿å‡ºenc&#x2F;key è§£AESå‘ç°æ˜¯ flag{test} å‡flag<br>æ³¨æ„åˆ°å¯¼å…¥äº†ä¸‰ä¸ªåŒ… è€Œä¸”PYZé‡Œæœ‰è¿™ä¸‰ä¸ª è¯´æ˜ä¸æ˜¯pythonåŸæœ¬çš„</p>
<p>æŒ¨ä¸ªçœ‹<br>é¦–å…ˆåœ¨Crypto.Util.numberçš„sieve_baseæ•°ç»„æœ€åå‘ç°æœ‰ä¸€æ®µè¦†ç›–encçš„ä»£ç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> time.time() % <span class="number">64</span> &lt; <span class="number">1</span>:</span><br><span class="line">    enc = (<span class="number">153</span>, <span class="number">240</span>, <span class="number">237</span>, <span class="number">199</span>, <span class="number">63</span>, <span class="number">44</span>, <span class="number">237</span>, <span class="number">45</span>, <span class="number">25</span>, <span class="number">47</span>, <span class="number">97</span>, <span class="number">154</span>, <span class="number">158</span>, <span class="number">112</span>, <span class="number">46</span>, <span class="number">176</span>, <span class="number">219</span>, <span class="number">247</span>, <span class="number">44</span>, <span class="number">115</span>, <span class="number">169</span>, <span class="number">124</span>, <span class="number">64</span>, <span class="number">63</span>, <span class="number">121</span>, <span class="number">253</span>, <span class="number">250</span>, <span class="number">137</span>, <span class="number">34</span>, <span class="number">144</span>, <span class="number">33</span>, <span class="number">17</span>, <span class="number">182</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">247</span>, <span class="number">249</span>, <span class="number">41</span>, <span class="number">165</span>, <span class="number">114</span>, <span class="number">87</span>, <span class="number">231</span>, <span class="number">222</span>, <span class="number">242</span>, <span class="number">126</span>, <span class="number">30</span>, <span class="number">124</span>, <span class="number">237</span>)</span><br></pre></td></tr></table></figure>

<p>åœ¨Crypto.Util.Paddingä¸­å‘ç°åˆå¼•å…¥äº†py3compat<br>æŸ¥çœ‹py3compat å‘ç°è¦†å†™äº†listæ–¹æ³• è®©ä¼ å…¥çš„sæ¯ä½xoräº†1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">list</span>(<span class="params">s</span>):</span><br><span class="line">    _x = time.time() % <span class="number">64</span> &lt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">lambda</span> <span class="number">.0</span> = <span class="literal">None</span>: [ _x ^ x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="number">.0</span> ])(s)</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„åˆ°listæ˜¯pythonè‡ªå¸¦çš„åˆ—è¡¨æ–¹æ³• åœ¨ä¸»çš„run.pyè¢«è°ƒç”¨äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">encrypted = <span class="built_in">list</span>(encrypt_message(key, message.encode()))</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥å†åŠ å¯†ååˆè¿›è¡Œäº†xor 1çš„æ“ä½œ é€†å‘å›å»å°±è¡Œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">&#x27;2033-05-18_03:33&#x27;</span></span><br><span class="line">key = key.encode()</span><br><span class="line">enc = [<span class="number">153</span>, <span class="number">240</span>, <span class="number">237</span>, <span class="number">199</span>, <span class="number">63</span>, <span class="number">44</span>, <span class="number">237</span>, <span class="number">45</span>, <span class="number">25</span>, <span class="number">47</span>, <span class="number">97</span>, <span class="number">154</span>, <span class="number">158</span>, <span class="number">112</span>, <span class="number">46</span>, <span class="number">176</span>, <span class="number">219</span>, <span class="number">247</span>, <span class="number">44</span>, <span class="number">115</span>, <span class="number">169</span>, <span class="number">124</span>, <span class="number">64</span>, <span class="number">63</span>, <span class="number">121</span>, <span class="number">253</span>, <span class="number">250</span>, <span class="number">137</span>, <span class="number">34</span>, <span class="number">144</span>, <span class="number">33</span>, <span class="number">17</span>, <span class="number">182</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">247</span>, <span class="number">249</span>, <span class="number">41</span>, <span class="number">165</span>, <span class="number">114</span>, <span class="number">87</span>, <span class="number">231</span>, <span class="number">222</span>, <span class="number">242</span>, <span class="number">126</span>, <span class="number">30</span>, <span class="number">124</span>, <span class="number">237</span>]</span><br><span class="line">enc = [x^<span class="number">1</span> <span class="keyword">for</span> x <span class="keyword">in</span> enc]</span><br><span class="line">enc = <span class="built_in">bytes</span>(enc)</span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">pt = cipher.decrypt(enc)</span><br><span class="line"><span class="built_in">print</span>(pt.decode())</span><br></pre></td></tr></table></figure>

<p><strong>TPCTF{83_C4u710U5_0F_PY7hON_k3YW0Rd_sHadOWIN9}</strong></p>
<h1 id="GXYCTF2019"><a href="#GXYCTF2019" class="headerlink" title="GXYCTF2019"></a>GXYCTF2019</h1><h2 id="minecraft"><a href="#minecraft" class="headerlink" title="minecraft"></a>minecraft</h2><p>IDAæ‰“å¼€exeçš„main</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)String_to_long(v9) != <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = (<span class="type">void</span> *)sub_7FF724273ED0((__int64)&amp;qword_7FF7242AD260, (__int64)&amp;unk_7FF7242A7780);</span><br><span class="line">    _CallMemberFunction0(v7, sub_7FF7242742A0);</span><br><span class="line">    sub_7FF72427F480(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨dllä¸­æ‰¾åˆ°String_to_long</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_BOOL8 __fastcall <span class="title">String_to_long</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">void</span> *v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">bool</span> v3; <span class="comment">// [rsp+30h] [rbp-138h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+34h] [rbp-134h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+38h] [rbp-130h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+3Ch] [rbp-12Ch]</span></span><br><span class="line">  _QWORD *v7; <span class="comment">// [rsp+48h] [rbp-120h]</span></span><br><span class="line">  <span class="type">void</span> *BASE64_INPUT; <span class="comment">// [rsp+50h] [rbp-118h]</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp+58h] [rbp-110h]</span></span><br><span class="line">  <span class="type">int</span> v10[<span class="number">8</span>]; <span class="comment">// [rsp+60h] [rbp-108h]</span></span><br><span class="line">  <span class="type">char</span> *v11; <span class="comment">// [rsp+80h] [rbp-E8h]</span></span><br><span class="line">  <span class="type">const</span> <span class="keyword">struct</span> <span class="title class_">std</span>::_Container_base0 *v12; <span class="comment">// [rsp+88h] [rbp-E0h]</span></span><br><span class="line">  __int64 v13; <span class="comment">// [rsp+90h] [rbp-D8h]</span></span><br><span class="line">  __int64 v14; <span class="comment">// [rsp+98h] [rbp-D0h]</span></span><br><span class="line">  <span class="type">char</span> *v15; <span class="comment">// [rsp+A0h] [rbp-C8h]</span></span><br><span class="line">  <span class="type">const</span> <span class="keyword">struct</span> <span class="title class_">std</span>::_Container_base0 *v16; <span class="comment">// [rsp+A8h] [rbp-C0h]</span></span><br><span class="line">  <span class="type">char</span> v17[<span class="number">32</span>]; <span class="comment">// [rsp+B0h] [rbp-B8h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v18[<span class="number">32</span>]; <span class="comment">// [rsp+D0h] [rbp-98h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v19[<span class="number">32</span>]; <span class="comment">// [rsp+F0h] [rbp-78h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v20[<span class="number">32</span>]; <span class="comment">// [rsp+110h] [rbp-58h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v21[<span class="number">32</span>]; <span class="comment">// [rsp+130h] [rbp-38h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v7 = <span class="keyword">operator</span> <span class="built_in">new</span>(<span class="number">0x128</span>ui64);</span><br><span class="line">  <span class="keyword">if</span> ( v7 )</span><br><span class="line">  &#123;</span><br><span class="line">    *v7 = <span class="number">9</span>i64;</span><br><span class="line">    <span class="function">eh vector constructor <span class="title">iterator</span><span class="params">(v7 + <span class="number">1</span>, <span class="number">0x20</span>ui64, <span class="number">9u</span>i64, sub_180003C90, (<span class="type">void</span> (__stdcall *)(<span class="type">void</span> *))sub_180003AF0)</span></span>;</span><br><span class="line">    v9 = (__int64)(v7 + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v9 = <span class="number">0</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sub_180003C90</span>(v20);</span><br><span class="line">  v11 = v18;</span><br><span class="line">  v12 = <span class="built_in">sub_180003CE0</span>((<span class="type">const</span> <span class="keyword">struct</span> std::_Container_base0 *)v18, a1);</span><br><span class="line">  BASE64_INPUT = (<span class="type">void</span> *)<span class="built_in">BASE64ENCODE</span>(v12);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">LEN0</span>(a1) &gt;= <span class="number">0xA</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_180003A60</span>((__int64)v20, (__int64)BASE64_INPUT);</span><br><span class="line">    v5 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      v13 = v5;</span><br><span class="line">      <span class="keyword">if</span> ( v5 &gt;= (<span class="type">unsigned</span> __int64)<span class="built_in">LEN0</span>((__int64)v20) )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v14 = <span class="built_in">sub_180003900</span>((__int64)v20, (__int64)v17, v5, <span class="number">4</span>);</span><br><span class="line">      <span class="built_in">sub_180003B20</span>(<span class="number">32</span>i64 * i + v9, v14);</span><br><span class="line">      <span class="built_in">sub_180003AF0</span>(v17);</span><br><span class="line">      <span class="built_in">sub_1800039E0</span>(<span class="number">32</span>i64 * i + v9, (__int64)&amp;unk_180034570);</span><br><span class="line">      v5 += <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sub_180003C90</span>(v21);</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">8</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">sub_180003A90</span>((__int64)v21, <span class="number">32</span>i64 * j + v9);</span><br><span class="line">      v15 = v19;</span><br><span class="line">      v16 = <span class="built_in">sub_180003CE0</span>((<span class="type">const</span> <span class="keyword">struct</span> std::_Container_base0 *)v19, (__int64)v21);</span><br><span class="line">      v10[j] = <span class="built_in">sub_180003390</span>(v16);              <span class="comment">// hash....</span></span><br><span class="line">    &#125;</span><br><span class="line">    v3 = <span class="number">0</span>;</span><br><span class="line">    v2 = (<span class="type">void</span> *)<span class="built_in">sub_180004B90</span>(&amp;qword_18003A200, <span class="string">&quot;-------Checking-----&quot;</span>);</span><br><span class="line">    _CallMemberFunction0(v2, (<span class="built_in">void</span> (__stdcall *)(<span class="type">void</span> *))sub_180004F60);</span><br><span class="line">    <span class="keyword">if</span> ( v10[<span class="number">0</span>] == <span class="number">0x6C43B2A7</span></span><br><span class="line">      &amp;&amp; v10[<span class="number">1</span>] == <span class="number">0x7954FD91</span></span><br><span class="line">      &amp;&amp; v10[<span class="number">2</span>] == <span class="number">0xA3E9532</span></span><br><span class="line">      &amp;&amp; v10[<span class="number">3</span>] == <span class="number">0xB87B5156</span></span><br><span class="line">      &amp;&amp; v10[<span class="number">4</span>] == <span class="number">0xDA847742</span></span><br><span class="line">      &amp;&amp; v10[<span class="number">5</span>] == <span class="number">0x2395E7F3</span></span><br><span class="line">      &amp;&amp; v10[<span class="number">6</span>] == <span class="number">0xA679D954</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v3 = v10[<span class="number">7</span>] == <span class="number">0xE1FAAFF7</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sub_180003310</span>(v9, BASE64_INPUT);</span><br><span class="line">    <span class="built_in">sub_180003AF0</span>(v21);</span><br><span class="line">    <span class="built_in">sub_180003AF0</span>(v20);</span><br><span class="line">    <span class="keyword">return</span> v3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_180003AF0</span>(v20);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>md è¿™ç§å‡½æ•°å†™æ³•å¾ˆå®¹æ˜“çœ‹æ¼æ‰æŸä¸ªâ€¦<br>è¿™é‡Œå…ˆæ˜¯ä½œäº†ä¸ªæ ‡å‡†base64encode<br>ç„¶åå››ä¸ªå­—ç¬¦ä¸€ç»„(è¿™é‡ŒåŠ¨è°ƒå¯ä»¥å‘ç°å‰é¢çš„base64inputè¢«åˆ†æˆäº†å››ä¸ªå­—ç¬¦ä¸€ç»„çš„å‡ ä¸ªç»„)<br>è¿›è¡Œäº†hashå˜æ¢</p>
<p>è¿˜è—å¾—æŒºæ·±çš„â€¦</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">HASH___</span><span class="params">(__int64 *a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  *a1 ^= <span class="number">0xC6A4A7935BD1E995</span>ui64 * (((<span class="number">0xC6A4A7935BD1E995</span>ui64 * a2) &gt;&gt; <span class="number">47</span>) ^ (<span class="number">0xC6A4A7935BD1E995</span>ui64 * a2));</span><br><span class="line">  *a1 *= <span class="number">0xC6A4A7935BD1E995</span>ui64;</span><br><span class="line">  result = *a1 + <span class="number">0xE6546B64</span>i64;</span><br><span class="line">  *a1 = result;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆå°±å››ä¸ªä¸€ç»„çˆ†ç ´ æ³¨æ„ç»†èŠ‚ï¼ æœ€åè·Ÿenc[]æ•°ç»„checkåˆè¦å°†unsigned __int64 è½¬ä¸ºunsigned int â€¦</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> <span class="title">HASH</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> a1,<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> a2)</span></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> result; <span class="comment">// rax</span></span><br><span class="line">  a1 ^= (<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>)<span class="number">0xC6A4A7935BD1E995</span> * ((((<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>)<span class="number">0xC6A4A7935BD1E995</span> * a2) &gt;&gt; <span class="number">47</span>) ^ ((<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>)<span class="number">0xC6A4A7935BD1E995</span> * a2));</span><br><span class="line">  a1 *= (<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>)<span class="number">0xC6A4A7935BD1E995</span>;</span><br><span class="line">  result = a1 + <span class="number">0xE6546B64</span>;</span><br><span class="line">  a1 = result;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> enc[]=&#123;<span class="number">0x6C43B2A7</span>,<span class="number">0x7954FD91</span>,<span class="number">0xA3E9532</span>,<span class="number">0xB87B5156</span>,<span class="number">0xDA847742</span>,<span class="number">0x2395E7F3</span>,<span class="number">0xA679D954</span>,<span class="number">0xE1FAAFF7</span>&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">9</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">bool</span> vis = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> n1=<span class="number">32</span>;n1&lt;<span class="number">129</span>&amp;&amp;vis;n1++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> n2=<span class="number">32</span>;n2&lt;<span class="number">129</span>&amp;&amp;vis;n2++)</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> n3=<span class="number">32</span>;n3&lt;<span class="number">129</span>&amp;&amp;vis;n3++)</span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> n4=<span class="number">32</span>;n4&lt;<span class="number">129</span>&amp;&amp;vis;n4++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> res = <span class="number">0</span>;</span><br><span class="line">                        res=<span class="built_in">HASH</span>(res,n1);</span><br><span class="line">                        res=<span class="built_in">HASH</span>(res,n2);</span><br><span class="line">                        res=<span class="built_in">HASH</span>(res,n3);</span><br><span class="line">                        res=<span class="built_in">HASH</span>(res,n4);</span><br><span class="line">                        <span class="keyword">if</span>((<span class="type">unsigned</span> <span class="type">int</span> )res == enc[i])</span><br><span class="line">                        &#123;</span><br><span class="line">                            vis = <span class="number">0</span>;</span><br><span class="line">                            <span class="built_in">printf</span>(<span class="string">&quot;%c%c%c%c&quot;</span>,n1,n2,n3,n4);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€åçˆ†ç ´å¾—åˆ° R1hZe0lfaGF2ZV9ub19naXIxX2ZyaWVO<br>base64è½¬ä¸€ä¸‹å³å¯</p>
<h1 id="RoarCTF2019"><a href="#RoarCTF2019" class="headerlink" title="RoarCTF2019"></a>RoarCTF2019</h1><h2 id="Polyre"><a href="#Polyre" class="headerlink" title="Polyre"></a>Polyre</h2><p>åŠ¡å¿…è®°å½•ä¸€ä¸‹<br>ç¥å¥‡çš„æ’ä»¶ orz<br>åœ¨ç½‘ä¸Šæœç´¢ollvmåæ··æ·† å¤§æ¦‚ç‡æœä¸åˆ°è¿™ä¸ªç¥å¥‡çš„plugin<br><strong>D-810</strong> !!!<br>åœ¨githubä¸Šä¸‹è½½ä¸‹æ¥ å°†d-810æ–‡ä»¶å¤¹å’ŒD-810.pyç§»åŠ¨åˆ°.&#x2F;idapro&#x2F;pluginä¸‹<br>ç„¶åæ‰“å¼€IDA(æœ€å¥½ç”¨&gt;&#x3D;7.5 &lt;8.0çš„)ctrl+shift+D<br>å¯åŠ¨ï¼ ç„¶åF5<br>æ§åˆ¶æµå¹³å¦åŒ–åçš„main:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">signed</span> __int64 v4; <span class="comment">// [rsp+1E0h] [rbp-110h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+1E8h] [rbp-108h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+1ECh] [rbp-104h]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+1ECh] [rbp-104h]</span></span><br><span class="line">  <span class="type">char</span> s1[<span class="number">48</span>]; <span class="comment">// [rsp+1F0h] [rbp-100h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">60</span>]; <span class="comment">// [rsp+220h] [rbp-D0h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v10; <span class="comment">// [rsp+25Ch] [rbp-94h]</span></span><br><span class="line">  <span class="type">char</span> *v11; <span class="comment">// [rsp+260h] [rbp-90h]</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [rsp+26Ch] [rbp-84h]</span></span><br><span class="line">  <span class="type">bool</span> v13; <span class="comment">// [rsp+272h] [rbp-7Eh]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v14; <span class="comment">// [rsp+273h] [rbp-7Dh]</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// [rsp+274h] [rbp-7Ch]</span></span><br><span class="line">  <span class="type">char</span> *v16; <span class="comment">// [rsp+278h] [rbp-78h]</span></span><br><span class="line">  <span class="type">int</span> v17; <span class="comment">// [rsp+284h] [rbp-6Ch]</span></span><br><span class="line">  <span class="type">int</span> v18; <span class="comment">// [rsp+288h] [rbp-68h]</span></span><br><span class="line">  <span class="type">bool</span> v19; <span class="comment">// [rsp+28Fh] [rbp-61h]</span></span><br><span class="line">  <span class="type">char</span> *v20; <span class="comment">// [rsp+290h] [rbp-60h]</span></span><br><span class="line">  <span class="type">int</span> v21; <span class="comment">// [rsp+298h] [rbp-58h]</span></span><br><span class="line">  <span class="type">bool</span> v22; <span class="comment">// [rsp+29Fh] [rbp-51h]</span></span><br><span class="line">  __int64 v23; <span class="comment">// [rsp+2A0h] [rbp-50h]</span></span><br><span class="line">  <span class="type">bool</span> v24; <span class="comment">// [rsp+2AFh] [rbp-41h]</span></span><br><span class="line">  __int64 v25; <span class="comment">// [rsp+2B0h] [rbp-40h]</span></span><br><span class="line">  __int64 v26; <span class="comment">// [rsp+2B8h] [rbp-38h]</span></span><br><span class="line">  __int64 v27; <span class="comment">// [rsp+2C0h] [rbp-30h]</span></span><br><span class="line">  __int64 v28; <span class="comment">// [rsp+2C8h] [rbp-28h]</span></span><br><span class="line">  <span class="type">int</span> v29; <span class="comment">// [rsp+2D0h] [rbp-20h]</span></span><br><span class="line">  <span class="type">int</span> v30; <span class="comment">// [rsp+2D4h] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">char</span> *v31; <span class="comment">// [rsp+2D8h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> v32; <span class="comment">// [rsp+2E0h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v33; <span class="comment">// [rsp+2E4h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">bool</span> v34; <span class="comment">// [rsp+2EBh] [rbp-5h]</span></span><br><span class="line"></span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0x30</span>uLL);</span><br><span class="line">  <span class="built_in">memset</span>(s1, <span class="number">0</span>, <span class="built_in">sizeof</span>(s1));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Input:&quot;</span>);</span><br><span class="line">  v11 = s;</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, s);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v12 = i;</span><br><span class="line">    v13 = i &lt; <span class="number">64</span>;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= <span class="number">64</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v14 = s[i];</span><br><span class="line">    v15 = v14;</span><br><span class="line">    <span class="keyword">if</span> ( v14 == <span class="number">10</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v16 = &amp;s[i];</span><br><span class="line">      *v16 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v17 = i + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; ; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v18 = j;</span><br><span class="line">    v19 = j &lt; <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">if</span> ( j &gt;= <span class="number">6</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v20 = s;</span><br><span class="line">    v4 = *(_QWORD *)&amp;s[<span class="number">8</span> * j];</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; ; ++k )</span><br><span class="line">    &#123;</span><br><span class="line">      v21 = k;</span><br><span class="line">      v22 = k &lt; <span class="number">64</span>;</span><br><span class="line">      <span class="keyword">if</span> ( k &gt;= <span class="number">64</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v23 = v4;</span><br><span class="line">      v24 = v4 &lt; <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v4 &lt; <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v25 = <span class="number">2</span> * v4;</span><br><span class="line">        v26 = <span class="number">2</span> * v4;</span><br><span class="line">        v4 = (<span class="number">2</span> * v4) ^ <span class="number">0xB0004B7679FA26B3</span>LL;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        v27 = v4;</span><br><span class="line">        v28 = <span class="number">2</span> * v4;</span><br><span class="line">        v4 *= <span class="number">2LL</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      v29 = k;</span><br><span class="line">    &#125;</span><br><span class="line">    v30 = <span class="number">8</span> * j;</span><br><span class="line">    v31 = &amp;s1[<span class="number">8</span> * j];</span><br><span class="line">    *(_QWORD *)v31 = v4;</span><br><span class="line">    v32 = j + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v33 = <span class="built_in">memcmp</span>(s1, &amp;unk_402170, <span class="number">0x30</span>uLL);</span><br><span class="line">  v34 = v33 != <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> v10;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸æ¸…æ™°å¤šäº†â€¦<br>è¿˜æœ‰ä¸€ä¸ªå¾ˆçƒ¦çš„ç‚¹ è¿™ä¸ªunsignedå’Œsignedç»•æ¥ç»•å»çš„â€¦(é‡ç‚¹æ˜¯åˆ†æç¬¦å·ä½)<br>æ ¹æ®v4&lt;0çš„åˆ†æ”¯ ä¹˜2å†xorä¸€ä¸ªå¥‡æ•°åè‚¯å®šæ˜¯ä¸€ä¸ªå¥‡æ•°<br>è€Œv4&gt;0æ—¶ç›´æ¥ä¹˜2 è‚¯å®šæ˜¯ä¸ªå¶æ•°<br>é‚£ä¹ˆæ ¹æ®å¥‡å¶å°±èƒ½çŸ¥é“v4ä¹‹å‰æ˜¯å¦ä¸ºè´Ÿæ•°<br>é‚£ä¹ˆæˆ‘ä»¬é€†å‘è¿˜åŸä¹‹å‰çš„v4å°±è¦ä¿è¯v4ä¸ºè´Ÿæ•° ä¸ºäº†ä¿è¯è¿™ä¸€ç‚¹éœ€è¦ |&#x3D; 0x8000000000000000<br>(å½“ä¸ªçŸ¥è¯†ç‚¹è®°ä½å§)<br>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">0xBC8FF26D43536296</span>, <span class="number">0x520100780530EE16</span>, <span class="number">0x4DC0B5EA935F08EC</span>, <span class="number">0x342B90AFD853F450</span>, </span><br><span class="line">    <span class="number">0x8B250EBCAA2C3681</span>, <span class="number">0x55759F81A2C68AE4</span>, <span class="number">0xB0004B7679FA26B3</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> enc:</span><br><span class="line">    x = c</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        <span class="keyword">if</span>(x&amp;<span class="number">1</span>==<span class="number">1</span>):</span><br><span class="line">            x ^= <span class="number">0xB0004B7679FA26B3</span></span><br><span class="line">            x //= <span class="number">2</span></span><br><span class="line">            x |= <span class="number">0x8000000000000000</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x //= <span class="number">2</span></span><br><span class="line">    <span class="built_in">print</span>((long_to_bytes(x).decode()[::-<span class="number">1</span>]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># flag&#123;6ff29390-6c20-4c56-ba70-a95758e3d1f8&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="ç½‘é¼æ¯2018"><a href="#ç½‘é¼æ¯2018" class="headerlink" title="ç½‘é¼æ¯2018"></a>ç½‘é¼æ¯2018</h1><h2 id="æœ€å¥½çš„è¯­è¨€"><a href="#æœ€å¥½çš„è¯­è¨€" class="headerlink" title="æœ€å¥½çš„è¯­è¨€"></a>æœ€å¥½çš„è¯­è¨€</h2><p>å‚è€ƒ:<br><a href="https://www.wolai.com/ctfhub/hF9r3aJKC7d2uxwZMa85gp" target="_blank"> + </a></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">magic 03f30d0a</span><br><span class="line">moddate 6d4a695b (Tue Aug  7 15:29:49 2018)</span><br><span class="line"><span class="tag">&lt;<span class="name">code</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">argcount</span>&gt;</span> 0 <span class="tag">&lt;/<span class="name">argcount</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">nlocals</span>&gt;</span> 0<span class="tag">&lt;/<span class="name">nlocals</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">stacksize</span>&gt;</span> 5<span class="tag">&lt;/<span class="name">stacksize</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">flags</span>&gt;</span> 0040<span class="tag">&lt;/<span class="name">flags</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">code</span>&gt;</span></span><br><span class="line">      6400006401006c00005a00006400006402006c01006d02005a0200016400</span><br><span class="line">      006401006c03005a03006400006401006c04005a04006403005a05006404</span><br><span class="line">      008400005a06006405008400005a07006506006505006406002083010065</span><br><span class="line">      070065050064060064070021830100176506006505006407001f83010017</span><br><span class="line">      5a08006500006a090065080083010047486408005a080064010053</span><br><span class="line">   <span class="tag">&lt;/<span class="name">code</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">names</span>&gt;</span> (&#x27;base64&#x27;, &#x27;hashlib&#x27;, &#x27;md5&#x27;, &#x27;random&#x27;, &#x27;string&#x27;, &#x27;f&#x27;, &#x27;_&#x27;, &#x27;____&#x27;, &#x27;e&#x27;, &#x27;b64encode&#x27;)<span class="tag">&lt;/<span class="name">names</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">varnames</span>&gt;</span> ()<span class="tag">&lt;/<span class="name">varnames</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">freevars</span>&gt;</span> ()<span class="tag">&lt;/<span class="name">freevars</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">cellvars</span>&gt;</span> ()<span class="tag">&lt;/<span class="name">cellvars</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">filename</span>&gt;</span> &#x27;re2.py&#x27;<span class="tag">&lt;/<span class="name">filename</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">name</span>&gt;</span> &#x27;<span class="tag">&lt;<span class="name">module</span>&gt;</span>&#x27;<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">firstlineno</span>&gt;</span> 1<span class="tag">&lt;/<span class="name">firstlineno</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">consts</span>&gt;</span></span><br><span class="line">      -1</span><br><span class="line">      None</span><br><span class="line">      (&#x27;md5&#x27;,)</span><br><span class="line">      &#x27;flag&#123;*******&#125;&#x27;</span><br><span class="line">      <span class="tag">&lt;<span class="name">code</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">argcount</span>&gt;</span> 1 <span class="tag">&lt;/<span class="name">argcount</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">nlocals</span>&gt;</span> 4<span class="tag">&lt;/<span class="name">nlocals</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">stacksize</span>&gt;</span> 8<span class="tag">&lt;/<span class="name">stacksize</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">flags</span>&gt;</span> 0043<span class="tag">&lt;/<span class="name">flags</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">code</span>&gt;</span></span><br><span class="line">            6401006a00007401006a02007403006a04006402008302008301007d0100</span><br><span class="line">            6401007d02007846007405007406007c0000830100830100445d32007d03</span><br><span class="line">            007c02007407007408007c00007c0300198301007408007c01007c030064</span><br><span class="line">            0200161983010041830100377d0200713700577c020053</span><br><span class="line">         <span class="tag">&lt;/<span class="name">code</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">names</span>&gt;</span> (&#x27;join&#x27;, &#x27;random&#x27;, &#x27;sample&#x27;, &#x27;string&#x27;, &#x27;digits&#x27;, &#x27;range&#x27;, &#x27;len&#x27;, &#x27;chr&#x27;, &#x27;ord&#x27;)<span class="tag">&lt;/<span class="name">names</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">varnames</span>&gt;</span> (&#x27;b&#x27;, &#x27;__&#x27;, &#x27;___&#x27;, &#x27;i&#x27;)<span class="tag">&lt;/<span class="name">varnames</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">freevars</span>&gt;</span> ()<span class="tag">&lt;/<span class="name">freevars</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">cellvars</span>&gt;</span> ()<span class="tag">&lt;/<span class="name">cellvars</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">filename</span>&gt;</span> &#x27;re2.py&#x27;<span class="tag">&lt;/<span class="name">filename</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">name</span>&gt;</span> &#x27;_&#x27;<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">firstlineno</span>&gt;</span> 7<span class="tag">&lt;/<span class="name">firstlineno</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">consts</span>&gt;</span></span><br><span class="line">            None</span><br><span class="line">            &#x27;&#x27;</span><br><span class="line">            4</span><br><span class="line">         <span class="tag">&lt;/<span class="name">consts</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">lnotab</span>&gt;</span> 00011e01060119013001<span class="tag">&lt;/<span class="name">lnotab</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">code</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">code</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">argcount</span>&gt;</span> 1 <span class="tag">&lt;/<span class="name">argcount</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">nlocals</span>&gt;</span> 2<span class="tag">&lt;/<span class="name">nlocals</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">stacksize</span>&gt;</span> 2<span class="tag">&lt;/<span class="name">stacksize</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">flags</span>&gt;</span> 0043<span class="tag">&lt;/<span class="name">flags</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">code</span>&gt;</span></span><br><span class="line">            7400008300007d01007c01006a01007c0000830100017c01006a02008300</span><br><span class="line">            0053</span><br><span class="line">         <span class="tag">&lt;/<span class="name">code</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">names</span>&gt;</span> (&#x27;md5&#x27;, &#x27;update&#x27;, &#x27;digest&#x27;)<span class="tag">&lt;/<span class="name">names</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">varnames</span>&gt;</span> (&#x27;a&#x27;, &#x27;___&#x27;)<span class="tag">&lt;/<span class="name">varnames</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">freevars</span>&gt;</span> ()<span class="tag">&lt;/<span class="name">freevars</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">cellvars</span>&gt;</span> ()<span class="tag">&lt;/<span class="name">cellvars</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">filename</span>&gt;</span> &#x27;re2.py&#x27;<span class="tag">&lt;/<span class="name">filename</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">name</span>&gt;</span> &#x27;____&#x27;<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">firstlineno</span>&gt;</span> 14<span class="tag">&lt;/<span class="name">firstlineno</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">consts</span>&gt;</span></span><br><span class="line">            None</span><br><span class="line">         <span class="tag">&lt;/<span class="name">consts</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">lnotab</span>&gt;</span> 000109010d01<span class="tag">&lt;/<span class="name">lnotab</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">code</span>&gt;</span></span><br><span class="line">      12</span><br><span class="line">      19</span><br><span class="line">      &#x27;U1VQU05pSHdqCEJrQu7FS7Vngk1OTQ58qqghXmt2AUdrcFBBUEU=&#x27;</span><br><span class="line">   <span class="tag">&lt;/<span class="name">consts</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">lnotab</span>&gt;</span> 0c0110010c010c020601090709052f010e01<span class="tag">&lt;/<span class="name">lnotab</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">code</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°<a href="https://github.com/hinus/railgun/blob/master/src/main/python/rgparser/show.py" target="_blank">é¡¹ç›®åœ°å€</a><br>è¿™ç§å°±è‡ªå·±å†™å‡ ä¸ªpythonç¨‹åºè®©æºç ç¼–è¯‘çœ‹çœ‹ç»“æ„<br>ä½†tmd python2 â€¦<br>è¿˜ä¸å¦‚ç›´æ¥ç¡¬çŒœâ€¦<br>â€¦<br>ä½¬ç»™çš„ä»£ç :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">f = <span class="string">&#x27;flag&#123;*******&#125;&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_</span>(<span class="params">b</span>):</span><br><span class="line">    __ = <span class="string">&#x27;&#x27;</span>.join(random.sample(string.digits,<span class="number">4</span>))</span><br><span class="line">    ___ = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(b)):</span><br><span class="line">        ___ += <span class="built_in">chr</span>(<span class="built_in">ord</span>(b[i])^<span class="built_in">ord</span>(__[i % <span class="number">4</span>]))</span><br><span class="line">    <span class="keyword">return</span> ___</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">____</span>(<span class="params">a</span>):</span><br><span class="line">    ___ = md5()</span><br><span class="line">    ___.update(a)</span><br><span class="line">    <span class="keyword">return</span> ___.digest()</span><br><span class="line">e = _(f[:<span class="number">12</span>])+____(f[<span class="number">12</span>:<span class="number">19</span>])+_(f[<span class="number">19</span>:])</span><br><span class="line"><span class="built_in">print</span> base64.b64encode(e)</span><br><span class="line">e = <span class="string">&#x27;U1VQU05pSHdqCEJrQu7FS7Vngk1OTQ58qqghXmt2AUdrcFBBUEU=&#x27;</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åå°±çˆ†ç ´md5 è¿˜åŸkeyâ€¦<br>æœ€åå¾—åˆ°:<br><strong>flag{PyC_1s_613u21i_N0t_Hard}</strong></p>
<hr>
<hr>
<p>ä»¥åæœ‰ç©ºå†æ¥æ…¢æ…¢æ¨å§â€¦<br>é¢˜ç›®æŠŠdisæ®µåˆ æ‰åèƒ½æ¨å‡ºè¿™ä¸ªæ¥çš„çœŸçš„æ˜¯ç¥ä»™ orzâ€¦</p>
<h1 id="ç¾ŠåŸæ¯2023"><a href="#ç¾ŠåŸæ¯2023" class="headerlink" title="ç¾ŠåŸæ¯2023"></a>ç¾ŠåŸæ¯2023</h1><h2 id="CSGO"><a href="#CSGO" class="headerlink" title="CSGO"></a>CSGO</h2><p>å­¦ä¹ åˆ°äº†sharpOD orz<br>IDAçš„è¯æ²¡åŠæ³•åŠ¨è°ƒ è‡³å°‘å¾ˆéš¾åŠ¨è°ƒ<br>FindCryptæ’ä»¶å¯ä»¥å‘ç°æœ‰base64åŠ å¯†<br>æŸ¥çœ‹äº¤å‰å¼•ç”¨ åœ¨æ±‡ç¼–ä»£ç ä¸­å®šä½åˆ°å­—ä¸²</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">000000000049B</span>144                 mov     [rsp+<span class="number">0</span>C8h+var_88], rcx</span><br><span class="line">.text:<span class="number">000000000049B</span>149                 mov     [rsp+<span class="number">0</span>C8h+var_80], rdi</span><br><span class="line">.text:<span class="number">000000000049B</span>14E                 mov     [rsp+<span class="number">0</span>C8h+var_70], rdx</span><br><span class="line">.text:<span class="number">000000000049B</span>153                 lea     rcx, BASE64_table_4D9278 ; <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklm&quot;</span>...</span><br><span class="line">.text:<span class="number">000000000049B</span>15A                 movzx   ebx, byte ptr [rax+rcx+<span class="number">0B</span>h]</span><br><span class="line">.text:<span class="number">000000000049B</span>15F                 <span class="keyword">xor</span>     eax, eax</span><br><span class="line">.text:<span class="number">000000000049B</span>161                 call    runtime_intstring</span><br><span class="line">.text:<span class="number">000000000049B</span>166                 mov     rcx, [rsp+<span class="number">0</span>C8h+var_88]</span><br><span class="line">.text:<span class="number">000000000049B</span>16B                 mov     rdi, rax</span><br><span class="line">.text:<span class="number">000000000049B</span>16E                 mov     rsi, rbx</span><br><span class="line">.text:<span class="number">000000000049B</span>171                 <span class="keyword">xor</span>     eax, eax</span><br><span class="line">.text:<span class="number">000000000049B</span>173                 mov     rbx, [rsp+<span class="number">0</span>C8h+var_70]</span><br><span class="line">.text:<span class="number">000000000049B</span>178                 call    runtime_concatstring2</span><br><span class="line">.text:<span class="number">000000000049B</span>17D                 mov     rcx, [rsp+<span class="number">0</span>C8h+var_80]</span><br><span class="line">.text:<span class="number">000000000049B</span>182                 inc     rcx</span><br><span class="line">.text:<span class="number">000000000049B</span>185                 mov     rdx, rax</span><br><span class="line">.text:<span class="number">000000000049B</span>188                 mov     rax, rcx</span><br><span class="line">.text:<span class="number">000000000049B</span>18B                 mov     rcx, rbx</span><br></pre></td></tr></table></figure>

<p>åœ¨mainçš„æ±‡ç¼–å¯ä»¥æ‰¾åˆ°æœ€ååŠ å¯†å¯¹æ¯”å­—ç¬¦ä¸²</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mov     rcx, rbx</span><br><span class="line">lea     rbx, aCpqebacrpNZepY ; <span class="string">&quot;cPQebAcRp+n+ZeP+YePEWfP7bej4YefCYd/7cuP&quot;</span>...</span><br><span class="line">call    runtime_memequal</span><br><span class="line">test    al, al</span><br><span class="line">jnz     <span class="type">short</span> loc_49B282</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ç›´æ¥è§£å‘ç°æ˜¯ä¹±ç <br>é‚£ä¹ˆè¦ä¹ˆæ¢è¡¨ è¦ä¹ˆbase64åè¿˜è¿›è¡Œäº†åŠ å¯†<br>ä½†æ˜¯çœ‹å¯†æ–‡å½¢å¼(&#x3D;) åªå¯èƒ½æ˜¯æ¢è¡¨ ä½†åªæœ‰ä¸Šé¢æ‰¾åˆ°çš„ä¸€å¤„lea â€¦ ABCDâ€¦<br>ç†è®ºå¯ä»¥åŠ¨è°ƒæŸ¥çœ‹<br>ä½†IDAåŠ¨è°ƒä¼šç›´æ¥while(1)å¡æ­»<br>åè°ƒè¯•é€»è¾‘ä¹Ÿæ¯”è¾ƒå¤æ‚<br>è¿™é‡Œå­¦ä¹ åˆ°äº†ç”¨x64dbgçš„sharpODæ’ä»¶è¿‡æ‰åè°ƒè¯•çš„æ–¹æ³•</p>
<p>æœç´¢å®‰è£…å¥½æ’ä»¶ æŠŠé»˜è®¤å‹¾ä¸Šçš„éƒ½å‹¾ä¸Š<br>åœ¨x64ä¸­æœç´¢ABCDâ€¦ å®šä½åˆ°ä»£ç æ®µ<br>ä¸‹ä¸ªæ–­ç‚¹ å°±èƒ½è¿è¡Œäº†<br>è¾“å…¥flagåä¸€ç›´F9 å¯ä»¥å‘ç°å‡ºç°äº†ä¸€ä¸ªå¾ˆå¤§çš„å¾ªç¯ å¯¹base64è¡¨è¿›è¡Œäº†å˜æ¢</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0000000000B</span>5B14 | <span class="number">48</span>:<span class="number">895424</span> <span class="number">58</span>            | mov qword ptr ss:[rsp+<span class="number">58</span>],rdx           | [rsp+<span class="number">58</span>]:<span class="string">&quot;LMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/ABCDEFGHI&quot;</span></span><br><span class="line"><span class="number">0000000000B</span>5B15 | <span class="number">48</span>:<span class="number">8</span>D0D <span class="number">1</span>EE10300        | lea rcx,qword ptr ds:[B99278]           | <span class="number">0000000000B</span>99278:<span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°è¿™é‡Œé€»è¾‘å°±æ˜¯åšäº†ä¸€ä¸ªæ•´ä½“å¹³ç§» é‚£ä¹ˆæå–å‡ºå˜è¡¨base64è§£å¯†å³å¯<br>flag: DASCTF{73913519-A0A6-5575-0F10-DDCBF50FA8CA}</p>
<hr>
<hr>
<p>æŠ½ç©ºè¿˜å¾—çœ‹çœ‹å…·ä½“æ€ä¹ˆåè°ƒè¯•çš„ ä»¥åŠIDAæ€ä¹ˆååè°ƒè¯•</p>
<p>å…¶å®é€šè¿‡è¿™æ®µä»£ç (æ¦‚ç‡æ€§çš„F5å‡ºæ¥äº†)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">v19 = (<span class="type">unsigned</span> __int8)BASE64_table_4D9278[v25 + <span class="number">11</span>];</span><br><span class="line">v8 = <span class="built_in">runtime_intstring</span>(</span><br><span class="line">       <span class="number">0</span>,</span><br><span class="line">       v19,</span><br><span class="line">       (<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>,</span><br><span class="line">       v24,</span><br><span class="line">       (<span class="type">int</span>)v25 + <span class="number">11</span>,</span><br><span class="line">       v12,</span><br><span class="line">       v13,</span><br><span class="line">       v14,</span><br><span class="line">       v15,</span><br><span class="line">       v53,</span><br><span class="line">       v59);</span><br><span class="line"><span class="built_in">LODWORD</span>(v9) = v19;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çŒœåˆ°å¤§è‡´æ˜¯ç§»ä½11ä½ å¤–é¢å¥—äº†ä¸ª64çš„å¾ªç¯ é‚£ä¹ˆåº”è¯¥æ˜¯å–indexèµ‹å€¼ä¹‹ç±»</p>
<h2 id="Blast"><a href="#Blast" class="headerlink" title="Blast"></a>Blast</h2><p>ç”¨D810ç¨å¾®å»äº†ç‚¹æ··æ·†<br>main</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  v45 = a1;</span><br><span class="line">  v44 = a2;</span><br><span class="line">  v43 = &amp;v8;</span><br><span class="line">  v42 = &amp;v8;</span><br><span class="line">  v41 = &amp;v8;</span><br><span class="line">  v40 = &amp;v8;</span><br><span class="line">  v46 = <span class="number">0</span>;</span><br><span class="line">  s = (<span class="type">char</span> *)(&amp;v8 - <span class="number">4</span>);</span><br><span class="line">  v38 = &amp;v8 - <span class="number">4</span>;</span><br><span class="line">  v37 = &amp;v8 - <span class="number">24</span>;</span><br><span class="line">  v36 = &amp;v8 - <span class="number">4</span>;</span><br><span class="line">  v35 = &amp;v47;</span><br><span class="line">  v34 = &amp;v8 - <span class="number">4</span>;</span><br><span class="line">  v9 = <span class="built_in">HIDWORD</span>(a2);</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      v33 = *v41;</span><br><span class="line">    <span class="keyword">while</span> ( dword_40F9A8 &gt;= <span class="number">10</span> &amp;&amp; dword_40F9A8 &lt; <span class="number">10</span> );</span><br><span class="line">    v32 = v33;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      v31 = <span class="built_in">strlen</span>((<span class="type">const</span> <span class="type">char</span> *)(<span class="type">unsigned</span> <span class="type">int</span>)a0123456789abcd);</span><br><span class="line">    <span class="keyword">while</span> ( dword_40F9A8 &lt; <span class="number">10</span> &amp;&amp; dword_40F9A8 &gt;= <span class="number">10</span> );</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      v30 = v32 &lt; v31;</span><br><span class="line">    <span class="keyword">while</span> ( dword_40F9A8 &lt; <span class="number">10</span> &amp;&amp; dword_40F9A8 &gt;= <span class="number">10</span> );</span><br><span class="line">    <span class="keyword">if</span> ( !v30 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      v29 = *v41;</span><br><span class="line">    <span class="keyword">while</span> ( dword_40F9A8 &lt; <span class="number">10</span> &amp;&amp; dword_40F9A8 &gt;= <span class="number">10</span> );</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      v28 = &amp;a0123456789abcd[v29];</span><br><span class="line">    <span class="keyword">while</span> ( dword_40F9A8 &gt;= <span class="number">10</span> &amp;&amp; dword_40F9A8 &lt; <span class="number">10</span> );</span><br><span class="line">    byte_40E060[*v41] = *v28;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      v27 = *v41;</span><br><span class="line">    <span class="keyword">while</span> ( dword_40F9A8 &lt; <span class="number">10</span> &amp;&amp; dword_40F9A8 &gt;= <span class="number">10</span> );</span><br><span class="line">    v26 = v27 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( dword_40F9A8 &gt;= <span class="number">10</span> &amp;&amp; dword_40F9A8 &lt; <span class="number">10</span> )</span><br><span class="line">LABEL_38:</span><br><span class="line">      *v41 = v26;</span><br><span class="line">    *v41 = v26;</span><br><span class="line">    <span class="keyword">if</span> ( dword_40F9A8 &lt; <span class="number">10</span> &amp;&amp; dword_40F9A8 &gt;= <span class="number">10</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_38;</span><br><span class="line">    <span class="keyword">while</span> ( dword_40F9A8 &gt;= <span class="number">10</span> &amp;&amp; dword_40F9A8 &lt; <span class="number">10</span> )</span><br><span class="line">      ;</span><br><span class="line">  &#125;</span><br><span class="line">  v25 = <span class="built_in">gets</span>(INPUT);                            <span class="comment">// INPUT here</span></span><br><span class="line">  *v40 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">LABEL_16:</span><br><span class="line">    v24 = *v40;</span><br><span class="line">  <span class="keyword">while</span> ( dword_40F9A8 &lt; <span class="number">10</span> &amp;&amp; dword_40F9A8 &gt;= <span class="number">10</span> );</span><br><span class="line">  v23 = v24 &lt; <span class="number">47</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v24 &lt; <span class="number">47</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v22 = *v40;</span><br><span class="line">    *s = INPUT[v22];</span><br><span class="line">    <span class="built_in">sub_404010</span>(v37);                            <span class="comment">// md5å¸¸é‡åˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v21 = <span class="number">1</span>;</span><br><span class="line">      v20 = <span class="built_in">strlen</span>(s);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( !((v21 | <span class="number">1</span>) &amp; (dword_40F9A8 &lt; <span class="number">10</span>) | ((<span class="type">unsigned</span> __int8)(~(dword_40F9A8 &lt; <span class="number">10</span>) | v21 ^ <span class="number">1</span>) ^ (((v21 &amp; <span class="number">1</span>) == <span class="number">0</span>) | <span class="number">0xFE</span>)) &amp; <span class="number">1</span>) );</span><br><span class="line">    <span class="keyword">if</span> ( dword_40F9A8 &lt; <span class="number">10</span> &amp;&amp; dword_40F9A8 &gt;= <span class="number">10</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_42;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">sub_404140</span>(v37, s, (<span class="type">unsigned</span> <span class="type">int</span>)v20);</span><br><span class="line">      <span class="built_in">sub_40A510</span>(v37, v38);</span><br><span class="line">      *v36 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( dword_40F9A8 &gt;= <span class="number">10</span> || dword_40F9A8 &lt; <span class="number">10</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">LABEL_42:</span><br><span class="line">      <span class="built_in">sub_404140</span>(v37, s, (<span class="type">unsigned</span> <span class="type">int</span>)v20);</span><br><span class="line">      <span class="built_in">sub_40A510</span>(v37, v38);</span><br><span class="line">      *v36 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v19 = *v36;</span><br><span class="line">      v18 = v19 &lt; <span class="number">16</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v19 &gt;= <span class="number">16</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v10 = *v40;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">          v9 = v10 + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> ( dword_40F9A8 &lt; <span class="number">10</span> &amp;&amp; dword_40F9A8 &gt;= <span class="number">10</span> );</span><br><span class="line">        *v40 = v9;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_16;</span><br><span class="line">      &#125;</span><br><span class="line">      v17 = *v36;</span><br><span class="line">      v16 = v17;</span><br><span class="line">      v15 = *((<span class="type">unsigned</span> __int8 *)v38 + v17);</span><br><span class="line">      v14 = <span class="number">0</span>;</span><br><span class="line">      v13 = <span class="number">16</span>;</span><br><span class="line">      v3 = v35;</span><br><span class="line">      *(_BYTE *)v35 = byte_40E060[v15 / <span class="number">16LL</span>];</span><br><span class="line">      v4 = v36;</span><br><span class="line">      v5 = v34;</span><br><span class="line">      *(_BYTE *)v34 = byte_40E060[*((<span class="type">unsigned</span> __int8 *)v38 + *v36) % <span class="number">16</span>];</span><br><span class="line">      v6 = v40;</span><br><span class="line">      byte_40E700[<span class="number">33</span> * *v40 + <span class="number">2</span> * *v4] = *(_BYTE *)v3;</span><br><span class="line">      byte_40E700[<span class="number">33</span> * *v6 + <span class="number">2</span> * *v4 - (v14 - <span class="number">1</span>)] = *(_BYTE *)v5;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">        v12 = *v36;</span><br><span class="line">      <span class="keyword">while</span> ( dword_40F9A8 &gt;= <span class="number">10</span> &amp;&amp; dword_40F9A8 &lt; <span class="number">10</span> );</span><br><span class="line">      v11 = v12 + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> ( dword_40F9A8 &gt;= <span class="number">10</span> &amp;&amp; dword_40F9A8 &lt; <span class="number">10</span> )</span><br><span class="line">LABEL_44:</span><br><span class="line">        *v36 = v11;</span><br><span class="line">      *v36 = v11;</span><br><span class="line">      <span class="keyword">if</span> ( dword_40F9A8 &lt; <span class="number">10</span> &amp;&amp; dword_40F9A8 &gt;= <span class="number">10</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_44;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sub_402370</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>çœ‹ç€å¥½å¤šdo-while å…¶å®å°±åªæ‰§è¡Œä¸€æ¬¡<br>FindCryptæ‰¾åˆ°md5åŠ å¯†ç‰¹å¾ åŒæ—¶åœ¨sub_404010ä¹Ÿæ‰¾åˆ°md5å¸¸é‡<br>å†åŠ ä¸Šæ‰¾åˆ°çš„</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">.data:<span class="number">000000000040E0</span>A0	global	Big_Numbers1_40E0A0	$c0	b<span class="number">&#x27;14</span>d89c38cd0fb23a14be2798d449c182<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E0</span>C1	global	Big_Numbers1_40E0C1	$c0	b<span class="number">&#x27;</span>a94837b18f8f43f29448b40a6e7386ba<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E0</span>E2	global	Big_Numbers1_40E0E2	$c0	b<span class="number">&#x27;</span>af85d512594fc84a5c65ec9970956ea5<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E103</span>	global	Big_Numbers1_40E103	$c0	b<span class="number">&#x27;</span>af85d512594fc84a5c65ec9970956ea5<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E124</span>	global	Big_Numbers1_40E124	$c0	b<span class="number">&#x27;10e21</span>da237a4a1491e769df6f4c3b419<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E145</span>	global	Big_Numbers1_40E145	$c0	b<span class="number">&#x27;</span>a705e8280082f93f07e3486636f3827a<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E166</span>	global	Big_Numbers1_40E166	$c0	b<span class="number">&#x27;297e7</span>ca127d2eef674c119331fe30dff<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E187</span>	global	Big_Numbers1_40E187	$c0	b<span class="number">&#x27;b</span>5d2099e49bdb07b8176dff5e23b3c14<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E1</span>A8	global	Big_Numbers1_40E1A8	$c0	b<span class="number">&#x27;83b</span>e264eb452fcf0a1c322f2c7cbf987<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E1</span>C9	global	Big_Numbers1_40E1C9	$c0	b<span class="number">&#x27;</span>a94837b18f8f43f29448b40a6e7386ba<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E1</span>EA	global	Big_Numbers1_40E1EA	$c0	b<span class="number">&#x27;71b</span>0438bf46aa26928c7f5a371d619e1<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E20</span>B	global	Big_Numbers1_40E20B	$c0	b<span class="number">&#x27;</span>a705e8280082f93f07e3486636f3827a<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E22</span>C	global	Big_Numbers1_40E22C	$c0	b<span class="number">&#x27;</span>ac49073a7165f41c57eb2c1806a7092e<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E24</span>D	global	Big_Numbers1_40E24D	$c0	b<span class="number">&#x27;</span>a94837b18f8f43f29448b40a6e7386ba<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E26</span>E	global	Big_Numbers1_40E26E	$c0	b<span class="number">&#x27;</span>af85d512594fc84a5c65ec9970956ea5<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E28</span>F	global	Big_Numbers1_40E28F	$c0	b<span class="number">&#x27;</span>ed108f6919ebadc8e809f8b86ef40b05<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E2</span>B0	global	Big_Numbers1_40E2B0	$c0	b<span class="number">&#x27;10e21</span>da237a4a1491e769df6f4c3b419<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E2</span>D1	global	Big_Numbers1_40E2D1	$c0	b<span class="number">&#x27;3</span>cfd436919bc3107d68b912ee647f341<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E2</span>F2	global	Big_Numbers1_40E2F2	$c0	b<span class="number">&#x27;</span>a705e8280082f93f07e3486636f3827a<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E313</span>	global	Big_Numbers1_40E313	$c0	b<span class="number">&#x27;65</span>c162f7c43612ba1bdf4d0f2912bbc0<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E334</span>	global	Big_Numbers1_40E334	$c0	b<span class="number">&#x27;10e21</span>da237a4a1491e769df6f4c3b419<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E355</span>	global	Big_Numbers1_40E355	$c0	b<span class="number">&#x27;</span>a705e8280082f93f07e3486636f3827a<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E376</span>	global	Big_Numbers1_40E376	$c0	b<span class="number">&#x27;3</span>cfd436919bc3107d68b912ee647f341<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E397</span>	global	Big_Numbers1_40E397	$c0	b<span class="number">&#x27;557460</span>d317ae874c924e9be336a83cbe<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E3</span>B8	global	Big_Numbers1_40E3B8	$c0	b<span class="number">&#x27;</span>a705e8280082f93f07e3486636f3827a<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E3</span>D9	global	Big_Numbers1_40E3D9	$c0	b<span class="number">&#x27;9203</span>d8a26e241e63e4b35b3527440998<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E3</span>FA	global	Big_Numbers1_40E3FA	$c0	b<span class="number">&#x27;10e21</span>da237a4a1491e769df6f4c3b419<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E41</span>B	global	Big_Numbers1_40E41B	$c0	b<span class="number">&#x27;f</span>91b2663febba8a884487f7de5e1d249<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E43</span>C	global	Big_Numbers1_40E43C	$c0	b<span class="number">&#x27;</span>a705e8280082f93f07e3486636f3827a<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E45</span>D	global	Big_Numbers1_40E45D	$c0	b<span class="number">&#x27;</span>d7afde3e7059cd0a0fe09eec4b0008cd<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E47</span>E	global	Big_Numbers1_40E47E	$c0	b<span class="number">&#x27;488</span>c428cd4a8d916deee7c1613c8b2fd<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E49</span>F	global	Big_Numbers1_40E49F	$c0	b<span class="number">&#x27;39</span>abe4bca904bca5a11121955a2996bf<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E4</span>C0	global	Big_Numbers1_40E4C0	$c0	b<span class="number">&#x27;</span>a705e8280082f93f07e3486636f3827a<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E4</span>E1	global	Big_Numbers1_40E4E1	$c0	b<span class="number">&#x27;3</span>cfd436919bc3107d68b912ee647f341<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E502</span>	global	Big_Numbers1_40E502	$c0	b<span class="number">&#x27;39</span>abe4bca904bca5a11121955a2996bf<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E523</span>	global	Big_Numbers1_40E523	$c0	b<span class="number">&#x27;4e44</span>f1ac85cd60e3caa56bfd4afb675e<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E544</span>	global	Big_Numbers1_40E544	$c0	b<span class="number">&#x27;45</span>cf8ddfae1d78741d8f1c622689e4af<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E565</span>	global	Big_Numbers1_40E565	$c0	b<span class="number">&#x27;3</span>cfd436919bc3107d68b912ee647f341<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E586</span>	global	Big_Numbers1_40E586	$c0	b<span class="number">&#x27;39</span>abe4bca904bca5a11121955a2996bf<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E5</span>A7	global	Big_Numbers1_40E5A7	$c0	b<span class="number">&#x27;4e44</span>f1ac85cd60e3caa56bfd4afb675e<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E5</span>C8	global	Big_Numbers1_40E5C8	$c0	b<span class="number">&#x27;37327b</span>b06c83cb29cefde1963ea588aa<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E5</span>E9	global	Big_Numbers1_40E5E9	$c0	b<span class="number">&#x27;</span>a705e8280082f93f07e3486636f3827a<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E60</span>A	global	Big_Numbers1_40E60A	$c0	b<span class="number">&#x27;23e65</span>a679105b85c5dc7034fded4fb5f<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E62</span>B	global	Big_Numbers1_40E62B	$c0	b<span class="number">&#x27;10e21</span>da237a4a1491e769df6f4c3b419<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E64</span>C	global	Big_Numbers1_40E64C	$c0	b<span class="number">&#x27;71b</span>0438bf46aa26928c7f5a371d619e1<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E66</span>D	global	Big_Numbers1_40E66D	$c0	b<span class="number">&#x27;</span>af85d512594fc84a5c65ec9970956ea5<span class="number">&#x27;</span></span><br><span class="line">.data:<span class="number">000000000040E68</span>E	global	Big_Numbers1_40E68E	$c0	b<span class="number">&#x27;39</span>abe4bca904bca5a11121955a2996bf<span class="number">&#x27;</span></span><br></pre></td></tr></table></figure>

<p>æ‰¾ä¸ªmd5ç½‘ç«™è§£ä¸€è§£ å‘ç°æ˜¯è¿™ç§å½¢å¼ md5(md5($pass))<br>æ‰€ä»¥è¿™æ˜¯å¯¹å•å­—ç¬¦åšäº†ä¸¤émd5çš„ç»“æœ<br>é‚£ä¹ˆæ‹¿åˆ°æœ€åæ•°æ® çˆ†ç ´ä¸€ä¸‹å³å¯<br>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">s = s.split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">s = s[:-<span class="number">1</span>]</span><br><span class="line">enc = []</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">    enc.append(c[-<span class="number">33</span>:-<span class="number">1</span>])</span><br><span class="line">enc = enc[<span class="number">1</span>:]</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> target <span class="keyword">in</span> enc:</span><br><span class="line">    <span class="comment"># print(target)</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        _<span class="built_in">hash</span> = md5(<span class="built_in">str</span>(<span class="built_in">chr</span>(x)).encode()).hexdigest()</span><br><span class="line">        ss = _<span class="built_in">hash</span></span><br><span class="line">        _<span class="built_in">hash</span> = md5(<span class="built_in">str</span>(ss).encode()).hexdigest()</span><br><span class="line">        <span class="keyword">if</span>(_<span class="built_in">hash</span> == target):</span><br><span class="line">            flag += <span class="built_in">chr</span>(x)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># Hello_Ctfer_Velcom_To_my_Mov_and_md5(md5)_world</span></span><br></pre></td></tr></table></figure>

<hr>
<hr>
<p>ä»¥ä¸Šæ˜¯åšé¢˜çš„ä¸€äº›trick å…¶å®è¿˜æ˜¯æƒ³äº†è§£ä¸€ä¸‹è¿™é¢˜å®Œæ•´çš„é€»è¾‘<br>ç”±äºå‡½æ•°ä¸å¤š æŒ¨ä¸ªç¿»<br>åœ¨ sub_404CB0 çœ‹åˆ°æ˜¯md5åŠ å¯†ç®—æ³•(ä¸å¯èƒ½é­”æ”¹md5å§â€¦)<br>äº¤å‰å¼•ç”¨æŸ¥çœ‹å“ªé‡Œè°ƒç”¨äº†md5<br>åœ¨ sub_404140 æ‰¾åˆ°äº†å”¯ä¸‰è°ƒç”¨çš„ç‚¹</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">v14 = *v51 + <span class="number">24</span>;</span><br><span class="line">v33 = *v51 + <span class="number">8</span>;</span><br><span class="line">v32 = v14;</span><br><span class="line"><span class="built_in">sub_404CB0</span>(v33, v14);</span><br><span class="line">*v48 = *(_DWORD *)v46;</span><br><span class="line"><span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">&#123;</span><br><span class="line">  v31 = *v48;</span><br><span class="line">  v30 = v31 + <span class="number">64</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)(v31 + <span class="number">64</span>) &gt; *(_DWORD *)v49 )</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  v28 = *v51 + <span class="number">8</span>;</span><br><span class="line">  <span class="keyword">while</span> ( dword_40FA30 &lt; <span class="number">10</span> &amp;&amp; dword_40FA30 &gt;= <span class="number">10</span> )</span><br><span class="line">    ;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_404CB0</span>(v28, (<span class="type">char</span> *)*v50 + (<span class="type">unsigned</span> <span class="type">int</span>)*v48);</span><br><span class="line">    <span class="keyword">if</span> ( dword_40FA30 &gt;= <span class="number">10</span> || dword_40FA30 &lt; <span class="number">10</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="built_in">sub_404CB0</span>(v28, (<span class="type">char</span> *)*v50 + (<span class="type">unsigned</span> <span class="type">int</span>)*v48);</span><br><span class="line">  &#125;</span><br><span class="line">  v27 = *v48;</span><br><span class="line">  v26 = v27 + <span class="number">64</span>;</span><br></pre></td></tr></table></figure>

<p>ç”±äºç¬¬äºŒä¸ªç¬¬ä¸‰ä¸ªåœ¨ä¸€ä¸ªè™šå‡çš„do-whileé‡Œ å®åˆ™åªæ‰§è¡Œäº†ç¬¬äºŒä¸ªmd5 åŠ ä¸Šå‰é¢çš„md5 æœ‰æ•ˆçš„md5è°ƒç”¨äº†ä¸¤æ¬¡<br>åŒæ—¶é€šè¿‡ v28-&gt;v51-&gt;v14&#x2F;v33 ä¹Ÿèƒ½å‘ç°è¿™ä¸¤æ¬¡md5æœ‰å…³è” é‚£ä¹ˆåˆç†æ¨æµ‹md5(md5(xxx))å°±å¾ˆè‡ªç„¶äº†<br>ç”±äºè¿™é¢˜æ§åˆ¶æµä¸æ˜¯é‚£ä¹ˆå¹³å¦ å¹³å¦åŒ–åçœ‹é€»è¾‘è¿˜å¥½ ä½†æ˜¯åŠ¨è°ƒè·³æ¥è·³å»æŒºçƒ¦çš„ æ‰€ä»¥åŠ¨è°ƒå°±å…äº†(ä»¥åæœ‰æ—¶é—´å†æ¥è¯•è¯•)</p>
<h2 id="vm-wo"><a href="#vm-wo" class="headerlink" title="vm_wo"></a>vm_wo</h2><p>macosçš„ARMæŒ‡ä»¤é›†â€¦ å› ä¸ºæ²¡æœ‰macåŠ¨è°ƒä¸äº†ä¸€ç‚¹â€¦<br>é¢˜ç›®é€»è¾‘ç®€å•<br>è¾“å…¥é•¿åº¦ä¸º29çš„flagåè¿›è¡Œè™šæ‹Ÿæœºæ“ä½œåŠ å¯† ç„¶åä¸ä¸€ç›´encæ¯”å¯¹<br>è™šæ‹Ÿæœºå‰çš„opcodeå‡†å¤‡éƒ¨åˆ†:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v8[<span class="number">0</span>] = <span class="number">0x20D01011903001A</span>LL;</span><br><span class="line">      *(_QWORD *)((<span class="type">char</span> *)v8 + <span class="number">7</span>) = <span class="number">0x300010201180702</span>LL;</span><br><span class="line">      BYTE2(v8[<span class="number">0</span>]) = *a1;</span><br><span class="line">      interpretBytecode((__int64)v8, <span class="number">15</span>);</span><br><span class="line">      v7[<span class="number">0</span>] = <span class="number">0x20D02011903001A</span>LL;</span><br><span class="line">      *(_QWORD *)((<span class="type">char</span> *)v7 + <span class="number">7</span>) = <span class="number">0x400010201180602</span>LL;</span><br><span class="line">      BYTE2(v7[<span class="number">0</span>]) = vm_body[<span class="number">0</span>];</span><br><span class="line">      interpretBytecode((__int64)v7, <span class="number">15</span>);</span><br><span class="line">      v6[<span class="number">0</span>] = <span class="number">0x20D03011903001A</span>LL;</span><br><span class="line">      *(_QWORD *)((<span class="type">char</span> *)v6 + <span class="number">7</span>) = <span class="number">0x500010201180502</span>LL;</span><br><span class="line">      BYTE2(v6[<span class="number">0</span>]) = vm_body[<span class="number">0</span>];</span><br><span class="line">      interpretBytecode((__int64)v6, <span class="number">15</span>);</span><br><span class="line">      v5[<span class="number">0</span>] = <span class="number">0x20D04011903001A</span>LL;</span><br><span class="line">      *(_QWORD *)((<span class="type">char</span> *)v5 + <span class="number">7</span>) = <span class="number">0x600010201180402</span>LL;</span><br><span class="line">      BYTE2(v5[<span class="number">0</span>]) = vm_body[<span class="number">0</span>];</span><br><span class="line">      interpretBytecode((__int64)v5, <span class="number">15</span>);</span><br><span class="line">      *a1++ = ((<span class="type">unsigned</span> __int8)vm_body[<span class="number">0</span>] &gt;&gt; <span class="number">5</span>) | (<span class="number">8</span> * vm_body[<span class="number">0</span>]);</span><br><span class="line">      --v2;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>æœ€å¼€å§‹å°±æ˜¯è¿™é‡Œæ²¡æœ‰ç†è§£å‡†ç¡®<br>ä»¥v7[0]ä¸ºä¾‹</p>
<figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">v7[0] = 0x20D02011903001ALL; -&gt; ä½8ä¸ªå­—èŠ‚ 020D02011903001A</span><br><span class="line"><span class="emphasis">*(_QWORD *</span>)((char <span class="emphasis">*)v7 + 7) = 0x400010201180602LL;</span></span><br><span class="line"><span class="emphasis">æ³¨æ„åˆ°è¿™é‡Œæ˜¯+7 æ‰€ä»¥ä¼šè¦†ç›–æ‰v7[0]çš„æœ€é«˜å­—èŠ‚</span></span><br><span class="line"><span class="emphasis">-&gt;400010201180602 020D02011903001A -&gt; 04000102011806020D02011903001A</span></span><br><span class="line"><span class="emphasis">åˆšå¥½15å­—èŠ‚</span></span><br></pre></td></tr></table></figure>

<p>è¿™å°±æ˜¯é™æ€åˆ†æå®¹æ˜“å‡ºé”™çš„ç‚¹â€¦ å¦‚æœèƒ½åŠ¨è°ƒçš„è¯å°±ç‰¹åˆ«ç®€å•â€¦<br>ç„¶åæ‰¾å¯¹åº”çš„opcode(hex)<br>å‘ç°å°±æ˜¯ä¸€ä¸ªå¾ªç¯ç§»ä½+å¼‚æˆ–çš„åŠ å¯†é€»è¾‘</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">0 mov vm_body[0] 3</span><br><span class="line">3 mov vm_body[1] vm_body[0]&gt;&gt;1</span><br><span class="line">6 mov vm_body[2] vm_body[0]&lt;&lt;7</span><br><span class="line">9 mov vm_body[0] vm_body[1]|vm_body[2]</span><br><span class="line">12 xor vm_body[0] vm_body[3]</span><br><span class="line">15 mov vm_body[0] 3</span><br><span class="line">18 mov vm_body[1] vm_body[0]&gt;&gt;2</span><br><span class="line">21 mov vm_body[2] vm_body[0]&lt;&lt;6</span><br><span class="line">24 mov vm_body[0] vm_body[1]|vm_body[2]</span><br><span class="line">27 xor vm_body[0] vm_body[4]</span><br><span class="line">30 mov vm_body[0] 3</span><br><span class="line">33 mov vm_body[1] vm_body[0]&gt;&gt;3</span><br><span class="line">36 mov vm_body[2] vm_body[0]&lt;&lt;5</span><br><span class="line">39 mov vm_body[0] vm_body[1]|vm_body[2]</span><br><span class="line">42 xor vm_body[0] vm_body[5]</span><br><span class="line">45 mov vm_body[0] 3</span><br><span class="line">48 mov vm_body[1] vm_body[0]&gt;&gt;4</span><br><span class="line">51 mov vm_body[2] vm_body[0]&lt;&lt;4</span><br><span class="line">54 mov vm_body[0] vm_body[1]|vm_body[2]</span><br><span class="line">57 xor vm_body[0] vm_body[6]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ä¸‹vm_body[3]å¤„æ˜¯dwordçš„èµ‹å€¼ åˆšå¥½å¯¹åº”BYTEçš„[3],[4],[5],[6]<br>æ­£å‘çˆ†ç ´å³å¯</p>
<p><strong>DASCTF{you_are_right_so_cool}</strong></p>
<h2 id="EZåŠ å¯†å™¨"><a href="#EZåŠ å¯†å™¨" class="headerlink" title="EZåŠ å¯†å™¨"></a>EZåŠ å¯†å™¨</h2><p>å­¦ä¹ åˆ°äº†IDA7.5 Signsrchæ’ä»¶çš„ä½¿ç”¨<br>åšçš„æ—¶å€™çŠ¯äº†ä¸€ä¸ªé”™è¯¯ é¢˜ç›®å¯¹è¾“å…¥çš„vericodeæ²¡æœ‰åšæ­£ç¡®æ€§çš„æ£€æŸ¥ï¼ï¼ï¼<br>åªæ£€æŸ¥äº†é•¿åº¦â€¦ åªè¦æ˜¯6ä½éƒ½ä¼šç»§ç»­â€¦ æ‰€ä»¥åé¢éœ€è¦çˆ†ç ´<br>å¤§è‡´æµç¨‹:<br>å…ˆè¾“å…¥6ä½æ•°å­— ç„¶åbase64å˜è¡¨åŠ å¯†å¾—åˆ°æ–°çš„key<br>å†å¯¹inputåšåŠ å¯† æœ€åHEXæ‹¼æ¥ä¸å·²çŸ¥æ¯”è¾ƒ<br>æ¯”è¾ƒçš„å¯†æ–‡åœ¨åŠ å¯†inputçš„æ—¶å€™åšäº†xor7çš„ä¿®æ”¹</p>
<p>å…³é”®éƒ¨åˆ†çš„åŠ å¯†å¤§è‡´å¯ä»¥çŸ¥é“æ˜¯æœ‰sboxçš„æµåŠ å¯†<br>ç”¨IDAæ’ä»¶ Sighsrch</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.rdata:0140016080	0040	DES_fp [..64]</span><br><span class="line">.rdata:01400160C0	0030	DES permuted choice key (table) [..48]</span><br><span class="line">.rdata:0140016100	0038	DES permuted choice table (key) [..56]</span><br><span class="line">.rdata:0140016160	0020	DES_p32i [..32]</span><br><span class="line">.rdata:0140016180	0200	DES S-boxes [..512]</span><br><span class="line">.rdata:0140016380	0030	DES_ei [..48]</span><br><span class="line">.rdata:01400163C0	0040	DES initial permutation IP [..64]</span><br></pre></td></tr></table></figure>

<p>çŸ¥é“æ˜¯DES é‚£ä¹ˆæšä¸¾è¾“å…¥æ•°å­—çˆ†ç ´å³å¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s1 = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">s2 = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ+/&quot;</span></span><br><span class="line">cipher = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;0723105D5C12217DCDC3601F5ECB54DA9CCEC2279F1684A13A0D716D17217F4C9EA85FF1A42795731CA3C55D3A4D7BEA&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">100000</span>,<span class="number">1000000</span>):</span><br><span class="line">    s = <span class="built_in">str</span>(i).zfill(<span class="number">6</span>)</span><br><span class="line">    key = b64encode((s.encode())).decode().translate(<span class="built_in">str</span>.maketrans(s1,s2)).encode()</span><br><span class="line">    des = DES.new(key,DES.MODE_ECB)</span><br><span class="line">    pt = des.decrypt(cipher)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;DASCTF&#x27;</span> <span class="keyword">in</span> pt:</span><br><span class="line">        <span class="built_in">print</span>(pt)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p><strong>DASCTF{f771b96b71514bb6bc20f3275fa9404e}</strong></p>
<h1 id="V-N2020å…¬å¼€èµ›"><a href="#V-N2020å…¬å¼€èµ›" class="headerlink" title="V&amp;N2020å…¬å¼€èµ›"></a>V&amp;N2020å…¬å¼€èµ›</h1><h2 id="strangeCPP"><a href="#strangeCPP" class="headerlink" title="strangeCPP"></a>strangeCPP</h2><p>è¿™å‡ å¤©åšreversing.Krè¢«å¹²ç¢äº†â€¦</p>
<p>è¿è¡Œä¸€ä¸‹ å‘ç°ç”µè„‘çš„å¾ˆå¤šä¿¡æ¯éƒ½è¢«ä»–æ‰“å°å‡ºæ¥äº†(å­¦ä¹ ä¸€æ‰‹)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  __int64 v6; <span class="comment">// rax</span></span><br><span class="line">  __int64 v7; <span class="comment">// rax</span></span><br><span class="line">  __int64 v8; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v10; <span class="comment">// [rsp+0h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_SYSTEM_INFO</span> SystemInfo; <span class="comment">// [rsp+28h] [rbp+8h] BYREF</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> **j; <span class="comment">// [rsp+78h] [rbp+58h]</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v13; <span class="comment">// [rsp+98h] [rbp+78h]</span></span><br><span class="line"></span><br><span class="line">  v3 = &amp;v10;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">94</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v3 = <span class="number">-858993460</span>;</span><br><span class="line">    v3 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">j___CheckForDebuggerJustMyCode</span>(&amp;unk_7FF7D1F77033);</span><br><span class="line">  <span class="built_in">GetSystemInfo</span>(&amp;SystemInfo);</span><br><span class="line">  <span class="built_in">putchar</span>(byte_7FF7D1F71004);</span><br><span class="line">  <span class="built_in">putchar</span>(byte_7FF7D1F71005);</span><br><span class="line">  <span class="built_in">putchar</span>(byte_7FF7D1F71006);</span><br><span class="line">  <span class="built_in">putchar</span>(byte_7FF7D1F71007);</span><br><span class="line">  <span class="built_in">putchar</span>(byte_7FF7D1F71019);</span><br><span class="line">  <span class="built_in">putchar</span>(byte_7FF7D1F7101A);</span><br><span class="line">  <span class="built_in">putchar</span>(byte_7FF7D1F71005);</span><br><span class="line">  <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Let me have a look at your computer...&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = envp; *j; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v13 = *j;</span><br><span class="line">    <span class="built_in">sub_7FF7D1F61226</span>(<span class="string">&quot;%s\n&quot;</span>, v13);</span><br><span class="line">  &#125;</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(std::cout, sub_7FF7D1F61127);</span><br><span class="line">  CPU_NUMBER = SystemInfo.dwNumberOfProcessors;</span><br><span class="line">  <span class="built_in">sub_7FF7D1F61226</span>(<span class="string">&quot;now system cpu num is %d\n&quot;</span>, SystemInfo.dwNumberOfProcessors);</span><br><span class="line">  <span class="keyword">if</span> ( CPU_NUMBER &lt; <span class="number">8</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Are you in VM?&quot;</span>);</span><br><span class="line">    _exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">GetUserNameA</span>(Str1, &amp;pcbBuffer) )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = <span class="built_in">sub_7FF7D1F61172</span>(std::cout, <span class="string">&quot;this is useful&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v5, sub_7FF7D1F61127);</span><br><span class="line">  &#125;</span><br><span class="line">  v6 = std::ostream::<span class="keyword">operator</span>&lt;&lt;(std::cout, sub_7FF7D1F61127);</span><br><span class="line">  v7 = <span class="built_in">sub_7FF7D1F61172</span>(v6, <span class="string">&quot;ok,I am checking...&quot;</span>);</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(v7, sub_7FF7D1F61127);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">j_strcmp</span>(Str1, <span class="string">&quot;cxx&quot;</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = <span class="built_in">sub_7FF7D1F61172</span>(std::cout, <span class="string">&quot;flag&#123;where_is_my_true_flag?&#125;&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v8, sub_7FF7D1F61127);</span><br><span class="line">    _exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>IDAæ‰“å¼€ æŸ¥çœ‹CPU_NUMBERçš„äº¤å‰å¼•ç”¨ æ‰¾åˆ°ä¸€ä¸ªæœ‰forçš„xor<br>å‰é¢å¯¹CPU_NUMBERè¿›è¡Œäº†å¤„ç†<br>é‚£ä¹ˆç›´æ¥çˆ†ç ´å¾—åˆ°v5(31604766)çš„å€¼ å†çˆ†ç ´å¾—åˆ°CPU_NUMBER(123456)çš„å€¼ æœ€åxorå›å»å³å¯<br>å¾—åˆ°: flag{MD5(theNum)}<br>æ ¹æ®é¢˜ç›®è¦æ±‚ æ²¡æœ‰å¤§å†™ é‚£ä¹ˆå°å†™md5åŠ å¯†123456å³å¯</p>
<h1 id="BJDCTF-2nd"><a href="#BJDCTF-2nd" class="headerlink" title="BJDCTF 2nd"></a>BJDCTF 2nd</h1><h2 id="guessgame"><a href="#guessgame" class="headerlink" title="guessgame"></a>guessgame</h2><p>IDAæ‰“å¼€ å­—ç¬¦ä¸²ä¸€æœå°±æœ‰<br><strong>S1mple_ReV3r5e_W1th_0D_0r_IDA</strong></p>
<h2 id="easy"><a href="#easy" class="headerlink" title="easy"></a>easy</h2><p>æ‰¾åˆ°_quesåœ°å€ åŠ¨è°ƒset Ip è·³è½¬å³å¯çœ‹åˆ°ç”»å‡ºçš„å­—ç¬¦<br><strong>HACKIT4FUN</strong></p>
<h2 id="8086"><a href="#8086" class="headerlink" title="8086"></a>8086</h2><p>è«åå…¶å¦™çš„<br>åå…­è¿›åˆ¶ç¼–è¾‘å™¨çœ‹çœ‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"> Offset    0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F   Ascii</span><br><span class="line"></span><br><span class="line">00000000  4D 5A 90 00 03 00 00 00 04 00 00 00 FF FF 00 00  MZ?......ï£µï£µ..</span><br><span class="line">00000010  00 00 00 00 1A 00 03 00 1E 00 00 00 01 00 1B 00  ...........</span><br><span class="line">00000020  03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ...............</span><br><span class="line">00000030  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000040  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000050  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000060  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000070  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000080  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000090  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">000000A0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">000000B0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">000000C0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">000000D0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">000000E0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">000000F0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000100  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000110  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000120  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000130  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000140  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000150  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000160  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000170  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000180  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000190  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">000001A0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">000001B0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">000001C0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">000001D0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">000001E0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">000001F0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000200  5D 55 5B 64 75 7E 7C 74 40 7B 7A 40 77 6A 2E 7D  ]U[du~|t@&#123;z@wj.&#125;</span><br><span class="line">00000210  2E 7E 71 40 67 6A 7A 7B 7A 40 77 7A 71 57 7E 2F  .~q@gjz&#123;z@wzqW~/</span><br><span class="line">00000220  62 3B 00 00 00 00 00 00 00 00 00 00 00 00 00 00  b;..............</span><br><span class="line">00000230  EB FE B9 22 00 8D 1E 00 00 8B F9 4F 80 31 1F E2  è†»?.?..å­‚Oâ‚¬1?</span><br><span class="line">00000240  F8 8D 16 00 00 B4 09 CD 21 C3 B8 00 00 8E D8 E8  é´¯..??é…¶..åº?</span><br><span class="line">00000250  DE FF B4 4C CD 21                                ?ç¢™?</span><br></pre></td></tr></table></figure>

<p>åªèƒ½è¯´ç¦»è°± çŒœæµ‹</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">]U[du~|t@&#123;z@wj.&#125;.~q@gjz&#123;z@wzqW~/b;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªåº”è¯¥è·ŸæŸä¸ªkey xoråå°±æ˜¯flag<br>çˆ†ç ´ä¸€ä¸‹ key&#x3D;31æ—¶å¾—åˆ°flag<br><strong>BJD{jack_de_hu1b1an_xuede_henHa0}</strong></p>
<p>æ±‡ç¼–å­¦çš„çœŸå¥½å‘</p>
<h1 id="justCTF2020"><a href="#justCTF2020" class="headerlink" title="justCTF2020"></a>justCTF2020</h1><h2 id="Rusty"><a href="#Rusty" class="headerlink" title="Rusty"></a>Rusty</h2><p>é¢˜ç›®å‹æƒ…æç¤ºï¼š<br><strong>Looking at Rust code in disassembler&#x2F;decompiler hurts, soâ€¦ look somewhere else.</strong></p>
<p>ä½†æˆ‘è¿˜æ˜¯æ‹–åˆ°IDAé‡Œé¢äº†â€¦<br>ä»¥ä¸‹åˆ†æçº¯é”™è¯¯æ–¹å‘â€¦</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">char</span> <span class="title">sub_7FF6B75D23E0</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  ...</span><br><span class="line">  *(_OWORD *)v14 = *(_OWORD *)lpMem;</span><br><span class="line">  v15 = <span class="number">55</span>i64;</span><br><span class="line">  v6 = *(_QWORD *)lpMem;</span><br><span class="line">  <span class="keyword">if</span> ( **(_BYTE **)lpMem != <span class="string">&#x27;j&#x27;</span></span><br><span class="line">    || *((_BYTE *)v14[<span class="number">0</span>] + <span class="number">1</span>) != <span class="string">&#x27;c&#x27;</span></span><br><span class="line">    || *((_BYTE *)v14[<span class="number">0</span>] + <span class="number">2</span>) != <span class="string">&#x27;t&#x27;</span></span><br><span class="line">    || *((_BYTE *)v14[<span class="number">0</span>] + <span class="number">3</span>) != <span class="string">&#x27;f&#x27;</span></span><br><span class="line">    || *((_BYTE *)v14[<span class="number">0</span>] + <span class="number">4</span>) != <span class="string">&#x27;&#123;&#x27;</span></span><br><span class="line">    || *((_BYTE *)v14[<span class="number">0</span>] + <span class="number">54</span>) != <span class="string">&#x27;&#125;&#x27;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_QWORD *)v17 = &amp;off_7FF6B75F05D8;</span><br><span class="line">    *(_QWORD *)&amp;v17[<span class="number">8</span>] = <span class="number">1</span>i64;</span><br><span class="line">    *(_QWORD *)&amp;v17[<span class="number">16</span>] = <span class="number">0</span>i64;</span><br><span class="line">    v18 = <span class="string">&quot;Are you sure??? Try somewhere else.\n&quot;</span>;</span><br><span class="line">    v19 = <span class="number">0</span>i64;</span><br><span class="line">    result = <span class="built_in">sub_7FF6B75D8690</span>((__int128 *)v17);</span><br><span class="line">    <span class="keyword">if</span> ( !v14[<span class="number">1</span>] )</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_25;</span><br><span class="line">  &#125;</span><br><span class="line">  v7 = <span class="built_in">sub_7FF6B75D2A30</span>(<span class="number">0x64</span>ui64);</span><br><span class="line">  <span class="keyword">if</span> ( !v7 )</span><br><span class="line">    <span class="built_in">sub_7FF6B75E8830</span>();</span><br><span class="line">  v8 = (<span class="type">void</span> *)v7;</span><br><span class="line">  *(_OWORD *)v7 = xmmword_7FF6B75F0460;</span><br><span class="line">  *(_OWORD *)(v7 + <span class="number">16</span>) = xmmword_7FF6B75F0470;</span><br><span class="line">  *(_OWORD *)(v7 + <span class="number">32</span>) = xmmword_7FF6B75F0480;</span><br><span class="line">  *(_OWORD *)(v7 + <span class="number">48</span>) = xmmword_7FF6B75F0490;</span><br><span class="line">  *(_OWORD *)(v7 + <span class="number">64</span>) = xmmword_7FF6B75F04A0;</span><br><span class="line">  *(_OWORD *)(v7 + <span class="number">80</span>) = xmmword_7FF6B75F04B0;</span><br><span class="line">  *(_DWORD *)(v7 + <span class="number">96</span>) = <span class="number">0x14A0108</span>;</span><br><span class="line">  *(_QWORD *)v13 = v7;</span><br><span class="line">  *(_OWORD *)&amp;v13[<span class="number">8</span>] = xmmword_7FF6B75F04C0;</span><br><span class="line">  v9 = <span class="number">7</span>i64;</span><br><span class="line">  <span class="keyword">while</span> ( v9 != <span class="number">57</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = *(<span class="type">unsigned</span> __int8 *)(v6 + (v9 - <span class="number">2</span>) % <span class="number">55</span>)<span class="comment">// v6: input!</span></span><br><span class="line">        + (<span class="type">unsigned</span> __int16)*(<span class="type">unsigned</span> __int8 *)(v6 + (v9 - <span class="number">1</span>) % <span class="number">55</span>)</span><br><span class="line">        + *(<span class="type">unsigned</span> __int8 *)(v6 + v9 % <span class="number">55</span>) == *(_WORD *)(v7 + <span class="number">2</span> * v9 - <span class="number">14</span>);</span><br><span class="line">    ++v9;</span><br><span class="line">    <span class="keyword">if</span> ( !v10 )</span><br><span class="line">    &#123;</span><br><span class="line">      *(_QWORD *)v17 = &amp;off_7FF6B75F05D8;</span><br><span class="line">      *(_QWORD *)&amp;v17[<span class="number">8</span>] = <span class="number">1</span>i64;</span><br><span class="line">      *(_QWORD *)&amp;v17[<span class="number">16</span>] = <span class="number">0</span>i64;</span><br><span class="line">      v18 = <span class="string">&quot;Are you sure??? Try somewhere else.\n&quot;</span>;</span><br><span class="line">      v19 = <span class="number">0</span>i64;</span><br><span class="line">      <span class="built_in">sub_7FF6B75D8690</span>((__int128 *)v17);</span><br><span class="line">      <span class="keyword">goto</span> LABEL_29;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  *(_QWORD *)v17 = &amp;off_7FF6B75F0610;</span><br><span class="line">  *(_QWORD *)&amp;v17[<span class="number">8</span>] = <span class="number">1</span>i64;</span><br><span class="line">  *(_QWORD *)&amp;v17[<span class="number">16</span>] = <span class="number">0</span>i64;</span><br><span class="line">  v18 = <span class="string">&quot;Are you sure??? Try somewhere else.\n&quot;</span>;</span><br><span class="line">  v19 = <span class="number">0</span>i64;</span><br><span class="line">  <span class="built_in">sub_7FF6B75D8690</span>((__int128 *)v17);</span><br><span class="line">LABEL_29:</span><br><span class="line">  result = <span class="built_in">sub_7FF6B75D2A40</span>(v8);</span><br><span class="line">  <span class="keyword">if</span> ( v14[<span class="number">1</span>] )</span><br><span class="line">  &#123;</span><br><span class="line">LABEL_25:</span><br><span class="line">    v12 = v14[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sub_7FF6B75D2A40</span>(v12);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå¤§è‡´èƒ½çœ‹åˆ° â€œflagâ€  çš„check<br>ç”šè‡³z3è¿˜å¯ä»¥çº¦æŸæ±‚è§£å‡º â€œflagâ€<br>ä½†æ˜¯è§£å‡ºæ¥å¾ˆå¥‡æ€ª<br>ç±»ä¼¼è¿™ç§å¥‡æ€ªå­—ç¬¦ä¸²</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tgjs^JS^oos`tgf_&#123;?_xpu^brd`lnpkhog^<span class="number">5</span>_EBKDGL@H! <span class="string">&quot;!|kc2k</span></span><br></pre></td></tr></table></figure>

<p>å¾ˆæ˜æ˜¾è¿™æ˜¯ä¸€æ¡å®Œå…¨é”™è¯¯çš„é“è·¯<br>æ³¨æ„åˆ°è¿™ä¸ªæ–‡ä»¶çš„DOSå¤´è¶…å¤§<br>ä¸€èˆ¬çš„PEæ–‡ä»¶Ntçš„åç§»ä¹Ÿå°±F0å·¦å³ è¿™ä¸ªPEè¾¾åˆ°äº†1150ï¼<br>æå–å‡ºæ¥å†™å…¥æ–‡ä»¶ IDAæ‰“å¼€ æ²¡åŠæ³•F5 ç¡¬æ€¼æ±‡ç¼–<br>è¿˜å¥½IDAè¯†åˆ«å‡ºäº†å¾ˆå¤šé‡è¦çš„ç‰¹å¾</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line">seg000:<span class="number">008</span>A                 <span class="keyword">public</span> start</span><br><span class="line">seg000:<span class="number">008</span>A start           proc near</span><br><span class="line">seg000:<span class="number">008</span>A                 cld</span><br><span class="line">seg000:<span class="number">008B</span>                 call    sub_102C7</span><br><span class="line">seg000:<span class="number">008</span>E                 mov     ax, <span class="number">13</span>h</span><br><span class="line">seg000:<span class="number">0091</span>                 <span class="type">int</span>     <span class="number">10</span>h             ; - VIDEO - SET VIDEO MODE</span><br><span class="line">seg000:<span class="number">0091</span>                                         ; AL = mode</span><br><span class="line">seg000:<span class="number">0093</span>                 call    sub_101FF</span><br><span class="line">seg000:<span class="number">0096</span>                 mov     ax, <span class="number">0</span>A000h</span><br><span class="line">seg000:<span class="number">0099</span>                 mov     es, ax</span><br><span class="line">seg000:<span class="number">009B</span>                 assume es:nothing</span><br><span class="line">seg000:<span class="number">009B</span></span><br><span class="line">seg000:<span class="number">009B</span> loc_1009B:                              ; CODE XREF: start+<span class="number">2</span>Aâ†“j</span><br><span class="line">seg000:<span class="number">009B</span>                                         ; start+<span class="number">4</span>Aâ†“j ...</span><br><span class="line">seg000:<span class="number">009B</span>                 call    sub_101C7</span><br><span class="line">seg000:<span class="number">009</span>E                 call    sub_101B5</span><br><span class="line">seg000:<span class="number">00</span>A1                 call    sub_1026A</span><br><span class="line">seg000:<span class="number">00</span>A4                 call    sub_1017A</span><br><span class="line">seg000:<span class="number">00</span>A7                 lea     di, ds:<span class="number">30</span>h</span><br><span class="line">seg000:<span class="number">00</span>AB                 mov     word ptr cs:[di], <span class="number">0</span></span><br><span class="line">seg000:<span class="number">00B</span>0                 mov     ah, <span class="number">1</span></span><br><span class="line">seg000:<span class="number">00B</span>2                 <span class="type">int</span>     <span class="number">16</span>h             ; KEYBOARD - CHECK BUFFER, DO NOT CLEAR</span><br><span class="line">seg000:<span class="number">00B</span>2                                         ; Return: ZF clear <span class="keyword">if</span> character in buffer</span><br><span class="line">seg000:<span class="number">00B</span>2                                         ; AH = scan code, AL = character</span><br><span class="line">seg000:<span class="number">00B</span>2                                         ; ZF set <span class="keyword">if</span> no character in buffer</span><br><span class="line">seg000:<span class="number">00B</span>4                 jz      <span class="type">short</span> loc_1009B</span><br><span class="line">seg000:<span class="number">00B</span>6                 mov     ah, <span class="number">0</span></span><br><span class="line">seg000:<span class="number">00B</span>8                 <span class="type">int</span>     <span class="number">16</span>h             ; KEYBOARD - READ CHAR FROM BUFFER, WAIT IF EMPTY</span><br><span class="line">seg000:<span class="number">00B</span>8                                         ; Return: AH = scan code, AL = character</span><br><span class="line">seg000:<span class="number">00B</span>A                 lea     di, ds:<span class="number">60</span>h</span><br><span class="line">seg000:<span class="number">00B</span>E                 cmp     al, <span class="number">1B</span>h</span><br><span class="line">seg000:<span class="number">00</span>C0                 jz      <span class="type">short</span> loc_10134</span><br><span class="line">seg000:<span class="number">00</span>C2                 cmp     al, <span class="number">0</span>Dh</span><br><span class="line">seg000:<span class="number">00</span>C4                 jz      <span class="type">short</span> loc_10107</span><br><span class="line">seg000:<span class="number">00</span>C6                 cmp     al, <span class="number">8</span></span><br><span class="line">seg000:<span class="number">00</span>C8                 jz      <span class="type">short</span> loc_100EE</span><br><span class="line">seg000:<span class="number">00</span>CA                 mov     bx, cs:word_10032</span><br><span class="line">seg000:<span class="number">00</span>CF                 cmp     bl, byte ptr cs:word_10088</span><br><span class="line">seg000:<span class="number">00</span>D4                 jnb     <span class="type">short</span> loc_1009B</span><br><span class="line">seg000:<span class="number">00</span>D6                 add     di, cs:word_10032</span><br><span class="line">seg000:<span class="number">00</span>DB                 mov     cs:[di], al</span><br><span class="line">seg000:<span class="number">00</span>DE                 inc     cs:word_10032</span><br><span class="line">seg000:<span class="number">00E3</span>                 lea     di, ds:<span class="number">30</span>h</span><br><span class="line">seg000:<span class="number">00E7</span>                 mov     word ptr cs:[di], <span class="number">2</span>Ah ; <span class="string">&#x27;*&#x27;</span></span><br><span class="line">seg000:<span class="number">00</span>EC                 jmp     <span class="type">short</span> loc_1009B</span><br><span class="line">seg000:<span class="number">00</span>EE ; ---------------------------------------------------------------------------</span><br><span class="line">seg000:<span class="number">00</span>EE</span><br><span class="line">seg000:<span class="number">00</span>EE loc_100EE:                              ; CODE XREF: start+<span class="number">3</span>Eâ†‘j</span><br><span class="line">seg000:<span class="number">00</span>EE                 cmp     cs:word_10032, <span class="number">0</span></span><br><span class="line">seg000:<span class="number">00F</span>4                 jbe     <span class="type">short</span> loc_1009B</span><br><span class="line">seg000:<span class="number">00F</span>6                 dec     cs:word_10032</span><br><span class="line">seg000:<span class="number">00F</span>B                 add     di, cs:word_10032</span><br><span class="line">seg000:<span class="number">0100</span>                 mov     word ptr cs:[di], <span class="number">0</span></span><br><span class="line">seg000:<span class="number">0105</span>                 jmp     <span class="type">short</span> loc_1009B</span><br><span class="line">seg000:<span class="number">0107</span> ; ---------------------------------------------------------------------------</span><br><span class="line">seg000:<span class="number">0107</span></span><br><span class="line">seg000:<span class="number">0107</span> loc_10107:                              ; CODE XREF: start+<span class="number">3</span>Aâ†‘j</span><br><span class="line">seg000:<span class="number">0107</span>                 <span class="keyword">xor</span>     bx, bx</span><br><span class="line">seg000:<span class="number">0109</span>                 push    cs</span><br><span class="line">seg000:<span class="number">010</span>A                 pop     ds</span><br><span class="line">seg000:<span class="number">010B</span>                 assume ds:seg000</span><br><span class="line">seg000:<span class="number">010B</span>                 mov     si, <span class="number">60</span>h ; <span class="string">&#x27;`&#x27;</span></span><br><span class="line">seg000:<span class="number">010</span>E                 push    cs</span><br><span class="line">seg000:<span class="number">010F</span>                 pop     es</span><br><span class="line">seg000:<span class="number">0110</span>                 assume es:seg000</span><br><span class="line">seg000:<span class="number">0110</span>                 mov     cx, cs:word_10088</span><br><span class="line">seg000:<span class="number">0115</span></span><br><span class="line">seg000:<span class="number">0115</span> loc_10115:                              ; CODE XREF: start+A8â†“j</span><br><span class="line">seg000:<span class="number">0115</span>                 mov     di, <span class="number">34</span>h ; <span class="string">&#x27;4&#x27;</span></span><br><span class="line">seg000:<span class="number">0118</span>                 push    cx</span><br><span class="line">seg000:<span class="number">0119</span>                 add     di, bx</span><br><span class="line">seg000:<span class="number">011B</span>                 mov     cx, cs:word_10088</span><br><span class="line">seg000:<span class="number">0120</span>                 sub     cx, bx</span><br><span class="line">seg000:<span class="number">0122</span></span><br><span class="line">seg000:<span class="number">0122</span> loc_10122:                              ; CODE XREF: start+A3â†“j</span><br><span class="line">seg000:<span class="number">0122</span>                 mov     al, [si]</span><br><span class="line">seg000:<span class="number">0124</span>                 mov     ah, es:[di]</span><br><span class="line">seg000:<span class="number">0127</span>                 <span class="keyword">xor</span>     al, ah</span><br><span class="line">seg000:<span class="number">0129</span>                 mov     es:[di], al</span><br><span class="line">seg000:<span class="number">012</span>C                 inc     di</span><br><span class="line">seg000:<span class="number">012</span>D                 loop    loc_10122</span><br><span class="line">seg000:<span class="number">012F</span>                 pop     cx</span><br><span class="line">seg000:<span class="number">0130</span>                 inc     si</span><br><span class="line">seg000:<span class="number">0131</span>                 inc     bx</span><br><span class="line">seg000:<span class="number">0132</span>                 loop    loc_10115</span><br><span class="line">seg000:<span class="number">0134</span></span><br><span class="line">seg000:<span class="number">0134</span> loc_10134:                              ; CODE XREF: start+<span class="number">36</span>â†‘j</span><br><span class="line">seg000:<span class="number">0134</span>                 mov     ax, <span class="number">3</span></span><br><span class="line">seg000:<span class="number">0137</span>                 <span class="type">int</span>     <span class="number">10</span>h             ; - VIDEO - SET VIDEO MODE</span><br><span class="line">seg000:<span class="number">0137</span>                                         ; AL = mode</span><br><span class="line">seg000:<span class="number">0139</span>                 mov     dx, <span class="number">0</span></span><br><span class="line">seg000:<span class="number">013</span>C                 push    cs</span><br><span class="line">seg000:<span class="number">013</span>D                 pop     ds</span><br><span class="line">seg000:<span class="number">013</span>E                 mov     si, <span class="number">60</span>h ; <span class="string">&#x27;`&#x27;</span></span><br><span class="line">seg000:<span class="number">0141</span>                 mov     cx, cs:word_10088</span><br><span class="line">seg000:<span class="number">0146</span>                 <span class="keyword">xor</span>     bx, bx</span><br><span class="line">seg000:<span class="number">0148</span>                 <span class="keyword">xor</span>     ah, ah</span><br><span class="line">seg000:<span class="number">014</span>A</span><br><span class="line">seg000:<span class="number">014</span>A loc_1014A:                              ; CODE XREF: start+C3â†“j</span><br><span class="line">seg000:<span class="number">014</span>A                 lodsb</span><br><span class="line">seg000:<span class="number">014B</span>                 add     bx, ax</span><br><span class="line">seg000:<span class="number">014</span>D                 loop    loc_1014A</span><br><span class="line">seg000:<span class="number">014F</span>                 cmp     bx, cs:word_1005E</span><br><span class="line">seg000:<span class="number">0154</span>                 jnz     <span class="type">short</span> loc_10171</span><br><span class="line">seg000:<span class="number">0156</span>                 mov     si, <span class="number">34</span>h ; <span class="string">&#x27;4&#x27;</span></span><br><span class="line">seg000:<span class="number">0159</span>                 mov     cx, cs:word_10088</span><br><span class="line">seg000:<span class="number">015</span>E                 <span class="keyword">xor</span>     bx, bx</span><br><span class="line">seg000:<span class="number">0160</span>                 <span class="keyword">xor</span>     ah, ah</span><br><span class="line">seg000:<span class="number">0162</span></span><br><span class="line">seg000:<span class="number">0162</span> loc_10162:                              ; CODE XREF: start+DBâ†“j</span><br><span class="line">seg000:<span class="number">0162</span>                 lodsb</span><br><span class="line">seg000:<span class="number">0163</span>                 add     bx, ax</span><br><span class="line">seg000:<span class="number">0165</span>                 loop    loc_10162</span><br><span class="line">seg000:<span class="number">0167</span>                 cmp     bx, cs:word_1005C</span><br><span class="line">seg000:<span class="number">016</span>C                 jnz     <span class="type">short</span> loc_10171</span><br><span class="line">seg000:<span class="number">016</span>E                 mov     dx, <span class="number">34</span>h ; <span class="string">&#x27;4&#x27;</span></span><br><span class="line">seg000:<span class="number">0171</span></span><br><span class="line">seg000:<span class="number">0171</span> loc_10171:                              ; CODE XREF: start+CAâ†‘j</span><br><span class="line">seg000:<span class="number">0171</span>                                         ; start+E2â†‘j</span><br><span class="line">seg000:<span class="number">0171</span>                 mov     ah, <span class="number">9</span></span><br><span class="line">seg000:<span class="number">0173</span>                 <span class="type">int</span>     <span class="number">21</span>h             ; DOS - PRINT STRING</span><br><span class="line">seg000:<span class="number">0173</span>                                         ; DS:DX -&gt; string terminated by <span class="string">&quot;$&quot;</span></span><br><span class="line">seg000:<span class="number">0175</span>                 mov     ax, <span class="number">4</span>C00h</span><br><span class="line">seg000:<span class="number">0178</span>                 <span class="type">int</span>     <span class="number">21</span>h             ; DOS - <span class="number">2</span>+ - <span class="function">QUIT WITH EXIT <span class="title">CODE</span> <span class="params">(EXIT)</span></span></span><br><span class="line"><span class="function">seg000:<span class="number">0178</span> start           endp                    ;</span> AL = exit code</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„åˆ°è¿™é‡Œæœ‰ä¸¤ä¸ªcheck</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">seg000:<span class="number">014</span>A                 lodsb</span><br><span class="line">seg000:<span class="number">014B</span>                 add     bx, ax</span><br><span class="line">seg000:<span class="number">014</span>D                 loop    loc_1014A</span><br><span class="line">seg000:<span class="number">014F</span>                 cmp     bx, cs:word_1005E</span><br><span class="line">seg000:<span class="number">0154</span>                 jnz     <span class="type">short</span> loc_10171</span><br><span class="line">seg000:<span class="number">0156</span>                 mov     si, <span class="number">34</span>h ; <span class="string">&#x27;4&#x27;</span></span><br><span class="line">seg000:<span class="number">0159</span>                 mov     cx, cs:word_10088</span><br><span class="line">seg000:<span class="number">015</span>E                 <span class="keyword">xor</span>     bx, bx</span><br><span class="line">seg000:<span class="number">0160</span>                 <span class="keyword">xor</span>     ah, ah</span><br><span class="line">seg000:<span class="number">0162</span></span><br><span class="line">seg000:<span class="number">0162</span> loc_10162:                              ; CODE XREF: start+DBâ†“j</span><br><span class="line">seg000:<span class="number">0162</span>                 lodsb</span><br><span class="line">seg000:<span class="number">0163</span>                 add     bx, ax</span><br><span class="line">seg000:<span class="number">0165</span>                 loop    loc_10162</span><br><span class="line">seg000:<span class="number">0167</span>                 cmp     bx, cs:word_1005C</span><br><span class="line">seg000:<span class="number">016</span>C                 jnz     <span class="type">short</span> loc_10171</span><br><span class="line">seg000:<span class="number">016</span>E                 mov     dx, <span class="number">34</span>h ; <span class="string">&#x27;4&#x27;</span></span><br></pre></td></tr></table></figure>

<p>åˆ†åˆ«è·Ÿ0D9Få’Œ0FD9åšäº†cmp<br>æ¯ä¸ªcmpå‰é¢æœ‰ä¸€ä¸ªè¶…çŸ­çš„loop add çŒœæµ‹æ˜¯ç´¯åŠ æ±‚å’Œ ç±»ä¼¼sum()<br>ç„¶è€Œå…¶ä»–éƒ¨åˆ†çš„æ±‡ç¼–çœ‹ç€çœŸç´¯ã€‚ã€‚ã€‚<br>å¤§è‡´èƒ½æ‰¾åˆ°æœ‰ä¸€å¤„xor<br>è¿™é‡Œå¯ä»¥çœ‹å‡ºæ˜¯ä¸€ä¸ªäºŒé‡å¾ªç¯xor</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">seg000:<span class="number">0115</span> loc_10115:                              ; CODE XREF: start+A8â†“j</span><br><span class="line">seg000:<span class="number">0115</span>                 mov     di, <span class="number">34</span>h ; <span class="string">&#x27;4&#x27;</span></span><br><span class="line">seg000:<span class="number">0118</span>                 push    cx</span><br><span class="line">seg000:<span class="number">0119</span>                 add     di, bx</span><br><span class="line">seg000:<span class="number">011B</span>                 mov     cx, cs:word_10088</span><br><span class="line">seg000:<span class="number">0120</span>                 sub     cx, bx</span><br><span class="line">seg000:<span class="number">0122</span></span><br><span class="line">seg000:<span class="number">0122</span> loc_10122:                              ; CODE XREF: start+A3â†“j</span><br><span class="line">seg000:<span class="number">0122</span>                 mov     al, [si]</span><br><span class="line">seg000:<span class="number">0124</span>                 mov     ah, es:[di]</span><br><span class="line">seg000:<span class="number">0127</span>                 <span class="keyword">xor</span>     al, ah</span><br><span class="line">seg000:<span class="number">0129</span>                 mov     es:[di], al</span><br><span class="line">seg000:<span class="number">012</span>C                 inc     di</span><br><span class="line">seg000:<span class="number">012</span>D                 loop    loc_10122</span><br><span class="line">seg000:<span class="number">012F</span>                 pop     cx</span><br><span class="line">seg000:<span class="number">0130</span>                 inc     si</span><br><span class="line">seg000:<span class="number">0131</span>                 inc     bx</span><br><span class="line">seg000:<span class="number">0132</span>                 loop    loc_10115</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡word_10088çš„å€¼0x27èƒ½çŸ¥é“å¾ªç¯æ˜¯ 0~39<br>è¿˜åŸå¤§æ¦‚è¿™ä¸ªæ ·å­:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">output = [<span class="number">0x3E</span>, <span class="number">0x49</span>, <span class="number">0x26</span>, <span class="number">0x52</span>, <span class="number">0x45</span>, <span class="number">0x22</span>, <span class="number">0x42</span>, <span class="number">0x10</span>, <span class="number">0x66</span>, <span class="number">0x0B</span>, <span class="number">0x6C</span>, <span class="number">0x06</span>, <span class="number">0x0D</span>, <span class="number">0x50</span>, <span class="number">0x0F</span>, <span class="number">0x4C</span>, <span class="number">0x25</span>, <span class="number">0x4C</span>, <span class="number">0x3F</span>, <span class="number">0x12</span>, <span class="number">0x56</span>, <span class="number">0x03</span>, <span class="number">0x20</span>, <span class="number">0x5A</span>, <span class="number">0x14</span>, <span class="number">0x61</span>, <span class="number">0x4A</span>, <span class="number">0x3F</span>, <span class="number">0x5D</span>, <span class="number">0x51</span>, <span class="number">0x12</span>, <span class="number">0x5C</span>, <span class="number">0x18</span>, <span class="number">0x05</span>, <span class="number">0x43</span>, <span class="number">0x39</span>, <span class="number">0x4F</span>, <span class="number">0x32</span>, <span class="number">0x0A</span>] <span class="comment"># 34h</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">input</span>)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i,<span class="built_in">len</span>(<span class="built_in">input</span>)):</span><br><span class="line">        output[j] ^= <span class="built_in">input</span>[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">sum</span>(<span class="built_in">input</span>)==<span class="number">0xD9F</span>)</span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">sum</span>(output)==<span class="number">0xFD9</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(output))</span><br></pre></td></tr></table></figure>

<p>åªæ˜¯ç°åœ¨ä¸çŸ¥é“inputå’Œoutput<br>ç„¶è€Œå·§åˆçš„æ˜¯<br>â€œThis program cannot be run in DOS mode.â€çš„sumå€¼æ°å¥½ç­‰äº0xd9fâ€¦<br>æ‰€ä»¥è¿™å°±æ˜¯inputâ€¦<br>é‚£ä¹ˆå¯¹åº”å¾—åˆ°output<br><strong>justCTF{just_a_rusty_old_DOS_stub_task}</strong></p>
<hr>
<hr>
<p>è¿™çœŸä¸æ˜¯èƒ½åšçš„é¢˜ orz</p>
<h1 id="NewStarCTF2022"><a href="#NewStarCTF2022" class="headerlink" title="NewStarCTF2022"></a>NewStarCTF2022</h1><h2 id="WEEK4"><a href="#WEEK4" class="headerlink" title="WEEK4"></a>WEEK4</h2><h3 id="Exception"><a href="#Exception" class="headerlink" title="Exception"></a>Exception</h3><p>è€ƒå¯Ÿäº†ä¸€ç‚¹ç‚¹å¼‚å¸¸å¤„ç†<br>åœ¨è¿™é‡Œteaé‡Œé¢:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">32</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 -= <span class="number">0x61C88647</span>;</span><br><span class="line">      MEMORY[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">      v11 += (v7 + (v10 &gt;&gt; <span class="number">5</span>)) ^ (v9 + v10) ^ (v8 + <span class="number">16</span> * v10);</span><br><span class="line">      v10 += (v5 + (v11 &gt;&gt; <span class="number">5</span>)) ^ (v9 + v11) ^ (v6 + <span class="number">16</span> * v11);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>filterå§‹ç»ˆè¿”å›1 handler:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">006</span>A18C9 ;   __except(loc_6A18BC) <span class="comment">// owned by 6A18A4</span></span><br><span class="line">.text:<span class="number">006</span>A18C9                 mov     esp, [ebp+ms_exc.old_esp]</span><br><span class="line">.text:<span class="number">006</span>A18CC                 mov     eax, [ebp+var_48]</span><br><span class="line">.text:<span class="number">006</span>A18CF                 <span class="keyword">xor</span>     eax, <span class="number">12345678</span>h</span><br><span class="line">.text:<span class="number">006</span>A18D4                 mov     [ebp+var_48], eax</span><br><span class="line">.text:<span class="number">006</span>A18D7                 mov     [ebp+ms_exc.registration.TryLevel], <span class="number">0F</span>FFFFFFEh</span><br></pre></td></tr></table></figure>

<p>å¯¹keyå€¼è¿›è¡Œäº†xorå¤„ç† åˆ†å¥‡å¶é€†å°±è¡Œäº† æ³¨æ„æˆ‘ä»¬å®åˆ™æ˜¯i:31-&gt;0çš„é€†å‘ æ‰€ä»¥å…ˆ+DELTA2(xor keyäº†çš„)<br>flag:<br><strong>flag{44C3A7F112DA2BE728F451C5E2D09558}</strong></p>
<h3 id="HelpMe"><a href="#HelpMe" class="headerlink" title="HelpMe"></a>HelpMe</h3><p>æŒºå¥½ç©çš„é¢˜çš„<br>é¦–å…ˆps1å†™äº†ä¸ªbase64encodeçš„zip åœ¨çº¿ç½‘ç«™è§£åä¿å­˜è§£å‹ å¾—åˆ°åŠ å¯†xlsmæ–‡ä»¶çš„ä»£ç </p>
<figure class="highlight ps1"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$timestamp</span> = ([<span class="built_in">DateTime</span><span class="type">Offset</span>](<span class="built_in">Get-Date</span> <span class="string">&quot;Sat Oct 01 2022 20:22:21&quot;</span>)).ToUnixTimeSeconds()</span><br><span class="line"><span class="variable">$key</span> = <span class="built_in">New-Object</span> Byte[] <span class="number">16</span></span><br><span class="line"><span class="built_in">Get-Random</span> <span class="literal">-Max</span> <span class="number">256</span> <span class="literal">-SetSeed</span> <span class="variable">$timestamp</span> &gt;<span class="variable">$null</span></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$index</span> = <span class="number">0</span>; <span class="variable">$index</span> <span class="operator">-lt</span> <span class="number">16</span>; <span class="variable">$index</span>++) &#123;<span class="variable">$key</span>[<span class="variable">$index</span>] = [<span class="built_in">byte</span>](<span class="built_in">Get-Random</span> <span class="literal">-Max</span> <span class="number">256</span>)&#125;</span><br><span class="line"><span class="variable">$AES</span> = <span class="built_in">New-Object</span> System.Security.Cryptography.AesManaged</span><br><span class="line"><span class="variable">$AES</span>.Key = <span class="variable">$key</span></span><br><span class="line"><span class="variable">$AES</span>.Mode = <span class="string">&quot;ECB&quot;</span></span><br><span class="line"><span class="variable">$AES</span>.Padding = [<span class="type">System.Security.Cryptography.PaddingMode</span>]::PKCS7</span><br><span class="line"><span class="variable">$file</span> = <span class="string">&quot;<span class="variable">$mypath</span>\mygift.xlsm&quot;</span></span><br><span class="line"><span class="variable">$bytes</span> = [<span class="type">System.IO.File</span>]::ReadAllBytes(<span class="string">&quot;<span class="variable">$file</span>&quot;</span>)</span><br><span class="line"><span class="variable">$Encryptor</span> = <span class="variable">$AES</span>.CreateEncryptor()</span><br><span class="line"><span class="variable">$encdata</span> = <span class="variable">$Encryptor</span>.TransformFinalBlock(<span class="variable">$bytes</span>, <span class="number">0</span>, <span class="variable">$bytes</span>.Length)</span><br><span class="line"><span class="variable">$Encryptor</span>.Dispose()</span><br><span class="line"><span class="variable">$AES</span>.Dispose()</span><br><span class="line"><span class="built_in">Set-Content</span> <span class="literal">-Value</span> <span class="variable">$encdata</span> <span class="literal">-Encoding</span> Byte <span class="string">&quot;<span class="variable">$file</span>.enc&quot;</span></span><br></pre></td></tr></table></figure>

<p>ç¨ä½œä¿®æ”¹: En-&gt;De è¿è¡Œå³å¯è§£å‹è·å¾—xlsm<br>æ‰“å¼€å‘ç°æœ‰å®ä»£ç <br>çœ‹<a target="_blank" rel="noopener" href="https://jingyan.baidu.com/article/02027811de95305bcc9ce5f3.html">è¿™ç¯‡</a><br>æ‰“å¼€å¼€å‘è€…é€‰é¡¹ é€‰æ‹©Micxxx Visualxxx<br>å°±å¯ä»¥çœ‹åˆ°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function">Sub <span class="title">hack</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span></span><br><span class="line"><span class="function">    MsgBox &quot;You have to pay me a lot of money now!&quot;</span></span><br><span class="line"><span class="function">    Dim shell</span></span><br><span class="line"><span class="function">    Dim talk</span></span><br><span class="line"><span class="function">    Set talk </span>= <span class="built_in">CreateObject</span>(<span class="string">&quot;SAPI.SpVoice&quot;</span>)</span><br><span class="line">    talk.Rate = <span class="number">-3</span></span><br><span class="line">    talk.Volume = <span class="number">100</span></span><br><span class="line">    talk.Speak <span class="string">&quot;You have to pay me a lot of money now&quot;</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    Dim a, b, x, arr</span><br><span class="line">    a = <span class="number">20</span></span><br><span class="line">    b = <span class="number">22</span></span><br><span class="line">    x = <span class="number">21</span></span><br><span class="line">    </span><br><span class="line">    arr = <span class="built_in">Array</span>(<span class="number">2</span>, <span class="number">19</span>, <span class="number">16</span>, <span class="number">21</span>, <span class="number">14</span>, <span class="number">24</span>, <span class="number">18</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">23</span>, <span class="number">13</span>, <span class="number">29</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">26</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">27</span>, <span class="number">25</span>, <span class="number">3</span>, <span class="number">28</span>, <span class="number">8</span>, <span class="number">22</span>, <span class="number">17</span>, <span class="number">4</span>)</span><br><span class="line">    </span><br><span class="line">    Dim i</span><br><span class="line">    </span><br><span class="line">    For i = <span class="number">1</span> To <span class="number">32</span></span><br><span class="line">    If <span class="built_in">Cells</span>(<span class="number">1</span>, i).Value = <span class="string">&quot;*&quot;</span> Then Exit For</span><br><span class="line">    <span class="built_in">Cells</span>(<span class="number">2</span>, <span class="built_in">arr</span>(i - <span class="number">1</span>) + <span class="number">1</span>).Value = <span class="built_in">Cells</span>(<span class="number">1</span>, i).Value Xor x</span><br><span class="line">    x = (a * x + b) Mod <span class="number">255</span></span><br><span class="line">    <span class="built_in">Cells</span>(<span class="number">1</span>, i).Value = <span class="string">&quot;*&quot;</span></span><br><span class="line">    Next</span><br><span class="line">    talk.Speak <span class="string">&quot;I have hacked you&quot;</span></span><br><span class="line">    Set sh = <span class="built_in">CreateObject</span>(<span class="string">&quot;Wscript.Shell&quot;</span>)</span><br><span class="line">    sh.<span class="built_in">Run</span> (<span class="string">&quot;%comspec% /k tree&quot;</span>), <span class="number">3</span>, True</span><br><span class="line">    ActiveWorkbook.Close</span><br><span class="line">    alertTime = Now + <span class="built_in">TimeValue</span>(<span class="string">&quot;00:00:30&quot;</span>)</span><br><span class="line">    Application.OnTime alertTime, <span class="string">&quot;hack&quot;</span></span><br><span class="line">    </span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>

<p>è·Ÿç€è§£å°±è¡Œäº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">enc = <span class="string">&quot;62	163	115	241	149	89	216	45	20	138	220	8	75	42	135	93	161	60	115	215	169	66	32	132	141	21	184	95	159	3	121	91&quot;</span></span><br><span class="line">enc = enc.split(<span class="string">&quot;\t&quot;</span>)</span><br><span class="line">enc = [<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> enc]</span><br><span class="line">a = <span class="number">20</span></span><br><span class="line">b = <span class="number">22</span></span><br><span class="line">x = <span class="number">21</span></span><br><span class="line">pos = [<span class="number">2</span>, <span class="number">19</span>, <span class="number">16</span>, <span class="number">21</span>, <span class="number">14</span>, <span class="number">24</span>, <span class="number">18</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">23</span>, <span class="number">13</span>, <span class="number">29</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">26</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">27</span>, <span class="number">25</span>, <span class="number">3</span>, <span class="number">28</span>, <span class="number">8</span>, <span class="number">22</span>, <span class="number">17</span>, <span class="number">4</span>]</span><br><span class="line">flag = [<span class="number">0</span>]*<span class="number">33</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">    flag[i] = x^enc[pos[i-<span class="number">1</span>]]</span><br><span class="line">    x = (a*x+b)%<span class="number">255</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(c),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>flag{This_is_@_begin_about@hack}</strong></p>
<h2 id="WEEK5"><a href="#WEEK5" class="headerlink" title="WEEK5"></a>WEEK5</h2><h3 id="Virtual-Self"><a href="#Virtual-Self" class="headerlink" title="Virtual Self"></a>Virtual Self</h3><p>å‚»é€¼é¢˜â€¦<br>è·Ÿç€vmæ‰“å°435è¡Œå­—èŠ‚ç  é€ä¸ªå­—ç¬¦æ‰‹æ‰£â€¦<br>éƒ¨åˆ†æ‰‹æ‰£å¦‚ä¸‹:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">flag[<span class="number">3</span>] = (<span class="built_in">chr</span>(((enc[<span class="number">3</span>]+<span class="number">2</span>)^<span class="number">20</span>)-<span class="number">2</span>))</span><br><span class="line">flag[<span class="number">10</span>] = (<span class="built_in">chr</span>((enc[<span class="number">10</span>]^<span class="number">97</span>^<span class="number">3</span>)))</span><br><span class="line">flag[<span class="number">17</span>] = <span class="built_in">chr</span>(((enc[<span class="number">17</span>]^<span class="number">3</span>)+<span class="number">2</span>)^<span class="number">1</span>)</span><br><span class="line">flag[<span class="number">22</span>] = <span class="built_in">chr</span>((((enc[<span class="number">22</span>]^<span class="number">230</span>)^<span class="number">1</span>)+<span class="number">252</span>)&amp;<span class="number">0xff</span>)</span><br><span class="line">flag[<span class="number">5</span>] = <span class="built_in">chr</span>((((((((enc[<span class="number">5</span>]-<span class="number">1</span>)^<span class="number">1</span>^<span class="number">74</span>)-<span class="number">112</span>)+<span class="number">23</span>)+<span class="number">1</span>)^<span class="number">74</span>)+<span class="number">23</span>)&amp;<span class="number">0xff</span>)</span><br><span class="line">flag[<span class="number">0</span>] = <span class="string">&#x27;f&#x27;</span></span><br><span class="line">flag[<span class="number">7</span>] = <span class="built_in">chr</span>(((enc[<span class="number">7</span>]+<span class="number">6</span>)^<span class="number">2</span>)+<span class="number">1</span>)</span><br><span class="line">flag[<span class="number">25</span>] = <span class="built_in">chr</span>((((enc[<span class="number">25</span>]+<span class="number">2</span>)^<span class="number">1</span>)-<span class="number">50</span>)&amp;<span class="number">0xff</span>)</span><br><span class="line">flag[<span class="number">23</span>] = <span class="built_in">chr</span>(((enc[<span class="number">23</span>]^<span class="number">1</span>)+<span class="number">2</span>))</span><br><span class="line">flag[<span class="number">14</span>] = <span class="built_in">chr</span>((((((enc[<span class="number">14</span>]+(<span class="number">80</span>^<span class="number">249</span>))+<span class="number">252</span>-<span class="number">2</span>*<span class="number">228</span>)))&amp;<span class="number">0xff</span>))</span><br><span class="line">flag[<span class="number">19</span>] = <span class="built_in">chr</span>(enc[<span class="number">19</span>]-<span class="number">1</span>)</span><br><span class="line">flag[<span class="number">26</span>] = <span class="built_in">chr</span>(((((enc[<span class="number">26</span>]^<span class="number">3</span>)+<span class="number">30</span>)^<span class="number">2</span>^<span class="number">177</span>)-<span class="number">58</span>)&amp;<span class="number">0xff</span>)</span><br><span class="line">flag[<span class="number">20</span>] = <span class="built_in">chr</span>((((((((enc[<span class="number">20</span>]-((<span class="number">8</span>^<span class="number">149</span>)-<span class="number">70</span>))^<span class="number">1</span>)-<span class="number">16</span>)^<span class="number">2</span>))))&amp;<span class="number">0xff</span>)</span><br><span class="line">flag[<span class="number">2</span>] = <span class="string">&#x27;a&#x27;</span></span><br><span class="line">flag[<span class="number">18</span>] = <span class="built_in">chr</span>(((((((enc[<span class="number">18</span>]-<span class="number">5</span>)^<span class="number">1</span>^<span class="number">3</span>)))))&amp;<span class="number">0xff</span>)</span><br><span class="line">flag[<span class="number">4</span>] = <span class="string">&#x27;&#123;&#x27;</span></span><br><span class="line">flag[<span class="number">6</span>] = <span class="built_in">chr</span>(((((enc[<span class="number">6</span>]+<span class="number">3</span>)^<span class="number">3</span>)-<span class="number">2</span>)^<span class="number">3</span>)&amp;<span class="number">0xff</span>)</span><br><span class="line">flag[<span class="number">11</span>] = <span class="built_in">chr</span>(((((((enc[<span class="number">11</span>]+<span class="number">174</span>)^(-<span class="number">58</span>))-<span class="number">1</span>))))&amp;<span class="number">0xff</span>)</span><br><span class="line">flag[<span class="number">21</span>] = <span class="built_in">chr</span>((((((((enc[<span class="number">21</span>]-<span class="number">3</span>)^<span class="number">2</span>)+<span class="number">3</span>+<span class="number">236</span>+<span class="number">236</span>)^<span class="number">3</span>))))&amp;<span class="number">0xff</span>)</span><br><span class="line">flag[<span class="number">9</span>] = <span class="built_in">chr</span>((((((((enc[<span class="number">9</span>]+<span class="number">2</span>)^<span class="number">2</span>)-<span class="number">23</span>)))))&amp;<span class="number">0xff</span>)</span><br><span class="line">flag[<span class="number">28</span>] = <span class="built_in">chr</span>(((((((enc[<span class="number">28</span>]^<span class="number">28</span>)-<span class="number">1</span>)^<span class="number">28</span>)-<span class="number">3</span>)))&amp;<span class="number">0xff</span>)</span><br><span class="line">flag[<span class="number">15</span>] = <span class="built_in">chr</span>((((((((((enc[<span class="number">15</span>]+(<span class="number">165</span>^<span class="number">177</span>)-<span class="number">53</span>)^<span class="number">3</span>)+<span class="number">2</span>)^<span class="number">3</span>))))))&amp;<span class="number">0xff</span>)</span><br><span class="line">flag[<span class="number">16</span>] = <span class="built_in">chr</span>(((((enc[<span class="number">16</span>]-<span class="number">2</span>)^<span class="number">227</span>)-<span class="number">2</span>))&amp;<span class="number">0xff</span>)</span><br><span class="line">flag[<span class="number">8</span>] = <span class="built_in">chr</span>((((((((enc[<span class="number">8</span>]-(<span class="number">106</span>^<span class="number">43</span>))^<span class="number">43</span>)-<span class="number">1</span>)^<span class="number">43</span>))))&amp;<span class="number">0xff</span>)</span><br><span class="line">flag[<span class="number">13</span>] = <span class="built_in">chr</span>((enc[<span class="number">13</span>]^<span class="number">2</span>^<span class="number">3</span>^<span class="number">1</span>)&amp;<span class="number">0xff</span>)</span><br></pre></td></tr></table></figure>

<p>ç„¶åå°±èƒ½çŒœå‡ºflagäº†<br><strong>flag{Will_you_see_the_light?}</strong></p>
<h1 id="BUUCTF-N1BOOK"><a href="#BUUCTF-N1BOOK" class="headerlink" title="BUUCTF&#x2F;N1BOOK"></a>BUUCTF&#x2F;N1BOOK</h1><p>é‡Œé¢æœ‰goå’Œrustçš„é¢˜ è®°å¾—ä¸€ä¸¤ä¸ªæœˆå‰çœ‹æ¯«æ— å¤´ç»ª ç°åœ¨çœ‹å¥½å¤šäº†</p>
<h2 id="easy-rust"><a href="#easy-rust" class="headerlink" title="easy_rust"></a>easy_rust</h2><p>ç”±äºrustä»£ç å†—é•¿ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡stringæœç´¢å…³é”®å­—ç¬¦ä¸² æ¯”å¦‚æœç´¢flag<br>æ‰¾åˆ°è¾“å…¥ç‚¹ å‘ç°åœ¨ä¸€ä¸ªbase64encodeé‡Œ<br>å†åœ¨å‡½æ•°åˆ—è¡¨æœç´¢main è¿›å…¥main<br>æ ¸å¿ƒé€»è¾‘å°±è¿™ä¸¤å¥:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">BASE64ENCODE</span>((__int64)v14, (__int64)(&amp;v11.private_2 + <span class="number">1</span>));</span><br><span class="line"><span class="keyword">if</span> ( (_$LT$alloc..string..<span class="type">String</span>$u20$<span class="keyword">as</span>$u20$core..cmp..<span class="built_in">PartialEq</span>$GT$::eq::<span class="title function_ invoke__">h785456d93284be99</span>(v14, &amp;v11) &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯base64å’Œcheck<br>å‘ç°checkçš„ä¸¤ä¸ªå€¼éƒ½åœ¨base64encodeçš„å‚æ•°é‡Œ<br>è¿›å…¥base64encode å¯ä»¥å‘ç°è¿™æ ·ä¸€å¥</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">core::panicking::panic::<span class="title function_ invoke__">hb5daa85c7c72fc62</span>(</span><br><span class="line">        <span class="string">&quot;attempt to add with overflowxkPmey0LoJt4u5A9MznQhZEH6VSUvRX=Y13fi8srlaTdwGB2+q7cg/bKjpNCFIODInput your flag:\n&quot;</span></span><br><span class="line">        <span class="string">&quot;Ufy3UbIdXc82u0z=Sfk3=MlWFailed to read lineTrue!\n&quot;</span></span><br><span class="line">        <span class="string">&quot;False!\n&quot;</span>,</span><br><span class="line">        <span class="number">28</span>LL,</span><br><span class="line">        &amp;off_23FE58);</span><br></pre></td></tr></table></figure>

<p>ç»“åˆè¯­è¨€ç‰¹æ€§ è¿™ç§å°±æ˜¯æŠŠå‡½æ•°ç”¨ä¸Šçš„å‚æ•°&#x2F;å­—ç¬¦ä¸² éƒ½å†™è¿›å»äº†<br>å¾ˆå®¹æ˜“çŒœå‡ºoverflowåé¢çš„æ˜¯base64å˜è¡¨ flagåé¢çš„æ˜¯å¯†æ–‡<br>å˜è¡¨base64è§£å°±è¡Œäº†</p>
<p><strong>n1book{9o0d_j0b}</strong></p>
<h2 id="easy-go"><a href="#easy-go" class="headerlink" title="easy_go"></a>easy_go</h2><p>å‡½æ•°åˆ—è¡¨æœç´¢main è¿›å…¥main_main<br>æŸ¥æ‰¾å‘ç°æ²¡æœ‰main_init æ‰€ä»¥æ”¾å¿ƒåˆ†æmain_mainå³å¯<br>ä»£ç å¾ˆçŸ­<br>check len and format:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( p_string-&gt;<span class="built_in">len</span> == <span class="number">21</span></span><br><span class="line">    &amp;&amp; (*(_DWORD *)ptr != <span class="number">1868706158</span> || *((_WORD *)ptr + <span class="number">2</span>) != <span class="number">27503</span> ? (v1 = <span class="number">0</span>) : (v1 = ptr[<span class="number">6</span>] == <span class="number">123</span>),</span><br><span class="line">        v1 &amp;&amp; ptr[<span class="number">20</span>] == <span class="number">125</span>) )</span><br></pre></td></tr></table></figure>

<p>Final_Check:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>LL; i &lt; <span class="number">13</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( i &gt;= v4 )</span><br><span class="line">        runtime_panicIndex();</span><br><span class="line">      <span class="keyword">if</span> ( byte_561538[i] + byte_561518[i] * *(_BYTE *)(i + v3) != byte_561528[i] )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_12;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°å¯¹åº”å€¼ çˆ†ç ´å³å¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">0xB7</span>, <span class="number">0x9C</span>, <span class="number">0x79</span>, <span class="number">0x43</span>, <span class="number">0x9B</span>, <span class="number">0xAF</span>, <span class="number">0x94</span>, <span class="number">0xE4</span>, <span class="number">0x94</span>, <span class="number">0x71</span>, <span class="number">0xEC</span>, <span class="number">0xEA</span>, <span class="number">0x8E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line">key1 = [<span class="number">0xD3</span>, <span class="number">0x75</span>, <span class="number">0x9B</span>, <span class="number">0xF9</span>, <span class="number">0xA3</span>, <span class="number">0x87</span>, <span class="number">0xED</span>, <span class="number">0x93</span>, <span class="number">0x8D</span>, <span class="number">0xDD</span>, <span class="number">0x77</span>, <span class="number">0xED</span>, <span class="number">0x67</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line">key2 = [<span class="number">0xDB</span>, <span class="number">0x9E</span>, <span class="number">0xB7</span>, <span class="number">0x9A</span>, <span class="number">0x91</span>, <span class="number">0xCA</span>, <span class="number">0xA1</span>, <span class="number">0x6B</span>, <span class="number">0x97</span>, <span class="number">0xC1</span>, <span class="number">0x74</span>, <span class="number">0xB3</span>, <span class="number">0x90</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line">flag = <span class="string">&quot;n1book&#123;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        check = (key2[i]+key1[i]*x)&amp;<span class="number">0xff</span></span><br><span class="line">        <span class="keyword">if</span> check==enc[i]:</span><br><span class="line">            flag += <span class="built_in">chr</span>(x)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line">flag += <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p><strong>n1book{4Ff1n3_C1pH3R}</strong></p>
<h2 id="easy-mfc"><a href="#easy-mfc" class="headerlink" title="easy_mfc"></a>easy_mfc</h2><p>å‰å‡ å¤©åšReversing.Kræ—¶æ¥è§¦è¿‡mfcçš„æ¦‚å¿µ(è¢«å¹²ç¢äº†)<br>è¿™é¢˜æ‰“å¼€è¿˜æ˜¯ä¸å¥½æ‰¾åˆ°é€»è¾‘<br>WinMainé‡Œé¢è²Œä¼¼æ²¡æœ‰è¿›è¡Œcheckæ“ä½œ<br>è¿˜å¥½å‡½æ•°å¾ˆå°‘ æŒ¨ä¸ªç¿»<br>ç¿»åˆ°æœ‰ä¸ªcheck</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">v7[<span class="number">0</span>] = <span class="number">0x928C9DBC</span>;</span><br><span class="line">v7[<span class="number">1</span>] = <span class="number">0x21864740</span>;</span><br><span class="line">v7[<span class="number">2</span>] = <span class="number">0xFD8FACF5</span>;</span><br><span class="line">v3 = *(_DWORD *)(a2 - <span class="number">12</span>) == <span class="number">26</span>;              <span class="comment">// len=26</span></span><br><span class="line">v7[<span class="number">3</span>] = <span class="number">0x3AE9E468</span>;</span><br><span class="line">v7[<span class="number">4</span>] = <span class="number">0x64B366C0</span>;</span><br><span class="line">v7[<span class="number">5</span>] = <span class="number">0x22D3797E</span>;</span><br><span class="line">v8 = <span class="number">0xF831</span>;</span><br><span class="line">v5[<span class="number">0</span>] = <span class="number">0xFDEEACD2</span>;</span><br><span class="line">v5[<span class="number">1</span>] = <span class="number">0x79FD2C2F</span>;</span><br><span class="line">v5[<span class="number">2</span>] = <span class="number">0x85D0DEC5</span>;</span><br><span class="line">v5[<span class="number">3</span>] = <span class="number">0xBB6B658</span>;</span><br><span class="line">v5[<span class="number">4</span>] = <span class="number">0x54C039F5</span>;</span><br><span class="line">v5[<span class="number">5</span>] = <span class="number">0x54E21F21</span>;</span><br><span class="line">v6 = <span class="number">0x8502</span>;</span><br><span class="line"><span class="keyword">if</span> ( v3 )</span><br><span class="line">&#123;</span><br><span class="line">  v4 = <span class="number">0</span>;                                     <span class="comment">// CHECKï¼</span></span><br><span class="line">  <span class="keyword">while</span> ( (*((<span class="type">unsigned</span> __int8 *)v7 + v4) ^ (<span class="type">unsigned</span> __int16)ATL::CSimpleStringT&lt;<span class="type">wchar_t</span>,<span class="number">1</span>&gt;::<span class="built_in">GetAt</span>(&amp;a2, v4)) == *((<span class="type">unsigned</span> __int8 *)v5 + v4) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ++v4 &gt;= *(_DWORD *)(a2 - <span class="number">12</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      CWnd::<span class="built_in">SetDlgItemTextW</span>(<span class="keyword">this</span>, <span class="number">-1</span>, <span class="string">L&quot;OK&quot;</span>);</span><br><span class="line">      <span class="keyword">goto</span> LABEL_7;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">CWnd::<span class="built_in">SetDlgItemTextW</span>(<span class="keyword">this</span>, <span class="number">-1</span>, <span class="string">L&quot;Error&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæå–å‡ºä¸¤ä¸ªæ•°ç»„ xorå›å»å³å¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">enc1 = <span class="string">&quot;BC9D8C9240478621F5AC8FFD68E4E93AC066B3647E79D32231F8&quot;</span></span><br><span class="line">enc2 = <span class="string">&quot;D2ACEEFD2F2CFD79C5DED08558B6B60BF539C054211FE2540285&quot;</span></span><br><span class="line">enc1 = [<span class="built_in">int</span>(enc1[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>],<span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc1)//<span class="number">2</span>)]</span><br><span class="line">enc2 = [<span class="built_in">int</span>(enc2[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>],<span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc2)//<span class="number">2</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc1)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(enc1[i]^enc2[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>n1book{X0r_x0R_15_s0_f1v3}</strong></p>
<hr>
<hr>
<p>ç«‹ä¸ªflag è¿‡æ®µæ—¶é—´æŠ½ç©ºè®¤çœŸå­¦å­¦mfcç¼–ç¨‹ å…ˆäº†è§£å¼€å‘åŸç†å†é€†å‘</p>
<p>è¿™ä¸ªç³»åˆ—è¿˜å‰©ä¸€é“python è²Œä¼¼ä¸èƒ½ç›´æ¥åç¼–è¯‘.pyc åº”è¯¥æ˜¯è¦æŸ¥çœ‹å­—èŠ‚ç  è¿‡æ®µæ—¶é—´å†æ¥çœ‹å§</p>
<h1 id="NPUCTF2020"><a href="#NPUCTF2020" class="headerlink" title="NPUCTF2020"></a>NPUCTF2020</h1><h2 id="BasicASM"><a href="#BasicASM" class="headerlink" title="BasicASM"></a>BasicASM</h2><p>ç»™çš„ä¸€ä¸ªasmæ–‡ä»¶ IDAå•¥ä¹Ÿçœ‹ä¸äº† ç”¨winhexæŸ¥çœ‹</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00007F</span>F7A8AC5A50  push        rbp  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5A52  push        rdi  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5A53  sub         rsp,<span class="number">238</span>h  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5A5A  lea         rbp,[rsp+<span class="number">20</span>h]  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5A5F  mov         rdi,rsp  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5A62  mov         ecx,<span class="number">8</span>Eh  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5A67  mov         eax,<span class="number">0</span>CCCCCCCCh  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5A6C  rep stos    dword ptr [rdi]  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5A6E  mov         rax,qword ptr [__security_cookie (<span class="number">07F</span>F7A8AD3018h)]  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5A75  <span class="keyword">xor</span>         rax,rbp  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5A78  mov         qword ptr [rbp+<span class="number">208</span>h],rax  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5A7F  lea         rcx,[__06A15900_ConsoleApplication@<span class="built_in">cpp</span> (<span class="number">07F</span>F7A8AD902Ah)]  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5A86  call        __CheckForDebuggerJustMyCode (<span class="number">07F</span>F7A8AC1122h)  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5A8B  lea         rdx,[string <span class="string">&quot;flag&#123;this_is_a_fake_flag&#125;&quot;</span> (<span class="number">07F</span>F7A8ACF450h)]  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5A92  lea         rcx,[flag]  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5A96  call        std::basic_string&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,std::allocator&lt;<span class="type">char</span>&gt; &gt;::basic_string&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,std::allocator&lt;<span class="type">char</span>&gt; &gt; (<span class="number">07F</span>F7A8AC15E1h)  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5A9B  nop  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5A9C  mov         dword ptr [p],<span class="number">0</span>  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AA3  mov         dword ptr [rbp+<span class="number">64</span>h],<span class="number">0</span>  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AAA  jmp         main+<span class="number">64</span>h (<span class="number">07F</span>F7A8AC5AB4h)  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AAC  mov         eax,dword ptr [rbp+<span class="number">64</span>h]  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AAF  inc         eax  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AB1  mov         dword ptr [rbp+<span class="number">64</span>h],eax  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AB4  movsxd      rax,dword ptr [rbp+<span class="number">64</span>h]  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AB8  mov         qword ptr [rbp+<span class="number">1F</span>8h],rax  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5ABF  lea         rcx,[flag]  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AC3  call        std::basic_string&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,std::allocator&lt;<span class="type">char</span>&gt; &gt;::<span class="built_in">length</span> (<span class="number">07F</span>F7A8AC122Bh)  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AC8  mov         rcx,qword ptr [rbp+<span class="number">1F</span>8h]  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5ACF  cmp         rcx,rax  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AD2  jae         main+<span class="number">1B</span>2h (<span class="number">07F</span>F7A8AC5C02h)  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AD8  mov         eax,dword ptr [rbp+<span class="number">64</span>h]  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5ADB  <span class="keyword">and</span>         eax,<span class="number">1</span>  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5ADE  cmp         eax,<span class="number">1</span>  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AE1  jne         main+<span class="number">126</span>h (<span class="number">07F</span>F7A8AC5B76h)  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AE7  movsxd      rax,dword ptr [rbp+<span class="number">64</span>h]  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AEB  mov         rdx,rax  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AEE  lea         rcx,[flag]  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AF2  call        std::basic_string&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,std::allocator&lt;<span class="type">char</span>&gt; &gt;::<span class="keyword">operator</span>[] (<span class="number">07F</span>F7A8AC1442h)  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AF7  movsx       eax,byte ptr [rax]  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AFA  <span class="keyword">xor</span>         eax,<span class="number">42</span>h  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AFD  mov         dword ptr [p],eax  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5B00  mov         dl,<span class="number">30</span>h  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5B02  lea         rcx,[rbp+<span class="number">144</span>h]  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5B09  call        std::<span class="built_in">setfill</span>&lt;<span class="type">char</span>&gt; (<span class="number">07F</span>F7A8AC1046h)  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5B0E  mov         qword ptr [rbp+<span class="number">1F</span>8h],rax  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5B15  mov         edx,<span class="number">2</span>  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5B1A  lea         rcx,[rbp+<span class="number">168</span>h]  </span><br><span class="line"><span class="number">00007F</span><span class="function">F7A8AC5B21  call        <span class="title">std::setw</span> <span class="params">(<span class="number">07F</span>F7A8AC10D2h)</span>  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B26  mov         qword ptr [rbp+200h],rax  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B2D  lea         rdx,[<span class="title">std::hex</span> <span class="params">(<span class="number">07F</span>F7A8AC1488h)</span>]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B34  mov         rcx,qword ptr [<span class="title">__imp_std::cout</span> <span class="params">(<span class="number">07F</span>F7A8AD71C0h)</span>]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B3B  call        qword ptr [__imp_std::basic_ostream&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt; &gt;::<span class="keyword">operator</span>&lt;&lt; <span class="params">(<span class="number">07F</span>F7A8AD7160h)</span>]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B41  mov         rcx,qword ptr [rbp+200h]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B48  mov         rdx,rcx  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B4B  mov         rcx,rax  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B4E  call        std::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,__int64&gt; <span class="params">(<span class="number">07F</span>F7A8AC12F8h)</span>  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B53  mov         rcx,qword ptr [rbp+1F8h]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B5A  mov         rdx,rcx  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B5D  mov         rcx,rax  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B60  call        std::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,<span class="type">char</span>&gt; <span class="params">(<span class="number">07F</span>F7A8AC11A4h)</span>  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B65  mov         edx,dword ptr [p]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B68  mov         rcx,rax  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B6B  call        qword ptr [__imp_std::basic_ostream&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt; &gt;::<span class="keyword">operator</span>&lt;&lt; <span class="params">(<span class="number">07F</span>F7A8AD7158h)</span>]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B71  jmp         main+1<span class="title">ADh</span> <span class="params">(<span class="number">07F</span>F7A8AC5BFDh)</span>  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B76  movsxd      rax,dword ptr [rbp+64h]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B7A  mov         rdx,rax  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B7D  lea         rcx,[flag]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B81  call        std::basic_string&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,std::allocator&lt;<span class="type">char</span>&gt; &gt;::<span class="keyword">operator</span>[] <span class="params">(<span class="number">07F</span>F7A8AC1442h)</span>  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B86  movsx       eax,byte ptr [rax]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B89  mov         dword ptr [p],eax  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B8C  mov         dl,30h  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B8E  lea         rcx,[rbp+194h]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B95  call        std::setfill&lt;<span class="type">char</span>&gt; <span class="params">(<span class="number">07F</span>F7A8AC1046h)</span>  </span></span><br><span class="line"><span class="function">00007FF7A8AC5B9A  mov         qword ptr [rbp+1F8h],rax  </span></span><br><span class="line"><span class="function">00007FF7A8AC5BA1  mov         edx,2  </span></span><br><span class="line"><span class="function">00007FF7A8AC5BA6  lea         rcx,[rbp+1B8h]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5BAD  call        <span class="title">std::setw</span> <span class="params">(<span class="number">07F</span>F7A8AC10D2h)</span>  </span></span><br><span class="line"><span class="function">00007FF7A8AC5BB2  mov         qword ptr [rbp+200h],rax  </span></span><br><span class="line"><span class="function">00007FF7A8AC5BB9  lea         rdx,[<span class="title">std::hex</span> <span class="params">(<span class="number">07F</span>F7A8AC1488h)</span>]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5BC0  mov         rcx,qword ptr [<span class="title">__imp_std::cout</span> <span class="params">(<span class="number">07F</span>F7A8AD71C0h)</span>]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5BC7  call        qword ptr [__imp_std::basic_ostream&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt; &gt;::<span class="keyword">operator</span>&lt;&lt; <span class="params">(<span class="number">07F</span>F7A8AD7160h)</span>]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5BCD  mov         rcx,qword ptr [rbp+200h]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5BD4  mov         rdx,rcx  </span></span><br><span class="line"><span class="function">00007FF7A8AC5BD7  mov         rcx,rax  </span></span><br><span class="line"><span class="function">00007FF7A8AC5BDA  call        std::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,__int64&gt; <span class="params">(<span class="number">07F</span>F7A8AC12F8h)</span>  </span></span><br><span class="line"><span class="function">00007FF7A8AC5BDF  mov         rcx,qword ptr [rbp+1F8h]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5BE6  mov         rdx,rcx  </span></span><br><span class="line"><span class="function">00007FF7A8AC5BE9  mov         rcx,rax  </span></span><br><span class="line"><span class="function">00007FF7A8AC5BEC  call        std::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,<span class="type">char</span>&gt; <span class="params">(<span class="number">07F</span>F7A8AC11A4h)</span>  </span></span><br><span class="line"><span class="function">00007FF7A8AC5BF1  mov         edx,dword ptr [p]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5BF4  mov         rcx,rax  </span></span><br><span class="line"><span class="function">00007FF7A8AC5BF7  call        qword ptr [__imp_std::basic_ostream&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt; &gt;::<span class="keyword">operator</span>&lt;&lt; <span class="params">(<span class="number">07F</span>F7A8AD7158h)</span>]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5BFD  jmp         main+5<span class="title">Ch</span> <span class="params">(<span class="number">07F</span>F7A8AC5AACh)</span>  </span></span><br><span class="line"><span class="function">00007FF7A8AC5C02  mov         dword ptr [rbp+1E4h],0  </span></span><br><span class="line"><span class="function">00007FF7A8AC5C0C  lea         rcx,[flag]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5C10  call        std::basic_string&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,std::allocator&lt;<span class="type">char</span>&gt; &gt;::~basic_string&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,std::allocator&lt;<span class="type">char</span>&gt; &gt; <span class="params">(<span class="number">07F</span>F7A8AC1302h)</span>  </span></span><br><span class="line"><span class="function">00007FF7A8AC5C15  mov         eax,dword ptr [rbp+1E4h]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5C1B  mov         edi,eax  </span></span><br><span class="line"><span class="function">00007FF7A8AC5C1D  lea         rcx,[rbp-20h]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5C21  lea         rdx,[__xt_z+540<span class="title">h</span> <span class="params">(<span class="number">07F</span>F7A8ACEFE0h)</span>]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5C28  call        _<span class="title">RTC_CheckStackVars</span> <span class="params">(<span class="number">07F</span>F7A8AC1596h)</span>  </span></span><br><span class="line"><span class="function">00007FF7A8AC5C2D  mov         eax,edi  </span></span><br><span class="line"><span class="function">00007FF7A8AC5C2F  mov         rcx,qword ptr [rbp+208h]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5C36  <span class="keyword">xor</span>         rcx,rbp  </span></span><br><span class="line"><span class="function">00007FF7A8AC5C39  call        __<span class="title">security_check_cookie</span> <span class="params">(<span class="number">07F</span>F7A8AC1190h)</span>  </span></span><br><span class="line"><span class="function">00007FF7A8AC5C3E  lea         rsp,[rbp+218h]  </span></span><br><span class="line"><span class="function">00007FF7A8AC5C45  pop         rdi  </span></span><br><span class="line"><span class="function">00007FF7A8AC5C46  pop         rbp  </span></span><br><span class="line"><span class="function">00007FF7A8AC5C47  ret  </span></span><br></pre></td></tr></table></figure>

<p>é€»è¾‘ä¸éš¾ èƒ½æ‰¾åˆ°å…³é”®ç‚¹ xor 42h<br>åŒæ—¶é¢˜ç›®ä¹Ÿç»™äº†output</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">662e61257b26301d7972751d6b2c6f355f3a38742d74341d61776d7d7d</span><br></pre></td></tr></table></figure>

<p>ç„¶è€Œç›´æ¥è§£å‘ç°å¾—åˆ°æ— æ„ä¹‰å­—ç¬¦ä¸²<br>å†ä»”ç»†çœ‹æ±‡ç¼– å‘ç°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00007F</span>F7A8AC5AC3  call        std::basic_string&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,std::allocator&lt;<span class="type">char</span>&gt; &gt;::<span class="built_in">length</span> (<span class="number">07F</span>F7A8AC122Bh)  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AC8  mov         rcx,qword ptr [rbp+<span class="number">1F</span>8h]  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5ACF  cmp         rcx,rax  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AD2  jae         main+<span class="number">1B</span>2h (<span class="number">07F</span>F7A8AC5C02h)  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AD8  mov         eax,dword ptr [rbp+<span class="number">64</span>h]  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5ADB  <span class="keyword">and</span>         eax,<span class="number">1</span>  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5ADE  cmp         eax,<span class="number">1</span>  </span><br><span class="line"><span class="number">00007F</span>F7A8AC5AE1  jne         main+<span class="number">126</span>h (<span class="number">07F</span>F7A8AC5B76h)  </span><br></pre></td></tr></table></figure>

<p>è¿™æ®µæœ‰ä¸ª eax&amp;1&#x3D;&#x3D;1çš„åˆ¤æ–­ å¹¶æœ‰æ¡ä»¶è·³è½¬<br>ç»“åˆä¸Šä¸‹çŸ¥é“è¿™é‡Œæ˜¯å¯¹å¾ªç¯æ¬¡æ•°è¿›è¡Œäº†å¥‡å¶check<br>æ‰€ä»¥å¥‡æ•°æ—¶æ‰xor 0x42 (jne)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">enc = <span class="string">&quot;662e61257b26301d7972751d6b2c6f355f3a38742d74341d61776d7d7d&quot;</span></span><br><span class="line">enc = [<span class="built_in">int</span>(enc[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>],<span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)//<span class="number">2</span>)]</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x42</span>,<span class="number">0x42</span>+<span class="number">1</span>):</span><br><span class="line">    flag = <span class="string">&quot;&quot;</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> enc:</span><br><span class="line">        <span class="keyword">if</span>(i&amp;<span class="number">1</span>):</span><br><span class="line">            flag += <span class="built_in">chr</span>((x^c)&amp;<span class="number">0xff</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag += <span class="built_in">chr</span>(c)</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p><strong>flag{d0_y0u_know_x86-64_a5m?}</strong></p>
<h2 id="Baby-Obfuscation"><a href="#Baby-Obfuscation" class="headerlink" title="Baby Obfuscation"></a>Baby Obfuscation</h2><p>èŠ±é‡Œèƒ¡å“¨â€¦</p>
<p>å¯¹mainè¿›è¡Œè®¡ç®— è¿˜åŸæµç¨‹</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  ...</span><br><span class="line">  _main(argc, argv, envp);</span><br><span class="line">  <span class="built_in">memset</span>(v30, <span class="number">0</span>, <span class="number">4004</span>);</span><br><span class="line">  <span class="built_in">memset</span>(v28, <span class="number">0</span>, <span class="number">260</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">64</span>; ++i )</span><br><span class="line">    v28[i] = i + <span class="number">1</span>;</span><br><span class="line">  v31[<span class="number">0</span>] = <span class="number">2</span>;</span><br><span class="line">  v31[<span class="number">1</span>] = <span class="number">3</span>;</span><br><span class="line">  v31[<span class="number">2</span>] = <span class="number">4</span>;</span><br><span class="line">  v31[<span class="number">3</span>] = <span class="number">5</span>;</span><br><span class="line">  v30[<span class="number">1004</span>] = <span class="number">2</span>;</span><br><span class="line">  v30[<span class="number">1005</span>] = <span class="number">3</span>;</span><br><span class="line">  v30[<span class="number">1006</span>] = <span class="number">4</span>;</span><br><span class="line">  v30[<span class="number">1007</span>] = <span class="number">5</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;WHERE IS MY KEY!?&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%32s&quot;</span>, INPUT);</span><br><span class="line">  v32 = <span class="built_in">strlen</span>(INPUT);</span><br><span class="line">  v3 = <span class="built_in">GCD</span>(v28[j], v28[j]);</span><br><span class="line">  <span class="keyword">for</span> ( j = v3 / v28[j]; j &lt;= v32; ++j )        <span class="comment">// j=1~v32</span></span><br><span class="line">  &#123;</span><br><span class="line">    v4 = (v28[j] + v28[j + <span class="number">1</span>]) * (v28[j] + v28[j + <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span> ( v4 &gt;= (<span class="type">int</span>)(<span class="built_in">QPOW</span>(<span class="number">2</span>, <span class="number">2</span>) * v28[j] * v28[j + <span class="number">1</span>]) )<span class="comment">// æ°¸çœŸ</span></span><br><span class="line">    &#123;</span><br><span class="line">      v5 = ~INPUT[(<span class="type">int</span>)<span class="built_in">SUB_XX</span>(j, <span class="number">1</span>)];</span><br><span class="line">      v6 = <span class="built_in">SUB_XX</span>(j, <span class="number">1</span>);</span><br><span class="line">      v30[j] = ~(v5 + v31[v6 % (<span class="type">int</span>)<span class="built_in">QPOW</span>(<span class="number">2</span>, <span class="number">2</span>)]);</span><br><span class="line">    &#125;</span><br><span class="line">    v7 = <span class="built_in">GCD</span>(v28[j], v28[j + <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span> ( v7 &gt; (<span class="type">int</span>)<span class="built_in">GCD</span>(v28[j + <span class="number">1</span>], ~(~v28[j + <span class="number">1</span>] + v28[j])) )<span class="comment">// 1&gt;1 æ°¸å‡</span></span><br><span class="line">    &#123;</span><br><span class="line">      v8 = v30[j];</span><br><span class="line">      v9 = <span class="built_in">SUB_XX</span>(j, <span class="number">1</span>);</span><br><span class="line">      v30[j] = ~(~v8 + v28[v9 % (<span class="type">int</span>)<span class="built_in">QPOW</span>(<span class="number">2</span>, <span class="number">2</span>)]) * v8;</span><br><span class="line">    &#125;</span><br><span class="line">    v10 = v28[j + <span class="number">1</span>];</span><br><span class="line">    v11 = <span class="built_in">QPOW</span>(<span class="number">2</span>, <span class="number">1</span>) * v10;</span><br><span class="line">    v12 = v28[j];</span><br><span class="line">    v13 = <span class="built_in">QPOW</span>(<span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line">    v14 = <span class="built_in">GCD</span>(v12 * v13, v11);                  <span class="comment">// v14=2</span></span><br><span class="line">    v15 = <span class="built_in">QPOW</span>(<span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v14 == v15 * (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">GCD</span>(v28[j], v28[j + <span class="number">1</span>]) )<span class="comment">// v14==v15 æ°¸çœŸ</span></span><br><span class="line">    &#123;</span><br><span class="line">      v16 = <span class="built_in">SUB_XX</span>(j, <span class="number">1</span>);</span><br><span class="line">      v30[j] ^= v31[v16 % (<span class="type">int</span>)<span class="built_in">QPOW</span>(<span class="number">2</span>, <span class="number">2</span>)];</span><br><span class="line">    &#125;</span><br><span class="line">    v17 = <span class="built_in">QPOW</span>(n_3, v28[j]);                    </span><br><span class="line">    v18 = v17 &lt; v28[j] + <span class="number">1</span>;                     <span class="comment">// v18=0</span></span><br><span class="line">    v19 = <span class="built_in">QPOW</span>(<span class="number">2</span>, <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)<span class="built_in">F0X3</span>(v19 &gt;= j, v18) ) <span class="comment">// v19&gt;=j : 1  F3(1,0) æœ€å0</span></span><br><span class="line">    &#123;</span><br><span class="line">      v20 = ~INPUT[(<span class="type">int</span>)<span class="built_in">SUB_XX</span>(j, <span class="number">1</span>)];</span><br><span class="line">      v21 = <span class="built_in">SUB_XX</span>(j, <span class="number">1</span>);</span><br><span class="line">      v30[j] ^= ~(v20 + v31[v21 % (<span class="type">int</span>)<span class="built_in">QPOW</span>(<span class="number">2</span>, <span class="number">2</span>)]);</span><br><span class="line">    &#125;</span><br><span class="line">    v22 = <span class="built_in">QPOW</span>(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">    v23 = <span class="built_in">GCD</span>(v28[j], v28[j]);</span><br><span class="line">    v30[j] *= v22 + (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">QPOW</span>(<span class="number">2</span>, v23 / v28[j]);<span class="comment">// v30[j]*=10</span></span><br><span class="line">  &#125;</span><br><span class="line">  v24 = <span class="built_in">QPOW</span>(<span class="number">2</span>, <span class="number">4</span>);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">SUB_XX</span>(v24, <span class="number">1</span>) != v32 )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_23;</span><br><span class="line">  v25 = <span class="built_in">GCD</span>(v28[k], v28[k]);</span><br><span class="line">  <span class="keyword">for</span> ( k = v25 / v28[k]; k &lt;= v32; ++k )       <span class="comment">// k=1~v32</span></span><br><span class="line">  &#123;</span><br><span class="line">    v26 = v30[k];</span><br><span class="line">    <span class="keyword">if</span> ( v26 == (<span class="type">int</span>)<span class="built_in">SUB_XX</span>(A0X6[k], <span class="number">1</span>) / <span class="number">10</span> )</span><br><span class="line">      ++V0X2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( V0X2 == v32 )                            <span class="comment">// len=15 16</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\nPASS&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">LABEL_23:</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\nDENIED&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åæ³¨æ„ä¸€ä¸ªç‚¹ é•¿åº¦åº”è¯¥ä¸º15 å› ä¸ºä»–jä»1å¼€å§‹çš„ æ‰€ä»¥åé¢æå–çš„encä¹Ÿè¦ä»1ç´¢å¼•å¼€å§‹<br>é€†å›å»å³å¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">780</span>,<span class="number">780</span>,<span class="number">850</span>,<span class="number">590</span>,<span class="number">800</span>,<span class="number">640</span>,<span class="number">1150</span>,<span class="number">460</span>,<span class="number">980</span>,<span class="number">960</span>,<span class="number">1170</span>,<span class="number">530</span>,<span class="number">970</span>,<span class="number">1080</span>,<span class="number">1250</span>]</span><br><span class="line">enc = [x//<span class="number">10</span> <span class="keyword">for</span> x <span class="keyword">in</span> enc]</span><br><span class="line">key = [<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">    x = enc[j]</span><br><span class="line">    x ^= key[j%<span class="number">4</span>]</span><br><span class="line">    x = (~x)&amp;<span class="number">0xff</span></span><br><span class="line">    x -= key[j%<span class="number">4</span>]</span><br><span class="line">    x &amp;= <span class="number">0xff</span></span><br><span class="line">    x = (~x)&amp;<span class="number">0xff</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(x),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="comment"># pass</span></span><br></pre></td></tr></table></figure>

<p><strong>NPUCTF{0bfu5er}</strong></p>
<h2 id="èŠœæ¹–ğŸ›«"><a href="#èŠœæ¹–ğŸ›«" class="headerlink" title="èŠœæ¹–ğŸ›«"></a>èŠœæ¹–ğŸ›«</h2><p>çœŸæœäº†â€¦<br>æ²¡æœ‰ä»»ä½•è¾“å…¥è¿è¡Œä¼šå¾—åˆ°ä¸€é¦–æ­Œè¯â€¦<br>ç¨‹åºä¸­å¯ä»¥æ‰¾åˆ°base64çš„è¡¨ ä¹Ÿèƒ½çœ‹å‡ºå¯¹ä¸€äº›è¿›è¡Œäº†base64decode è¿›è€Œå¾—åˆ°è¿™ä¸€ä¸²ä¸­æ–‡<br>å®åœ¨æƒ³ä¸åˆ°æ˜¯base64éšå†™<br>å¥½å§ çŸ¥é“è¿™ç‚¹åæƒ³åŠæ³•æŠŠbase64decodeå‰çš„base64ä¸²æå–å‡ºæ¥<br>ç¨‹åºå…³é”®ä»£ç :</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">34</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; A1[i]; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      v3 = A2[<span class="number">42</span> * i + j];</span><br><span class="line">      v2 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">7</span>; ++k )</span><br><span class="line">        v2 = F1((v3 &gt;&gt; (<span class="number">7</span> - k)) &amp; <span class="number">1</span>, (<span class="number">97</span> &gt;&gt; (<span class="number">7</span> - k)) &amp; <span class="number">1</span>) ^ (<span class="number">2</span> * v2);</span><br><span class="line">      <span class="built_in">std</span>::<span class="built_in">string</span>::operator+=((__int64)&amp;A3 + <span class="number">32</span> * i, v2);</span><br><span class="line">    &#125;</span><br><span class="line">    F2((__int64)v7, (__int64)&amp;A3 + <span class="number">32</span> * i);</span><br><span class="line">    v0 = <span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="type">char</span>&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, v7);</span><br><span class="line">    <span class="built_in">std</span>::ostream::operator&lt;&lt;(v0, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="type">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(v7);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>å°±åœ¨è¿™å¥:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">F2</span>((__int64)v7, (__int64)&amp;A3 + <span class="number">32</span> * i);</span><br></pre></td></tr></table></figure>
<p>ä¸‹æ–­ç‚¹ å¯ä»¥çœ‹åˆ°A3çš„åœ°å€ æˆ‘çš„å¤§æ¦‚åœ¨ 5583D5E4DFHå·¦å³<br>è¿™åœ°å€åœ¨å †ä¸Š IDAå†…å­˜ä¸­ç¿»ç¿» æ‰¾åˆ°<br><img src="https://s2.loli.net/2024/01/04/5DfGocJ3RINlFEs.png" alt="img"></p>
<p>æˆ‘åªèƒ½è¯´nb<br>å¾—åˆ° 55y85YmN6YeN5aSN55qE6aOO5pmvLG&#x3D;&#x3D;<br>ç±»ä¼¼çš„å¯ä»¥æ‰‹åŠ¨æŠŠæ‰€æœ‰çš„æ”¶é›†å®Œ<br>æœ€åå¾—åˆ°:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;55y85YmN6YeN5aSN55qE6aOO5pmvLG==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5riQ5riQ5qih57OK5LqG57qm5a6aLO==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5pif56m65LiL5rWB5rWq55qE5L2gLH==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5LuN54S256eY5a+G55qE6Led56a7LA==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5rip5bqm5raI5aSx55qE556s6Ze0LH==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5peg5rOV6Kem5pG455qE5piO5aSpLF==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5rKh5pyJ5byV5Yqb55qE5LiW55WMLG==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5rKh5pyJ6ISa5Y2w55qE5YWJ5bm0LD==&quot;</span>,</span><br><span class="line"><span class="string">&quot;6L+Y5Zyo562J552A5L2g5Ye6546wLH==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5pel5pel5aSc5aSc6Ieq6L2s55qE6KGM5pifLE==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5Yiw5aSE6YGu5ruh5Yir5Lq655qE6IOM5b2xLG==&quot;</span>,</span><br><span class="line"><span class="string">&quot;6K6p6aOO5ZC55pWj5re35Lmx55qE5ZG85ZC4LG==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5b+r5b+r5riF6YaSfn==&quot;</span>,</span><br><span class="line"><span class="string">&quot;6Z2Z6Z2Z54Wn5Lqu5Y6f5p2l55qE6Ieq5bexLL==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5aSp56m65rSS5ruh5b+954S255qE5YWJ5piOLE==&quot;</span>,</span><br><span class="line"><span class="string">&quot;55y85Lit5Y+q6KaB57ua54OC55qE5aSp6ZmFLG==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5YaN6aOe6KGMIW==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5oiR5YuH5pWi5Zyw5oqs6LW35aS0LM==&quot;</span>,</span><br><span class="line"><span class="string">&quot;55yL552A6Iyr6Iyr55qE5a6H5a6ZLH==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5aSa5bCR5pyq55+l55qE5pif55CDLJ==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5pyJ5rKh5pyJ6YCa5ZCR5pyq5p2l6Lev5Y+jLD==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5Lqy54ix55qE5LyZ5Ly0LB==&quot;</span>,</span><br><span class="line"><span class="string">&quot;6K6p5oiR5Lus5LiA6LW354K554eDLG==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5YuH5rCU5ZKM5L+h5b+1LO==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5Zyo6YGl6L+c55qE5aSp6L65LG==&quot;</span>,</span><br><span class="line"><span class="string">&quot;6ZO25rKz6L6557yYLH==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5pyJ5LiA54mH56We5aWH55qE5b2p6Jm55rW3LC==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5ZKM5oiR5LiA6LW35YaS6ZmpLB==&quot;</span>,</span><br><span class="line"><span class="string">&quot;6aOe5ZCR5Y+m5LiA5Liq5LiW55WMLC==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5Zyo6YGl6L+c55qE5aSp6L65LB==&quot;</span>,</span><br><span class="line"><span class="string">&quot;6ZO25rKz6L6557yYLC==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5pyJ5LiA54mH56We5aWH55qE5b2p6Jm55rW3LB==&quot;</span>,</span><br><span class="line"><span class="string">&quot;5ZKM5oiR5LiA6LW35YaS6ZmpLH==&quot;</span>,</span><br><span class="line"><span class="string">&quot;6aOe5ZCR5Y+m5LiA5Liq5LiW55WMLN==&quot;</span>,</span><br><span class="line"><span class="string">&quot;c3VwZXIgbWFnaWMgd29ybGR+fg==&quot;</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åç›´æ¥ä¸ŠMISC base64éšå†™è„šæœ¬:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">path = <span class="string">r&#x27;base.txt&#x27;</span></span><br><span class="line">file = <span class="built_in">open</span>(path)</span><br><span class="line">a = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">aaa = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    text = file.readline()  <span class="comment"># åªè¯»å–ä¸€è¡Œå†…å®¹</span></span><br><span class="line">    <span class="comment"># åˆ¤æ–­æ˜¯å¦è¯»å–åˆ°å†…å®¹</span></span><br><span class="line">    text = text.replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    text = text.replace(<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">    text = text.replace(<span class="string">&#x27;,&#x27;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> text:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> text.count(<span class="string">&#x27;=&#x27;</span>) == <span class="number">1</span>:</span><br><span class="line">        aaa = aaa + \</span><br><span class="line">            <span class="built_in">str</span>(<span class="string">&#x27;&#123;:02b&#125;&#x27;</span>.<span class="built_in">format</span>((a.find(text[<span class="built_in">len</span>(text)-<span class="number">2</span>])) % <span class="number">4</span>))</span><br><span class="line">    <span class="keyword">if</span> text.count(<span class="string">&#x27;=&#x27;</span>) == <span class="number">2</span>:</span><br><span class="line">        aaa = aaa + \</span><br><span class="line">            <span class="built_in">str</span>(<span class="string">&#x27;&#123;:04b&#125;&#x27;</span>.<span class="built_in">format</span>((a.find(text[<span class="built_in">len</span>(text)-<span class="number">3</span>])) % <span class="number">16</span>))</span><br><span class="line">file.close()</span><br><span class="line">t = <span class="string">&quot;&quot;</span></span><br><span class="line">ttt = <span class="built_in">len</span>(aaa)</span><br><span class="line">ttt = ttt//<span class="number">8</span>*<span class="number">8</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,ttt,<span class="number">8</span>):</span><br><span class="line">    t = t + <span class="built_in">chr</span>(<span class="built_in">int</span>( aaa[i:i+<span class="number">8</span>],<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"><span class="comment"># npuctf&#123;Fly1ng!!!&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>npuctf{Fly1ng!!!}</strong></p>
<hr>
<hr>
<p>reverseé‡Œé¢æ··miscæ˜¯çœŸéš¾ç»·â€¦<br>è¿™é¢˜å”¯ä¸€ä½œç”¨å°±æ˜¯ç»ƒä¹ äº†åœ¨å †ä¸Šæ‰¾æ•°æ®â€¦</p>
<h1 id="å®‰æ´µæ¯2019"><a href="#å®‰æ´µæ¯2019" class="headerlink" title="å®‰æ´µæ¯2019"></a>å®‰æ´µæ¯2019</h1><h2 id="crackMe"><a href="#crackMe" class="headerlink" title="crackMe"></a>crackMe</h2><p>æŒºå¥½çš„é¢˜<br>è€ƒç‚¹: å¼‚å¸¸å¤„ç†+base64å˜è¡¨(çœ‹ä½œ2æ¬¡å˜è¡¨)+SM4ç®—æ³•</p>
<p>main:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __cdecl __noreturn <span class="title">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _BYTE v3[<span class="number">6</span>]; <span class="comment">// [esp-4h] [ebp-D0h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;please Input the flag:\n&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf_s</span>(<span class="string">&quot;%s&quot;</span>, &amp;INPUT);</span><br><span class="line">  <span class="built_in">MessageBoxW</span>(<span class="number">0</span>, <span class="string">L&quot;Exception&quot;</span>, <span class="string">L&quot;Warning&quot;</span>, <span class="number">0</span>);</span><br><span class="line">  *(_DWORD *)v3 = sub_50100F;</span><br><span class="line">  MEMORY[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">j_FINAL_CHECK</span>(*(<span class="type">int</span> *)&amp;v3[<span class="number">2</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå¾ˆå®¹æ˜“æƒ³åˆ°è§¦å‘å¼‚å¸¸ è¿›è¡ŒExceptionFilterå’Œå¤„ç†<br>ä½†æ˜¯ç›´æ¥æ‰¾æ‰¾ä¸ç€</p>
<p>æ³¨æ„åˆ°è¿è¡Œexeä¼šå¼¹å‡º hook å¼¹çª— æç¤ºæˆ‘ä»¬å¯èƒ½è¿›è¡Œäº†hookæ“ä½œ<br>åŠ¨è°ƒorçç¿»&#x2F;æŸ¥çœ‹äº¤å‰å¼•ç”¨<br>æ‰¾åˆ°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __stdcall <span class="title">CHANGE_BASE64_TABLE_AND_ADD_EXCEPTION_HANDLER</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2, <span class="type">int</span> a3, <span class="type">int</span> a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">size_t</span> i; <span class="comment">// [esp+D8h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">j_strlen</span>(BASE64_table_41A080); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( BASE64_table_41A080[i] &lt;= <span class="number">122</span> &amp;&amp; BASE64_table_41A080[i] &gt;= <span class="number">97</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      BASE64_table_41A080[i] -= <span class="number">32</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( BASE64_table_41A080[i] &lt;= <span class="number">90</span> &amp;&amp; BASE64_table_41A080[i] &gt;= <span class="number">65</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      BASE64_table_41A080[i] += <span class="number">32</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">MessageBoxA</span>(<span class="number">0</span>, <span class="string">&quot;hooked&quot;</span>, <span class="string">&quot;successed&quot;</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">AddVectoredExceptionHandler</span>(<span class="number">0</span>, Handler);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå¯¹base64çš„tableè¿›è¡Œäº†å¤§å°å†™äº’æ¢ åŒæ—¶å‡ºç°äº†hookå­—æ ·<br>åé¢è·Ÿäº†ä¸ªExceptionHandler<br>è¿™æ ·æˆ‘ä»¬å‰é¢çš„åˆ†æå°±èƒ½è¯´å¾—é€šäº†<br>æŸ¥çœ‹handler</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __stdcall <span class="title">Handler_0</span><span class="params">(_DWORD **a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> SM4_KEY[<span class="number">20</span>]; <span class="comment">// [esp+D0h] [ebp-18h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( **a1 == <span class="number">0xC0000005</span> )                     <span class="comment">// å¼‚å¸¸</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">qmemcpy</span>(SM4_KEY, <span class="string">&quot;where_are_u_now?&quot;</span>, <span class="number">16</span>);</span><br><span class="line">    <span class="built_in">sub_501172</span>((<span class="type">int</span>)&amp;unk_50A218, (<span class="type">int</span>)SM4_KEY);</span><br><span class="line">    <span class="built_in">SetUnhandledExceptionFilter</span>(TopLevelExceptionFilter);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„0xC0000005å°±æ˜¯è®¿é—®éæ³•å†…å­˜çš„å¼‚å¸¸<br>è¿™é‡Œè·Ÿè¿› sub_501172</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span> __cdecl <span class="title">SM4233</span><span class="params">(<span class="type">int</span> a1, <span class="type">unsigned</span> <span class="type">int</span> *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// [esp+D0h] [ebp-B8h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// [esp+DCh] [ebp-ACh]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [esp+E0h] [ebp-A8h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [esp+E4h] [ebp-A4h]</span></span><br><span class="line">  <span class="type">int</span> v7[<span class="number">35</span>]; <span class="comment">// [esp+E8h] [ebp-A0h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v8; <span class="comment">// [esp+174h] [ebp-14h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v9; <span class="comment">// [esp+178h] [ebp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v10; <span class="comment">// [esp+17Ch] [ebp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v11; <span class="comment">// [esp+180h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="number">0</span>;                                       <span class="comment">// è¿˜æ˜¯SM4å§~</span></span><br><span class="line">  v8 = _byteswap_ulong(*a2);</span><br><span class="line">  v9 = _byteswap_ulong(a2[<span class="number">1</span>]);</span><br><span class="line">  v10 = _byteswap_ulong(a2[<span class="number">2</span>]);</span><br><span class="line">  v11 = _byteswap_ulong(a2[<span class="number">3</span>]);</span><br><span class="line">  v4 = v8 ^ <span class="number">0xA3B1BAC6</span>;</span><br><span class="line">  v5 = dword_507A68[<span class="number">1</span>] ^ v9;</span><br><span class="line">  v6 = dword_507A68[<span class="number">2</span>] ^ v10;</span><br><span class="line">  result = <span class="number">12</span>;</span><br><span class="line">  v7[<span class="number">0</span>] = dword_507A68[<span class="number">3</span>] ^ v11;</span><br><span class="line">  <span class="keyword">while</span> ( v3 &lt; <span class="number">0x20</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v7[v3 + <span class="number">1</span>] = *(&amp;v4 + v3) ^ <span class="built_in">sub_5014E0</span>(dword_507A78[v3] ^ v7[v3] ^ v7[v3 - <span class="number">1</span>] ^ *(&amp;v5 + v3));</span><br><span class="line">    *(_DWORD *)(a1 + <span class="number">4</span> * v3) = v7[v3 + <span class="number">1</span>];</span><br><span class="line">    result = ++v3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¾ˆå®¹æ˜“è¯†åˆ«å‡ºæ˜¯SM4åŠ å¯†ç®—æ³•çš„ç‰¹å¾</p>
<p>æ³¨æ„åˆ°è¿˜æœ‰ä¸ª TopLevelExceptionFilter</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">sub_502C30</span><span class="params">(_DWORD *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> v2; <span class="comment">// [esp+D3h] [ebp-11h]</span></span><br><span class="line">  <span class="type">size_t</span> i; <span class="comment">// [esp+DCh] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  result = (<span class="type">int</span>)a1;</span><br><span class="line">  <span class="keyword">if</span> ( *(_DWORD *)*a1 == <span class="number">0xC0000005</span> )           <span class="comment">// å¼‚å¸¸</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">j_strlen</span>(Str2); i += <span class="number">2</span> )   <span class="comment">// ç›¸é‚»swap</span></span><br><span class="line">    &#123;</span><br><span class="line">      v2 = Str2[i];</span><br><span class="line">      Str2[i] = Str2[i + <span class="number">1</span>];</span><br><span class="line">      Str2[i + <span class="number">1</span>] = v2;</span><br><span class="line">    &#125;</span><br><span class="line">    Str1 = <span class="built_in">j_BASE64ENCODE</span>(byte_50A180);</span><br><span class="line">    *(_DWORD *)(a1[<span class="number">1</span>] + <span class="number">176</span>) = *(_DWORD *)(*a1 + <span class="number">20</span>);</span><br><span class="line">    *(_DWORD *)(a1[<span class="number">1</span>] + <span class="number">164</span>) = *(_DWORD *)(*a1 + <span class="number">24</span>);</span><br><span class="line">    *(_DWORD *)(a1[<span class="number">1</span>] + <span class="number">172</span>) = *(_DWORD *)(*a1 + <span class="number">28</span>);</span><br><span class="line">    *(_DWORD *)(a1[<span class="number">1</span>] + <span class="number">168</span>) = *(_DWORD *)(*a1 + <span class="number">32</span>);</span><br><span class="line">    *(_DWORD *)(a1[<span class="number">1</span>] + <span class="number">156</span>) = *(_DWORD *)(*a1 + <span class="number">36</span>);</span><br><span class="line">    *(_DWORD *)(a1[<span class="number">1</span>] + <span class="number">160</span>) = *(_DWORD *)(*a1 + <span class="number">40</span>);</span><br><span class="line">    *(_DWORD *)(a1[<span class="number">1</span>] + <span class="number">184</span>) = j_FINAL_CHECK;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå¯¹Str2è¿›è¡Œäº†ä¸¤ä¸ªä¸€ç»„çš„ç›¸é‚»swap<br>åŒæ—¶å¯¹byte_50A180è¿›è¡Œäº†base64åŠ å¯†<br>æŸ¥çœ‹base64åŠ å¯†å‡½æ•°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_BYTE *__cdecl <span class="title">BASE64ENCODE</span><span class="params">(<span class="type">char</span> *Str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [esp+E4h] [ebp-5Ch]</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [esp+F0h] [ebp-50h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [esp+FCh] [ebp-44h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [esp+108h] [ebp-38h]</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> i; <span class="comment">// [esp+114h] [ebp-2Ch]</span></span><br><span class="line">  _BYTE *v7; <span class="comment">// [esp+120h] [ebp-20h]</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> v8; <span class="comment">// [esp+12Ch] [ebp-14h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [esp+138h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v8 = <span class="built_in">j_strlen</span>(Str);</span><br><span class="line">  <span class="keyword">if</span> ( v8 % <span class="number">3</span> )</span><br><span class="line">    v9 = <span class="number">4</span> * (v8 / <span class="number">3</span>) + <span class="number">4</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v9 = <span class="number">4</span> * (v8 / <span class="number">3</span>);</span><br><span class="line">  v7 = <span class="built_in">malloc</span>(__CFADD__(v9, <span class="number">1</span>) ? <span class="number">-1</span> : v9 + <span class="number">1</span>);</span><br><span class="line">  v7[v9] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v8; i += <span class="number">3</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">3</span>; ++j )</span><br><span class="line">      v3 |= (<span class="type">unsigned</span> __int8)Str[j + i] &lt;&lt; (<span class="number">8</span> * (<span class="number">2</span> - j));</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( k &gt;= <span class="number">4</span> - (i + <span class="number">3</span> - v8) &amp;&amp; i + <span class="number">3</span> &gt; v8 )</span><br><span class="line">        v7[v5] = <span class="string">&#x27;!&#x27;</span>;                           <span class="comment">// æŠŠ&quot;=&quot;å¡«å……æ”¹ä¸º&quot;!&quot;äº†</span></span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        v7[v5] = BASE64_table_41A080[<span class="built_in">sub_5010FF</span>((v3 &gt;&gt; (<span class="number">6</span> * (<span class="number">3</span> - k))) &amp; <span class="number">0x3F</span>)];<span class="comment">// è¿™é‡Œå˜äº†ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</span></span><br><span class="line">                                                <span class="comment">// (a1 + 24) % 64;</span></span><br><span class="line">                                                <span class="comment">// æ‰€ä»¥ç­‰ä»·äºå†æŠŠbase64è¡¨ç§»åŠ¨24ä½...</span></span><br><span class="line">      ++v5;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v7;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ç¬¬ä¸€éçœ‹ä»¥ä¸ºå®ƒåªæ˜¯æŠŠå¡«å……å­—ç¬¦æ”¹äº†<br>åé¢ä¸€ç›´è§£çš„ä¸å¯¹åŠ² å†ç»†çœ‹æ‰å‘ç°è¿™ä¸ªsub_5010FFï¼</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> (a1 + <span class="number">24</span>) % <span class="number">64</span>;</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥ç›¸å½“äºæŠŠbase64çš„tableæ•´ä½“å‘å·¦ç§»äº†24ä½<br>æ‰€ä»¥å˜è¡¨åº”è¯¥ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/abcdefghijklmnopqrstuvwx</span><br></pre></td></tr></table></figure>

<p>å›åˆ°sub_502C30<br>base64åŠ å¯†å®Œåæœ‰ä¸ªcheck</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> __noreturn <span class="title">FINAL_CHECK</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">j_strcmp</span>(Str1, Str2) )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;right\n&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;wrong\n&quot;</span>);</span><br><span class="line">  <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°†base64åŠ å¯†çš„Str1å’Œå˜æ¢åçš„Str2æ¯”å¯¹</p>
<p>å›æº¯ä¸€ä¸‹ çœ‹è¿™é‡Œ:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Str1 = <span class="built_in">j_BASE64ENCODE</span>(byte_50A180);</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹byte_50A180çš„äº¤å‰å¼•ç”¨</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">sub_502EA0</span><span class="params">(_DWORD *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( *a1 == <span class="number">0xC0000005</span> )                      <span class="comment">// å¼‚å¸¸å¤„ç†</span></span><br><span class="line">    <span class="built_in">sub_501131</span>((<span class="type">int</span>)&amp;unk_50A218, <span class="number">1</span>, <span class="number">16</span>, (<span class="type">int</span>)&amp;INPUT, (<span class="type">int</span>)byte_50A180);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œè·Ÿè¿›å»å‘ç°æ˜¯SM4çš„ä¸»ä½“éƒ¨åˆ† å‰é¢çš„é‚£ä¸ªå…·æœ‰SM4ç‰¹å¾çš„åº”è¯¥æ˜¯initå‡½æ•°<br>é‚£ä¹ˆæµç¨‹å°±æ¸…æ¥šäº†<br>è¾“å…¥-&gt;hook(å˜è¡¨+è®¾ç½®å¼‚å¸¸å¤„ç†)-&gt;è§¦å‘å¼‚å¸¸-&gt;SM4-&gt;é­”æ”¹base64-&gt;check<br>é‚£ä¹ˆæˆ‘ä»¬æŠŠStr2 swap   base64table å¤„ç†å¥½<br>é€†å›å»è§£å°±å¯ä»¥äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Str2: U1ATIOpkOyWSvGm/YOYFR4==</span><br><span class="line">table: yzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/abcdefghijklmnopqrstuvwx</span><br></pre></td></tr></table></figure>

<p>base64é€†å›å»å¾—åˆ°:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">59d095290df2400614f48d276906874e</span><br></pre></td></tr></table></figure>

<p>SM4 ä»¥where_are_u_now?ä¸ºkeyé€†å›å» å¾—åˆ°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SM4foRExcepioN?!</span><br></pre></td></tr></table></figure>
<p><strong>flag{SM4foRExcepioN?!}</strong></p>
<hr>
<hr>
<p>æ€»ç»“ æ¯ä¸ªå‡½æ•°éƒ½ç‚¹ä¸€ç‚¹â€¦ <del>æ€ä¹ˆå°±æŠŠé‚£ä¸ªç§»24ä½çš„å‡½æ•°çœ‹æ¼äº†å‘¢â€¦</del></p>
<h2 id="Game"><a href="#Game" class="headerlink" title="Game"></a>Game</h2><p>ç”¨æ’ä»¶å»é™¤ollvmæ··æ·† æ§åˆ¶æµå¹³å¦åŒ–å<br>main</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v4; <span class="comment">// [rsp+30h] [rbp-50h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+38h] [rbp-48h]</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">56</span>]; <span class="comment">// [rsp+40h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [rsp+78h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;input your flag:&quot;</span>);</span><br><span class="line">  <span class="built_in">gets</span>(v6, argv);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">general_inspection</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])sudoku) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    <span class="built_in">check</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])sudoku);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v5 = <span class="built_in">blank_num</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])sudoku);</span><br><span class="line">    v4 = <span class="built_in">mem_alloc</span>(v5);</span><br><span class="line">    <span class="built_in">trace</span>(sudoku, v4, v5);</span><br><span class="line">    <span class="built_in">check</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])sudoku);</span><br><span class="line">    <span class="built_in">check1</span>(v6);                                 <span class="comment">// å¯¹è¾“å…¥ä½œäº†å˜æ¢</span></span><br><span class="line">    <span class="built_in">check3</span>(v6);                                 <span class="comment">// è§£ä¸€ä¸ªæ•°ç‹¬</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®check3é‡Œé¢çš„è§£å‡ºæ•°ç‹¬å¾—åˆ°æˆ‘ä»¬å˜æ¢åçš„è¾“å…¥ä¸º</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4693641762894685722843556137219876255986</span></span><br></pre></td></tr></table></figure>

<p>çœ‹check1</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">check1</span><span class="params">(<span class="type">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> v2; <span class="comment">// [rsp+6Eh] [rbp-12h]</span></span><br><span class="line">  <span class="type">char</span> v3; <span class="comment">// [rsp+6Fh] [rbp-11h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+70h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+74h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+74h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+74h] [rbp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v5 = <span class="built_in">strlen</span>(a1) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(a1) &gt;&gt; <span class="number">1</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = a1[v5];</span><br><span class="line">    a1[v5] = a1[i];</span><br><span class="line">    a1[i] = v3;</span><br><span class="line">    ++v5;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(a1); j += <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = a1[j];</span><br><span class="line">    a1[j] = a1[j + <span class="number">1</span>];</span><br><span class="line">    a1[j + <span class="number">1</span>] = v2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; <span class="built_in">strlen</span>(a1); ++k )</span><br><span class="line">    a1[k] = -(a1[k] ^ <span class="number">0xF3</span>) - <span class="number">21</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è·Ÿç€é€†å›å»å°±å¥½</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&quot;4693641762894685722843556137219876255986&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(flag))</span><br><span class="line">flag = <span class="built_in">list</span>(flag)</span><br><span class="line">flag = [<span class="built_in">ord</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> flag]</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    flag[k] = -(flag[k]+<span class="number">21</span>)^<span class="number">0xf3</span></span><br><span class="line">    flag[k] &amp;= <span class="number">0xff</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(flag),<span class="number">2</span>):</span><br><span class="line">    tmp = flag[j]</span><br><span class="line">    flag[j] = flag[j+<span class="number">1</span>]</span><br><span class="line">    flag[j+<span class="number">1</span>] = tmp</span><br><span class="line">v5 = <span class="number">40</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    v5 -= <span class="number">1</span></span><br><span class="line">    v3 = flag[v5]</span><br><span class="line">    flag[v5] = flag[i]</span><br><span class="line">    flag[i] = v3</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># KDEEIFGKIJ@AFGEJAEF@FDKADFGIJFA@FDE@JG@J</span></span><br></pre></td></tr></table></figure>

<p><strong>flag{KDEEIFGKIJ@AFGEJAEF@FDKADFGIJFA@FDE@JG@J}</strong></p>
<h1 id="å®‰æ´µæ¯2021"><a href="#å®‰æ´µæ¯2021" class="headerlink" title="å®‰æ´µæ¯2021"></a>å®‰æ´µæ¯2021</h1><h2 id="sign-in"><a href="#sign-in" class="headerlink" title="sign_in"></a>sign_in</h2><p>IDAæ£é¼“åŠå¤© ä¸€å¤§å †æœªè¯†åˆ«çš„éº»çƒ¦æ­»äº†<br>ç›´æ¥odè·‘ä¸€è·‘ dumpå‡ºæ¥çœ‹ æ¸…æ™°å¤šäº†</p>
<p>æ ¹æ®å…³é”®å­—ç¬¦ä¸²æ‰¾åˆ°åŠ å¯†å‡½æ•°:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">sub_401D10</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _BYTE v1[<span class="number">125</span>]; <span class="comment">// [esp+4Ch] [ebp-140h] BYREF</span></span><br><span class="line">  __int16 v2; <span class="comment">// [esp+C9h] [ebp-C3h]</span></span><br><span class="line">  <span class="type">char</span> v3; <span class="comment">// [esp+CBh] [ebp-C1h]</span></span><br><span class="line">  <span class="type">int</span> v4[<span class="number">4</span>]; <span class="comment">// [esp+CCh] [ebp-C0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v5[<span class="number">32</span>]; <span class="comment">// [esp+DCh] [ebp-B0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">36</span>]; <span class="comment">// [esp+15Ch] [ebp-30h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [esp+180h] [ebp-Ch]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [esp+184h] [ebp-8h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+188h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v5, <span class="number">0</span>, <span class="built_in">sizeof</span>(v5));</span><br><span class="line">  v4[<span class="number">0</span>] = <span class="number">68</span>;</span><br><span class="line">  v4[<span class="number">1</span>] = <span class="number">48</span>;</span><br><span class="line">  v4[<span class="number">2</span>] = <span class="number">103</span>;</span><br><span class="line">  v4[<span class="number">3</span>] = <span class="number">51</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v1, <span class="number">0</span>, <span class="built_in">sizeof</span>(v1));</span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">sub_402200</span>(<span class="string">&quot;Now please input your flag:&quot;</span>);</span><br><span class="line">  <span class="built_in">sub_4023D0</span>(<span class="string">&quot;%s&quot;</span>, v6);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i )</span><br><span class="line">    v6[i] ^= v6[(i + <span class="number">1</span>) % <span class="number">32</span>];</span><br><span class="line">  i = <span class="number">0</span>;</span><br><span class="line">  j = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( i &lt; <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( j % <span class="number">6</span> &gt;= <span class="number">3</span> )</span><br><span class="line">      v1[<span class="number">32</span> * (<span class="number">3</span> - j % <span class="number">3</span>) + i] = v6[i];</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v1[<span class="number">32</span> * (j % <span class="number">3</span>) + i] = v6[i];</span><br><span class="line">    ++i;</span><br><span class="line">    ++j;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">32</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v1[<span class="number">32</span> * i + j] )</span><br><span class="line">        v5[v7++] = (<span class="type">unsigned</span> __int8)v1[<span class="number">32</span> * i + j];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sub_401055</span>(v5, v4, <span class="number">32</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">sub_40105F</span>(v5) )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sub_402200</span>(<span class="string">&quot;congratulations !!!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sub_402200</span>(<span class="string">&quot;sorry , you&#x27;re wrong&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>xxteaéƒ¨åˆ†:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_DWORD *__cdecl <span class="title">sub_401AE0</span><span class="params">(_DWORD *a1, <span class="type">int</span> a2, <span class="type">unsigned</span> <span class="type">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _DWORD *result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [esp+4Ch] [ebp-1Ch]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [esp+50h] [ebp-18h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [esp+54h] [ebp-14h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// [esp+58h] [ebp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v8; <span class="comment">// [esp+5Ch] [ebp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v9; <span class="comment">// [esp+60h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = dword_42CA44 + <span class="number">1144219440</span>;</span><br><span class="line">  v7 = <span class="number">0x34</span> / a3 + <span class="number">6</span>;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  v9 = a1[a3 - <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v8 += v5;</span><br><span class="line">    v6 = (v8 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; a3 - <span class="number">1</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[i] += ((v9 ^ *(_DWORD *)(a2 + <span class="number">4</span> * (v6 ^ i &amp; <span class="number">3</span>))) + (a1[i + <span class="number">1</span>] ^ v8)) ^ (((<span class="number">16</span> * v9) ^ (a1[i + <span class="number">1</span>] &gt;&gt; <span class="number">3</span>))</span><br><span class="line">                                                                               + ((<span class="number">4</span> * a1[i + <span class="number">1</span>]) ^ (v9 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">      v9 = a1[i];</span><br><span class="line">    &#125;</span><br><span class="line">    a1[a3 - <span class="number">1</span>] += ((v9 ^ *(_DWORD *)(a2 + <span class="number">4</span> * (v6 ^ i &amp; <span class="number">3</span>))) + (*a1 ^ v8)) ^ (((<span class="number">16</span> * v9) ^ (*a1 &gt;&gt; <span class="number">3</span>))</span><br><span class="line">                                                                            + ((<span class="number">4</span> * *a1) ^ (v9 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">    result = a1;</span><br><span class="line">    v9 = a1[a3 - <span class="number">1</span>];</span><br><span class="line">    --v7;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v7 );</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œdword_42CA44ä¸çŸ¥é“ ä½†æ˜¯æˆ‘ä»¬å¯ä»¥çˆ†ç ´<br>åˆ©ç”¨xxteaè§£å¯†åæ˜¯unsigned int8 æ¥çº¦æŸ çˆ†ç ´å¾—åˆ° 77<br>å†è§£ä¸€ä¸ªxor</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">60</span>,<span class="number">64</span>,<span class="number">43</span>,<span class="number">102</span>,<span class="number">111</span>,<span class="number">79</span>,<span class="number">92</span>,<span class="number">29</span>,<span class="number">66</span>,<span class="number">26</span>,<span class="number">43</span>,<span class="number">87</span>,<span class="number">54</span>,<span class="number">68</span>,<span class="number">51</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">107</span>,<span class="number">92</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">28</span>,<span class="number">92</span>,<span class="number">26</span>,<span class="number">43</span>,<span class="number">9</span>,<span class="number">50</span>,<span class="number">110</span>,<span class="number">21</span>,<span class="number">90</span>,<span class="number">44</span>,<span class="number">37</span>]</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line">v1 = [<span class="number">0</span>]*<span class="number">128</span></span><br><span class="line"><span class="keyword">while</span> i&lt;<span class="number">32</span>:</span><br><span class="line">    <span class="keyword">if</span> j%<span class="number">6</span>&gt;=<span class="number">3</span>:</span><br><span class="line">        v1[<span class="number">32</span>*(<span class="number">3</span>-(j%<span class="number">3</span>))+i] = i+<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        v1[<span class="number">32</span>*(j%<span class="number">3</span>)+i] = i+<span class="number">1</span></span><br><span class="line">    j += <span class="number">1</span></span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        <span class="keyword">if</span>(v1[<span class="number">32</span>*i+j]!=<span class="number">0</span>):</span><br><span class="line">            <span class="built_in">print</span>(v1[<span class="number">32</span>*i+j],end=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pos = [<span class="number">1</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">19</span>,<span class="number">25</span>,<span class="number">31</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">14</span>,<span class="number">18</span>,<span class="number">20</span>,<span class="number">24</span>,<span class="number">26</span>,<span class="number">30</span>,<span class="number">32</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">17</span>,<span class="number">21</span>,<span class="number">23</span>,<span class="number">27</span>,<span class="number">29</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">16</span>,<span class="number">22</span>,<span class="number">28</span>]</span><br><span class="line">flag = [<span class="number">0</span>]*<span class="number">32</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    flag[pos[i]-<span class="number">1</span>] = enc[i]</span><br><span class="line">flag[-<span class="number">1</span>] ^= flag[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    flag[i] ^= flag[i+<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(x),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>flag:<br><strong>Th4_1mp0rtant_th2n9_is_t0_le@rn!</strong></p>
<h1 id="MTCTF2021"><a href="#MTCTF2021" class="headerlink" title="MTCTF2021"></a>MTCTF2021</h1><h2 id="wow"><a href="#wow" class="headerlink" title="wow"></a>wow</h2><p>å¤¹æ‚ç€ä¸€ä¸ªå¤©å ‚ä¹‹é—¨ lazydumpå‡ºæ¥é™æ€åˆ†æ<br>ä¸€ä¸ªé­”æ”¹çš„xxtea ä¸»è¦æ˜¯roundsæ”¹ä¸ºäº†12 ç„¶ån&#x3D;9 è§£å°±å®Œäº†</p>
<h2 id="Superflat"><a href="#Superflat" class="headerlink" title="Superflat"></a>Superflat</h2><p>movæ··æ·†<br>å·¥å…·demovfuscatorä¸€ç›´ä¸€ç›´å®‰ä¸å¥½â€¦<br>è¿™é‡Œå­¦ä¹ ä½¿ç”¨pintoolæ¥è¿›è¡Œæ±‚è§£<br>å­¦ä¹ :<br><a target="_blank" rel="noopener" href="https://s0uthwood.github.io/post/all-solves-during-a-weekend/">s0uthwood</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/level5uiharu/p/16963907.html">pintool</a></p>
<p>è¿™é‡Œæœ‰ä¸ªå°å‘ 64ä½ubuntuéœ€è¦å®‰è£…å…¼å®¹32ä½çš„gccæ‰èƒ½make ia32â€¦</p>
<p>idaç¡¬çœ‹æ±‡ç¼– å¯ä»¥å‘ç°getcharå’Œputcharå­—æ ·<br>çŒœæµ‹æ˜¯é€å­—ç¬¦åˆ¤æ–­ è¿™ç§éƒ½å¯ä»¥ç¥­å‡ºpintool<br>åŸç†: åˆ©ç”¨æ­£ç¡®ä¸é”™è¯¯åˆ†åˆ«å¯¹åº”çš„æŒ‡ä»¤æ‰§è¡Œæ¡æ•°ä¸åŒ (ç±»ä¼¼ä¾§ä¿¡é“æ”»å‡»)<br>é¦–å…ˆè¦æ»¡è¶³42ä½lençš„check ç„¶åå°è¯•å‘ç°(ç”¨å·²çŸ¥ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºf)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa: Count 584288</span><br><span class="line">faaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa: Count 589176</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‚¹æ¥è¿›è¡Œçˆ†ç ´<br>pintoolç”¨æ³•:<br>åœ¨ <code>pin-3.30-98830-g1d7b601b3-gcc-linux/source/tools/ManualExamples</code> ä¸‹è¿è¡Œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;d06f0bcc-93e0-9c5b-161e-e146417&quot;</span>+<span class="number">5</span>*<span class="string">&quot;a&quot;</span>+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line">table = <span class="string">&quot;012f3456789abcde-&quot;</span></span><br><span class="line"></span><br><span class="line">now = <span class="number">36</span></span><br><span class="line">prev_cnt = <span class="number">759287</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span>(now&gt;=<span class="number">41</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> table:</span><br><span class="line">        cmd = <span class="string">&quot;echo &quot;</span>+flag[:now]+x+flag[now+<span class="number">1</span>:]+<span class="string">&quot; | ../../../pin -t obj-ia32/inscount0.so -o superflat.log -- ./superflat; cat ./superflat.log&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(flag[:now]+x+flag[now+<span class="number">1</span>:])</span><br><span class="line">        output = subprocess.check_output(cmd,shell=<span class="literal">True</span>,stderr=subprocess.PIPE)   </span><br><span class="line">        now_cnt = <span class="built_in">int</span>(output.split(<span class="string">b&#x27;\n&#x27;</span>)[<span class="number">1</span>].split()[<span class="number">1</span>].decode())</span><br><span class="line"><span class="comment">#        print(output,now_cnt)</span></span><br><span class="line">        <span class="keyword">if</span> now_cnt-prev_cnt&gt;<span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;[+]RIGHT!    <span class="subst">&#123;x&#125;</span>&#x27;</span>)</span><br><span class="line">            flag = flag[:now]+x+flag[now+<span class="number">1</span>:]</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">            prev_cnt = now_cnt</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] WRONG!&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œè´´çš„æ˜¯ååŠéƒ¨åˆ†çš„ ä»å¤´å¼€å§‹çš„è¯æ”¹ä¸€æ”¹now prev_cnt å³å¯<br>çˆ†ç ´å¾—åˆ°flag<br><strong>flag{d06f0bcc-93e0-9c5b-161e-e1464176d395}</strong></p>
<h1 id="GKCTF2021"><a href="#GKCTF2021" class="headerlink" title="GKCTF2021"></a>GKCTF2021</h1><h2 id="QQQQT"><a href="#QQQQT" class="headerlink" title="QQQQT"></a>QQQQT</h2><p>è™½è¯´æ•´ä¸ªé¢˜ç›®è«åå…¶å¦™çš„(æŒ‡è™½ç„¶èƒ½æ‰¾åˆ°base58ä»¥åŠå¯†æ–‡ ä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆè°ƒç”¨åˆ°çš„ ç½‘ä¸Šæ²¡æ‰¾åˆ°ä¸€ç¯‡è®²åˆ°è°ƒç”¨åŸç†çš„â€¦)<br>ä½†æ˜¯å€Ÿæ­¤æœºä¼šäº†è§£ä¸€ä¸‹QT<br>äº†è§£ä¸€ä¸‹ å¯¹è±¡æ ‘ ä¿¡å·&#x2F;æ§½é€šä¿¡ çš„æ¦‚å¿µ<br><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/ics-articles/328193.html">+</a></p>
<h2 id="App-debug"><a href="#App-debug" class="headerlink" title="App-debug"></a>App-debug</h2><p>jadxæ‰“å¼€ å‘ç°loadäº†.soåº“ IDAæŸ¥çœ‹<br>æ‰¾åˆ° Java_com_example_myapplication_MainActivity_check<br>å‘ç°TEAåŠ å¯†<br>å…ˆçœ‹TEAåŠ å¯†<br>é‡ç‚¹åœ¨äºå‘ç°key[]æ˜¯ä¿®æ”¹è¿‡çš„ è¿™ç§äº¤å‰å¼•ç”¨å³å¯æŸ¥çœ‹åˆ°æ­£ç¡®çš„å€¼<br>é€†å‡ºæ¥ä¸¤ä¸ªæ•´æ•°</p>
<p>è¿™ç§load cçš„åº“çš„apkæœ€çƒ¦äººçš„ç‚¹å°±åœ¨äºå±‚ä¹‹é—´æ¥å£çš„æ•°æ®ä¼ é€’<br>è¿™é¢˜:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sub_3FE20</span>(a1, a3, (__int64)v6);</span><br><span class="line"><span class="keyword">if</span> ( <span class="built_in">sub_40040</span>((__int64)v6) == <span class="number">8</span> )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">6</span>; ++i )</span><br><span class="line">    *((_BYTE *)&amp;unk_C80E0 + i) = *(_BYTE *)<span class="built_in">sub_40064</span>((__int64)v6, i);</span><br><span class="line">  v5 = <span class="built_in">TEA</span>((<span class="type">unsigned</span> <span class="type">int</span> *)&amp;unk_C80E0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sub_3FE20:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">v9 = <span class="built_in">sub_40094</span>(a1, <span class="string">&quot;java/lang/String&quot;</span>);</span><br><span class="line">  v8 = <span class="built_in">sub_400CC</span>(a1, <span class="string">&quot;GB2312&quot;</span>);</span><br><span class="line">  v7 = <span class="built_in">sub_40104</span>(a1, v9, <span class="string">&quot;getBytes&quot;</span>, <span class="string">&quot;(Ljava/lang/String;)[B&quot;</span>);</span><br><span class="line">  v6 = <span class="built_in">sub_4014C</span>(a1, a2, v7, v8);</span><br><span class="line">  v5 = <span class="built_in">sub_4024C</span>(a1, v6);</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥çŸ¥é“æ˜¯long_to_bytes&#x2F;bytes_to_long è¿™ç§<br>è¿™ä¸¤ä¸ªæ•°å­—è½¬å‡ºæ¥åˆ†åˆ«æ˜¯<br>TcKG å’Œ 0gF<br>æ³¨æ„ä¸‹ç«¯åº ä»¥åŠsub_40040çš„len checkè¦æ»¡è¶³&#x3D;&#x3D;8 æ‰€ä»¥æœ«å°¾å†è¡¥ä¸ªç©ºæ ¼ apkéªŒè¯æ­£ç¡®<br>â€œGKcTFg0 â€œ<br>ä½†æ˜¯md5çš„æ—¶å€™åˆè¦æŠŠç©ºæ ¼å»æ‰â€¦<br>flag:<br><strong>flag{77bca47fe645ca1bd1ac93733171c9c4}</strong></p>
<h1 id="GWCTF2019"><a href="#GWCTF2019" class="headerlink" title="GWCTF2019"></a>GWCTF2019</h1><h2 id="babyvm"><a href="#babyvm" class="headerlink" title="babyvm"></a>babyvm</h2><p>vm opcode<br>è®°å¾—å‡ ä¸ªæœˆå‰çœ‹è¿˜æ²¡ä»€ä¹ˆå¤´ç»ª ä¹Ÿé™ä¸ä¸‹å¿ƒæ¥é€†å‘ åœ¨è®¡ç»„çŸ¥è¯†å­¦ä¹ æ·±å…¥åå†æ¥çœ‹å°±å¥½å¤šäº†</p>
<p>main:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> __fastcall __noreturn <span class="title">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3[<span class="number">2</span>]; <span class="comment">// [rsp+10h] [rbp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3[<span class="number">1</span>] = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v3[<span class="number">0</span>] = <span class="number">0LL</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please input something:&quot;</span>);</span><br><span class="line">  <span class="built_in">SETUP</span>((__int64)v3);</span><br><span class="line">  <span class="built_in">EXECUTE_OPCODE</span>((__int64)v3);</span><br><span class="line">  <span class="built_in">FALSE_FINAL_CHECK</span>();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;And the flag is GWHT&#123;true flag&#125;&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>SETUP:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">SETUP</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  *(_DWORD *)a1 = <span class="number">0</span>;</span><br><span class="line">  *(_DWORD *)(a1 + <span class="number">4</span>) = <span class="number">0x12</span>;</span><br><span class="line">  *(_DWORD *)(a1 + <span class="number">8</span>) = <span class="number">0</span>;</span><br><span class="line">  *(_DWORD *)(a1 + <span class="number">12</span>) = <span class="number">0</span>;</span><br><span class="line">  *(_QWORD *)(a1 + <span class="number">16</span>) = &amp;OPCODE;</span><br><span class="line">  *(_BYTE *)(a1 + <span class="number">24</span>) = <span class="number">0xF1</span>;</span><br><span class="line">  *(_QWORD *)(a1 + <span class="number">32</span>) = F1_sub_56088D000B5F;</span><br><span class="line">  *(_BYTE *)(a1 + <span class="number">40</span>) = <span class="number">0xF2</span>;</span><br><span class="line">  *(_QWORD *)(a1 + <span class="number">48</span>) = F2_XOR;</span><br><span class="line">  *(_BYTE *)(a1 + <span class="number">56</span>) = <span class="number">0xF5</span>;</span><br><span class="line">  *(_QWORD *)(a1 + <span class="number">64</span>) = F5_INPUT_AND_CHECK_LEN;</span><br><span class="line">  *(_BYTE *)(a1 + <span class="number">72</span>) = <span class="number">0xF4</span>;</span><br><span class="line">  *(_QWORD *)(a1 + <span class="number">80</span>) = F4_sub_55E3A8C00956;</span><br><span class="line">  *(_BYTE *)(a1 + <span class="number">88</span>) = <span class="number">0xF7</span>;</span><br><span class="line">  *(_QWORD *)(a1 + <span class="number">96</span>) = F7_MUL;</span><br><span class="line">  *(_BYTE *)(a1 + <span class="number">104</span>) = <span class="number">0xF8</span>;</span><br><span class="line">  *(_QWORD *)(a1 + <span class="number">112</span>) = F8_SWAP;</span><br><span class="line">  *(_BYTE *)(a1 + <span class="number">120</span>) = <span class="number">0xF6</span>;</span><br><span class="line">  *(_QWORD *)(a1 + <span class="number">128</span>) = F6_LINERAL_CAL;</span><br><span class="line">  INPUT = <span class="built_in">malloc</span>(<span class="number">0x512</span>uLL);</span><br><span class="line">  <span class="built_in">memset</span>(INPUT, <span class="number">0</span>, <span class="number">0x512</span>uLL);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„åˆ°æ‰§è¡Œopcodeçš„æ—¶å€™å†™äº†ä¸ª0xF4åœæ­¢ ä½†æ˜¯æ­¤æ—¶å‘ç°æ²¡å‡ºç°è¿‡å‰æ–‡çš„mulç­‰å‡½æ•°<br>è¿™æ˜¯å› ä¸ºç¬¬ä¸€ä¸ª0xF4åé¢ä¸€å †0è¿‡åè¿˜ä¼šç»§ç»­æ‰§è¡Œç¬¬äºŒé˜¶æ®µ</p>
<p>æŸ¥çœ‹æ¯ä¸ªå‡½æ•°<br>F1: è®¾ç½®å¯„å­˜å™¨&#x2F;èµ‹å€¼</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">F1_sub_56088D000B5F</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> *v2; <span class="comment">// [rsp+28h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v3; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v3 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v2 = (<span class="type">int</span> *)(*(_QWORD *)(a1 + <span class="number">16</span>) + <span class="number">2LL</span>);</span><br><span class="line">  <span class="keyword">switch</span> ( *(_BYTE *)(*(_QWORD *)(a1 + <span class="number">16</span>) + <span class="number">1LL</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xE1</span>:</span><br><span class="line">      *(_DWORD *)a1 = *((<span class="type">char</span> *)INPUT + *v2);   <span class="comment">// reg1</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xE2</span>:</span><br><span class="line">      *(_DWORD *)(a1 + <span class="number">4</span>) = *((<span class="type">char</span> *)INPUT + *v2);<span class="comment">// reg2</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xE3</span>:</span><br><span class="line">      *(_DWORD *)(a1 + <span class="number">8</span>) = *((<span class="type">char</span> *)INPUT + *v2);<span class="comment">// reg3</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xE4</span>:</span><br><span class="line">      *((_BYTE *)INPUT + *v2) = *(_DWORD *)a1;  <span class="comment">// input[] = reg1</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xE5</span>:</span><br><span class="line">      *(_DWORD *)(a1 + <span class="number">12</span>) = *((<span class="type">char</span> *)INPUT + *v2);<span class="comment">// reg4</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xE7</span>:</span><br><span class="line">      *((_BYTE *)INPUT + *v2) = *(_DWORD *)(a1 + <span class="number">4</span>);<span class="comment">// input[] = reg2</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  *(_QWORD *)(a1 + <span class="number">16</span>) += <span class="number">6LL</span>;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä»–çš„éƒ½æ²¡ä»€ä¹ˆéš¾ç‚¹<br>è¿™é‡Œæœ‰ä¸ªåœ°æ–¹æ„Ÿè§‰regå¯¹åº”ä¸ç®—å¾ˆæ¸…æ™°<br>ä½†ä¹Ÿèƒ½çŒœåˆ°æ˜¯swap(reg1,reg2) åªæ˜¯æœ‰å¯èƒ½æ˜¯å¸¦ç€åœ°å€çš„æŒ‡é’ˆäº¤æ¢</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">F8_SWAP</span><span class="params">(<span class="type">int</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// [rsp+14h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v3; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v3 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v2 = *a1;</span><br><span class="line">  *a1 = a1[<span class="number">1</span>];</span><br><span class="line">  a1[<span class="number">1</span>] = v2;</span><br><span class="line">  ++*((_QWORD *)a1 + <span class="number">2</span>);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>pythonæå–opcodeæ‰“å°å­—èŠ‚ç :<br>è¦æ³¨æ„åˆ°reg2æœ€åˆæ˜¯èµ‹äº†å€¼çš„</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">opcode = [<span class="number">0xF5</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x21</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x23</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x24</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x25</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x06</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x26</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x27</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x28</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x09</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x29</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x0A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x2A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x2B</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x2C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x2D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x2E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x2F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x30</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x31</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x12</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x32</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x13</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x33</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF4</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF5</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x06</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x06</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE3</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE5</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0xF7</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x06</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE3</span>, <span class="number">0x09</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE5</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0xF7</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x09</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE3</span>, <span class="number">0x0A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE5</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0xF7</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x13</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF8</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE7</span>, <span class="number">0x13</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x12</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF8</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE7</span>, <span class="number">0x12</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF8</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE7</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF4</span>,-<span class="number">1</span>]</span><br><span class="line">enc = [<span class="number">0x69</span>, <span class="number">0x45</span>, <span class="number">0x2A</span>, <span class="number">0x37</span>, <span class="number">0x09</span>, <span class="number">0x17</span>, <span class="number">0xC5</span>, <span class="number">0x0B</span>, <span class="number">0x5C</span>, <span class="number">0x72</span>, <span class="number">0x33</span>, <span class="number">0x76</span>, <span class="number">0x33</span>, <span class="number">0x21</span>, <span class="number">0x74</span>, <span class="number">0x31</span>, <span class="number">0x5F</span>, <span class="number">0x33</span>, <span class="number">0x73</span>, <span class="number">0x72</span>]</span><br><span class="line"><span class="comment"># enc = &quot;Fz&#123;aM&#123;aM|&#125;fMt~suM !!&quot;</span></span><br><span class="line">pc = <span class="number">0</span></span><br><span class="line">line = <span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;mov reg2 12h&quot;</span>)</span><br><span class="line"><span class="keyword">while</span> opcode[pc] != -<span class="number">1</span>:</span><br><span class="line">    line+=<span class="number">1</span></span><br><span class="line">    op = opcode[pc]</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">0x0</span>):</span><br><span class="line">        pc+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">0xF5</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;INPUT_AND_CHECKLEN&quot;</span>)</span><br><span class="line">        pc += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">0xF1</span>):</span><br><span class="line">        <span class="keyword">case</span> = opcode[pc+<span class="number">1</span>]</span><br><span class="line">        v2 = opcode[pc+<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">case</span>==<span class="number">0xE1</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;mov reg1 input[<span class="subst">&#123;v2&#125;</span>]&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">case</span>==<span class="number">0xE2</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;mov reg2 input[<span class="subst">&#123;v2&#125;</span>]&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">case</span>==<span class="number">0xE3</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;mov reg3 input[<span class="subst">&#123;v2&#125;</span>]&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">case</span>==<span class="number">0xE4</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;mov input[<span class="subst">&#123;v2&#125;</span>] reg1&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">case</span>==<span class="number">0xE5</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;mov reg4 input[<span class="subst">&#123;v2&#125;</span>]&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">case</span>==<span class="number">0xE6</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;mov input[<span class="subst">&#123;v2&#125;</span>] reg2&quot;</span>)</span><br><span class="line">        pc += <span class="number">6</span></span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">0xF2</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;xor reg1 reg2&quot;</span>)</span><br><span class="line">        pc += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">0xF4</span>):</span><br><span class="line">        pc += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">0xF7</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;mul reg1 reg4&quot;</span>)</span><br><span class="line">        pc += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">0xF8</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;swap reg1 reg2&quot;</span>) </span><br><span class="line">        pc += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">0xF6</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;mov reg1 3*reg1 + 2*reg2 + reg3&quot;</span>)</span><br><span class="line">        pc += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>æ‰“å°å‡ºæ¥:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">mov reg2 12h</span><br><span class="line">INPUT_AND_CHECKLEN</span><br><span class="line">mov reg1 input[0]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[32] reg1</span><br><span class="line">mov reg1 input[1]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[33] reg1</span><br><span class="line">mov reg1 input[2]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[34] reg1</span><br><span class="line">mov reg1 input[3]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[35] reg1</span><br><span class="line">mov reg1 input[4]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[36] reg1</span><br><span class="line">mov reg1 input[5]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[37] reg1</span><br><span class="line">mov reg1 input[6]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[38] reg1</span><br><span class="line">mov reg1 input[7]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[39] reg1</span><br><span class="line">mov reg1 input[8]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[40] reg1</span><br><span class="line">mov reg1 input[9]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[41] reg1</span><br><span class="line">mov reg1 input[10]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[42] reg1</span><br><span class="line">mov reg1 input[11]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[43] reg1</span><br><span class="line">mov reg1 input[12]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[44] reg1</span><br><span class="line">mov reg1 input[13]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[45] reg1</span><br><span class="line">mov reg1 input[14]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[46] reg1</span><br><span class="line">mov reg1 input[15]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[47] reg1</span><br><span class="line">mov reg1 input[16]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[48] reg1</span><br><span class="line">mov reg1 input[17]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[49] reg1</span><br><span class="line">mov reg1 input[18]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[50] reg1</span><br><span class="line">mov reg1 input[19]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[51] reg1</span><br><span class="line">INPUT_AND_CHECKLEN</span><br><span class="line">mov reg1 input[0]</span><br><span class="line">mov reg2 input[1]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[0] reg1</span><br><span class="line">mov reg1 input[1]</span><br><span class="line">mov reg2 input[2]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[1] reg1</span><br><span class="line">mov reg1 input[2]</span><br><span class="line">mov reg2 input[3]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[2] reg1</span><br><span class="line">mov reg1 input[3]</span><br><span class="line">mov reg2 input[4]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[3] reg1</span><br><span class="line">mov reg1 input[4]</span><br><span class="line">mov reg2 input[5]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[4] reg1</span><br><span class="line">mov reg1 input[5]</span><br><span class="line">mov reg2 input[6]</span><br><span class="line">xor reg1 reg2</span><br><span class="line">mov input[5] reg1</span><br><span class="line">mov reg1 input[6]</span><br><span class="line">mov reg2 input[7]</span><br><span class="line">mov reg3 input[8]</span><br><span class="line">mov reg4 input[12]</span><br><span class="line">mov reg1 3*reg1 + 2*reg2 + reg3</span><br><span class="line">mul reg1 reg4</span><br><span class="line">mov input[6] reg1</span><br><span class="line">mov reg1 input[7]</span><br><span class="line">mov reg2 input[8]</span><br><span class="line">mov reg3 input[9]</span><br><span class="line">mov reg4 input[12]</span><br><span class="line">mov reg1 3*reg1 + 2*reg2 + reg3</span><br><span class="line">mul reg1 reg4</span><br><span class="line">mov input[7] reg1</span><br><span class="line">mov reg1 input[8]</span><br><span class="line">mov reg2 input[9]</span><br><span class="line">mov reg3 input[10]</span><br><span class="line">mov reg4 input[12]</span><br><span class="line">mov reg1 3*reg1 + 2*reg2 + reg3</span><br><span class="line">mul reg1 reg4</span><br><span class="line">mov input[8] reg1</span><br><span class="line">mov reg1 input[13]</span><br><span class="line">mov reg2 input[19]</span><br><span class="line">swap reg1 reg2</span><br><span class="line">mov input[13] reg1</span><br><span class="line">mov reg1 input[14]</span><br><span class="line">mov reg2 input[18]</span><br><span class="line">swap reg1 reg2</span><br><span class="line">mov input[14] reg1</span><br><span class="line">mov reg1 input[15]</span><br><span class="line">mov reg2 input[17]</span><br><span class="line">swap reg1 reg2</span><br><span class="line">mov input[15] reg1</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥æ¸…æ™°çœ‹åˆ°æœ‰ä¸¤æ¬¡input<br>ç¬¬ä¸€éé€†å‘å‡ºæ¥æ˜¯å‡çš„flag</p>
<p>ç¬¬äºŒéé€æ­¥åˆ†æ:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">input[0] = input[0]^input[1]</span><br><span class="line">input[1] = input[1]^input[2]</span><br><span class="line">input[2] = input[2]^input[3]</span><br><span class="line">input[3] = input[3]^input[4]</span><br><span class="line">input[4] = input[4]^input[5]</span><br><span class="line">input[5] = input[5]^input[6]</span><br><span class="line">input[6] = (3*input[6]+2*input[7]+input[8])*input[12]</span><br><span class="line">input[7] = (3*input[7]+2*input[8]+input[9])*input[12]</span><br><span class="line">input[8] = (3*input[8]+2*input[9]+input[10])*input[12]</span><br><span class="line">input[13] = input[19]  swap?</span><br><span class="line">input[14] = input[18]</span><br><span class="line">input[15] = input[17]</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå°±å¯ä»¥å‘ç°swapé‚£ä¸ªå‡½æ•°åº”è¯¥æ˜¯å¸¦ç€æŒ‡é’ˆçš„ bytecodeæœ‰ä¸€ç‚¹å°é—®é¢˜ ä½†ä¸æ˜¯å¾ˆå½±å“åšé¢˜<br>è¿™æ ·çš„è¯æˆ‘ä»¬å°±ä»åå¼€å§‹é€†<br>å…ˆswap ç„¶åå‘ç°input[12]&#x2F;input[9]&#x2F;input[10]æ˜¯æ²¡æœ‰æ”¹å˜çš„ æ‰€ä»¥å¯ä»¥çˆ†ç ´å¾—åˆ°input[8] ä»è€Œå¾—åˆ°7,6<br>è¿™æ ·å°±å¯ä»¥xorå›å»å¾—åˆ°5,4,3,2,1,0<br>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dec</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] START&quot;</span>)</span><br><span class="line">    enc[<span class="number">13</span>],enc[<span class="number">19</span>] = enc[<span class="number">19</span>],enc[<span class="number">13</span>]</span><br><span class="line">    enc[<span class="number">14</span>],enc[<span class="number">18</span>] = enc[<span class="number">18</span>],enc[<span class="number">14</span>]</span><br><span class="line">    enc[<span class="number">15</span>],enc[<span class="number">17</span>] = enc[<span class="number">17</span>],enc[<span class="number">15</span>]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        y = <span class="number">3</span>*x+<span class="number">2</span>*enc[<span class="number">9</span>]+enc[<span class="number">10</span>]</span><br><span class="line">        y *= enc[<span class="number">12</span>]</span><br><span class="line">        y &amp;= <span class="number">0xff</span></span><br><span class="line">        <span class="keyword">if</span>(y==enc[<span class="number">8</span>]):</span><br><span class="line">            enc[<span class="number">8</span>] = x</span><br><span class="line">            <span class="built_in">print</span>(enc[<span class="number">8</span>])</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        y = <span class="number">3</span>*x+<span class="number">2</span>*enc[<span class="number">8</span>]+enc[<span class="number">9</span>]</span><br><span class="line">        y *= enc[<span class="number">12</span>]</span><br><span class="line">        y &amp;= <span class="number">0xff</span></span><br><span class="line">        <span class="keyword">if</span>(y==enc[<span class="number">7</span>]):</span><br><span class="line">            enc[<span class="number">7</span>] = x</span><br><span class="line">            <span class="built_in">print</span>(enc[<span class="number">7</span>])</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        y = <span class="number">3</span>*x+<span class="number">2</span>*enc[<span class="number">7</span>]+enc[<span class="number">8</span>]</span><br><span class="line">        y *= enc[<span class="number">12</span>]</span><br><span class="line">        y &amp;= <span class="number">0xff</span></span><br><span class="line">        <span class="keyword">if</span>(y==enc[<span class="number">6</span>]):</span><br><span class="line">            enc[<span class="number">6</span>]=x</span><br><span class="line">            <span class="built_in">print</span>(enc[<span class="number">6</span>])</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        enc[i] ^= enc[i+<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> enc:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(c),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">dec()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Y0u_hav3_r3v3rs3_1t!</span></span><br></pre></td></tr></table></figure>

<p><strong>GWHT{Y0u_hav3_r3v3rs3_1t!}</strong></p>
<hr>
<hr>
<p>è¿™é¢˜æ˜¯æœ€åŸºæœ¬çš„vmç±»å‹ è¿˜æ²¡åŠ jumpè·³è½¬æŒ‡ä»¤<br>å…³é”®åœ¨äºåˆ†æopcodeå’Œå¯¹åº”çš„æ“ä½œæ•°ä»¥åŠæ¯ä¸ªå‡½æ•°æŠ½è±¡å‡ºçš„æ„ä¹‰</p>
<h1 id="HGAME2022"><a href="#HGAME2022" class="headerlink" title="HGAME2022"></a>HGAME2022</h1><h2 id="week4-ezvm"><a href="#week4-ezvm" class="headerlink" title="week4 ezvm"></a>week4 ezvm</h2><p>è¿™é“vmå¾ˆæ€ª ç‰¹åˆ«æ€ªâ€¦<br>ç›´æ¥è§£ææŒ‡ä»¤å¾ˆç¦»è°±â€¦ å„ç§å¯„å­˜å™¨&#x2F;å †æ ˆ&#x2F;xor_key&#x2F;encäº¤ç»‡åœ¨ä¸€èµ· çœŸçš„åˆ†æä¸æ˜ç™½<br>å¤§æ¦‚æ‰“å°ä¸€ä¸‹ å¯ä»¥å‘ç°å…³é”®åŠ å¯†ä¸¤ä¸ªç‚¹<br>mul 2<br>xor xxx<br>å­—èŠ‚ç ä¸Šè¿™ä¸¤ä¸ªæ˜¯æŒ¨ç€çš„ çŒœæµ‹å°±æ˜¯ä¹˜2å†xor<br>ç›´æ¥åŠ¨è°ƒçœ‹(æ³¨æ„getcharé‚£é‡Œè¦ä¸€æ¬¡è¡Œè¾“å®Œâ€¦)<br>å‘ç°ç¡®å®ä¹˜2 åç´§è·Ÿç€å°±æ˜¯ xor<br>æ¯æ¬¡xorçš„ä¸ä¸€æ · å¯ä»¥åŠ¨è°ƒè®°å½• ä¹Ÿå¯ä»¥æ‰¾å‡ ä¸ªååœ¨dword_49F020æ•°ç»„æ‰¾å¯¹åº”é¡¹<br>å¾—åˆ°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xor_key = [<span class="number">0x0000005E</span>, <span class="number">0x00000046</span>, <span class="number">0x00000061</span>, <span class="number">0x00000043</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000053</span>, <span class="number">0x00000049</span>, <span class="number">0x0000001F</span>, <span class="number">0x00000051</span>, <span class="number">0x0000005E</span>, <span class="number">0x00000036</span>, <span class="number">0x00000037</span>, <span class="number">0x00000029</span>, <span class="number">0x00000041</span>, <span class="number">0x00000063</span>, <span class="number">0x0000003B</span>, <span class="number">0x00000064</span>, <span class="number">0x0000003B</span>, <span class="number">0x00000015</span>, <span class="number">0x00000018</span>, <span class="number">0x0000005B</span>, <span class="number">0x0000003E</span>, <span class="number">0x00000022</span>, <span class="number">0x00000050</span>, <span class="number">0x00000046</span>, <span class="number">0x0000005E</span>, <span class="number">0x00000035</span>, <span class="number">0x0000004E</span>, <span class="number">0x00000043</span>, <span class="number">0x00000023</span>, <span class="number">0x00000060</span>, <span class="number">0x0000003B</span>, <span class="number">0x00000000</span>]</span><br></pre></td></tr></table></figure>

<p>åŒæ ·çš„ encæ•°ç»„ä¹Ÿå¯ä»¥åœ¨dword_49F020é‡Œé¢ç¿» åº”è¯¥ä¹Ÿå¯ä»¥ç­‰å˜æ¢å®Œäº†æ­¥è¿‡æ¥æ‰¾<br>è¿™é‡Œè®°å½•ä¸€ä¸‹<br>é¦–å…ˆé€šè¿‡xor_keyçŸ¥é“flagä½æ•° ç„¶åç­‰32æ¬¡å˜æ¢å®Œå å‘ç°åŸæœ¬å­˜å‚¨è¾“å…¥çš„å˜æˆäº†åŠ å¯†åçš„<br>é‚£ä¹ˆåœ¨æ•°ç»„ç¬¬ä¸€ä¸ªç‚¹ä¸‹ç¡¬ä»¶æ–­ç‚¹ ç­‰è§¦å‘<br>å‘ç°åœ¨è¿™é‡Œ:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">sub_401904</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// edx</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  v0 = dword_49F030++;</span><br><span class="line">  result = ++dword_49F024;</span><br><span class="line">  dword_49F020[dword_49F024 + <span class="number">9</span>] = dword_49F020[v0 + <span class="number">209</span>];</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ—¶å¯ä»¥æ ¹æ®v0çš„å€¼æ‰¾åˆ°dword_49F020æ•°ç»„ä¸­çš„ä½ç½® ä¹Ÿå°±èƒ½æ‰¾åˆ°enc[]äº†</p>
<p>å¾—åˆ°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">0x0000008E</span>, <span class="number">0x00000088</span>, <span class="number">0x000000A3</span>, <span class="number">0x00000099</span>, <span class="number">0x000000C4</span>, <span class="number">0x000000A5</span>, <span class="number">0x000000C3</span>, <span class="number">0x000000DD</span>, <span class="number">0x00000019</span>, <span class="number">0x000000EC</span>, <span class="number">0x0000006C</span>, <span class="number">0x0000009B</span>, <span class="number">0x000000F3</span>, <span class="number">0x0000001B</span>, <span class="number">0x0000008B</span>, <span class="number">0x0000005B</span>, <span class="number">0x0000003E</span>, <span class="number">0x0000009B</span>, <span class="number">0x000000F1</span>, <span class="number">0x00000086</span>, <span class="number">0x000000F3</span>, <span class="number">0x000000F4</span>, <span class="number">0x000000A4</span>, <span class="number">0x000000F8</span>, <span class="number">0x000000F8</span>, <span class="number">0x00000098</span>, <span class="number">0x000000AB</span>, <span class="number">0x00000086</span>, <span class="number">0x00000089</span>, <span class="number">0x00000061</span>, <span class="number">0x00000022</span>, <span class="number">0x000000C1</span>, <span class="number">0x00000002</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>é€†å‘è§£å¯†å¾—åˆ°flag<br><strong>hgame{Ea$Y-Vm-t0-PrOTeCT_cOde!!}</strong></p>
<hr>
<hr>
<p>è¿˜æ˜¯å¸Œæœ›èƒ½å¤Ÿæ‰“å°å‡ºæ­£ç¡®çš„å­—èŠ‚ç æ¥çœ‹ ä½†æ˜¯ç½‘ä¸Šå°±æ‰¾ä¸åˆ°ä¸€ç¯‡è¿™ä¹ˆåšçš„â€¦  ç­‰ä»¥åå†æ¥è¡¥å§~<br>ä¹Ÿè¡Œå§ vmæœ€åˆçš„æ–¹æ³•å°±æ˜¯åŠ¨è°ƒâ€¦ è¿™ç§ä¸å¥½è§£ææ±‡ç¼–æŒ‡ä»¤çš„åŠ¨è°ƒä¹Ÿä¸å¤±ä¸ºä¸€ç§å¥½æ–¹æ³•</p>
<h1 id="FSCTF2023"><a href="#FSCTF2023" class="headerlink" title="FSCTF2023"></a>FSCTF2023</h1><h2 id="ezbroke"><a href="#ezbroke" class="headerlink" title="ezbroke"></a>ezbroke</h2><p>PEä¿®å¤+vm<br>vmå¾ˆç®€å• é‡ç‚¹æ˜¯PEä¿®å¤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"> Offset    0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F   Ascii</span><br><span class="line"></span><br><span class="line">00000000  54 47 90 00 03 00 00 00 04 00 00 00 FF FF 00 00  TG?......ï£µï£µ..</span><br><span class="line">00000010  B8 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00  ?......@.......</span><br><span class="line">00000020  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000030  00 00 00 00 00 00 00 00 00 00 00 00 70 00 00 00  ............p...</span><br><span class="line">00000040  0E 1F BA 0E 00 B4 09 CD 21 B8 01 4C CD 21 54 68  ?.???L?Th</span><br><span class="line">00000050  69 73 20 70 72 6F 67 72 61 6D 20 63 61 6E 6E 6F  is.program.canno</span><br><span class="line">00000060  74 20 62 65 20 72 75 6E 20 69 6E 20 44 4F 53 20  t.be.run.in.DOS.</span><br><span class="line">00000070  6D 6F 64 65 2E 0D 0D 0A 24 00 00 00 00 00 00 00  mode....$.......</span><br><span class="line">00000080  50 45 00 00 4C 01 03 00 9B 10 21 65 00 BC 04 00  PE..L.?!e.?.</span><br><span class="line">00000090  1A 05 00 00 E0 00 27 01 0B 01 02 21 00 F0 00 00  ..?&#x27;!.?.</span><br><span class="line">000000A0  00 10 00 00 00 90 04 00 20 80 05 00 00 A0 04 00  ....?..â‚¬..?.</span><br><span class="line">000000B0  00 90 05 00 00 00 40 00 00 10 00 00 00 02 00 00  .?...@.......</span><br><span class="line">000000C0  04 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00  .............</span><br><span class="line">000000D0  00 A0 05 00 00 10 00 00 00 00 00 00 03 00 00 00  .?...........</span><br><span class="line">000000E0  00 00 20 00 00 10 00 00 00 00 10 00 00 10 00 00  .............</span><br><span class="line">000000F0  00 00 00 00 10 00 00 00 00 00 00 00 00 00 00 00  ...............</span><br><span class="line">00000100  EC 94 05 00 B4 00 00 00 00 90 05 00 EC 04 00 00  éŒ.?...?.?..</span><br><span class="line">00000110  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000120  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000130  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000140  F0 8B 05 00 18 00 00 00 00 00 00 00 00 00 00 00  é¥—............</span><br><span class="line">00000150  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000160  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">00000170  00 00 00 00 00 00 00 00 54 55 54 30 00 00 00 00  ........TUT0....</span><br><span class="line">00000180  00 90 04 00 00 10 00 00 00 00 00 00 00 02 00 00  .?...........</span><br><span class="line">00000190  00 00 00 00 00 00 00 00 00 00 00 00 80 00 00 E0  ............â‚¬..?</span><br><span class="line">000001A0  54 55 54 31 00 00 00 00 00 F0 00 00 00 A0 04 00  TUT1.....?..?.</span><br><span class="line">000001B0  00 EE 00 00 00 02 00 00 00 00 00 00 00 00 00 00  .?............</span><br><span class="line">000001C0  00 00 00 00 40 00 00 E0 2E 72 73 72 63 00 00 00  ....@..?rsrc...</span><br><span class="line">000001D0  00 10 00 00 00 90 05 00 00 06 00 00 00 F0 00 00  ....?.....?.</span><br><span class="line">000001E0  00 00 00 00 00 00 00 00 00 00 00 00 40 00 00 C0  ............@..?</span><br><span class="line">000001F0  33 2E 39 36 00 54 55 54 21 0D 09 0E 0A CE 64 10  3.96.TUT!...è‘</span><br></pre></td></tr></table></figure>

<p>é™¤äº†MZç­¾åå’ŒUPXæ®µçš„ä»¥å¤– è¿˜æœ‰PEå¤´åç§»ä¹Ÿè¦æ”¹(3Cå¤„) æ”¹ä¸º80<br>upxè§£å°±è¡Œäº†<br>ç„¶åä¸€ä¸ªè¶…ç®€å•çš„è™šæ‹Ÿæœº è¿™ç§vmâ€¦<br>å¾—åˆ°å­—èŠ‚ç :</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">0 read ---&gt; stack[]</span><br><span class="line">1 mov a1[0] stack[0]</span><br><span class="line">7 xor a1[0] (a1[1]^0x17)</span><br><span class="line">8 mov stack[32] a1[0]</span><br><span class="line">14 mov a1[0] stack[1]</span><br><span class="line">20 xor a1[0] (a1[1]^0x17)</span><br><span class="line">21 mov stack[33] a1[0]</span><br><span class="line">27 mov a1[0] stack[2]</span><br><span class="line">33 xor a1[0] (a1[1]^0x17)</span><br><span class="line">34 mov stack[34] a1[0]</span><br><span class="line">40 mov a1[0] stack[3]</span><br><span class="line">46 xor a1[0] (a1[1]^0x17)</span><br><span class="line">47 mov stack[35] a1[0]</span><br><span class="line">53 mov a1[0] stack[4]</span><br><span class="line">59 xor a1[0] (a1[1]^0x17)</span><br><span class="line">60 mov stack[36] a1[0]</span><br><span class="line">66 mov a1[0] stack[5]</span><br><span class="line">72 xor a1[0] (a1[1]^0x17)</span><br><span class="line">73 mov stack[37] a1[0]</span><br><span class="line">79 mov a1[0] stack[6]</span><br><span class="line">85 xor a1[0] (a1[1]^0x17)</span><br><span class="line">86 mov stack[38] a1[0]</span><br><span class="line">92 mov a1[0] stack[7]</span><br><span class="line">98 xor a1[0] (a1[1]^0x17)</span><br><span class="line">99 mov stack[39] a1[0]</span><br><span class="line">105 mov a1[0] stack[8]</span><br><span class="line">111 xor a1[0] (a1[1]^0x17)</span><br><span class="line">112 mov stack[40] a1[0]</span><br><span class="line">118 mov a1[0] stack[9]</span><br><span class="line">124 xor a1[0] (a1[1]^0x17)</span><br><span class="line">125 mov stack[41] a1[0]</span><br><span class="line">131 mov a1[0] stack[10]</span><br><span class="line">137 xor a1[0] (a1[1]^0x17)</span><br><span class="line">138 mov stack[42] a1[0]</span><br><span class="line">144 mov a1[0] stack[11]</span><br><span class="line">150 xor a1[0] (a1[1]^0x17)</span><br><span class="line">151 mov stack[43] a1[0]</span><br><span class="line">157 mov a1[0] stack[12]</span><br><span class="line">163 xor a1[0] (a1[1]^0x17)</span><br><span class="line">164 mov stack[44] a1[0]</span><br></pre></td></tr></table></figure>

<p>è¿™â€¦ æå–å‡ºenc æ³¨æ„åˆ°a1[1]&#x3D;&#x3D;&#x3D;0 æ‰€ä»¥å°±ä¸€ä¸ªxor 0x17â€¦<br>å¾—åˆ°flag<br><strong>FSCTF{Y0u successfu11y br0k3 my pr0t3ct10n!!!}</strong></p>
<h1 id="SWPU2019"><a href="#SWPU2019" class="headerlink" title="SWPU2019"></a>SWPU2019</h1><h2 id="EasiestRe"><a href="#EasiestRe" class="headerlink" title="EasiestRe"></a>EasiestRe</h2><p>å‚è€ƒèµ„æ–™:<br><a href="https://bbs.kanxue.com/thread-95082-1.htm" target="_blank">+</a><br><a href="https://www.nssctf.cn/note/set/2071" target="_blank">++</a><br><a href="https://blog.csdn.net/weixin_53349587/article/details/122279966" target="_blank">+++</a></p>
<p>ç¬¬ä¸€æ¬¡æ¥è§¦åŒè¿›ç¨‹ä¿æŠ¤çš„é¢˜<br>é€šè¿‡è¿™é“é¢˜å­¦ä¼šäº†å¥½å¤šå¥½å¤šâ€¦</p>
<p>IDAæ‰“å¼€ ç»“åˆIsDebugâ€¦çš„åˆ¤æ–­ çŸ¥é“è¿™æ˜¯ä¸€é“åŒè¿›ç¨‹ä¿æŠ¤çš„é¢˜ç›®<br>é€šè¿‡åˆ¤æ–­æ˜¯å¦å¤„äºè°ƒè¯•çŠ¶æ€æ¥æ‰§è¡Œå¯¹åº”æ“ä½œ è¿™ç§åŠ ä¸Šå¼‚å¸¸å¤„ç†å°±å¯ä»¥å¾ˆå¥½çš„æ··æ·†ç¨‹åºæµ</p>
<p>è¿™é¢˜çš„å­è¿›ç¨‹å°±æ˜¯sub_403922<br>æ³¨æ„åˆ°ä¸»è¿›ç¨‹ä¹Ÿå°±æ˜¯mainçš„è¿™é‡Œ:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">1</span>; i &lt; <span class="number">35</span> &amp;&amp; (<span class="type">unsigned</span> __int8)Buffer[i] == <span class="number">144</span>; ++i )</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ˜¯åœ¨ç»Ÿè®¡nopä¸ªæ•°ï¼<br>ä¹Ÿå°±æ˜¯æ ¹æ®å­è¿›ç¨‹è§¦å‘çš„__int3å¤„çš„nopæ•°æ¥å†³å®šä¸‹æ­¥æ“ä½œ<br>æœ‰4,5,7,30 çš„æƒ…å†µ<br>é‡ç‚¹å…³æ³¨7,30 </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">                    <span class="built_in">WriteProcessMemory</span>(ProcessInformation.hProcess, lpBaseAddress, v16, <span class="number">7u</span>, NumberOfBytesWritten);</span><br><span class="line">                    <span class="keyword">if</span> ( NumberOfBytesWritten[<span class="number">0</span>] == <span class="number">7</span> )</span><br><span class="line">                    &#123;</span><br><span class="line">                      <span class="built_in">ReadProcessMemory</span>(ProcessInformation.hProcess, lpBaseAddress, Buffer, <span class="number">7u</span>, NumberOfBytesRead);</span><br><span class="line">                      dwContinueStatus = <span class="number">65538</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                  <span class="keyword">case</span> <span class="number">30</span>:</span><br><span class="line">                    <span class="built_in">WriteProcessMemory</span>(ProcessInformation.hProcess, lpBaseAddress, v15, <span class="number">0x1E</span>u, NumberOfBytesWritten);</span><br><span class="line">                    <span class="keyword">if</span> ( NumberOfBytesWritten[<span class="number">0</span>] == <span class="number">30</span> )</span><br><span class="line">                      dwContinueStatus = <span class="number">65538</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå¯¹å“åº”çš„nopç‚¹è¿›è¡Œäº†ä»£ç çš„æ›¿æ¢ ä»write&#x2F;read æ“ä½œå†…å­˜ä»¥åŠv15,v16è½¬æˆ16è¿›åˆ¶å°±æ˜¯å“åº”æ“ä½œç å¯çŸ¥é“</p>
<p>å¯¹åº”7çš„ç‚¹åœ¨00408AF8å¤„<br>ida_patchæ›¿æ¢å¯¹åº”å­—èŠ‚ååæ±‡ç¼–å¾—åˆ°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">char</span> <span class="title">sub_68A40</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v1[<span class="number">52</span>]; <span class="comment">// [esp+8h] [ebp-138h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v2[<span class="number">10</span>]; <span class="comment">// [esp+D8h] [ebp-68h] BYREF</span></span><br><span class="line">  <span class="type">char</span> Str[<span class="number">56</span>]; <span class="comment">// [esp+100h] [ebp-40h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [esp+138h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">j__memset</span>(Str, <span class="number">0</span>, <span class="number">0x32</span>u);</span><br><span class="line">  v2[<span class="number">0</span>] = <span class="number">2</span>;</span><br><span class="line">  v2[<span class="number">1</span>] = <span class="number">3</span>;</span><br><span class="line">  v2[<span class="number">2</span>] = <span class="number">7</span>;</span><br><span class="line">  v2[<span class="number">3</span>] = <span class="number">14</span>;</span><br><span class="line">  v2[<span class="number">4</span>] = <span class="number">30</span>;</span><br><span class="line">  v2[<span class="number">5</span>] = <span class="number">57</span>;</span><br><span class="line">  v2[<span class="number">6</span>] = <span class="number">120</span>;</span><br><span class="line">  v2[<span class="number">7</span>] = <span class="number">251</span>;</span><br><span class="line">  <span class="built_in">j__memset</span>(v1, <span class="number">0</span>, <span class="number">0xC8</span>u);</span><br><span class="line">  <span class="built_in">sub_61497</span>(<span class="string">&quot;Please Input Flag:\n&quot;</span>);</span><br><span class="line">  <span class="built_in">sub_61956</span>(<span class="string">&quot;%s&quot;</span>, Str);</span><br><span class="line">  v4 = <span class="built_in">j__strlen</span>(Str);</span><br><span class="line">  <span class="keyword">if</span> ( v4 &gt;= <span class="number">24</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_6247D</span>(Str, (<span class="type">int</span>)v2, (<span class="type">int</span>)v1);           <span class="comment">// encrypt</span></span><br><span class="line">    <span class="built_in">sub_6384B</span>((<span class="type">int</span>)v1);                         <span class="comment">// checkçš„ä¸Šé¢çš„a3...</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_61497</span>(<span class="string">&quot;you are too short!&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* Orphan comments:</span></span><br><span class="line"><span class="comment">å¼ºè¡Œdebugbreak...</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>åœ¨è¿›å…¥sub_6247Dåå¯ä»¥æ‰¾åˆ°sub_6460Bä¸­å¯¹åº”30nopå¤„<br>åŒæ ·å¤„ç†åå¾—åˆ°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">char</span> __cdecl <span class="title">sub_687E0</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int8 i; <span class="comment">// [esp+3h] [ebp-9h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">8u</span>; ++i )</span><br><span class="line">    *(_DWORD *)(a2 + <span class="number">4</span> * i) = <span class="number">41</span> * *(_DWORD *)(a1 + <span class="number">4</span> * i) % <span class="number">491u</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·åˆ†æå°±å¥½åˆ†æå¤šäº†<br>åŠ å¯†å‡½æ•°:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">char</span> __cdecl <span class="title">sub_68860</span><span class="params">(<span class="type">char</span> *Str, <span class="type">int</span> a2, <span class="type">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int8 v4; <span class="comment">// [esp+Fh] [ebp-4Dh]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [esp+10h] [ebp-4Ch]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [esp+10h] [ebp-4Ch]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+14h] [ebp-48h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v8; <span class="comment">// [esp+1Bh] [ebp-41h]</span></span><br><span class="line">  <span class="type">int</span> v9[<span class="number">4</span>]; <span class="comment">// [esp+20h] [ebp-3Ch] BYREF</span></span><br><span class="line">  <span class="type">int</span> v10[<span class="number">9</span>]; <span class="comment">// [esp+30h] [ebp-2Ch] BYREF</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [esp+54h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v11 = <span class="number">0x1234</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v10, <span class="number">0</span>, <span class="number">32</span>);</span><br><span class="line">  v9[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  v9[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  v8 = <span class="built_in">j__strlen</span>(Str);</span><br><span class="line">  <span class="built_in">sub_6460B</span>(a2, (<span class="type">int</span>)v10);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v8; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( i )</span><br><span class="line">      Str[i] ^= *(_BYTE *)(a3 + <span class="number">4</span> * i - <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      *Str ^= v11;</span><br><span class="line">    v4 = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">j__memset</span>(v9, <span class="number">0</span>, <span class="number">8u</span>);</span><br><span class="line">    __debugbreak();</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">8</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (v4 &amp; Str[i]) != <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        *((_BYTE *)v9 + j) = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)j &gt;= <span class="number">8</span> )</span><br><span class="line">          <span class="built_in">j____report_rangecheckfailure</span>();</span><br><span class="line">        *((_BYTE *)v9 + j) = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      v4 *= <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; <span class="number">8</span>; ++k )</span><br><span class="line">      *(_DWORD *)(a3 + <span class="number">4</span> * i) += v10[<span class="number">7</span> - k] * *((<span class="type">unsigned</span> __int8 *)v9 + k);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„a3åˆå§‹ä¸ºç©º v10æ˜¯ä¼ å…¥çš„a2ç»è¿‡çº¿æ€§å˜æ¢å¾—åˆ°<br>æµç¨‹å°±æ˜¯xoråå†polyè½¬ä¸€ä¸‹å¾—åˆ°a3<br>ç»“æŸencå è¿›å…¥ä¸‹é¢çš„å‡½æ•° éœ€è¦åœ¨æ±‡ç¼–ä»£ç ä¸­æ‰¾åˆ°checkç‚¹<br>åœ¨loc_6845Aå¯ä»¥æ‰¾åˆ°æ¯”å¯¹å­—ç¬¦ä¸² è¿™é‡Œæœ‰ä¸ªç–‘é—® ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¦ä»ä¸­é—´åŠæˆªå¼€å§‹å–â€¦<br>ç†è®ºå¯ä»¥æ€¼é‚£ä¸€å¤§æ®µæ±‡ç¼–â€¦<br>å¥½å§ è¿™é‡Œèƒ½çœ‹å‡ºæ¥: ç®€å•æ–¹æ³•å°±æ˜¯æ‰¾cmpåçš„jz&#x2F;jnz</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mov     eax, [ebp+var_20]</span><br><span class="line">mov     ecx, [ebp+var_28]</span><br><span class="line">mov     edx, [ebp+var_20]</span><br><span class="line">mov     eax, [ecx+eax*<span class="number">4</span>]</span><br><span class="line">cmp     eax, [ebp+edx*<span class="number">4</span>+var_124]</span><br><span class="line">jnz     <span class="type">short</span> loc_68657</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„checkçš„æ˜¯a3çš„å€¼<br>æ ¹æ®è¿™ä¸ªé€»è¾‘é€†å›å»:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">v2 = [<span class="number">2</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">14</span>,<span class="number">30</span>,<span class="number">57</span>,<span class="number">120</span>,<span class="number">251</span>]</span><br><span class="line">enc = [<span class="number">0x3d1</span>,<span class="number">0x2f0</span>,<span class="number">0x52</span>,<span class="number">0x475</span>,<span class="number">0x1d2</span>,<span class="number">0x2f0</span>,<span class="number">0x224</span>,<span class="number">0x51c</span>,<span class="number">0x4e6</span>,<span class="number">0x29f</span>,<span class="number">0x2ee</span>,<span class="number">0x39b</span>,<span class="number">0x3f9</span>,<span class="number">0x32b</span>,<span class="number">0x2f2</span>,<span class="number">0x5b5</span>,<span class="number">0x24c</span>,<span class="number">0x45a</span>,<span class="number">0x34c</span>,<span class="number">0x56d</span>,<span class="number">0x0a</span>,<span class="number">0x4e6</span>,<span class="number">0x476</span>,<span class="number">0x2d9</span>]</span><br><span class="line">v10 = [<span class="number">41</span>*x%<span class="number">491</span> <span class="keyword">for</span> x <span class="keyword">in</span> v2]</span><br><span class="line"></span><br><span class="line">a3 = [<span class="number">0</span>]*<span class="number">24</span></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">24</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>&lt;&lt;<span class="number">9</span>):</span><br><span class="line">        s = <span class="built_in">bin</span>(x)[<span class="number">2</span>:]</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">len</span>(s)&lt;<span class="number">8</span>):</span><br><span class="line">            s = <span class="string">&#x27;0&#x27;</span>*(<span class="number">8</span>-<span class="built_in">len</span>(s))+s</span><br><span class="line">        tot = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            tot += <span class="built_in">int</span>(s[j])*v10[j]</span><br><span class="line">        <span class="keyword">if</span>(tot==enc[i]):</span><br><span class="line">            flag.append(x)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    <span class="keyword">if</span>(i==<span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>((flag[<span class="number">0</span>]^<span class="number">0x1234</span>)&amp;<span class="number">0xff</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>((flag[i]^enc[i-<span class="number">1</span>])&amp;<span class="number">0xff</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">## swpuctf&#123;y0u_@re_s0_coo1&#125;</span></span><br></pre></td></tr></table></figure>
<p>flag:<br><strong>swpuctf{y0u_@re_s0_coo1}</strong></p>
<hr>
<hr>
<p>é¢˜ç›®æœ¬èº«ä¸æ˜¯é‡ç‚¹ é‡è¦çš„æ˜¯é€šè¿‡è¿™é“é¢˜é€æ­¥æ¥è§¦äº†è§£åŒè¿›ç¨‹&#x2F;int3ç­‰çŸ¥è¯†ç‚¹!</p>
<h1 id="HGAME2023"><a href="#HGAME2023" class="headerlink" title="HGAME2023"></a>HGAME2023</h1><h2 id="week4-vm"><a href="#week4-vm" class="headerlink" title="week4 vm"></a>week4 vm</h2><p>åˆæ˜¯vmopcode è¿™é¢˜åœ¨åŸºç¡€çš„opcodeä¸ŠåŠ å…¥äº†je&#x2F;jne&#x2F;cmp&#x2F;jmpçš„è·³è½¬<br>éœ€è¦æ³¨æ„ä¸€ä¸ªç‚¹: jmpè·³è½¬åpcä¸é‡ç½®ä¸ºopcode[pc+1] æˆ‘ä»¬æ˜¯ç»§ç»­æ‰“å°åé¢çš„æŒ‡ä»¤<br>æˆ‘ä»¬æ‰“å°å®Œbytecodeè‡ªå·±åˆ†ææ—¶å†è€ƒè™‘è·³è½¬</p>
<p>æ¯ä¸ªå‡½æ•°:<br>F0</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">F0</span><span class="params">(_DWORD *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v2; <span class="comment">// [rsp+0h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v2 = OPCODE[a1[<span class="number">6</span>] + <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">if</span> ( v2 )                                     <span class="comment">// a1[]å½“ä½œå¯„å­˜å™¨</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">switch</span> ( v2 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1u</span>:</span><br><span class="line">        INPUT[a1[<span class="number">2</span>]] = *a1;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2u</span>:</span><br><span class="line">        a1[OPCODE[a1[<span class="number">6</span>] + <span class="number">2</span>]] = a1[OPCODE[a1[<span class="number">6</span>] + <span class="number">3</span>]];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3u</span>:</span><br><span class="line">        a1[OPCODE[a1[<span class="number">6</span>] + <span class="number">2</span>]] = OPCODE[a1[<span class="number">6</span>] + <span class="number">3</span>];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    *a1 = INPUT[a1[<span class="number">2</span>]];</span><br><span class="line">  &#125;</span><br><span class="line">  result = (<span class="type">unsigned</span> <span class="type">int</span>)(a1[<span class="number">6</span>] + <span class="number">4</span>);</span><br><span class="line">  a1[<span class="number">6</span>] = result;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>F1:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">F1</span><span class="params">(_DWORD *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v2; <span class="comment">// [rsp+0h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v2 = OPCODE[a1[<span class="number">6</span>] + <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">if</span> ( v2 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">switch</span> ( v2 )                               <span class="comment">// å…¥æ ˆ</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1u</span>:</span><br><span class="line">        tmp[++a1[<span class="number">7</span>]] = *a1;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2u</span>:</span><br><span class="line">        tmp[++a1[<span class="number">7</span>]] = a1[<span class="number">2</span>];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3u</span>:</span><br><span class="line">        tmp[++a1[<span class="number">7</span>]] = a1[<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    tmp[++a1[<span class="number">7</span>]] = *a1;</span><br><span class="line">  &#125;</span><br><span class="line">  result = (<span class="type">unsigned</span> <span class="type">int</span>)(a1[<span class="number">6</span>] + <span class="number">2</span>);</span><br><span class="line">  a1[<span class="number">6</span>] = result;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>F2:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">F2</span><span class="params">(_DWORD *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v2; <span class="comment">// [rsp+0h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v2 = OPCODE[a1[<span class="number">6</span>] + <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">if</span> ( v2 )                                     <span class="comment">// å‡ºæ ˆ</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">switch</span> ( v2 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1u</span>:</span><br><span class="line">        a1[<span class="number">1</span>] = tmp[a1[<span class="number">7</span>]--];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2u</span>:</span><br><span class="line">        a1[<span class="number">2</span>] = tmp[a1[<span class="number">7</span>]--];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3u</span>:</span><br><span class="line">        a1[<span class="number">3</span>] = tmp[a1[<span class="number">7</span>]--];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    *a1 = tmp[a1[<span class="number">7</span>]--];</span><br><span class="line">  &#125;</span><br><span class="line">  result = (<span class="type">unsigned</span> <span class="type">int</span>)(a1[<span class="number">6</span>] + <span class="number">2</span>);</span><br><span class="line">  a1[<span class="number">6</span>] = result;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>F3:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_7FF7D1EE14D0</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span> ( OPCODE[*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">1</span>] )   <span class="comment">// å¯„å­˜å™¨è¿ç®—</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0u</span>:</span><br><span class="line">      *(_DWORD *)(a1 + <span class="number">4</span>i64 * OPCODE[*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">2</span>]) += *(_DWORD *)(a1</span><br><span class="line">                                                                             + <span class="number">4</span>i64 * OPCODE[*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">3</span>]);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1u</span>:</span><br><span class="line">      *(_DWORD *)(a1 + <span class="number">4</span>i64 * OPCODE[*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">2</span>]) -= *(_DWORD *)(a1</span><br><span class="line">                                                                             + <span class="number">4</span>i64 * OPCODE[*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">3</span>]);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2u</span>:</span><br><span class="line">      *(_DWORD *)(a1 + <span class="number">4</span>i64 * OPCODE[*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">2</span>]) *= *(_DWORD *)(a1</span><br><span class="line">                                                                             + <span class="number">4</span>i64 * OPCODE[*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">3</span>]);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3u</span>:</span><br><span class="line">      *(_DWORD *)(a1 + <span class="number">4</span>i64 * OPCODE[*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">2</span>]) ^= *(_DWORD *)(a1</span><br><span class="line">                                                                             + <span class="number">4</span>i64 * OPCODE[*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">3</span>]);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4u</span>:</span><br><span class="line">      *(_DWORD *)(a1 + <span class="number">4</span>i64 * OPCODE[*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">2</span>]) &lt;&lt;= *(_DWORD *)(a1</span><br><span class="line">                                                                              + <span class="number">4</span>i64 * OPCODE[*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">3</span>]);</span><br><span class="line">      *(_DWORD *)(a1 + <span class="number">4</span>i64 * OPCODE[*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">2</span>]) &amp;= <span class="number">0xFF00</span>u;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5u</span>:</span><br><span class="line">      *(_DWORD *)(a1 + <span class="number">4</span>i64 * OPCODE[*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">2</span>]) &gt;&gt;= *(_DWORD *)(a1</span><br><span class="line">                                                                              + <span class="number">4</span>i64 * OPCODE[*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">3</span>]);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  result = (<span class="type">unsigned</span> <span class="type">int</span>)(*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">4</span>);</span><br><span class="line">  *(_DWORD *)(a1 + <span class="number">24</span>) = result;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>F4:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">F4</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( *(_DWORD *)a1 == *(_DWORD *)(a1 + <span class="number">4</span>) )   <span class="comment">// reg0==reg1</span></span><br><span class="line">    *(_BYTE *)(a1 + <span class="number">32</span>) = <span class="number">0</span>;                    <span class="comment">// æ¯”è¾ƒä½</span></span><br><span class="line">  <span class="keyword">if</span> ( *(_DWORD *)a1 != *(_DWORD *)(a1 + <span class="number">4</span>) )</span><br><span class="line">    *(_BYTE *)(a1 + <span class="number">32</span>) = <span class="number">1</span>;</span><br><span class="line">  result = (<span class="type">unsigned</span> <span class="type">int</span>)(*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">1</span>);</span><br><span class="line">  *(_DWORD *)(a1 + <span class="number">24</span>) = result;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>F5:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">F5</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">                                                <span class="comment">// pc = opcode[pc+1]</span></span><br><span class="line">  result = OPCODE[*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">1</span>];</span><br><span class="line">  *(_DWORD *)(a1 + <span class="number">24</span>) = result;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>F6:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">F6</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( *(_BYTE *)(a1 + <span class="number">32</span>) )                    <span class="comment">// æ¯”è¾ƒä½æ˜¯1ï¼š ä¸ç›¸ç­‰ ä¸è·³è½¬</span></span><br><span class="line">    result = (<span class="type">unsigned</span> <span class="type">int</span>)(*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">2</span>);</span><br><span class="line">  <span class="keyword">else</span>                                          <span class="comment">// ç›¸ç­‰ è·³è½¬</span></span><br><span class="line">    result = OPCODE[*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">1</span>];</span><br><span class="line">  *(_DWORD *)(a1 + <span class="number">24</span>) = result;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>F7:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">F7</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( *(_BYTE *)(a1 + <span class="number">32</span>) )                    <span class="comment">// ä¸ç›¸ç­‰ è·³è½¬</span></span><br><span class="line">    result = OPCODE[*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    result = (<span class="type">unsigned</span> <span class="type">int</span>)(*(_DWORD *)(a1 + <span class="number">24</span>) + <span class="number">2</span>);</span><br><span class="line">  *(_DWORD *)(a1 + <span class="number">24</span>) = result;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰“å°bytecode:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">opcode = [<span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x32</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x64</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x05</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x28</span>, <span class="number">0x04</span>, <span class="number">0x06</span>, <span class="number">0x5F</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x96</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x07</span>, <span class="number">0x88</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x28</span>, <span class="number">0x04</span>, <span class="number">0x07</span>, <span class="number">0x63</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>]</span><br><span class="line"></span><br><span class="line">pc = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> opcode[pc] != <span class="number">0xFF</span>:</span><br><span class="line">    op = opcode[pc]</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">0</span>):</span><br><span class="line">        v2 = opcode[pc+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span>(v2):</span><br><span class="line">            <span class="keyword">if</span>(v2==<span class="number">1</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    mov input[reg2] reg0&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span>(v2==<span class="number">2</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    mov reg<span class="subst">&#123;opcode[pc+<span class="number">2</span>]&#125;</span> reg<span class="subst">&#123;opcode[pc+<span class="number">3</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span>(v2==<span class="number">3</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    mov reg<span class="subst">&#123;opcode[pc+<span class="number">2</span>]&#125;</span> <span class="subst">&#123;opcode[pc+<span class="number">3</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    mov reg0 input[reg2]&quot;</span>)</span><br><span class="line">        pc += <span class="number">4</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">elif</span>(op==<span class="number">1</span>):</span><br><span class="line">        v2 = opcode[pc+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span>(v2):</span><br><span class="line">            <span class="keyword">if</span>(v2==<span class="number">1</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    push reg0&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span>(v2==<span class="number">2</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    push reg2&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span>(v2==<span class="number">3</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    push reg3&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    push reg0&quot;</span>)</span><br><span class="line">        pc += <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">elif</span>(op==<span class="number">2</span>):</span><br><span class="line">        v2 = opcode[pc+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span>(v2):</span><br><span class="line">            <span class="keyword">if</span>(v2==<span class="number">1</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    pop reg1&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span>(v2==<span class="number">2</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    pop reg2&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span>(v2==<span class="number">3</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    pop reg3&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    pop reg0&quot;</span>)</span><br><span class="line">        pc += <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span>(op==<span class="number">3</span>):</span><br><span class="line">        v1 = opcode[pc+<span class="number">1</span>]</span><br><span class="line">        v2 = opcode[pc+<span class="number">2</span>]</span><br><span class="line">        v3 = opcode[pc+<span class="number">3</span>]</span><br><span class="line">        <span class="keyword">if</span>(v1==<span class="number">0</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    add reg<span class="subst">&#123;v2&#125;</span> reg<span class="subst">&#123;v3&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(v1==<span class="number">1</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    sub reg<span class="subst">&#123;v2&#125;</span> reg<span class="subst">&#123;v3&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(v1==<span class="number">2</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    mul reg<span class="subst">&#123;v2&#125;</span> reg<span class="subst">&#123;v3&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(v1==<span class="number">3</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    xor reg<span class="subst">&#123;v2&#125;</span> reg<span class="subst">&#123;v3&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(v1==<span class="number">4</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    shl reg<span class="subst">&#123;v2&#125;</span> reg<span class="subst">&#123;v3&#125;</span>\n      and reg<span class="subst">&#123;v2&#125;</span> 0xFF00u&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(v1==<span class="number">5</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    shr reg<span class="subst">&#123;v2&#125;</span> reg<span class="subst">&#123;v3&#125;</span>&quot;</span>)</span><br><span class="line">        pc += <span class="number">4</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span>(op==<span class="number">4</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    cmp reg0 reg1&quot;</span>)</span><br><span class="line">        pc += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span>(op==<span class="number">5</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    jmp <span class="subst">&#123;opcode[pc+<span class="number">1</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment"># pc = opcode[pc+1]</span></span><br><span class="line">        pc += <span class="number">2</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">elif</span>(op==<span class="number">6</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    je <span class="subst">&#123;opcode[pc+<span class="number">1</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        pc += <span class="number">2</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">elif</span>(op==<span class="number">7</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pc&#125;</span>    jne <span class="subst">&#123;opcode[pc+<span class="number">1</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        pc += <span class="number">2</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ‰“å°å‡ºæ¥æ˜¯è¿™ä¸ªæ ·å­:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>    mov reg2 <span class="number">0</span></span><br><span class="line"><span class="number">4</span>    add reg2 reg3</span><br><span class="line"><span class="number">8</span>    mov reg0 input[reg2]</span><br><span class="line"><span class="number">12</span>    mov reg1 reg0</span><br><span class="line"><span class="number">16</span>    mov reg2 <span class="number">50</span></span><br><span class="line"><span class="number">20</span>    add reg2 reg3</span><br><span class="line"><span class="number">24</span>    mov reg0 input[reg2]</span><br><span class="line"><span class="number">28</span>    add reg1 reg0</span><br><span class="line"><span class="number">32</span>    mov reg2 <span class="number">100</span></span><br><span class="line"><span class="number">36</span>    add reg2 reg3</span><br><span class="line"><span class="number">40</span>    mov reg0 input[reg2]</span><br><span class="line"><span class="number">44</span>    <span class="keyword">xor</span> reg1 reg0</span><br><span class="line"><span class="number">48</span>    mov reg0 <span class="number">8</span></span><br><span class="line"><span class="number">52</span>    mov reg2 reg1</span><br><span class="line"><span class="number">56</span>    shl reg1 reg0</span><br><span class="line">      <span class="keyword">and</span> reg1 <span class="number">0xFF00</span>u</span><br><span class="line"><span class="number">60</span>    shr reg2 reg0</span><br><span class="line"><span class="number">64</span>    add reg1 reg2</span><br><span class="line"><span class="number">68</span>    mov reg0 reg1</span><br><span class="line"><span class="number">72</span>    push reg0</span><br><span class="line"><span class="number">74</span>    mov reg0 <span class="number">1</span></span><br><span class="line"><span class="number">78</span>    add reg3 reg0</span><br><span class="line"><span class="number">82</span>    mov reg0 reg3</span><br><span class="line"><span class="number">86</span>    mov reg1 <span class="number">40</span></span><br><span class="line"><span class="number">90</span>    cmp reg0 reg1</span><br><span class="line"><span class="number">91</span>    je <span class="number">95</span></span><br><span class="line"><span class="number">93</span>    jmp <span class="number">0</span></span><br><span class="line"><span class="number">95</span>    mov reg3 <span class="number">0</span></span><br><span class="line"><span class="number">99</span>    pop reg1</span><br><span class="line"><span class="number">101</span>    mov reg2 <span class="number">150</span></span><br><span class="line"><span class="number">105</span>    add reg2 reg3</span><br><span class="line"><span class="number">109</span>    mov reg0 input[reg2]</span><br><span class="line"><span class="number">113</span>    cmp reg0 reg1</span><br><span class="line"><span class="number">114</span>    jne <span class="number">136</span></span><br><span class="line"><span class="number">116</span>    mov reg0 <span class="number">1</span></span><br><span class="line"><span class="number">120</span>    add reg3 reg0</span><br><span class="line"><span class="number">124</span>    mov reg0 reg3</span><br><span class="line"><span class="number">128</span>    mov reg1 <span class="number">40</span></span><br><span class="line"><span class="number">132</span>    cmp reg0 reg1</span><br><span class="line"><span class="number">133</span>    jne <span class="number">99</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åå°±æ…¢æ…¢æ‰‹æ’•æ±‡ç¼–å§<br>åˆ†æå¦‚ä¸‹:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸€ä¸ªloop 0~93 å¾ªç¯40æ¬¡</span></span><br><span class="line"><span class="number">0</span>     mov reg2 <span class="number">0</span></span><br><span class="line"><span class="number">4</span>     add reg2 reg3</span><br><span class="line"><span class="number">8</span>     mov reg0 input[reg2]</span><br><span class="line"><span class="number">12</span>    mov reg1 reg0</span><br><span class="line"><span class="comment">// reg1 = input[i]</span></span><br><span class="line"><span class="number">16</span>    mov reg2 <span class="number">50</span></span><br><span class="line"><span class="number">20</span>    add reg2 reg3</span><br><span class="line"><span class="comment">// reg2 = 50+i</span></span><br><span class="line"><span class="number">24</span>    mov reg0 input[reg2]</span><br><span class="line"><span class="number">28</span>    add reg1 reg0</span><br><span class="line"><span class="comment">// reg1 += input[50+i]</span></span><br><span class="line"><span class="number">32</span>    mov reg2 <span class="number">100</span></span><br><span class="line"><span class="number">36</span>    add reg2 reg3</span><br><span class="line"><span class="number">40</span>    mov reg0 input[reg2]</span><br><span class="line"><span class="comment">// reg0 = input[100+i]</span></span><br><span class="line"><span class="number">44</span>    <span class="keyword">xor</span> reg1 reg0</span><br><span class="line"><span class="comment">// reg1 ^= reg0</span></span><br><span class="line"><span class="comment">// reg1 = (input[i]+input[50+i])^input[100+i]</span></span><br><span class="line"><span class="comment">// æ³¨æ„åˆ°åŸæœ¬çš„Inputä¸æ­¢40ä¸ªæ•°æ® æ‰€ä»¥åªæœ‰å‰40ä¸ªæ˜¯è¢«è¾“å…¥è¦†ç›– åé¢è¿˜æ˜¯æœ‰æ•°æ®çš„</span></span><br><span class="line"><span class="number">48</span>    mov reg0 <span class="number">8</span></span><br><span class="line"><span class="number">52</span>    mov reg2 reg1</span><br><span class="line"><span class="number">56</span>    shl reg1 reg0</span><br><span class="line">      <span class="keyword">and</span> reg1 <span class="number">0xFF00</span>u</span><br><span class="line"><span class="number">60</span>    shr reg2 reg0</span><br><span class="line"><span class="number">64</span>    add reg1 reg2</span><br><span class="line"><span class="number">68</span>    mov reg0 reg1</span><br><span class="line"><span class="number">72</span>    push reg0</span><br><span class="line"><span class="comment">// reg0 = (reg1&lt;&lt;8)&amp;0xFF00 + reg1&gt;&gt;8</span></span><br><span class="line"><span class="comment">// å…¶å®å°±æ˜¯reg1çš„é«˜ä½ä½äº’æ¢</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™é‡Œæ˜¯ä¸€ä¸ªecxçš„check ç›¸å½“äºreg0++ ç„¶åcmp reg0 40 è¾¾åˆ°å¾ªç¯æ¬¡æ•°å°±è·³å‡º</span></span><br><span class="line"><span class="comment">// reg0++;reg3++;cmp reg0 40;</span></span><br><span class="line"><span class="number">74</span>    mov reg0 <span class="number">1</span></span><br><span class="line"><span class="number">78</span>    add reg3 reg0</span><br><span class="line"><span class="number">82</span>    mov reg0 reg3</span><br><span class="line"><span class="number">86</span>    mov reg1 <span class="number">40</span></span><br><span class="line"><span class="number">90</span>    cmp reg0 reg1</span><br><span class="line"><span class="number">91</span>    je <span class="number">95</span></span><br><span class="line"><span class="number">93</span>    jmp <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¾ªç¯check</span></span><br><span class="line"><span class="number">95</span>    mov reg3 <span class="number">0</span></span><br><span class="line"><span class="comment">// loop:99~133</span></span><br><span class="line"><span class="comment">//è¿™æ®µcheckæ˜¯å°†ä¸Šé¢è¿ç®—ä¿å­˜åœ¨tmpæ ˆä¸­çš„æ•°æ®å–å‡ºæ¥ä¸input[]åšæ¯”è¾ƒcheck</span></span><br><span class="line"><span class="comment">// tmp[]æ•°ç»„æ˜¯é€†åºå– Input[]æ˜¯æ­£åºå–</span></span><br><span class="line"><span class="number">99</span>    pop reg1</span><br><span class="line"><span class="number">101</span>   mov reg2 <span class="number">150</span></span><br><span class="line"><span class="number">105</span>   add reg2 reg3</span><br><span class="line"><span class="number">109</span>   mov reg0 input[reg2]</span><br><span class="line"><span class="number">113</span>   cmp reg0 reg1</span><br><span class="line"><span class="comment">// reg0 = input[150+i]</span></span><br><span class="line"><span class="number">114</span>   jne <span class="number">136</span>   <span class="comment">// Fail</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// reg3++;reg0++;cmp reg0 40;</span></span><br><span class="line"></span><br><span class="line"><span class="number">116</span>   mov reg0 <span class="number">1</span></span><br><span class="line"><span class="number">120</span>   add reg3 reg0</span><br><span class="line"><span class="number">124</span>   mov reg0 reg3</span><br><span class="line"><span class="number">128</span>   mov reg1 <span class="number">40</span></span><br><span class="line"><span class="number">132</span>   cmp reg0 reg1</span><br><span class="line"><span class="number">133</span>   jne <span class="number">99</span></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„åˆ°åˆå§‹çš„inputæ•°ç»„æœ‰200ä¸ª å‰40ç”¨æ¥getchar åé¢çš„ç”¨æ¥checkå’Œè¿›è¡Œè¿ç®—<br>æ‰€ä»¥æå–å‡º[-50:-10] é€†åºåé€†å›å»å³å¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x0000009B</span>, <span class="number">0x000000A8</span>, <span class="number">0x00000002</span>, <span class="number">0x000000BC</span>, <span class="number">0x000000AC</span>, <span class="number">0x0000009C</span>, <span class="number">0x000000CE</span>, <span class="number">0x000000FA</span>, <span class="number">0x00000002</span>, <span class="number">0x000000B9</span>, <span class="number">0x000000FF</span>, <span class="number">0x0000003A</span>, <span class="number">0x00000074</span>, <span class="number">0x00000048</span>, <span class="number">0x00000019</span>, <span class="number">0x00000069</span>, <span class="number">0x000000E8</span>, <span class="number">0x00000003</span>, <span class="number">0x000000CB</span>, <span class="number">0x000000C9</span>, <span class="number">0x000000FF</span>, <span class="number">0x000000FC</span>, <span class="number">0x00000080</span>, <span class="number">0x000000D6</span>, <span class="number">0x0000008D</span>, <span class="number">0x000000D7</span>, <span class="number">0x00000072</span>, <span class="number">0x00000000</span>, <span class="number">0x000000A7</span>, <span class="number">0x0000001D</span>, <span class="number">0x0000003D</span>, <span class="number">0x00000099</span>, <span class="number">0x00000088</span>, <span class="number">0x00000099</span>, <span class="number">0x000000BF</span>, <span class="number">0x000000E8</span>, <span class="number">0x00000096</span>, <span class="number">0x0000002E</span>, <span class="number">0x0000005D</span>, <span class="number">0x00000057</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x000000C9</span>, <span class="number">0x000000A9</span>, <span class="number">0x000000BD</span>, <span class="number">0x0000008B</span>, <span class="number">0x00000017</span>, <span class="number">0x000000C2</span>, <span class="number">0x0000006E</span>, <span class="number">0x000000F8</span>, <span class="number">0x000000F5</span>, <span class="number">0x0000006E</span>, <span class="number">0x00000063</span>, <span class="number">0x00000063</span>, <span class="number">0x000000D5</span>, <span class="number">0x00000046</span>, <span class="number">0x0000005D</span>, <span class="number">0x00000016</span>, <span class="number">0x00000098</span>, <span class="number">0x00000038</span>, <span class="number">0x00000030</span>, <span class="number">0x00000073</span>, <span class="number">0x00000038</span>, <span class="number">0x000000C1</span>, <span class="number">0x0000005E</span>, <span class="number">0x000000ED</span>, <span class="number">0x000000B0</span>, <span class="number">0x00000029</span>, <span class="number">0x0000005A</span>, <span class="number">0x00000018</span>, <span class="number">0x00000040</span>, <span class="number">0x000000A7</span>, <span class="number">0x000000FD</span>, <span class="number">0x0000000A</span>, <span class="number">0x0000001E</span>, <span class="number">0x00000078</span>, <span class="number">0x0000008B</span>, <span class="number">0x00000062</span>, <span class="number">0x000000DB</span>, <span class="number">0x0000000F</span>, <span class="number">0x0000008F</span>, <span class="number">0x0000009C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00004800</span>, <span class="number">0x0000F100</span>, <span class="number">0x00004000</span>, <span class="number">0x00002100</span>, <span class="number">0x00003501</span>, <span class="number">0x00006400</span>, <span class="number">0x00007801</span>, <span class="number">0x0000F900</span>, <span class="number">0x00001801</span>, <span class="number">0x00005200</span>, <span class="number">0x00002500</span>, <span class="number">0x00005D01</span>, <span class="number">0x00004700</span>, <span class="number">0x0000FD00</span>, <span class="number">0x00006901</span>, <span class="number">0x00005C00</span>, <span class="number">0x0000AF01</span>, <span class="number">0x0000B200</span>, <span class="number">0x0000EC01</span>, <span class="number">0x00005201</span>, <span class="number">0x00004F01</span>, <span class="number">0x00001A01</span>, <span class="number">0x00005000</span>, <span class="number">0x00008501</span>, <span class="number">0x0000CD00</span>, <span class="number">0x00002300</span>, <span class="number">0x0000F800</span>, <span class="number">0x00000C00</span>, <span class="number">0x0000CF00</span>, <span class="number">0x00003D01</span>, <span class="number">0x00004501</span>, <span class="number">0x00008200</span>, <span class="number">0x0000D201</span>, <span class="number">0x00002901</span>, <span class="number">0x0000D501</span>, <span class="number">0x00000601</span>, <span class="number">0x0000A201</span>, <span class="number">0x0000DE00</span>, <span class="number">0x0000A601</span>, <span class="number">0x0000CA01</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>]</span><br><span class="line">tmp = enc[-<span class="number">50</span>:-<span class="number">10</span>]</span><br><span class="line">tmp = tmp[::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">    x = ((tmp[i]&lt;&lt;<span class="number">8</span>)&amp;<span class="number">0xFF00</span>)+(tmp[i]&gt;&gt;<span class="number">8</span>)</span><br><span class="line">    x ^= enc[<span class="number">100</span>+i]</span><br><span class="line">    x -= enc[<span class="number">50</span>+i]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(x),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># hgame&#123;y0ur_rever5e_sk1ll_i5_very_g0od!!&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>hgame{y0ur_rever5e_sk1ll_i5_very_g0od!!}</strong></p>
<hr>
<hr>
<p>æ€»ç»“: é‡ç‚¹åœ¨äºjmp&#x2F;jne&#x2F;jeæ—¶æˆ‘ä»¬çš„pcæ˜¯è¦ç»§ç»­è·Ÿç€+2çš„ è€Œä¸æ˜¯ç›´æ¥è·³è½¬åˆ°opcode[pc+1]çš„åœ°å€<br>å‡†ç¡®æ¥è¯´åº”è¯¥ä¸èƒ½å‘½åä¸ºpc çœ‹æˆeipæ›´å¦¥å½“<br>pcæ˜¯æŒ‡ä»¤åœ°å€ åœ¨opcodeæ‰§è¡Œæ—¶æ˜¯è·Ÿç€è·³è½¬çš„  eipå‚¨å­˜çš„æ˜¯å½“å‰è¯­å¥çš„ä½ç½® æ˜¯é¡ºåºèµ°çš„<br>æ‰€ä»¥åº”è¯¥æŠŠæ‰“å°opcodeçš„pcå…¨éƒ¨æ¢æˆeipæ‰ç¬¦åˆåŸç†</p>
<p>ç„¶åå°±æ˜¯æ‰‹æ’•æ±‡ç¼–çš„æ—¶å€™è¦æ³¨æ„åˆ°åˆå§‹æ•°ç»„çš„å¤šé‡åŠŸèƒ½</p>
<p>vm+opcodeç¡®å®å¾ˆå¥½ç©(ä¹Ÿå¾ˆç´¯â€¦) åšè¿™ç§å¯ä»¥å¾ˆå¥½åœ°<del>å¤ä¹ è®¡ç»„</del>ç†è§£åŸç†&#x2F;æå‡é€†å‘åŸºæœ¬åŠŸ&#x2F;<del>é”»ç‚¼è€å¿ƒ</del></p>
<h1 id="çº¢å¸½æ¯2019"><a href="#çº¢å¸½æ¯2019" class="headerlink" title="çº¢å¸½æ¯2019"></a>çº¢å¸½æ¯2019</h1><h2 id="xx"><a href="#xx" class="headerlink" title="xx"></a>xx</h2><p>å‡ ä¸ªæœˆå‰åšç¬¬ä¸€æ®µéƒ½æ²¡çœ‹æ‡‚ é‚£æ®µå¾ªç¯å¢åŠ çš„xorä¹Ÿæ²¡çœ‹æ‡‚<br>ç°åœ¨å†æ¥çœ‹å°±å¥½å¤šäº†</p>
<p>IDAæ‰“å¼€<br>å¼€å§‹æœ‰ä¸€ä¸ªlen&#x3D;19çš„check<br>åé¢æœ‰ä¸ªå¥‡æ€ªçš„Code:qwertyuiopasdfghjklzxcvbnm1234567890<br>ç„¶è€Œé€†å‘æ—¶å¹¶æ²¡æœ‰å‘ç°æœ‰å•¥ç”¨â€¦<br>å…³é”®ç‚¹:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span></span><br><span class="line"> &#123;</span><br><span class="line">   v10 = *((_BYTE *)v9 + (<span class="type">char</span> *)INPUT - (<span class="type">char</span> *)v5);</span><br><span class="line">   v11 = <span class="number">0</span>;</span><br><span class="line">   *(_BYTE *)v9 = v10;</span><br><span class="line">   v12 = <span class="number">0</span>i64;</span><br><span class="line">   v13 = <span class="number">-1</span>i64;</span><br><span class="line">   <span class="keyword">do</span></span><br><span class="line">     ++v13;</span><br><span class="line">   <span class="keyword">while</span> ( *(_BYTE *)(v6 + v13) );</span><br><span class="line">   <span class="keyword">if</span> ( v13 )</span><br><span class="line">   &#123;</span><br><span class="line">     <span class="keyword">do</span></span><br><span class="line">     &#123;</span><br><span class="line">       <span class="keyword">if</span> ( v10 == *(_BYTE *)(v6 + v12) )      <span class="comment">// find index???</span></span><br><span class="line">         <span class="keyword">break</span>;</span><br><span class="line">       ++v11;</span><br><span class="line">       ++v12;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">while</span> ( v11 &lt; v13 );</span><br><span class="line">   &#125;</span><br><span class="line">   v14 = <span class="number">-1</span>i64;</span><br><span class="line">   <span class="keyword">do</span></span><br><span class="line">     ++v14;</span><br><span class="line">   <span class="keyword">while</span> ( *(_BYTE *)(v6 + v14) );</span><br><span class="line">   <span class="keyword">if</span> ( v11 == v14 )</span><br><span class="line">     _exit(v6);</span><br><span class="line">   v9 = (__int128 *)((<span class="type">char</span> *)v9 + <span class="number">1</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">while</span> ( (<span class="type">char</span> *)v9 - (<span class="type">char</span> *)v5 &lt; <span class="number">4</span> );        <span class="comment">// &lt;4 ==&gt; å–å‰4ä½ä½œä¸ºxxteaçš„key</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œç»“åˆåŠ¨è°ƒå¯ä»¥çŸ¥é“åé¢xxteaçš„keyå°±æ˜¯å–çš„inputçš„å‰4ä½<br>xxtea</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v17 = <span class="built_in">XXTEA</span>((__int64)INPUT, v3, (<span class="type">unsigned</span> __int8 *)&amp;KEY, &amp;Size);<span class="comment">// KEY: INPUTçš„å‰å››ä¸ªå­—æ¯ ç›²çŒœflag?</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå°±çŒœflagå§<br>å†åé¢æœ‰ä¸ªå¯¹xxteaåŠ å¯†çš„inputæ•°ç»„çš„æ¢åº<br>æ¢åºå®Œäº†å°±æ˜¯ä¸€æ®µä¸¤ä¸ªæœˆå‰æ²¡çœ‹æ˜ç™½çš„xor</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( v20[<span class="number">23</span>] = enc_input1[<span class="number">21</span>]; v21 &lt; v18; ++v22 )</span><br><span class="line">  &#123;</span><br><span class="line">    v23 = <span class="number">0</span>i64;</span><br><span class="line">    <span class="keyword">if</span> ( v21 / <span class="number">3</span> &gt; <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v24 = *v22;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        v24 ^= v20[v23++];</span><br><span class="line">        *v22 = v24;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v23 &lt; v21 / <span class="number">3</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    ++v21;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªé€†å‘å°±è¿™ä¹ˆå†™:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//decrypt</span></span><br><span class="line"> <span class="comment">/*</span></span><br><span class="line"><span class="comment"> v21:1-&gt;23</span></span><br><span class="line"><span class="comment"> ä»v21=3å¼€å§‹</span></span><br><span class="line"><span class="comment"> v23:0-&gt;(v21//3)-1</span></span><br><span class="line"><span class="comment">     v20[v22] ^= v20[v23]</span></span><br><span class="line"><span class="comment"> v21==v22 åŒæ­¥</span></span><br><span class="line"><span class="comment"> å‰é¢å…ˆæ”¹å˜ä¼šå½±å“åé¢xorçš„å€¼ æ‰€ä»¥å€’åºé€†å‘</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">23</span>;i++)&#123;</span><br><span class="line">     <span class="type">int</span> v23 = <span class="number">0</span>;</span><br><span class="line">     <span class="keyword">if</span>(i/<span class="number">3</span>&gt;<span class="number">0</span>)&#123;</span><br><span class="line">         <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;(i/<span class="number">3</span>);j++)&#123;</span><br><span class="line">             enc[i] ^= enc[j];</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ­¥é€†å›å»åæ¢ä¸ªåºå¾—åˆ°:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">206</span>,<span class="number">188</span>,<span class="number">64</span>,<span class="number">165</span>,<span class="number">178</span>,<span class="number">244</span>,<span class="number">231</span>,<span class="number">178</span>,<span class="number">157</span>,<span class="number">169</span>,<span class="number">18</span>,<span class="number">18</span>,<span class="number">200</span>,<span class="number">174</span>,<span class="number">91</span>,<span class="number">16</span>,<span class="number">6</span>,<span class="number">61</span>,<span class="number">29</span>,<span class="number">215</span>,<span class="number">248</span>,<span class="number">220</span>,<span class="number">220</span>,<span class="number">112</span>]</span><br></pre></td></tr></table></figure>

<p>ç„¶åå°ç«¯åºå–ä¸€ä¸‹:<br>å¾—åˆ°:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x40cea5bc</span>,<span class="number">0xe7b2b2f4</span>,<span class="number">0x129d12a9</span>,<span class="number">0x5bc810ae</span>,<span class="number">0x1d6d73d</span>,<span class="number">0xdcf870dc</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œpythonè«åå…¶å¦™çš„å‘äº†æˆ‘åŠå¤©â€¦ ä»¥åæ•°ç»„èµ‹åˆå€¼çš„æ—¶å€™èµ‹[0]*xxx æœ€å¥½åˆ«ç›´æ¥ enc2&#x3D;enc â€¦<br>è«åå…¶å¦™è°ƒè¯•äº†å¥½ä¹…<br>ç„¶åkeyæ˜¯flag<br>è¿™é‡Œä¸æ˜¯å¾ˆæ¸…æ¥šæ˜¯å°ç«¯åºæ‹†æˆå­—èŠ‚è¿˜æ˜¯å…¶ä»–ç»„åˆ åŠ¨è°ƒè·Ÿè¿›xxtea<br>å‘ç°å¼€å¤´åšäº†ä¸€ç³»åˆ—å­—èŠ‚æ‹¼æ¥æ“ä½œ<br>åˆæ³¨æ„åˆ°åœ¨ä¸»åŠ å¯†éƒ¨åˆ†<br>v18[]çš„ç±»å‹æ˜¯DWORD æ‰€ä»¥keyæ•°ç»„(ä¸€ä¸ªå°å‘):</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint32_t</span> <span class="type">const</span> k[<span class="number">4</span>]= &#123;<span class="number">0x67616c66</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br></pre></td></tr></table></figure>

<p>è§£xxtea ç¨ç¨æ”¹ä¸‹ä½ç§»å¸¸æ•°<br>æœ€åè§£å‡ºflag<br><strong>flag{CXX_and_++tea}</strong></p>
<hr>
<hr>
<p>å…¶å®ä»è¿™é‡Œä¹Ÿçœ‹å¾—å‡ºæ¥key:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = v15 + <span class="number">1</span>; i &lt; <span class="number">0x10</span>; ++i )</span><br><span class="line">  *((_BYTE *)&amp;KEY + i) = <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p>åšçš„æ—¶å€™è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒç–‘æƒ‘çš„ç‚¹<br>è¾“å…¥çš„æ˜¯19ä¸ªå­—ç¬¦ ä½†æ˜¯æœ€ååŠ å¯†å´æ˜¯6ç»„DWORD<br>xxteaè§£å¯†å‘ç°æ˜¯å°†0 19 0 0 0 æ¥åœ¨åé¢ä¸€èµ·åŠ å¯†çš„<br>ä¹Ÿå°±æ˜¯å°†SIZEä¹Ÿä½œä¸ºäº†åŠ å¯†çš„ä¸€éƒ¨åˆ†?<br>é‚£ä¹ˆæ˜¯åœ¨ç¨‹åºçš„å“ªä¸ªåœ°æ–¹å®ç°çš„å‘¢ï¼Ÿ<br>ä»¥åæœ‰ç©º&#x2F;æ„Ÿå…´è¶£æ—¶å†æ¥çœ‹å§ ç«è½¦ä¸Šä¸æ˜¯å¾ˆæƒ³é€†äº†(å¤´æ™•â€¦)</p>
<h2 id="calc"><a href="#calc" class="headerlink" title="calc"></a>calc</h2><p>ä»£ç åˆ†æå¤ªé•¿äº†â€¦<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/U-L-G-A-N-O-Y/articles/-/NOZOMIZO">here~</a></p>
<h1 id="CISCN-2022-ä¸œåŒ—"><a href="#CISCN-2022-ä¸œåŒ—" class="headerlink" title="CISCN 2022 ä¸œåŒ—"></a>CISCN 2022 ä¸œåŒ—</h1><h2 id="hana"><a href="#hana" class="headerlink" title="hana"></a>hana</h2><p>æ˜“è¯­è¨€â€¦<br>åœ¨NCTF2023åˆæ¬¡æ¥è§¦æ˜“è¯­è¨€çš„é¢˜ç›® å®Œå…¨ä¸ä¼šâ€¦ è¿™pè¯­è¨€å†™çš„æ˜¯çœŸæŠ½è±¡<br>åœ¨äº†è§£äº†ä¸€ç‚¹ç‚¹æ˜“è¯­è¨€çš„é€†å‘çŸ¥è¯†å å†æ¥çœ‹çœ‹è¿™é“</p>
<p>è¿™é¢˜ç”šè‡³è¿˜æ˜¯åœ¨mfcä¸ŠåŠ ä¸Šæ˜“è¯­è¨€ çœŸçš„éš¾çœ‹å•Šâ€¦<br>main</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __stdcall <span class="title">sub_476208</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2, <span class="type">int</span> a3, <span class="type">int</span> a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">CWinThread</span> *Thread; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  v4 = <span class="number">-1</span>;</span><br><span class="line">  Thread = <span class="built_in">AfxGetThread</span>();</span><br><span class="line">  v6 = *((_DWORD *)<span class="built_in">AfxGetModuleState</span>() + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">sub_47A455</span>(a1, a2, a3, a4) &amp;&amp; (!v6 || (*(<span class="built_in">int</span> (__thiscall **)(<span class="type">int</span>))(*(_DWORD *)v6 + <span class="number">132</span>))(v6)) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (*(<span class="built_in">int</span> (__thiscall **)(<span class="keyword">struct</span> CWinThread *))(*(_DWORD *)Thread + <span class="number">80</span>))(Thread) )<span class="comment">// INPUT AND CHECK</span></span><br><span class="line">    &#123;</span><br><span class="line">      v8 = (*(<span class="built_in">int</span> (__thiscall **)(<span class="keyword">struct</span> CWinThread *))(*(_DWORD *)Thread + <span class="number">84</span>))(Thread);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v7 = *((_DWORD *)Thread + <span class="number">7</span>);</span><br><span class="line">      <span class="keyword">if</span> ( v7 )</span><br><span class="line">        (*(<span class="built_in">void</span> (__thiscall **)(<span class="type">int</span>))(*(_DWORD *)v7 + <span class="number">88</span>))(v7);</span><br><span class="line">      v8 = (*(<span class="built_in">int</span> (__thiscall **)(<span class="keyword">struct</span> CWinThread *))(*(_DWORD *)Thread + <span class="number">104</span>))(Thread);</span><br><span class="line">    &#125;</span><br><span class="line">    v4 = v8;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">AfxWinTerm</span>();</span><br><span class="line">  <span class="keyword">return</span> v4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŠ¨è°ƒå¯ä»¥æ‰¾åˆ°è¾“å…¥å’Œcheckç‚¹<br>æ‰¾åˆ°è¿™ä¸ªå‡½æ•°(éœ€è¦pä¸€ä¸‹ å¼€å§‹IDAæ²¡æœ‰è¯†åˆ«)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">sub_4010B0</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  lpMem = (<span class="type">void</span> *)((<span class="type">void</span> *(*)(<span class="type">int</span>, ...))sub_401446)(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  v0 = lpMem;</span><br><span class="line">  <span class="keyword">if</span> ( !lpMem )</span><br><span class="line">    v0 = &amp;unk_48049C;</span><br><span class="line">  <span class="keyword">if</span> ( ((_DWORD (*)(<span class="type">int</span>, ...))sub_401446)(<span class="number">1</span>, v0, <span class="number">0</span>, <span class="number">0x80000004</span>) == <span class="number">38</span> )<span class="comment">// len=38?</span></span><br><span class="line">  &#123;</span><br><span class="line">    v1 = lpMem;</span><br><span class="line">    <span class="keyword">if</span> ( !lpMem )</span><br><span class="line">      v1 = &amp;unk_48049C;</span><br><span class="line">    v12 = (<span class="type">void</span> *)((<span class="type">void</span> *(*)(<span class="type">int</span>, ...))sub_401446)(<span class="number">1</span>, v1, <span class="number">0</span>, <span class="number">0x80000004</span>);</span><br><span class="line">    v2 = (<span class="type">void</span> *)((<span class="type">void</span> *(*)(<span class="type">int</span>, ...))sub_40144C)(<span class="number">1</span>, &amp;unk_48049D, <span class="number">0</span>, <span class="number">0x80000005</span>);</span><br><span class="line">    v10 = v2;</span><br><span class="line">    <span class="keyword">if</span> ( !v2 )</span><br><span class="line">      v2 = &amp;unk_4804BB;</span><br><span class="line">    v9 = (<span class="type">void</span> *)((<span class="type">void</span> *(*)(<span class="type">int</span>, ...))sub_401446)(<span class="number">1</span>, v2, <span class="number">0</span>, <span class="number">0x80000005</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v10 )</span><br><span class="line">      <span class="built_in">sub_401440</span>(v10);</span><br><span class="line">    v3 = v9;</span><br><span class="line">    <span class="keyword">if</span> ( !v9 )</span><br><span class="line">      v3 = &amp;unk_48049C;</span><br><span class="line">    v8 = v3;</span><br><span class="line">    v4 = v12;</span><br><span class="line">    <span class="keyword">if</span> ( !v12 )</span><br><span class="line">      v4 = &amp;unk_4804BB;</span><br><span class="line">    ((<span class="built_in">void</span> (*)(<span class="type">int</span>, ...))sub_40144C)(<span class="number">3</span>, v4, <span class="number">0</span>, <span class="number">0x80000005</span>, v8, <span class="number">0</span>, <span class="number">0x80000004</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0x80000301</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v12 )</span><br><span class="line">      <span class="built_in">sub_401440</span>(v12);</span><br><span class="line">    <span class="keyword">if</span> ( v9 )</span><br><span class="line">      <span class="built_in">sub_401440</span>(v9);</span><br><span class="line">    <span class="built_in">JUMPOUT</span>(<span class="number">0x40122D</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v13 = (<span class="type">void</span> *)((<span class="type">void</span> *(*)(<span class="type">int</span>, ...))sub_40144C)(<span class="number">1</span>, &amp;unk_48049D, <span class="number">0</span>, <span class="number">0x80000005</span>);</span><br><span class="line">  v5 = v13;</span><br><span class="line">  <span class="keyword">if</span> ( !v13 )</span><br><span class="line">    v5 = &amp;unk_4804BB;</span><br><span class="line">  v11 = (<span class="type">void</span> *)((<span class="type">void</span> *(*)(<span class="type">int</span>, ...))sub_401446)(<span class="number">1</span>, v5, <span class="number">0</span>, <span class="number">0x80000005</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v13 )</span><br><span class="line">    <span class="built_in">sub_401440</span>(v13);</span><br><span class="line">  v6 = v11;</span><br><span class="line">  <span class="keyword">if</span> ( !v11 )</span><br><span class="line">    v6 = &amp;unk_48049C;</span><br><span class="line">  ((<span class="built_in">void</span> (*)(<span class="type">int</span>, ...))sub_401446)(<span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, v6, <span class="number">0</span>, <span class="number">0x80000004</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v11 )</span><br><span class="line">    <span class="built_in">sub_401440</span>(v11);</span><br><span class="line">  <span class="keyword">if</span> ( lpMem )</span><br><span class="line">    <span class="built_in">sub_401440</span>(lpMem);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŠ¨è°ƒ+é™æ€çæä¸€é€š<br>sub_401446å‘ç°æ˜¯ç±»ä¼¼å›è°ƒå‡½æ•°è¿™ç§<br>ç„¶åå­¦åˆ°äº†ä¸€ä¸ªç‚¹: åœ¨æ±‡ç¼–ä¸­çœ‹å¯ä»¥çœ‹åˆ°å›è°ƒçš„å‡½æ•°!<br>ä»¥len&#x3D;38é‚£å„¿ä¸ºä¾‹:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">00401110</span>                 push    eax</span><br><span class="line">.text:<span class="number">00401111</span>                 push    <span class="number">1</span></span><br><span class="line">.text:<span class="number">00401116</span>                 mov     ebx, offset sub_401590</span><br><span class="line">.text:<span class="number">0040111B</span>                 call    sub_401446</span><br><span class="line">.text:<span class="number">00401120</span>                 add     esp, <span class="number">10</span>h</span><br><span class="line">.text:<span class="number">00401123</span>                 mov     [ebp+var_C], eax</span><br><span class="line">.text:<span class="number">00401126</span>                 jmp     <span class="type">short</span> loc_401129</span><br></pre></td></tr></table></figure>

<p>æ±‡ç¼–ä¸­å¯ä»¥çœ‹åˆ° mov     ebx, offset sub_401590<br>è¿™ä¸ªsub_401590å°±æ˜¯getså’Œstrlen!<br>æœ‰äº›å¸ˆå‚…çš„IDAç»™æ˜¾ç¤ºå‡ºæ¥äº† æˆ‘çš„æ˜¯æ²¡æ˜¾ç¤ºçš„ ä½†ä¹Ÿä¸æ˜¯å¾ˆå½±å“</p>
<p>è™½ç„¶ä½†æ˜¯ è¿™IDAå¥½å¤šè¯†åˆ«ä¸å¯¹å•Šâ€¦<br>èƒ½æ‰¾åˆ°encç‚¹ åœ¨è¿™é‡Œ</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sub_40144C</span>(<span class="number">3</span>, (<span class="type">char</span>)v3, <span class="number">0</span>, <span class="number">0x80000005</span>, v7, <span class="number">0</span>, <span class="number">0x80000004</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0x80000301</span>);<span class="comment">// enc</span></span><br></pre></td></tr></table></figure>

<p>è·Ÿè¿›æŸ¥çœ‹</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( v6 != <span class="number">1</span> )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">sub_45A100</span>(a2[<span class="number">3</span>], <span class="built_in">strlen</span>((<span class="type">const</span> <span class="type">char</span> *)a2[<span class="number">3</span>]), RC4_KEY);<span class="comment">// RC4é¢„å¤„ç†</span></span><br><span class="line">  v7 = <span class="built_in">malloc</span>(v5);</span><br><span class="line">  v13 = v7;</span><br><span class="line">  <span class="keyword">if</span> ( v7 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">qmemcpy</span>(v7, v4, v5);</span><br><span class="line">    v12 = v5;</span><br><span class="line">    <span class="built_in">sub_45A1D0</span>((<span class="type">int</span>)v7, v5, (<span class="type">int</span>)RC4_KEY);    <span class="comment">// ç±»RC4</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">goto</span> LABEL_21;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°±æ˜¯ä¸ªRC4 é¢„å¤„ç†å¯ä»¥ç›´æ¥åŠ¨è°ƒæå–å‡ºè¡¨<br>å…³é”®åœ¨äºæ‰¾åˆ°åŠ å¯†åçš„checkç‚¹ï¼<br>çœŸæ²¡æ‰¾åˆ°â€¦<br>çœ‹ç½‘ä¸Šå”¯ä¸€ä¸€ç¯‡wpä¹Ÿæ²¡å¤ç°æˆåŠŸ<br>å°±å…ˆå€Ÿæ•°æ®å§</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">enc = [0x56, 0xEC,</span><br><span class="line">	0xA0, 0xDC, 0x57, 0x07, 0xF4, 0xA3, 0xE9, 0x77, 0xBF, 0x93,</span><br><span class="line">	0xBC, 0x86, 0x52, 0xA5, 0x14, 0x6A, 0xA5, 0xBD, 0xB5, 0xD2,</span><br><span class="line">	0x7F, 0x0B, 0x9B, 0x67, 0x1D, 0x08, 0xEF, 0xC9, 0x32, 0x5D,</span><br><span class="line">	0x43, 0xED, 0x1E, 0x01, 0x4B, 0x7B]</span><br></pre></td></tr></table></figure>

<p>æœ€åè§£å‡º<br><strong>flag{08360c3f9f994e199427d9c7ed14ef23}</strong></p>
<hr>
<hr>
<p>IDAçç¿»è¿˜çœŸèƒ½ç¿»åˆ°â€¦<br>unk_4804C3å¤„å°±æ˜¯encæ•°ç»„</p>
<p>äº¤å‰å¼•ç”¨æ‰¾åˆ°å”¯ä¸€ä¸€å¤„</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">00401249</span></span><br><span class="line">.text:<span class="number">00401249</span> loc_401249:                             ; CODE XREF: sub_4010B0+<span class="number">196</span>â†‘j</span><br><span class="line">.text:<span class="number">00401249</span>                 mov     eax, offset unk_4804C3</span><br><span class="line">.text:<span class="number">0040124</span>E                 <span class="keyword">xor</span>     ecx, ecx</span><br><span class="line">.text:<span class="number">00401250</span>                 test    eax, eax</span><br><span class="line">.text:<span class="number">00401252</span>                 jz      <span class="type">short</span> loc_401257</span><br><span class="line">.text:<span class="number">00401254</span>                 mov     ecx, [eax+<span class="number">4</span>]</span><br></pre></td></tr></table></figure>

<p>ä½†è¿™å‰åä¹Ÿçœ‹ä¸å‡ºä»»ä½•checkçš„é€»è¾‘å•Šâ€¦<br>æ—¥åå†æ¥é€†å§â€¦</p>
<h1 id="è¥¿æ¹–è®ºå‰‘2022"><a href="#è¥¿æ¹–è®ºå‰‘2022" class="headerlink" title="è¥¿æ¹–è®ºå‰‘2022"></a>è¥¿æ¹–è®ºå‰‘2022</h1><h2 id="EasyVT"><a href="#EasyVT" class="headerlink" title="EasyVT"></a>EasyVT</h2><a href="/VT%E5%A4%84%E7%90%86%E5%99%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF%E5%AD%A6%E4%B9%A0/" title="VTå¤„ç†å™¨è™šæ‹ŸåŒ–æŠ€æœ¯å­¦ä¹ ">VT</a>

<h2 id="babyRe"><a href="#babyRe" class="headerlink" title="babyRe"></a>babyRe</h2><p>è€ƒç‚¹:<br>IATè¡¨hook + sha1 + base8 + RC4</p>
<p>å­¦ä¹ :</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://equinox-shame.github.io/2023/03/01/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91%20BabyRe%20%E5%A4%8D%E7%8E%B0/#">+</a></li>
<li><a target="_blank" rel="noopener" href="https://www.ctfiot.com/97742.html">++</a></li>
</ul>
<p>å¼€å±€ä¸€ä¸ªå¥‡å¥‡æ€ªæ€ªçš„main åªè°ƒç”¨äº†ä¸€ä¸ªGetLastError<br>ç¿»stringè·Ÿè¸ªinput èƒ½æ‰¾åˆ°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.rdata:<span class="number">00406164</span>                 dd offset sub_401000</span><br><span class="line">.rdata:<span class="number">00406168</span>                 dd offset sub_401050</span><br><span class="line">.rdata:<span class="number">0040616</span>C                 dd offset sub_4010A0</span><br></pre></td></tr></table></figure>

<p>æ¯ä¸ªé‡Œé¢éƒ½æ˜¯å…ˆè°ƒç”¨ä¸€ä¸ªå‡½æ•° ç„¶ååœ¨atexité‡Œåˆè°ƒç”¨å¦ä¸€ä¸ªå‡½æ•°<br>çŒœæµ‹atexitçš„é¡ºåºæ˜¯æ ˆ ä¹Ÿå°±æ˜¯è¿™ä¸‰ä¸ªå‡½æ•°çš„ç¬¬ä¸€ä¸ªè°ƒç”¨å®Œäº†åå†ä»é‡Œåˆ°å¤–è°ƒç”¨atexit<br>åœ¨è¿™3*2+mainè¿™7ä¸ªå‡½æ•°ä¸‹æ–­ç‚¹<br>é¡ºåº:<br>1170-&gt;1230-&gt;12B0-&gt;main-&gt;1670 å› ä¸ºä¸ç¬¦åˆcheckç›´æ¥é€€äº† ä½†ä¹Ÿèƒ½å°è¯çŒœæµ‹ æ‰€ä»¥<br>1170-&gt;1230-&gt;12B0-&gt;main-&gt;1670-&gt;15C0-&gt;10E0<br>æŒ¨ä¸ªçœ‹<br>1170:<br>input and check is_digit</p>
<p>1230:<br>set table</p>
<p>12B0:<br>é‡ç‚¹!<br><img src="https://s2.loli.net/2024/01/24/wjebRFKkmsa3dL7.png" alt="IAT_HOOK.png"></p>
<p>ä¹Ÿå°±æ˜¯è¯´è¿™é‡ŒæŠŠIATè¡¨ä¸­GetLastErroræ›¿æ¢æˆäº†sub_4019D0<br>æ‰€ä»¥æ¥ä¸‹æ¥çš„mainç›¸å½“äºè°ƒç”¨sub_4019D0</p>
<p>è¿™é‡Œçš„åˆ†ææ˜¯å¯ä»¥é€šè¿‡LoadLibraryå’Œâ€GetLastErrorâ€ä»¥åŠå¯¹åº”æŒ‡é’ˆçš„æ›¿æ¢çœ‹å‡ºæ¥çš„(åšé¢˜è§’åº¦å¹¶ä¸ä¸€å®šè¦åˆ†æåˆ°IATè¿™ä¹ˆå‡†ç¡®)</p>
<p>19D0:<br>è¦†ç›–sha1çš„å¸¸é‡å€¼</p>
<p>1670:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">sub_401670</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_4090A2);</span><br><span class="line">  <span class="built_in">sub_401720</span>(INPUT, (<span class="type">int</span>)&amp;unk_4081C0);          <span class="comment">// base8</span></span><br><span class="line">  result = <span class="built_in">memcmp</span>(&amp;unk_4081D0, a16230465152334, <span class="number">0x60</span>u);<span class="comment">// base8åŠ å¯†åçš„encçš„[16:] è¯´æ˜å‰6ä½flagæœªçŸ¥</span></span><br><span class="line">  <span class="keyword">if</span> ( result )</span><br><span class="line">    <span class="built_in">ExitProcess</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯¹input base8åŠ å¯†<br>æ³¨æ„åˆ°encæ˜¯å­˜å…¥&amp;4081C0 è€Œåé¢çš„checkæ˜¯&amp;4081D0å¼€å§‹çš„0x60ä¸ª<br>æ‰€ä»¥encçš„[:16]æ˜¯æ²¡æœ‰éªŒè¯çš„ å¯¹åº”å°±æ˜¯Input[:6]æ˜¯ä¸çŸ¥é“çš„ (base8 ptå’Œctçš„bitå…³ç³»: 3-&gt;8)</p>
<p>15C0:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">sub_4015C0</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_4090A2);</span><br><span class="line">  <span class="built_in">sha1_sub_401CC0</span>((<span class="type">int</span>)&amp;unk_4081C0, <span class="number">112</span>, <span class="number">0</span>, Buffer);<span class="comment">// å¯¹base8åŠ å¯†çš„enc[:16] sha1 </span></span><br><span class="line">  result = <span class="built_in">memcmp</span>(Buffer, a67339fc92b4875, <span class="number">0x28</span>u);<span class="comment">// 67339fc92b4875b8c073c76994ef1ca4ce632d26 è¿™é‡Œèƒ½è¿˜åŸflag[:6]</span></span><br><span class="line">  <span class="keyword">if</span> ( result )</span><br><span class="line">    <span class="built_in">ExitProcess</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sha1<br>æ³¨æ„è¿™é‡Œä»&amp;4081C0å¼€å§‹å–112ä¸ªå­—ç¬¦ ä¹Ÿå°±æ˜¯base8åŠ å¯†åçš„enc[:112]<br>æ‰€ä»¥æ˜¯å¯ä»¥é€šè¿‡è¿™é‡Œè¿˜åŸflag[:6] åªæ˜¯sha1æ˜¯é­”æ”¹è¿‡çš„â€¦</p>
<p>14E0:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">sub_4014E0</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> v1; <span class="comment">// [esp+0h] [ebp-E8h]</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_4090A2);</span><br><span class="line">  <span class="built_in">memcpy</span>(&amp;unk_4084C0, &amp;unk_4081C0, <span class="number">0x70</span>u);</span><br><span class="line">  <span class="built_in">sub_401B60</span>(&amp;unk_4083C0, &amp;unk_408182, <span class="number">6</span>);      <span class="comment">// RC4 inputä»408158å¼€å§‹ è¿™é‡Œçš„RC4keyå°±å–çš„æ˜¯flagçš„æœ€å6ä½</span></span><br><span class="line">  <span class="built_in">sub_401A40</span>(&amp;unk_4083C0, &amp;unk_4084C0, <span class="number">112</span>);    <span class="comment">// 4084C0å–çš„æ˜¯base8åŠ å¯†çš„encçš„å‰112ä¸ªå­—ç¬¦</span></span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">memcmp</span>(&amp;unk_4084C0, &amp;unk_408090, <span class="number">0x70</span>u) )</span><br><span class="line">    <span class="built_in">ExitProcess</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">sub_4025A0</span>(<span class="string">&quot;Good, flag is DASCTF&#123;your input&#125;&quot;</span>, v1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‰é¢çš„inputæ˜¯é‡å‘½åè¿‡çš„ çœŸå®åœ°å€æ˜¯408158 å¯ä»¥å¤§è‡´ç®—ç®—å‰é¢ä¸€å…±å¾—åˆ°äº†6+36&#x3D;42&#x3D;2Ahçš„flag<br>åˆšå¥½58+2A&#x3D;82 æ‰€ä»¥è¿™é‡Œå°±æ˜¯å–å¾—flagæœ«6ä½ä½œä¸ºRC4çš„key ç„¶åå–base8åŠ å¯†enc[:112]</p>
<p>æ•´ä½“åˆ†æå®Œäº† æ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•é€†å‘<br>flag[6:-6]å¯ä»¥ç›´æ¥<a target="_blank" rel="noopener" href="https://try8.cn/tool/code/base8#google_vignette">åœ¨çº¿ç½‘ç«™</a>è§£base8<br>æ³¨æ„åˆ°flag[-6:]æ˜¯ä½œä¸ºkey  é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çˆ†ç ´è¿™ä¸ªkey æ ¹æ®å¯†æ–‡åè§£RC4åŒæ—¶check is_digitæ¥ç­›é€‰key<br>ç†è®ºä¸Škeyçš„å¯èƒ½å€¼åº”è¯¥å°±ä¸å¤šäº† ç„¶åç»“åˆRC4è¿˜åŸçš„æ˜æ–‡ä¸flag[6:-6]æ¯”è¾ƒ å› ä¸º112-&gt;42 æ‰€ä»¥RC4è¿˜åŸçš„åº”è¯¥å¤šå‡ºå‰6ä½<br>é‚£ä¹ˆRC4_DEC+keyå°±æ˜¯flagäº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">0x3F</span>, <span class="number">0x95</span>, <span class="number">0xBB</span>, <span class="number">0xF2</span>, <span class="number">0x57</span>, <span class="number">0xF1</span>, <span class="number">0x7A</span>, <span class="number">0x5A</span>, <span class="number">0x22</span>, <span class="number">0x61</span>, <span class="number">0x51</span>, <span class="number">0x43</span>, <span class="number">0xA2</span>, <span class="number">0xFA</span>, <span class="number">0x9B</span>, <span class="number">0x6F</span>, <span class="number">0x44</span>, <span class="number">0x63</span>, <span class="number">0xC0</span>, <span class="number">0x08</span>, <span class="number">0x12</span>, <span class="number">0x65</span>, <span class="number">0x5C</span>, <span class="number">0x8A</span>, <span class="number">0x8C</span>, <span class="number">0x4C</span>, <span class="number">0xED</span>, <span class="number">0x5E</span>, <span class="number">0xCA</span>, <span class="number">0x76</span>, <span class="number">0xB9</span>, <span class="number">0x85</span>, <span class="number">0xAF</span>, <span class="number">0x05</span>, <span class="number">0x38</span>, <span class="number">0xED</span>, <span class="number">0x42</span>, <span class="number">0x3E</span>, <span class="number">0x42</span>, <span class="number">0xDF</span>, <span class="number">0x5D</span>, <span class="number">0xBE</span>, <span class="number">0x05</span>, <span class="number">0x8B</span>, <span class="number">0x35</span>, <span class="number">0x6D</span>, <span class="number">0xF3</span>, <span class="number">0x1C</span>, <span class="number">0xCF</span>, <span class="number">0xF8</span>, <span class="number">0x6A</span>, <span class="number">0x73</span>, <span class="number">0x25</span>, <span class="number">0xE4</span>, <span class="number">0xB7</span>, <span class="number">0xB9</span>, <span class="number">0x36</span>, <span class="number">0xFB</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0xA0</span>, <span class="number">0xF0</span>, <span class="number">0x57</span>, <span class="number">0xAB</span>, <span class="number">0x21</span>, <span class="number">0xC6</span>, <span class="number">0xC7</span>, <span class="number">0x46</span>, <span class="number">0x99</span>, <span class="number">0xBD</span>, <span class="number">0x1E</span>, <span class="number">0x61</span>, <span class="number">0x5E</span>, <span class="number">0xEE</span>, <span class="number">0x55</span>, <span class="number">0x18</span>, <span class="number">0xEE</span>, <span class="number">0x03</span>, <span class="number">0x29</span>, <span class="number">0x84</span>, <span class="number">0x7F</span>, <span class="number">0x94</span>, <span class="number">0x5F</span>, <span class="number">0xB4</span>, <span class="number">0x6A</span>, <span class="number">0x29</span>, <span class="number">0xD8</span>, <span class="number">0x6C</span>, <span class="number">0xE4</span>, <span class="number">0xC0</span>, <span class="number">0x9D</span>, <span class="number">0x6B</span>, <span class="number">0xCC</span>, <span class="number">0xD5</span>, <span class="number">0x94</span>, <span class="number">0x5C</span>, <span class="number">0xDD</span>, <span class="number">0xCC</span>, <span class="number">0xD5</span>, <span class="number">0x3D</span>, <span class="number">0xC0</span>, <span class="number">0xEF</span>, <span class="number">0x0C</span>, <span class="number">0x29</span>, <span class="number">0xE5</span>, <span class="number">0xB0</span>, <span class="number">0x93</span>, <span class="number">0xF1</span>, <span class="number">0xB3</span>, <span class="number">0xDE</span>, <span class="number">0xB0</span>, <span class="number">0x70</span>]</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ARC4</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">1000000</span>):</span><br><span class="line">    rc4 = ARC4.new(<span class="built_in">str</span>(i).zfill(<span class="number">6</span>).encode())</span><br><span class="line">    pt = rc4.decrypt(<span class="built_in">bytes</span>(enc))</span><br><span class="line">    <span class="keyword">if</span> pt.isdigit():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;key = &quot;</span>,i)</span><br><span class="line">        <span class="built_in">print</span>(pt)</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°key&#x3D;807391 å¯¹åº”RC4_DEC&#x3D;561516915572239428449843076691286116796614 æ‹¼æ¥å¾—åˆ°flag<br><strong>DASCTF{561516915572239428449843076691286116796614807391}</strong></p>
<h2 id="DualPersonality"><a href="#DualPersonality" class="headerlink" title="DualPersonality"></a>DualPersonality</h2><p>å‚è€ƒ:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.fup1p1.cn/archives/reverse2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91%E5%A4%8D%E7%8E%B0">+</a></li>
</ul>
<p>32ä½å’Œ64ä½çš„åˆ‡æ¢ å¤©å ‚ä¹‹é—¨<br>ç›´æ¥é™æ€nopæ‰0æ•°æ®åF5<br>main:<br><img src="/Reverse-Other/images/image.png" alt="main"></p>
<p>å¯ä»¥çœ‹å‡ºå¼€å§‹ä½œäº†ä¸€ä¸ªxoråŠ å¯† åªæ˜¯è¿™é‡Œçš„v3æˆ‘ä¸€ç›´æ‰¾ä¸åˆ° é™æ€&#x2F;åŠ¨è°ƒéƒ½æ‰¾ä¸å‡ºæ¥â€¦<br>ç»§ç»­çœ‹æ±‡ç¼–<br><img src="/Reverse-Other/images/image-1.png" alt="401455"><br><img src="/Reverse-Other/images/image-2.png" alt="40700C"></p>
<p>ç›¸å½“äºæ˜¯è°ƒç”¨äº†401200å¤„<br><img src="/Reverse-Other/images/image-3.png" alt="401200"></p>
<p>è¿™é‡Œæ˜¯å› ä¸ºæˆ‘ç”¨çš„32åˆ†ææ‰€ä»¥æ˜¯ROL4 ä½†è¿™é‡Œæ˜¯64ä½çš„ æ‰€ä»¥åº”è¯¥æ˜¯ROL8 ä½†ä¸å½±å“ çŸ¥é“æ˜¯ç®—æœ¯å·¦ç§»å°±è¡Œ ç„¶å64ä½åº”è¯¥èµ°elseåˆ†æ”¯</p>
<p>ç„¶åmainä¸‹é¢çš„<code>if ( !sub_401120(7u, (int)&amp;loc_401290) )</code><br>è°ƒç”¨äº†<br><img src="/Reverse-Other/images/image-4.png" alt="401290"></p>
<p>è¦æ³¨æ„åˆ°è¿™é‡Œçš„407014æ˜¯åé¢æœ€åä¸€æ¬¡åŠ å¯†çš„keyå€¼</p>
<p>ç„¶åå°±æ˜¯æœ€åä¸€æ¬¡åŠ å¯† ç®€å•çš„xor keyæ˜¯ç»è¿‡ä¸Šé¢å‡½æ•°ä¿®æ”¹åçš„</p>
<p>ç¨‹åºå¤šæ¬¡åˆ‡æ¢32&#x2F;64 æ‰€ä»¥æ•°æ®å¤„ç†è¦æ³¨æ„!!! ä¸€å®šè¦zfill(2)å•Šå•Šå•Šï¼ï¼ï¼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># exp ... éš¾ç»·</span></span><br><span class="line">enc = [<span class="number">0xAA</span>, <span class="number">0x4F</span>, <span class="number">0x0F</span>, <span class="number">0xE2</span>, <span class="number">0xE4</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x54</span>, <span class="number">0x2C</span>, <span class="number">0x2B</span>, <span class="number">0x84</span>, <span class="number">0x7E</span>, <span class="number">0xBC</span>, <span class="number">0x8F</span>, <span class="number">0x8B</span>, <span class="number">0x78</span>, <span class="number">0xD3</span>, <span class="number">0x73</span>, <span class="number">0x88</span>, <span class="number">0x5E</span>, <span class="number">0xAE</span>, <span class="number">0x47</span>, <span class="number">0x85</span>, <span class="number">0x70</span>, <span class="number">0x31</span>, <span class="number">0xB3</span>,<span class="number">0x09</span>, <span class="number">0xCE</span>, <span class="number">0x13</span>, <span class="number">0xF5</span>, <span class="number">0x0D</span>, <span class="number">0xCA</span>]</span><br><span class="line">key = [<span class="number">0x9D</span>,<span class="number">0x44</span>,<span class="number">0x37</span>,<span class="number">0xB5</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encodekey</span>():</span><br><span class="line">    key[<span class="number">0</span>] &amp;= key[<span class="number">1</span>]</span><br><span class="line">    key[<span class="number">1</span>] |= key[<span class="number">2</span>]</span><br><span class="line">    key[<span class="number">2</span>] ^= key[<span class="number">3</span>]</span><br><span class="line">    key[<span class="number">3</span>] = (~key[<span class="number">3</span>])&amp;<span class="number">0xff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec1</span>(): <span class="comment"># decode enc4</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        enc[i] ^= key[i%<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ROR</span>(<span class="params">x,n</span>):</span><br><span class="line">    <span class="keyword">return</span> (x&gt;&gt;n|(x&lt;&lt;(<span class="number">64</span>-n)))&amp;<span class="number">0xffffffffffffffff</span> </span><br><span class="line">    </span><br><span class="line">encodekey()</span><br><span class="line">dec1()</span><br><span class="line">s = []</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> enc:</span><br><span class="line">    s.append(<span class="built_in">hex</span>(c)[<span class="number">2</span>:].zfill(<span class="number">2</span>)) <span class="comment"># !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span></span><br><span class="line">enc = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    ss = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        ss += s[i*<span class="number">8</span>+<span class="number">7</span>-j]</span><br><span class="line">    enc.append(ss)</span><br><span class="line">enc = [<span class="built_in">int</span>(x,<span class="number">16</span>) <span class="keyword">for</span> x <span class="keyword">in</span> enc]</span><br><span class="line">enc[<span class="number">0</span>] = ROR(enc[<span class="number">0</span>],<span class="number">12</span>)</span><br><span class="line">enc[<span class="number">1</span>] = ROR(enc[<span class="number">1</span>],<span class="number">34</span>)</span><br><span class="line">enc[<span class="number">2</span>] = ROR(enc[<span class="number">2</span>],<span class="number">56</span>)</span><br><span class="line">enc[<span class="number">3</span>] = ROR(enc[<span class="number">3</span>],<span class="number">14</span>)</span><br><span class="line">final_enc = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    x = enc[i]&amp;<span class="number">0x00000000ffffffff</span></span><br><span class="line">    final_enc.append(x)</span><br><span class="line">    x = enc[i]&amp;<span class="number">0xffffffff00000000</span></span><br><span class="line">    x &gt;&gt;= <span class="number">32</span></span><br><span class="line">    final_enc.append(x)</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">v3 = <span class="number">0x5DF966AE</span></span><br><span class="line">d = v3 - <span class="number">0x21524111</span></span><br><span class="line">pt = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    d &amp;= <span class="number">0xffffffff</span></span><br><span class="line">    pt.append((final_enc[i]-d)&amp;<span class="number">0xffffffff</span>)</span><br><span class="line">    d ^= final_enc[i]</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] ANS&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> pt:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(c).decode()[::-<span class="number">1</span>],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="built_in">print</span>()</span><br></pre></td></tr></table></figure>

<p><strong>DASCTF{6cc1e44811647d38a15017e389b3f704}</strong></p>
<h1 id="æœªçŸ¥æ¥æº"><a href="#æœªçŸ¥æ¥æº" class="headerlink" title="æœªçŸ¥æ¥æº"></a>æœªçŸ¥æ¥æº</h1><h2 id="ctfshow-reverse-æ¯”èµ›åŸé¢˜-snake"><a href="#ctfshow-reverse-æ¯”èµ›åŸé¢˜-snake" class="headerlink" title="ctfshow-reverse-æ¯”èµ›åŸé¢˜-snake"></a>ctfshow-reverse-æ¯”èµ›åŸé¢˜-snake</h2><p>pyåç¼–è¯‘</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.9.0</span></span><br><span class="line"><span class="comment"># Python bytecode version base 3.7.0 (3394)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 3.6.12 (default, Feb  9 2021, 09:19:15) </span></span><br><span class="line"><span class="comment"># [GCC 8.3.0]</span></span><br><span class="line"><span class="comment"># Embedded file name: snake.py</span></span><br><span class="line"><span class="keyword">import</span> hashlib, sys, random, time</span><br><span class="line">maze = [</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">9</span>]]</span><br><span class="line">s = <span class="built_in">str</span>(<span class="built_in">input</span>())</span><br><span class="line">seed = time.time()</span><br><span class="line">random.seed(seed)</span><br><span class="line">random.seed(random.randint(<span class="number">0</span>, <span class="number">999999</span>))</span><br><span class="line">maze[<span class="number">1</span>][<span class="number">1</span>] = random.randint(<span class="number">987</span>, <span class="number">1000</span>)</span><br><span class="line">maze[<span class="number">3</span>][<span class="number">4</span>] = random.randint(<span class="number">345</span>, <span class="number">356</span>)</span><br><span class="line">maze[<span class="number">7</span>][<span class="number">7</span>] = random.randint(<span class="number">107</span>, <span class="number">116</span>)</span><br><span class="line">maze[<span class="number">11</span>][<span class="number">8</span>] = random.randint(<span class="number">833</span>, <span class="number">856</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        tmp = <span class="number">12</span> * i + j</span><br><span class="line">        <span class="keyword">if</span> maze[i][j] == <span class="number">0</span>:</span><br><span class="line">            maze[i][j] = <span class="number">3456</span> + tmp</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> tmp % <span class="number">4</span> == <span class="number">0</span>:</span><br><span class="line">            random.seed(maze[<span class="number">1</span>][<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">for</span> cnt <span class="keyword">in</span> <span class="built_in">range</span>(tmp):</span><br><span class="line">                random.randint(<span class="number">0</span>, <span class="number">999</span>)</span><br><span class="line"></span><br><span class="line">            maze[i][j] = random.randint(<span class="number">0</span>, <span class="number">999</span>)</span><br><span class="line">        <span class="keyword">elif</span> tmp % <span class="number">4</span> == <span class="number">1</span>:</span><br><span class="line">            random.seed(maze[<span class="number">3</span>][<span class="number">4</span>])</span><br><span class="line">            <span class="keyword">for</span> cnt <span class="keyword">in</span> <span class="built_in">range</span>(tmp):</span><br><span class="line">                random.randint(<span class="number">555</span>, <span class="number">1234</span>)</span><br><span class="line"></span><br><span class="line">            maze[i][j] = random.randint(<span class="number">555</span>, <span class="number">1234</span>)</span><br><span class="line">        <span class="keyword">elif</span> tmp % <span class="number">4</span> == <span class="number">2</span>:</span><br><span class="line">            random.seed(maze[<span class="number">7</span>][<span class="number">7</span>])</span><br><span class="line">            <span class="keyword">for</span> cnt <span class="keyword">in</span> <span class="built_in">range</span>(tmp):</span><br><span class="line">                random.randint(<span class="number">777</span>, <span class="number">888</span>)</span><br><span class="line"></span><br><span class="line">            maze[i][j] = random.randint(<span class="number">777</span>, <span class="number">888</span>)</span><br><span class="line">        <span class="keyword">elif</span> tmp % <span class="number">4</span> == <span class="number">3</span>:</span><br><span class="line">            random.seed(maze[<span class="number">11</span>][<span class="number">8</span>])</span><br><span class="line">            <span class="keyword">for</span> cnt <span class="keyword">in</span> <span class="built_in">range</span>(tmp):</span><br><span class="line">                random.randint(<span class="number">369</span>, <span class="number">777</span>)</span><br><span class="line"></span><br><span class="line">            maze[i][j] = random.randint(<span class="number">369</span>, <span class="number">777</span>)</span><br><span class="line"></span><br><span class="line">maze[<span class="number">11</span>][<span class="number">11</span>] = <span class="number">9</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(s) != <span class="number">56</span>:</span><br><span class="line">    sys.exit(-<span class="number">1</span>)</span><br><span class="line">idx1 = <span class="number">0</span></span><br><span class="line">idx2 = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="string">&#x27;w&#x27;</span>:</span><br><span class="line">        idx1 -= <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">            idx1 += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> i == <span class="string">&#x27;a&#x27;</span>:</span><br><span class="line">                idx2 -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> i == <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">                    idx2 += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="number">0</span> &lt;= maze[idx1][idx2] &lt;= <span class="number">1234</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Where are you going?&#x27;</span>)</span><br><span class="line">        sys.exit(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> maze[idx1][idx2] != <span class="number">9</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;You lost in the maze!&#x27;</span>)</span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> xx <span class="keyword">in</span> maze:</span><br><span class="line">    <span class="keyword">for</span> xxx <span class="keyword">in</span> xx:</span><br><span class="line">        result += <span class="built_in">str</span>(xxx)</span><br><span class="line"></span><br><span class="line">hash_res = hashlib.sha256(result.encode(<span class="string">&#x27;latin-1&#x27;</span>)).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(hash_res)</span><br><span class="line"><span class="keyword">if</span> hash_res == <span class="string">&#x27;f1793dcf5ad3858512b944ac34413725a27c63e25618858231e88b9686466b00&#x27;</span>:</span><br><span class="line">    flag1 = <span class="built_in">str</span>(maze[<span class="number">1</span>][<span class="number">1</span>]) + <span class="built_in">str</span>(maze[<span class="number">7</span>][<span class="number">7</span>]) + <span class="built_in">str</span>(maze[<span class="number">11</span>][<span class="number">8</span>]) + <span class="built_in">str</span>(maze[<span class="number">3</span>][<span class="number">4</span>])</span><br><span class="line">    flag2 = hashlib.sha256(s.encode(<span class="string">&#x27;latin-1&#x27;</span>)).hexdigest()</span><br><span class="line">    flag = flag2[::-<span class="number">1</span>] + flag1[::-<span class="number">1</span>]</span><br><span class="line">    final_flag = hashlib.sha256(flag.encode(<span class="string">&#x27;latin-1&#x27;</span>)).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;flag&#123;&#x27;</span> + final_flag[<span class="number">0</span>:<span class="number">32</span>] + <span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>çœ‹ç€è²Œä¼¼éšæœºå¾ˆå¤š ä½†æ˜¯å‘ç°å¥½å¤šseedæ²¡ç”¨ æœ‰ç”¨çš„seedå°±æ˜¯maze[1][1]&#x2F;maze[7][7]&#x2F;maze[11][8]&#x2F;maze[3][4]<br>é¢˜ç›®ç»™äº†èŒƒå›´æšä¸¾çˆ†ç ´å³å¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">987</span>,<span class="number">1001</span>):</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> trange(<span class="number">345</span>,<span class="number">357</span>):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">107</span>,<span class="number">117</span>):</span><br><span class="line">            <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">833</span>,<span class="number">857</span>):</span><br><span class="line">                        maze = [</span><br><span class="line">                            [</span><br><span class="line">                            ]</span><br><span class="line">                        ]</span><br><span class="line">                        _ += <span class="number">1</span></span><br><span class="line">                        <span class="comment"># print(_)</span></span><br><span class="line">                        seed = time.time()</span><br><span class="line">                        random.seed(seed)</span><br><span class="line">                        random.seed(random.randint(<span class="number">0</span>, <span class="number">999999</span>))</span><br><span class="line">                        maze[<span class="number">1</span>][<span class="number">1</span>] = a</span><br><span class="line">                        maze[<span class="number">3</span>][<span class="number">4</span>] = b</span><br><span class="line">                        maze[<span class="number">7</span>][<span class="number">7</span>] = c</span><br><span class="line">                        maze[<span class="number">11</span>][<span class="number">8</span>] = d</span><br><span class="line">                        ...</span><br><span class="line">                        maze[<span class="number">11</span>][<span class="number">11</span>] = <span class="number">9</span></span><br><span class="line">                        <span class="comment"># print(maze)</span></span><br><span class="line">                        result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                        <span class="keyword">for</span> xx <span class="keyword">in</span> maze:</span><br><span class="line">                            <span class="keyword">for</span> xxx <span class="keyword">in</span> xx:</span><br><span class="line">                                result += <span class="built_in">str</span>(xxx)</span><br><span class="line"></span><br><span class="line">                        hash_res = hashlib.sha256(result.encode(<span class="string">&#x27;latin-1&#x27;</span>)).hexdigest()</span><br><span class="line">                        <span class="keyword">if</span> hash_res == <span class="string">&#x27;f1793dcf5ad3858512b944ac34413725a27c63e25618858231e88b9686466b00&#x27;</span>:</span><br><span class="line">                            <span class="built_in">print</span>(maze)</span><br><span class="line">                            exit()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">maze = [[<span class="number">937</span>, <span class="number">3457</span>, <span class="number">3458</span>, <span class="number">3459</span>, <span class="number">3460</span>, <span class="number">3461</span>, <span class="number">3462</span>, <span class="number">3463</span>, <span class="number">3464</span>, <span class="number">3465</span>, <span class="number">3466</span>, <span class="number">3467</span>], [<span class="number">360</span>, <span class="number">671</span>, <span class="number">3470</span>, <span class="number">3471</span>, <span class="number">954</span>, <span class="number">741</span>, <span class="number">815</span>, <span class="number">3475</span>, <span class="number">3476</span>, <span class="number">3477</span>, <span class="number">3478</span>, <span class="number">3479</span>], [<span class="number">3480</span>, <span class="number">1232</span>, <span class="number">836</span>, <span class="number">3483</span>, <span class="number">934</span>, <span class="number">3485</span>, <span class="number">886</span>, <span class="number">588</span>, <span class="number">487</span>, <span class="number">830</span>, <span class="number">3490</span>, <span class="number">3491</span>], [<span class="number">3492</span>, <span class="number">3493</span>, <span class="number">854</span>, <span class="number">696</span>, <span class="number">744</span>, <span class="number">3497</span>, <span class="number">3498</span>, <span class="number">3499</span>, <span class="number">3500</span>, <span class="number">1066</span>, <span class="number">3502</span>, <span class="number">3503</span>], [<span class="number">3504</span>, <span class="number">3505</span>, <span class="number">3506</span>, <span class="number">3507</span>, <span class="number">3508</span>, <span class="number">3509</span>, <span class="number">781</span>, <span class="number">447</span>, <span class="number">677</span>, <span class="number">598</span>, <span class="number">3514</span>, <span class="number">3515</span>], [<span class="number">3516</span>, <span class="number">3517</span>, <span class="number">3518</span>, <span class="number">3519</span>, <span class="number">3520</span>, <span class="number">3521</span>, <span class="number">793</span>, <span class="number">3523</span>, <span class="number">3524</span>, <span class="number">3525</span>, <span class="number">3526</span>, <span class="number">3527</span>], [<span class="number">3528</span>, <span class="number">580</span>, <span class="number">787</span>, <span class="number">622</span>, <span class="number">63</span>, <span class="number">3533</span>, <span class="number">861</span>, <span class="number">618</span>, <span class="number">269</span>, <span class="number">1118</span>, <span class="number">791</span>, <span class="number">3539</span>], [<span class="number">3540</span>, <span class="number">993</span>, <span class="number">3542</span>, <span class="number">3543</span>, <span class="number">665</span>, <span class="number">3545</span>, <span class="number">3546</span>, <span class="number">400</span>, <span class="number">3548</span>, <span class="number">3549</span>, <span class="number">807</span>, <span class="number">3551</span>], [<span class="number">3552</span>, <span class="number">650</span>, <span class="number">3554</span>, <span class="number">3555</span>, <span class="number">297</span>, <span class="number">3557</span>, <span class="number">3558</span>, <span class="number">3559</span>, <span class="number">3560</span>, <span class="number">801</span>, <span class="number">845</span>, <span class="number">3563</span>], [<span class="number">3564</span>, <span class="number">1222</span>, <span class="number">872</span>, <span class="number">3567</span>, <span class="number">298</span>, <span class="number">1072</span>, <span class="number">827</span>, <span class="number">640</span>, <span class="number">847</span>, <span class="number">1046</span>, <span class="number">3574</span>, <span class="number">3575</span>], [<span class="number">3576</span>, <span class="number">3577</span>, <span class="number">817</span>, <span class="number">599</span>, <span class="number">3580</span>, <span class="number">3581</span>, <span class="number">3582</span>, <span class="number">3583</span>, <span class="number">3584</span>, <span class="number">3585</span>, <span class="number">3586</span>, <span class="number">3587</span>], [<span class="number">3588</span>, <span class="number">3589</span>, <span class="number">3590</span>, <span class="number">506</span>, <span class="number">926</span>, <span class="number">1161</span>, <span class="number">853</span>, <span class="number">687</span>, <span class="number">440</span>, <span class="number">1026</span>, <span class="number">860</span>, <span class="number">9</span>]]</span><br></pre></td></tr></table></figure>

<p>ç„¶åC++å†™ä¸ªdfsè·‘å°±å¾—äº†</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> a[<span class="number">100</span>][<span class="number">100</span>];</span><br><span class="line"><span class="type">int</span> dx[<span class="number">4</span>]=&#123;<span class="number">1</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">int</span> dy[<span class="number">4</span>]=&#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">-1</span>&#125;;</span><br><span class="line"><span class="type">char</span> ccc[<span class="number">4</span>]=&#123;<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,<span class="string">&#x27;a&#x27;</span>&#125;;</span><br><span class="line"><span class="type">int</span> vis[<span class="number">13</span>][<span class="number">13</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,string jl,<span class="type">int</span> cnt)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(x==<span class="number">12</span>&amp;&amp;y==<span class="number">12</span>&amp;&amp;cnt==<span class="number">56</span>)&#123;</span><br><span class="line">		cout&lt;&lt;<span class="string">&quot;[+] Find! \n&quot;</span>;</span><br><span class="line">		cout&lt;&lt;jl&lt;&lt;<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">		<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)&#123;</span><br><span class="line">		<span class="type">int</span> nx=x+dx[i],ny=y+dy[i];</span><br><span class="line">		<span class="keyword">if</span>(nx&gt;=<span class="number">1</span>&amp;&amp;nx&lt;=<span class="number">12</span>&amp;&amp;ny&gt;=<span class="number">1</span>&amp;&amp;ny&lt;=<span class="number">12</span>&amp;&amp;a[nx][ny]&lt;=<span class="number">1234</span>&amp;&amp;!vis[nx][ny])&#123;</span><br><span class="line">			vis[nx][ny]=<span class="number">1</span>;</span><br><span class="line">			<span class="built_in">dfs</span>(nx,ny,jl+ccc[i],cnt+<span class="number">1</span>);</span><br><span class="line">			vis[nx][ny]=<span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ma[<span class="number">1006</span>]=&#123;...&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">12</span>;i++)</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=<span class="number">12</span>;j++)</span><br><span class="line">			a[i][j] = ma[(i<span class="number">-1</span>)*<span class="number">12</span>+j<span class="number">-1</span>];</span><br><span class="line">	<span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="string">&quot;&quot;</span>,<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è·¯å¾„:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s = sdsdsddwwddsdddssaaassddddssasaaaaawwwaaasssdsdsdddddddd</span><br></pre></td></tr></table></figure>

<p>æœ€åflag<br><strong>flag{e1df25dac4906584fe2d6f155b60e233}</strong></p>
<h2 id="NSSCTF-2022-Spring-Recruit-easy-Pe"><a href="#NSSCTF-2022-Spring-Recruit-easy-Pe" class="headerlink" title="[NSSCTF 2022 Spring Recruit]easy Pe"></a>[NSSCTF 2022 Spring Recruit]easy Pe</h2><p>2024å¹´åšçš„ç¬¬ä¸€é“é€†å‘é¢˜~<br>è™½è¯´æœ‰æ¥æº ä½†æ˜¯æ‡’å¾—æ–°å»ºåˆ†ç±»äº†</p>
<p>è¿™é¢˜æŒºæœ‰æ„æ€çš„ ç”¨CFFEXPLOERERçœ‹å¯ä»¥çœ‹åˆ°æœ‰t.exeä»¥å¤–çš„resource<br>ç‚¹å‡»è¿è¡Œexeå¯ä»¥å‘ç°åœ¨æ‰§è¡Œcmdshellä¹‹å‰æœ‰ä¸€ä¸ªçŸ­æš‚çš„guiç•Œé¢</p>
<p>IDAæ‰“å¼€exe<br>WinMainçš„341è¡Œå¯ä»¥æ‰¾åˆ°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sub_401A18</span>(&amp;lpText, v37);</span><br><span class="line">StartupInfo.dwXCountChars = <span class="number">0</span>;</span><br><span class="line">StartupInfo.dwYCountChars = <span class="number">1</span>;</span><br><span class="line">StartupInfo.hStdError = <span class="number">0</span>;</span><br><span class="line">StartupInfo.dwYSize = v50 != <span class="number">0</span> ? (DWORD)lpText : <span class="number">0</span>;</span><br><span class="line"><span class="built_in">ShellExecuteExA</span>((SHELLEXECUTEINFOA *)&amp;StartupInfo.lpDesktop);</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå°±æ˜¯æœ€ç»ˆå‘ˆç°ç»™æˆ‘ä»¬çš„shellçª—å£<br>åŠ¨è°ƒ åœ¨è¿™å‰é¢å¾ˆå®¹æ˜“çœ‹åˆ°ä¸€å †messagebox<br>æ³¨æ„åˆ°æœ‰å¾ˆå¤šlpathnameè¿™ç§<br>åœ¨256è¡Œ</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  <span class="built_in">sub_401EC1</span>(v36);</span><br><span class="line">  <span class="built_in">sub_405040</span>(v36);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">SetCurrentDirectoryA</span>(lpPathName[<span class="number">0</span>]) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">SetCurrentDirectoryA</span>(v36[<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">FREE</span>((<span class="type">void</span> *)v36[<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">FREE</span>(v28[<span class="number">0</span>]);</span><br><span class="line">LABEL_42:</span><br><span class="line">  ...</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡ŒåŠ¨è°ƒå¯ä»¥å‘ç°lpPathName[0]æŒ‡å‘C:&#x2F;&#x2F;USER&#x2F;xxx&#x2F;AppData&#x2F;local&#x2F;tmp ä¸‹çš„ä¸€ä¸ªæ–‡ä»¶<br>æˆ‘ç”µè„‘ä¸Šå°±æ˜¯è¿™ä¸ªè·¯å¾„ C:\Users\asus\AppData\Local\Temp\7zS24E6.tmp<br>æ‰“å¼€å‘ç°æœ‰ä¸€ä¸ªbat2exe.exe è¿˜æœ‰ä¸€ä¸ªbat  ç‚¹å‡»batè¿è¡Œå‘ç°å°±æ˜¯æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„shellçª—å£</p>
<p>é¡¾åæ€ä¹‰è¿™ä¸ªbat2exeæ˜¯å°†.batè½¬æˆ.exe é‚£ä¹ˆæˆ‘ä»¬æŸ¥çœ‹.batå†…å®¹ ç›´æ¥å³é”®æ‰“ä¸å¼€ è½¬æˆ.txtæ‰“å¼€</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">set</span> /p input =please input flag:</span><br><span class="line"><span class="built_in">set</span> input|findstr <span class="string">&quot;\&lt;123123\&gt;&quot;</span></span><br><span class="line">cls</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;%errorlevel%&quot;</span> == <span class="string">&quot;0&quot;</span> ( goto 0 ) ELSE (goto 1)</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">:0</span><br><span class="line"><span class="built_in">echo</span> good_job!</span><br><span class="line">pause</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">:1</span><br><span class="line"><span class="built_in">echo</span> sorry...</span><br><span class="line">pause</span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>

<p>å¾ˆæ¸…æ™° flagå°±æ˜¯123123<br>åŒæ—¶è¾“å…¥å®Œåçš„clsä¹Ÿå°è¯äº†å‰é¢è¾“å…¥å®Œè¢«æ¸…ç©ºçš„ç°è±¡<br><strong>NSSCTF{123123}</strong></p>
<hr>
<hr>
<p>æ€»çš„æ¥è¯´è¿˜æ˜¯ä¸€é“å¾ˆæ–°é¢–çš„é¢˜çš„<br>æˆ‘çš„è§£é¢˜çªç ´å£å°±åœ¨äºå‘ç°lpathnameè¿™ç§æ•æ„Ÿå˜é‡<br>PEåƒå˜ä¸‡åŒ– è¿˜è¦ç»§ç»­åŠ æ²¹å­¦ä¹ !</p>
<h2 id="ctfshow-å·ç‹æ¯-babyoc"><a href="#ctfshow-å·ç‹æ¯-babyoc" class="headerlink" title="ctfshow-å·ç‹æ¯-babyoc"></a>ctfshow-å·ç‹æ¯-babyoc</h2><p>ä¸€é“Object-Cçš„é¢˜ ä¸€äº›ç‹¬ç‰¹çš„è¯­æ³• è®°å½•ä¸€ä¸‹<br>ç½‘ä¸Šç²—ç•¥å­¦äº†ä¸€ä¸‹Object-C ç„¶è€Œè¿›IDAè¿˜æ˜¯çœ‹ä¸æ€ä¹ˆæ‡‚â€¦</p>
<p>åœ¨ä¸»å‡½æ•°å¾ˆå®¹æ˜“æ‰¾åˆ°è¾“å…¥ç‚¹ enc check<br>å‡½æ•°åˆ—è¡¨ç¿»ç¿»è¿˜èƒ½æ‰¾åˆ°xor add è¿™ç§è¿ç®—<br>çœ‹enc<br>åˆ†å¥‡å¶ä½è¿›è¡Œäº†å¤„ç†<br>ç¨‹åºè¿™ä¹ˆå†™çš„:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0LL</span>; i &lt; *(_QWORD *)(a1 + <span class="number">16</span>); i += <span class="number">2LL</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v13 = <span class="built_in">objc_get_class</span>(<span class="string">&quot;flagChar&quot;</span>, v10, v12);</span><br><span class="line">    v14 = (__int64 (__fastcall *)(__int64, <span class="type">char</span> **))<span class="built_in">objc_msg_lookup</span>(v13, off_55EC019DFA50);</span><br><span class="line">    v30 = <span class="built_in">v14</span>(v13, off_55EC019DFA50);</span><br><span class="line">    v15 = (<span class="built_in">void</span> (__fastcall *)(__int64, <span class="type">char</span> **, _QWORD))<span class="built_in">objc_msg_lookup</span>(v30, off_55EC019DFA60);</span><br><span class="line">    <span class="built_in">v15</span>(v30, off_55EC019DFA60, (<span class="type">unsigned</span> __int16)(<span class="number">1249</span> * i));</span><br><span class="line">    v16 = (<span class="built_in">void</span> (__fastcall *)(__int64, <span class="type">char</span> **, _QWORD))<span class="built_in">objc_msg_lookup</span>(v30, off_55EC019DFA80);</span><br><span class="line">    v17 = (__int64 (__fastcall *)(__int64, <span class="type">char</span> **, <span class="type">unsigned</span> __int64))<span class="built_in">objc_msg_lookup</span>(a3, off_55EC019DFA70);</span><br><span class="line">    v18 = <span class="built_in">v17</span>(a3, off_55EC019DFA70, i);</span><br><span class="line">    <span class="built_in">v16</span>(v30, off_55EC019DFA80, v18);</span><br><span class="line">    v19 = *(_QWORD *)(a1 + <span class="number">8</span>);</span><br><span class="line">    v20 = (<span class="built_in">void</span> (__fastcall *)(__int64, <span class="type">char</span> **, __int64))<span class="built_in">objc_msg_lookup</span>(v19, off_55EC019DFA90);</span><br><span class="line">    v10 = off_55EC019DFA90;</span><br><span class="line">    <span class="built_in">v20</span>(v19, off_55EC019DFA90, v30);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯çœŸçœ‹ç€å¤´å¤§<br>çœ‹æ±‡ç¼–å‘ç°ä¸€äº› I: Y: è¿™ç§å­—ç¬¦<br>æŸ¥çœ‹äº¤å‰å¼•ç”¨</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">.data:<span class="number">000055</span>EC019DF590 C2 F0 <span class="number">9</span>D <span class="number">01</span> EC <span class="number">55</span> <span class="number">00</span> <span class="number">00</span>       dq offset aR                            ; <span class="string">&quot;R&quot;</span></span><br><span class="line">.data:<span class="number">000055</span>EC019DF598 B8 F1 <span class="number">9</span>D <span class="number">01</span> EC <span class="number">55</span> <span class="number">00</span> <span class="number">00</span>       dq offset aQ1608_0                      ; <span class="string">&quot;Q16@0:8&quot;</span></span><br><span class="line">.data:<span class="number">000055</span>EC019DF5A0 E3 C3 <span class="number">9</span>D <span class="number">01</span> EC <span class="number">55</span> <span class="number">00</span> <span class="number">00</span>       dq offset sub_55EC019DC3E3</span><br><span class="line">.data:<span class="number">000055</span>EC019DF5A8 C4 F0 <span class="number">9</span>D <span class="number">01</span> EC <span class="number">55</span> <span class="number">00</span> <span class="number">00</span>       dq offset aI                            ; <span class="string">&quot;I:&quot;</span></span><br><span class="line">.data:<span class="number">000055</span>EC019DF5B0 C0 F1 <span class="number">9</span>D <span class="number">01</span> EC <span class="number">55</span> <span class="number">00</span> <span class="number">00</span>       dq offset aV2408q16                     ; <span class="string">&quot;v24@0:8Q16&quot;</span></span><br><span class="line">.data:<span class="number">000055</span>EC019DF5B8 C4 C3 <span class="number">9</span>D <span class="number">01</span> EC <span class="number">55</span> <span class="number">00</span> <span class="number">00</span>       dq offset sub_55EC019DC3C4</span><br><span class="line">.data:<span class="number">000055</span>EC019DF5C0 C7 F0 <span class="number">9</span>D <span class="number">01</span> EC <span class="number">55</span> <span class="number">00</span> <span class="number">00</span>       dq offset aY                            ; <span class="string">&quot;Y:&quot;</span></span><br><span class="line">.data:<span class="number">000055</span>EC019DF5C8 C0 F1 <span class="number">9</span>D <span class="number">01</span> EC <span class="number">55</span> <span class="number">00</span> <span class="number">00</span>       dq offset aV2408q16                     ; <span class="string">&quot;v24@0:8Q16&quot;</span></span><br><span class="line">.data:<span class="number">000055</span>EC019DF5D0 <span class="number">9</span>A C3 <span class="number">9</span>D <span class="number">01</span> EC <span class="number">55</span> <span class="number">00</span> <span class="number">00</span>       dq offset sub_55EC019DC39A</span><br><span class="line">.data:<span class="number">000055</span>EC019DF5D8 CA F0 <span class="number">9</span>D <span class="number">01</span> EC <span class="number">55</span> <span class="number">00</span> <span class="number">00</span>       dq offset aA                            ; <span class="string">&quot;A:&quot;</span></span><br><span class="line">.data:<span class="number">000055</span>EC019DF5E0 C0 F1 <span class="number">9</span>D <span class="number">01</span> EC <span class="number">55</span> <span class="number">00</span> <span class="number">00</span>       dq offset aV2408q16                     ; <span class="string">&quot;v24@0:8Q16&quot;</span></span><br><span class="line">.data:<span class="number">000055</span>EC019DF5E8 <span class="number">70</span> C3 <span class="number">9</span>D <span class="number">01</span> EC <span class="number">55</span> <span class="number">00</span> <span class="number">00</span>       dq offset sub_55EC019DC370</span><br><span class="line">.data:<span class="number">000055</span>EC019DF5F0 CD F0 <span class="number">9</span>D <span class="number">01</span> EC <span class="number">55</span> <span class="number">00</span> <span class="number">00</span>       dq offset aB                            ; <span class="string">&quot;B:&quot;</span></span><br><span class="line">.data:<span class="number">000055</span>EC019DF5F8 D0 F1 <span class="number">9</span>D <span class="number">01</span> EC <span class="number">55</span> <span class="number">00</span> <span class="number">00</span>       dq offset aC2408q16_0                   ; <span class="string">&quot;C24@0:8Q16&quot;</span></span><br><span class="line">.data:<span class="number">000055</span>EC019DF600 <span class="number">4F</span> C3 <span class="number">9</span>D <span class="number">01</span> EC <span class="number">55</span> <span class="number">00</span> <span class="number">00</span>       dq offset sub_55EC019DC34F</span><br><span class="line">.data:<span class="number">000055</span>EC019DF608 D0 F0 <span class="number">9</span>D <span class="number">01</span> EC <span class="number">55</span> <span class="number">00</span> <span class="number">00</span>       dq offset asc_55EC019DF0D0              ; <span class="string">&quot;X:&quot;</span></span><br><span class="line">.data:<span class="number">000055</span>EC019DF610 C0 F1 <span class="number">9</span>D <span class="number">01</span> EC <span class="number">55</span> <span class="number">00</span> <span class="number">00</span>       dq offset aV2408q16                     ; <span class="string">&quot;v24@0:8Q16&quot;</span></span><br><span class="line">.data:<span class="number">000055</span>EC019DF618 <span class="number">25</span> C3 <span class="number">9</span>D <span class="number">01</span> EC <span class="number">55</span> <span class="number">00</span> <span class="number">00</span>       dq offset sub_55EC019DC325</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç° R&#x2F;I&#x2F;â€¦ è¿™äº›æ˜¯ç±» åé¢çš„ç¬¬ä¸‰é¡¹æ˜¯ç±»ä¸­çš„æ–¹æ³•(åº”è¯¥æ˜¯) ç¬¬äºŒé¡¹æ˜¯ç±»ä¼¼ç­¾åè¿™ç§<br>é‚£ä¹ˆæˆ‘ä»¬å¯¹äºæ¯ä¸ªåªéœ€è¦å…³æ³¨å®ƒæ‰€è°ƒç”¨çš„æ–¹æ³•å³å¯<br>å‘ç°æ­£æ˜¯å‰é¢æ‰¾åˆ°çš„xor&#x2F;add&#x2F;movç­‰æ“ä½œ</p>
<p>çŸ¥é“è¿™ç‚¹å é€ä¸ªåˆ†æè¿˜åŸåŠ å¯†é€»è¾‘ é€†å‘å›å»å³å¯<br>æ³¨æ„ encæ˜¯sub_55EC019DC7A6 åˆšåˆšåˆ†æçš„å¥‡å¶xoræ˜¯åœ¨inputä¸‹è°ƒç”¨çš„</p>
<p>inputä¸‹çš„åŠ å¯†å°±ä½œäº† xor 0x4E1*i çš„æ“ä½œ<br>æ³¨æ„åˆ°Yå¯¹åº”çš„ *(_QWORD *)(a1 + 8) &#x3D; a3 ^ *(_QWORD *)(a1 + 16);<br>äº‹å®ä¸Šè¿™é‡Œé™æ€è¿˜æ˜¯å¾ˆéº»çƒ¦çš„ ä½†æ˜¯Linuxè¦è¿è¡ŒObject-Cä¹Ÿæ¯”è¾ƒéº»çƒ¦â€¦<br>å¥½åƒæ˜ç™½äº† calé‡Œçš„ç¬¬äºŒä¸ªå¾ªç¯çœ‹ä¼¼æ­£åº å…¶å®</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( j = <span class="number">0LL</span>; ; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    result = *(_QWORD *)(a1 + <span class="number">16</span>) - <span class="number">1LL</span>;</span><br><span class="line">    <span class="keyword">if</span> ( j &gt;= result )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v10 = *(_QWORD *)(a1 + <span class="number">8</span>);</span><br><span class="line">    v11 = (__int64 (__fastcall *)(__int64, <span class="type">char</span> **, <span class="type">unsigned</span> __int64))<span class="built_in">objc_msg_lookup</span>(v10, OBJECT_AT_INDEX);</span><br><span class="line">    v12 = <span class="built_in">v11</span>(v10, OBJECT_AT_INDEX, *(_QWORD *)(a1 + <span class="number">16</span>) - j - <span class="number">1</span>);</span><br><span class="line">    v13 = (<span class="built_in">void</span> (__fastcall *)(__int64, <span class="type">char</span> **, __int64))<span class="built_in">objc_msg_lookup</span>(v12, A_XOR);</span><br><span class="line">    v14 = *(_QWORD *)(a1 + <span class="number">8</span>);</span><br><span class="line">    v15 = (__int64 (__fastcall *)(__int64, <span class="type">char</span> **, <span class="type">unsigned</span> __int64))<span class="built_in">objc_msg_lookup</span>(v14, OBJECT_AT_INDEX);</span><br><span class="line">    v16 = <span class="built_in">v15</span>(v14, OBJECT_AT_INDEX, *(_QWORD *)(a1 + <span class="number">16</span>) - j - <span class="number">2</span>);</span><br><span class="line">    v17 = (__int64 (__fastcall *)(__int64, <span class="type">char</span> **))<span class="built_in">objc_msg_lookup</span>(v16, R_MOV);</span><br><span class="line">    v18 = <span class="built_in">v17</span>(v16, R_MOV);</span><br><span class="line">    <span class="built_in">v13</span>(v12, A_XOR, v18);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„å–å¾—æ˜¯ *(_QWORD *)(a1 + 16) - j - 1<br>*(_QWORD *)(a1 + 16)  - 1 æ˜¯len ä¹Ÿå°±æ˜¯å–å¾— len-1  len-2  â€¦  woc  æ‰€ä»¥æ˜¯å€’åºâ€¦<br>æ³¨æ„Aå¯¹åº”çš„xor</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_55EC019DC370</span><span class="params">(__int64 a1, __int64 a2, __int64 a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  result = a1;</span><br><span class="line">  *(_QWORD *)(a1 + <span class="number">8</span>) ^= a3;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥è¿™é‡Œæ˜¯ [len-1-j] ^&#x3D; [len-1-j-1]</p>
<p>ä½†æ˜¯å¥‡å¶é¡¹åŠ å¯†çš„+ ^ é¡ºåºé™æ€è¿˜æ˜¯æ²¡æ‰¾å‡ºæ¥â€¦ åŠ¨è°ƒåº”è¯¥èƒ½ç§’å‡º  ä½†æ˜¯æˆ‘æ‡’å¾—å®‰ä¾èµ–åº“äº†â€¦</p>
<p>æœ€åè§£å¯†é•¿è¿™æ ·:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">data = [<span class="number">1270</span>, <span class="number">2767</span>, <span class="number">5549</span>, <span class="number">9672</span>, <span class="number">11938</span>, <span class="number">16093</span>, <span class="number">29864</span>, <span class="number">30379</span>, <span class="number">22184</span>, <span class="number">20690</span>, <span class="number">25002</span>,</span><br><span class="line">        <span class="number">65039</span>, <span class="number">65793</span>, <span class="number">97983</span>, <span class="number">100411</span>, <span class="number">67904</span>, <span class="number">88053</span>, <span class="number">28147</span>, <span class="number">18776</span>, <span class="number">71764</span>, <span class="number">127654</span>,</span><br><span class="line">        <span class="number">39994</span>, <span class="number">30276</span>, <span class="number">33151</span>, <span class="number">49377</span>, <span class="number">62682</span>, <span class="number">128398</span>, <span class="number">32406</span>]</span><br><span class="line"></span><br><span class="line">key = [<span class="number">0x4E1</span> * i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">28</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">28</span>):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        data[i] ^= data[i - <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        data[i] -= data[i - <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        data[i] ^= data[i + <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        data[i] -= data[i + <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">28</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(data[i] ^ key[i]), end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>ctfshow{babyï¼¯ï½‚ï½Šï¼£,ä½ çœŸçš„è§£å‡ºæ¥äº†TQL}</strong></p>
<h2 id="SUCTF2019-hardCpp"><a href="#SUCTF2019-hardCpp" class="headerlink" title="SUCTF2019 hardCpp"></a>SUCTF2019 hardCpp</h2><p>ollvmè§£æ··æ·†å¹³å¦åŒ–åæ˜¯è¿™ç§:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  v28 = <span class="number">0</span>;</span><br><span class="line">  v27 = argc;</span><br><span class="line">  v26 = argv;</span><br><span class="line">  v25 = <span class="built_in">time</span>(<span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;func(?)=\&quot;01abfc750a0c942167651c40d088531d\&quot;?&quot;</span>);</span><br><span class="line">  s = <span class="built_in">getchar</span>();</span><br><span class="line">  <span class="built_in">fgets</span>(v20, <span class="number">21</span>, stdin);</span><br><span class="line">  v18 = <span class="built_in">time</span>(<span class="number">0LL</span>);</span><br><span class="line">  v17 = v18 - v25;</span><br><span class="line">  v29 = v18 - v25;</span><br><span class="line">  <span class="keyword">if</span> ( v18 - v25 &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Let the silent second hand take the place of my doubt...&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v16 = <span class="built_in">strlen</span>(&amp;s);</span><br><span class="line">  v30 = v16 != <span class="number">21</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v16 != <span class="number">21</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">1</span>; i &lt; <span class="number">21</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v14 = v17 ^ v20[i - <span class="number">1</span>];</span><br><span class="line">    v13[<span class="number">0</span>] = main::$_0::<span class="built_in">operator</span>()(v23, (<span class="type">unsigned</span> <span class="type">int</span>)v14);</span><br><span class="line">    v12[<span class="number">0</span>] = main::$_1::<span class="built_in">operator</span>()(v21, (<span class="type">unsigned</span> <span class="type">int</span>)*(&amp;s + v17 + i - <span class="number">1</span>));</span><br><span class="line">    v3 = main::$_1::<span class="built_in">operator</span>() <span class="built_in">const</span>(<span class="type">char</span>)::&#123;<span class="built_in">lambda</span>(<span class="type">int</span>)#<span class="number">1</span>&#125;::<span class="built_in">operator</span>()(v12, <span class="number">7LL</span>);</span><br><span class="line">    v14 = main::$_0::<span class="built_in">operator</span>() <span class="built_in">const</span>(<span class="type">char</span>)::&#123;<span class="built_in">lambda</span>(<span class="type">char</span>)#<span class="number">1</span>&#125;::<span class="built_in">operator</span>()(v13, (<span class="type">unsigned</span> <span class="type">int</span>)v3);</span><br><span class="line">    v11[<span class="number">0</span>] = main::$_2::<span class="built_in">operator</span>()(v24, (<span class="type">unsigned</span> <span class="type">int</span>)v14);</span><br><span class="line">    v10[<span class="number">0</span>] = main::$_2::<span class="built_in">operator</span>()(v24, (<span class="type">unsigned</span> <span class="type">int</span>)*(&amp;s + v17 + i - <span class="number">1</span>));</span><br><span class="line">    v4 = main::$_2::<span class="built_in">operator</span>() <span class="built_in">const</span>(<span class="type">char</span>)::&#123;<span class="built_in">lambda</span>(<span class="type">char</span>)#<span class="number">1</span>&#125;::<span class="built_in">operator</span>()(v10, <span class="number">18LL</span>);</span><br><span class="line">    v9[<span class="number">0</span>] = main::$_3::<span class="built_in">operator</span>()(v22, (<span class="type">unsigned</span> <span class="type">int</span>)v4);</span><br><span class="line">    v5 = main::$_3::<span class="built_in">operator</span>() <span class="built_in">const</span>(<span class="type">char</span>)::&#123;<span class="built_in">lambda</span>(<span class="type">char</span>)#<span class="number">1</span>&#125;::<span class="built_in">operator</span>()(v9, <span class="number">3LL</span>);</span><br><span class="line">    v8[<span class="number">0</span>] = main::$_0::<span class="built_in">operator</span>()(v23, (<span class="type">unsigned</span> <span class="type">int</span>)v5);</span><br><span class="line">    v6 = main::$_0::<span class="built_in">operator</span>() <span class="built_in">const</span>(<span class="type">char</span>)::&#123;<span class="built_in">lambda</span>(<span class="type">char</span>)#<span class="number">1</span>&#125;::<span class="built_in">operator</span>()(v8, <span class="number">2LL</span>);</span><br><span class="line">    v14 = main::$_2::<span class="built_in">operator</span>() <span class="built_in">const</span>(<span class="type">char</span>)::&#123;<span class="built_in">lambda</span>(<span class="type">char</span>)#<span class="number">1</span>&#125;::<span class="built_in">operator</span>()(v11, (<span class="type">unsigned</span> <span class="type">int</span>)v6);</span><br><span class="line">    <span class="keyword">if</span> ( enc[i - <span class="number">1</span>] != v14 )</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;You win&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é‡ç‚¹åˆ†æä¸‹é‚£äº›lambda<br>ç¬¬1,2ä¸ªéƒ½æ˜¯ç›´æ¥è¿”å›a2<br>ç¬¬3ä¸ªæ˜¯å–æ¨¡<br>ç¬¬4ä¸ªæ¯”è¾ƒé‡è¦:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall main::$_0::<span class="built_in">operator</span>() <span class="built_in">const</span>(<span class="type">char</span>)::&#123;<span class="built_in">lambda</span>(<span class="type">char</span>)#<span class="number">1</span>&#125;::<span class="built_in">operator</span>()(__int64 a1, <span class="type">char</span> a2)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// [rsp+0h] [rbp-40h]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+8h] [rbp-38h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+Ch] [rbp-34h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+10h] [rbp-30h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [rsp+14h] [rbp-2Ch]</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+18h] [rbp-28h]</span></span><br><span class="line">  <span class="type">char</span> v9; <span class="comment">// [rsp+23h] [rbp-1Dh]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+24h] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">char</span> v11; <span class="comment">// [rsp+2Ah] [rbp-16h]</span></span><br><span class="line">  <span class="type">bool</span> v12; <span class="comment">// [rsp+2Bh] [rbp-15h]</span></span><br><span class="line"></span><br><span class="line">  v11 = <span class="number">1</span>;</span><br><span class="line">  v12 = y_6 &lt; <span class="number">10</span>;</span><br><span class="line">  v9 = a2;</span><br><span class="line">  v8 = a1;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v10 = <span class="number">-1418698808</span>;</span><br><span class="line">  v7 = <span class="number">-1418698808</span>;</span><br><span class="line">  v6 = <span class="number">618368500</span>;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v3 = (<span class="type">char</span> *)a1;</span><br><span class="line">  *((_BYTE *)&amp;v3 - <span class="number">16</span>) = a2;</span><br><span class="line">  <span class="keyword">return</span> (<span class="type">unsigned</span> <span class="type">int</span>)(*((<span class="type">char</span> *)&amp;v3 - <span class="number">16</span>) + *v3);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œè¿›è¡Œçš„æ˜¯å­—ç¬¦ä¸²ç›¸åŠ çš„æ“ä½œ!<br>ç¬¬5ä¸ªè¿˜æ˜¯è¿”å›<br>ç¬¬6ä¸ªä¹Ÿè¿˜æ˜¯è¿”å›<br>ç¬¬7ä¸ªæ˜¯å¼‚æˆ–18<br>ç¬¬8ä¸ªè¿˜æ˜¯è¿”å›<br>ç¬¬9ä¸ªæ˜¯ç›¸ä¹˜<br>ç¬¬10ä¸ªè¿˜æ˜¯è¿”å›<br>ç¬¬11ä¸ªå­—ç¬¦ä¸²ç›¸åŠ <br>ç¬¬12ä¸ªxor</p>
<p>æ³¨æ„ä¸€ä¸ªå°ç»†èŠ‚ v20[i - 1] å’Œ &amp;s + zero + i - 1<br>sæ˜¯åœ¨v20å‰é¢ä¸€ä½çš„ æ‰€ä»¥ç›¸å½“äºæ˜¯0~20ç›¸é‚»ä¸¤ä¸ªè¿›è¡ŒåŠ å¯†å¤„ç†<br>å¤§è‡´å¾—åˆ°è¿™æ ·çš„åŠ å¯†ä»£ç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">21</span>):</span><br><span class="line">    v14 = a[i]</span><br><span class="line">    v13 = v14</span><br><span class="line">    v12 = a[i-<span class="number">1</span>]</span><br><span class="line">    v3 = v12%<span class="number">7</span></span><br><span class="line">    v14 = v13+v3</span><br><span class="line">    v10 = a[i-<span class="number">1</span>]</span><br><span class="line">    v4 = v10^<span class="number">18</span></span><br><span class="line">    v9 = v4</span><br><span class="line">    v5 = v9*<span class="number">3</span></span><br><span class="line">    v6 = v5+<span class="number">2</span></span><br><span class="line">    v14 ^= v6</span><br><span class="line">    check = enc[i-<span class="number">1</span>]==v14</span><br><span class="line"></span><br><span class="line">check = (a[i]+a[i-<span class="number">1</span>]%<span class="number">7</span>)^((a[i-<span class="number">1</span>]^<span class="number">18</span>)*<span class="number">3</span>+<span class="number">2</span>)==enc[i-<span class="number">1</span>]</span><br></pre></td></tr></table></figure>

<p>çˆ†ç ´ä¸‹så³å¯<br>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">0xF3</span>, <span class="number">0x2E</span>, <span class="number">0x18</span>, <span class="number">0x36</span>, <span class="number">0xE1</span>, <span class="number">0x4C</span>, <span class="number">0x22</span>, <span class="number">0xD1</span>, <span class="number">0xF9</span>, <span class="number">0x8C</span>, <span class="number">0x40</span>, <span class="number">0x76</span>, <span class="number">0xF4</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x05</span>, <span class="number">0xA3</span>, <span class="number">0x90</span>, <span class="number">0x0E</span>, <span class="number">0xA5</span>]</span><br><span class="line"><span class="comment"># check = (a[i]+a[i-1]%7)^((a[i-1]^18)*3+2)==enc[i-1]</span></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">    a = []</span><br><span class="line">    a.append(s)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">        x = enc[i]^(((a[-<span class="number">1</span>]^<span class="number">18</span>)*<span class="number">3</span>+<span class="number">2</span>))</span><br><span class="line">        a.append(((x-a[-<span class="number">1</span>]%<span class="number">7</span>))&amp;<span class="number">0xff</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>(a))</span><br><span class="line"><span class="string">b&#x27;#flag&#123;mY-CurR1ed_Fns&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>flag:<br><strong>flag{mY-CurR1ed_Fns}</strong></p>
<hr>
<hr>
<p>é¡ºä¾¿è®°å½•ä¸€ä¸‹å¦ä¸€ä¸ªåŸºäºangrç¬¦å·æ‰§è¡Œçš„deflat.py<br>ç”¨æ³•:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 deflat.py hardCpp 0x4007E0</span><br><span class="line">python3 deflat.py xxx startaddr</span><br></pre></td></tr></table></figure>

<p>è™½è¯´æ„Ÿè§‰å¼„å®Œåè¿˜æ²¡æœ‰D810æ’ä»¶å¼„å¾—æ¸…æ™° ä½†æ˜¯ä¹Ÿäº†è§£ä¸€ä¸‹ç”¨æ³• å·¥å…·äº’è¡¥<br>è¿™ä¸ªdeflat.pyæœ‰ä¸ªå¥½å¤„æ˜¯ä»–çš„æ±‡ç¼–ä¹Ÿæ˜¯è·Ÿç€ä¼˜åŒ–äº†çš„ æ‰€ä»¥åŠ¨è°ƒçš„è¯è¿˜æ˜¯ç”¨è¿™ä¸ªå·¥å…·æ¥å¹³å¦åŒ–èˆ’é€‚çš„å¤š</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">é¦–é¡µ</a></li>
        
          <li><a href="/about/">å…³äº</a></li>
        
          <li><a href="/archives/">å½’æ¡£</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://github.com/N0zoM1z0">é¡¹ç›®</a></li>
        
          <li><a href="/search/">æœç´¢</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#moectf2023"><span class="toc-number">1.</span> <span class="toc-text">moectf2023</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#GUI"><span class="toc-number">1.1.</span> <span class="toc-text">GUI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#unwind"><span class="toc-number">1.2.</span> <span class="toc-text">unwind</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#miniLCTF2021"><span class="toc-number">2.</span> <span class="toc-text">miniLCTF2021</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sub"><span class="toc-number">2.1.</span> <span class="toc-text">sub</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#miniLCTF2022"><span class="toc-number">3.</span> <span class="toc-text">miniLCTF2022</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#lemon"><span class="toc-number">3.1.</span> <span class="toc-text">lemon</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NOTRC4"><span class="toc-number">3.2.</span> <span class="toc-text">NOTRC4</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NCTF2022"><span class="toc-number">4.</span> <span class="toc-text">NCTF2022</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-rev"><span class="toc-number">4.1.</span> <span class="toc-text">ez_rev</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#just-run-it"><span class="toc-number">4.2.</span> <span class="toc-text">just_run_it</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NCTF2018"><span class="toc-number">5.</span> <span class="toc-text">NCTF2018</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#wcyvm"><span class="toc-number">5.1.</span> <span class="toc-text">wcyvm</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NUAACTF2020"><span class="toc-number">6.</span> <span class="toc-text">NUAACTF2020</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#demium"><span class="toc-number">6.1.</span> <span class="toc-text">demium</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DUCTF2023"><span class="toc-number">7.</span> <span class="toc-text">DUCTF2023</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#nt-flag-checker"><span class="toc-number">7.1.</span> <span class="toc-text">nt_flag_checker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wrong-signal"><span class="toc-number">7.2.</span> <span class="toc-text">wrong-signal</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SPACEGAME"><span class="toc-number">7.3.</span> <span class="toc-text">SPACEGAME</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF2022"><span class="toc-number">8.</span> <span class="toc-text">ACTF2022</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#dropper"><span class="toc-number">8.1.</span> <span class="toc-text">dropper</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF2023-Week5"><span class="toc-number">9.</span> <span class="toc-text">NewStarCTF2023 Week5</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Fish"><span class="toc-number">9.1.</span> <span class="toc-text">Fish</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Genshin"><span class="toc-number">9.2.</span> <span class="toc-text">Genshin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-js2"><span class="toc-number">9.3.</span> <span class="toc-text">easy_js2</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2023%E5%BC%BA%E7%BD%91%E6%9D%AF"><span class="toc-number">10.</span> <span class="toc-text">2023å¼ºç½‘æ¯</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-re"><span class="toc-number">10.1.</span> <span class="toc-text">ez_re</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SM4%E7%9A%84%E5%AF%86%E9%92%A5%E6%89%A9%E5%B1%95%E7%AE%97%E6%B3%95"><span class="toc-number">10.1.1.</span> <span class="toc-text">SM4çš„å¯†é’¥æ‰©å±•ç®—æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%B8%8E%E7%B3%BB%E7%BB%9F%E5%8F%82%E6%95%B0%E5%BC%82%E6%88%96%E2%80%94%E2%80%94%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AF%86%E9%92%A5"><span class="toc-number">10.1.1.1.</span> <span class="toc-text">1.ä¸ç³»ç»Ÿå‚æ•°å¼‚æˆ–â€”â€”åˆå§‹åŒ–å¯†é’¥</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%BD%AE%E8%BF%AD%E4%BB%A3%E7%94%9F%E6%88%90%E8%BD%AE%E5%AF%86%E9%92%A5"><span class="toc-number">10.1.1.2.</span> <span class="toc-text">2.è½®è¿­ä»£ç”Ÿæˆè½®å¯†é’¥</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezre-%E5%BC%BA%E7%BD%91%E5%85%88%E9%94%8B"><span class="toc-number">10.2.</span> <span class="toc-text">ezre(å¼ºç½‘å…ˆé”‹)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GDOUCTF2023"><span class="toc-number">11.</span> <span class="toc-text">GDOUCTF2023</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#L-S"><span class="toc-number">11.1.</span> <span class="toc-text">L!S!</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#TPCTF2023"><span class="toc-number">12.</span> <span class="toc-text">TPCTF2023</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#maze"><span class="toc-number">12.1.</span> <span class="toc-text">maze</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nanoPyEnc"><span class="toc-number">12.2.</span> <span class="toc-text">nanoPyEnc</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GXYCTF2019"><span class="toc-number">13.</span> <span class="toc-text">GXYCTF2019</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#minecraft"><span class="toc-number">13.1.</span> <span class="toc-text">minecraft</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RoarCTF2019"><span class="toc-number">14.</span> <span class="toc-text">RoarCTF2019</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Polyre"><span class="toc-number">14.1.</span> <span class="toc-text">Polyre</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF2018"><span class="toc-number">15.</span> <span class="toc-text">ç½‘é¼æ¯2018</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%A5%BD%E7%9A%84%E8%AF%AD%E8%A8%80"><span class="toc-number">15.1.</span> <span class="toc-text">æœ€å¥½çš„è¯­è¨€</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF2023"><span class="toc-number">16.</span> <span class="toc-text">ç¾ŠåŸæ¯2023</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#CSGO"><span class="toc-number">16.1.</span> <span class="toc-text">CSGO</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Blast"><span class="toc-number">16.2.</span> <span class="toc-text">Blast</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vm-wo"><span class="toc-number">16.3.</span> <span class="toc-text">vm_wo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EZ%E5%8A%A0%E5%AF%86%E5%99%A8"><span class="toc-number">16.4.</span> <span class="toc-text">EZåŠ å¯†å™¨</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#V-N2020%E5%85%AC%E5%BC%80%E8%B5%9B"><span class="toc-number">17.</span> <span class="toc-text">V&amp;N2020å…¬å¼€èµ›</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#strangeCPP"><span class="toc-number">17.1.</span> <span class="toc-text">strangeCPP</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BJDCTF-2nd"><span class="toc-number">18.</span> <span class="toc-text">BJDCTF 2nd</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#guessgame"><span class="toc-number">18.1.</span> <span class="toc-text">guessgame</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy"><span class="toc-number">18.2.</span> <span class="toc-text">easy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8086"><span class="toc-number">18.3.</span> <span class="toc-text">8086</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#justCTF2020"><span class="toc-number">19.</span> <span class="toc-text">justCTF2020</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Rusty"><span class="toc-number">19.1.</span> <span class="toc-text">Rusty</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF2022"><span class="toc-number">20.</span> <span class="toc-text">NewStarCTF2022</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK4"><span class="toc-number">20.1.</span> <span class="toc-text">WEEK4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Exception"><span class="toc-number">20.1.1.</span> <span class="toc-text">Exception</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HelpMe"><span class="toc-number">20.1.2.</span> <span class="toc-text">HelpMe</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK5"><span class="toc-number">20.2.</span> <span class="toc-text">WEEK5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Virtual-Self"><span class="toc-number">20.2.1.</span> <span class="toc-text">Virtual Self</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BUUCTF-N1BOOK"><span class="toc-number">21.</span> <span class="toc-text">BUUCTF&#x2F;N1BOOK</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-rust"><span class="toc-number">21.1.</span> <span class="toc-text">easy_rust</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-go"><span class="toc-number">21.2.</span> <span class="toc-text">easy_go</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-mfc"><span class="toc-number">21.3.</span> <span class="toc-text">easy_mfc</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NPUCTF2020"><span class="toc-number">22.</span> <span class="toc-text">NPUCTF2020</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#BasicASM"><span class="toc-number">22.1.</span> <span class="toc-text">BasicASM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Baby-Obfuscation"><span class="toc-number">22.2.</span> <span class="toc-text">Baby Obfuscation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8A%9C%E6%B9%96%F0%9F%9B%AB"><span class="toc-number">22.3.</span> <span class="toc-text">èŠœæ¹–ğŸ›«</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF2019"><span class="toc-number">23.</span> <span class="toc-text">å®‰æ´µæ¯2019</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#crackMe"><span class="toc-number">23.1.</span> <span class="toc-text">crackMe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Game"><span class="toc-number">23.2.</span> <span class="toc-text">Game</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF2021"><span class="toc-number">24.</span> <span class="toc-text">å®‰æ´µæ¯2021</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sign-in"><span class="toc-number">24.1.</span> <span class="toc-text">sign_in</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MTCTF2021"><span class="toc-number">25.</span> <span class="toc-text">MTCTF2021</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#wow"><span class="toc-number">25.1.</span> <span class="toc-text">wow</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Superflat"><span class="toc-number">25.2.</span> <span class="toc-text">Superflat</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GKCTF2021"><span class="toc-number">26.</span> <span class="toc-text">GKCTF2021</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#QQQQT"><span class="toc-number">26.1.</span> <span class="toc-text">QQQQT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#App-debug"><span class="toc-number">26.2.</span> <span class="toc-text">App-debug</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GWCTF2019"><span class="toc-number">27.</span> <span class="toc-text">GWCTF2019</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#babyvm"><span class="toc-number">27.1.</span> <span class="toc-text">babyvm</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HGAME2022"><span class="toc-number">28.</span> <span class="toc-text">HGAME2022</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#week4-ezvm"><span class="toc-number">28.1.</span> <span class="toc-text">week4 ezvm</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FSCTF2023"><span class="toc-number">29.</span> <span class="toc-text">FSCTF2023</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ezbroke"><span class="toc-number">29.1.</span> <span class="toc-text">ezbroke</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SWPU2019"><span class="toc-number">30.</span> <span class="toc-text">SWPU2019</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#EasiestRe"><span class="toc-number">30.1.</span> <span class="toc-text">EasiestRe</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HGAME2023"><span class="toc-number">31.</span> <span class="toc-text">HGAME2023</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#week4-vm"><span class="toc-number">31.1.</span> <span class="toc-text">week4 vm</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BA%A2%E5%B8%BD%E6%9D%AF2019"><span class="toc-number">32.</span> <span class="toc-text">çº¢å¸½æ¯2019</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#xx"><span class="toc-number">32.1.</span> <span class="toc-text">xx</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#calc"><span class="toc-number">32.2.</span> <span class="toc-text">calc</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CISCN-2022-%E4%B8%9C%E5%8C%97"><span class="toc-number">33.</span> <span class="toc-text">CISCN 2022 ä¸œåŒ—</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#hana"><span class="toc-number">33.1.</span> <span class="toc-text">hana</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912022"><span class="toc-number">34.</span> <span class="toc-text">è¥¿æ¹–è®ºå‰‘2022</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#EasyVT"><span class="toc-number">34.1.</span> <span class="toc-text">EasyVT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#babyRe"><span class="toc-number">34.2.</span> <span class="toc-text">babyRe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DualPersonality"><span class="toc-number">34.3.</span> <span class="toc-text">DualPersonality</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%AA%E7%9F%A5%E6%9D%A5%E6%BA%90"><span class="toc-number">35.</span> <span class="toc-text">æœªçŸ¥æ¥æº</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ctfshow-reverse-%E6%AF%94%E8%B5%9B%E5%8E%9F%E9%A2%98-snake"><span class="toc-number">35.1.</span> <span class="toc-text">ctfshow-reverse-æ¯”èµ›åŸé¢˜-snake</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NSSCTF-2022-Spring-Recruit-easy-Pe"><span class="toc-number">35.2.</span> <span class="toc-text">[NSSCTF 2022 Spring Recruit]easy Pe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ctfshow-%E5%8D%B7%E7%8E%8B%E6%9D%AF-babyoc"><span class="toc-number">35.3.</span> <span class="toc-text">ctfshow-å·ç‹æ¯-babyoc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SUCTF2019-hardCpp"><span class="toc-number">35.4.</span> <span class="toc-text">SUCTF2019 hardCpp</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://n0zom1z0.github.io/Reverse-Other/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://n0zom1z0.github.io/Reverse-Other/&text=Reverse-Other"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://n0zom1z0.github.io/Reverse-Other/&title=Reverse-Other"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://n0zom1z0.github.io/Reverse-Other/&is_video=false&description=Reverse-Other"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Reverse-Other&body=Check out this article: http://n0zom1z0.github.io/Reverse-Other/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://n0zom1z0.github.io/Reverse-Other/&title=Reverse-Other"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://n0zom1z0.github.io/Reverse-Other/&title=Reverse-Other"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://n0zom1z0.github.io/Reverse-Other/&title=Reverse-Other"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://n0zom1z0.github.io/Reverse-Other/&title=Reverse-Other"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://n0zom1z0.github.io/Reverse-Other/&name=Reverse-Other&description=&lt;p&gt;è®°å½•ä¸€äº›reverseé¢˜ç›®&lt;/p&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://n0zom1z0.github.io/Reverse-Other/&t=Reverse-Other"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> èœå•</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> ç›®å½•</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> åˆ†äº«</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> è¿”å›é¡¶éƒ¨</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2024
    N0zoM1z0
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
      --><li><a href="/">é¦–é¡µ</a></li><!--
    --><!--
      --><li><a href="/about/">å…³äº</a></li><!--
    --><!--
      --><li><a href="/archives/">å½’æ¡£</a></li><!--
    --><!--
      --><li><a target="_blank" rel="noopener" href="http://github.com/N0zoM1z0">é¡¹ç›®</a></li><!--
    --><!--
      --><li><a href="/search/">æœç´¢</a></li><!--
    -->
      </ul>
      <ul>
        
          <!-- ä¸è’œå­ç»Ÿè®¡ -->
          <span id="busuanzi_container_site_pv">
              æœ¬ç«™æ€»è®¿é—®é‡Kasaki_Nozomiæ¬¡
          </span>
          <span class="post-meta-divider">|</span>
          <span id="busuanzi_container_site_uv" style='display:none'>
                  æœ¬ç«™è®¿å®¢æ•°Yoroizuka_Mizoreäºº
          </span>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        
      </ul>
    </nav>
  </div>
  
</footer>


    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"å¤åˆ¶åˆ°ç²˜è´´æ¿ï¼\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "å¤åˆ¶æˆåŠŸï¼");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
